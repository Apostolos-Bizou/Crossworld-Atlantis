<!DOCTYPE html>
<html lang="en">
<!--
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ATLANTIS ERP - Crossworld Marine Services                                    â•‘
â•‘  VERSION: v2.35 ANALYTICS #1 - CREW CHANGES (FIXED)                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  v2.35: Analytics Tab #1 - Crew Changes (Charts working!)                     â•‘
â•‘  ðŸ† 22/22 MODULES + 10/22 ANALYTICS TABS ðŸ†                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLANTIS v2.35 Analytics #1 Crew Changes WORKING | Crossworld Marine</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --cw-primary: #00495D;
            --cw-primary-dark: #003544;
            --cw-primary-light: #006680;
            --cw-accent: #0891B2;
            --cw-accent-light: #22D3EE;
            --cw-white: #FFFFFF;
            --cw-gray-50: #F8FAFC;
            --cw-gray-100: #F1F5F9;
            --cw-gray-200: #E2E8F0;
            --cw-gray-300: #CBD5E1;
            --cw-gray-400: #94A3B8;
            --cw-gray-500: #64748B;
            --cw-gray-600: #475569;
            --cw-gray-700: #334155;
            --cw-gray-800: #1E293B;
            --cw-gray-900: #0F172A;
            --status-endorsed: #8B5CF6;
            --status-on-approval: #F59E0B;
            --status-on-preparation: #3B82F6;
            --status-ready: #10B981;
            --status-embarked: #059669;
            --status-inactive: #6B7280;
            --tag-dedicated: #0EA5E9;
            --tag-non-dedicated: #8B5CF6;
            --tag-assigned: #10B981;
            --tag-unassigned: #F59E0B;
            --tag-on-leave: #EC4899;
            --tag-nfr: #EF4444;
            --rfa-new: #6366F1;
            --rfa-completed: #047857;
            --rfa-cancelled: #DC2626;
            --sidebar-width: 260px;
            --header-height: 64px;
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --shadow-sm: 0 1px 2px 0 rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --transition-fast: 150ms ease;
            --transition-base: 200ms ease;
            --transition-slow: 300ms ease;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { font-size: 14px; -webkit-font-smoothing: antialiased; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--cw-gray-100); color: var(--cw-gray-800); line-height: 1.5; min-height: 100vh; overflow: hidden; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--cw-gray-100); }
        ::-webkit-scrollbar-thumb { background: var(--cw-gray-300); border-radius: 4px; }
        .app-container { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar { width: var(--sidebar-width); background: var(--cw-primary); color: var(--cw-white); display: flex; flex-direction: column; position: fixed; top: 0; left: 0; bottom: 0; z-index: 100; transition: transform var(--transition-slow); }
        .sidebar-header { padding: 20px 24px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; color: var(--cw-white); }
        .logo-icon { width: 40px; height: 40px; background: rgba(255,255,255,0.15); border-radius: 10px; display: flex; align-items: center; justify-content: center; }
        .logo-icon svg { width: 24px; height: 24px; color: var(--cw-accent-light); }
        .logo-text { display: flex; flex-direction: column; }
        .logo-brand { font-size: 1.25rem; font-weight: 700; letter-spacing: -0.02em; }
        .logo-system { font-size: 0.7rem; font-weight: 500; color: var(--cw-accent-light); text-transform: uppercase; letter-spacing: 0.1em; }
        .sidebar-nav { flex: 1; padding: 16px 12px; overflow-y: auto; }
        .nav-section { margin-bottom: 24px; }
        .nav-section-title { font-size: 0.65rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; color: rgba(255,255,255,0.4); padding: 0 12px; margin-bottom: 8px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-radius: var(--border-radius); color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem; font-weight: 500; transition: all var(--transition-fast); cursor: pointer; position: relative; }
        .nav-item:hover { background: rgba(255,255,255,0.1); color: var(--cw-white); }
        .nav-item.active { background: rgba(255,255,255,0.15); color: var(--cw-white); }
        .nav-item.active::before { content: ''; position: absolute; left: -12px; width: 3px; height: 24px; background: var(--cw-accent-light); border-radius: 0 3px 3px 0; }
        .nav-item svg { width: 20px; height: 20px; flex-shrink: 0; }
        .nav-item-badge { margin-left: auto; background: var(--cw-accent); color: var(--cw-white); font-size: 0.7rem; font-weight: 600; padding: 2px 8px; border-radius: 10px; }
        .nav-item-badge.warning { background: var(--status-on-approval); }
        .nav-item-badge.danger { background: var(--tag-nfr); }
        .sidebar-footer { padding: 16px; border-top: 1px solid rgba(255,255,255,0.1); }
        .user-profile { display: flex; align-items: center; gap: 12px; padding: 8px; border-radius: var(--border-radius); cursor: pointer; }
        .user-profile:hover { background: rgba(255,255,255,0.1); }
        .user-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--cw-accent); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.85rem; }
        .user-info { flex: 1; min-width: 0; }
        .user-name { font-size: 0.85rem; font-weight: 600; }
        .user-role { font-size: 0.7rem; color: rgba(255,255,255,0.6); }
        
        /* Main Content */
        .main-content { flex: 1; margin-left: var(--sidebar-width); display: flex; flex-direction: column; min-height: 100vh; max-height: 100vh; overflow: hidden; }
        .header { height: var(--header-height); background: var(--cw-white); border-bottom: 1px solid var(--cw-gray-200); display: flex; align-items: center; padding: 0 24px; flex-shrink: 0; z-index: 50; }
        .header-left { display: flex; align-items: center; gap: 16px; }
        .menu-toggle { display: none; width: 40px; height: 40px; border: none; background: transparent; color: var(--cw-gray-600); cursor: pointer; border-radius: var(--border-radius); }
        .breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; }
        .breadcrumb-item { color: var(--cw-gray-500); }
        .breadcrumb-item.active { color: var(--cw-gray-800); font-weight: 600; }
        .breadcrumb-separator { color: var(--cw-gray-400); }
        .header-center { flex: 1; display: flex; justify-content: center; padding: 0 32px; }
        .global-search { position: relative; width: 100%; max-width: 480px; }
        .global-search input { width: 100%; height: 40px; padding: 0 16px 0 44px; border: 1px solid var(--cw-gray-200); border-radius: var(--border-radius-lg); font-size: 0.9rem; font-family: inherit; background: var(--cw-gray-50); transition: all var(--transition-fast); }
        .global-search input:focus { outline: none; border-color: var(--cw-accent); background: var(--cw-white); box-shadow: 0 0 0 3px rgba(8,145,178,0.1); }
        .global-search-icon { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: var(--cw-gray-400); pointer-events: none; }
        .global-search-shortcut { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: var(--cw-gray-200); padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-family: 'JetBrains Mono', monospace; color: var(--cw-gray-500); }
        .header-right { display: flex; align-items: center; gap: 8px; }
        .header-action { width: 40px; height: 40px; border-radius: var(--border-radius); border: none; background: transparent; color: var(--cw-gray-600); cursor: pointer; display: flex; align-items: center; justify-content: center; position: relative; transition: all var(--transition-fast); }
        .header-action:hover { background: var(--cw-gray-100); color: var(--cw-gray-800); }
        .notification-badge { position: absolute; top: 6px; right: 6px; width: 8px; height: 8px; background: var(--tag-nfr); border-radius: 50%; border: 2px solid var(--cw-white); }
        
        /* Page Content */
        .page-content { flex: 1; padding: 24px; overflow-y: auto; }
        .view { display: none; animation: fadeIn var(--transition-base) ease; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .page-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px; }
        .page-title-section { display: flex; flex-direction: column; gap: 4px; }
        .page-title { font-size: 1.75rem; font-weight: 700; color: var(--cw-gray-900); letter-spacing: -0.02em; }
        .page-subtitle { font-size: 0.9rem; color: var(--cw-gray-500); }
        .page-actions { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
        
        /* Buttons */
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 10px 16px; font-size: 0.9rem; font-weight: 600; font-family: inherit; border-radius: var(--border-radius); border: none; cursor: pointer; transition: all var(--transition-fast); text-decoration: none; white-space: nowrap; }
        .btn svg { width: 18px; height: 18px; }
        .btn-primary { background: var(--cw-primary); color: var(--cw-white); }
        .btn-primary:hover { background: var(--cw-primary-dark); }
        .btn-secondary { background: var(--cw-white); color: var(--cw-gray-700); border: 1px solid var(--cw-gray-300); }
        .btn-secondary:hover { background: var(--cw-gray-50); border-color: var(--cw-gray-400); }
        .btn-ghost { background: transparent; color: var(--cw-gray-600); }
        .btn-ghost:hover { background: var(--cw-gray-100); color: var(--cw-gray-800); }
        .btn-sm { padding: 6px 12px; font-size: 0.8rem; }
        .btn-icon { padding: 8px; }
        
        /* Cards */
        .card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); }
        .card-header { padding: 16px 20px; border-bottom: 1px solid var(--cw-gray-200); display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-size: 1rem; font-weight: 600; color: var(--cw-gray-800); }
        .card-body { padding: 20px; }
        
        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px; }
        .stat-card { background: var(--cw-white); border-radius: var(--border-radius-lg); padding: 16px 20px; border: 1px solid var(--cw-gray-200); transition: all var(--transition-fast); cursor: pointer; }
        .stat-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .stat-card.active { border-color: var(--cw-primary); background: linear-gradient(135deg, rgba(0,73,93,0.05) 0%, rgba(8,145,178,0.05) 100%); }
        .stat-icon { width: 40px; height: 40px; border-radius: var(--border-radius); display: flex; align-items: center; justify-content: center; margin-bottom: 12px; }
        .stat-icon svg { width: 20px; height: 20px; }
        .stat-icon.primary { background: rgba(0,73,93,0.1); color: var(--cw-primary); }
        .stat-icon.success { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .stat-icon.warning { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .stat-icon.info { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .stat-label { font-size: 0.75rem; font-weight: 600; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px; }
        .stat-value { font-size: 1.75rem; font-weight: 700; color: var(--cw-gray-900); letter-spacing: -0.02em; }
        .stat-change { display: flex; align-items: center; gap: 4px; font-size: 0.75rem; font-weight: 600; margin-top: 4px; }
        .stat-change.positive { color: var(--status-ready); }
        .stat-change.negative { color: var(--tag-nfr); }
        
        /* Filters */
        .filters-panel { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); padding: 16px 20px; margin-bottom: 16px; }
        .filters-bar { display: flex; align-items: flex-end; gap: 12px; flex-wrap: wrap; margin-bottom: 20px; }
        .filters-row { display: flex; align-items: flex-end; gap: 12px; flex-wrap: wrap; }
        .filter-group { display: flex; flex-direction: column; gap: 4px; }
        .filter-group.search-group { flex: 1; min-width: 240px; position: relative; }
        .filter-label { font-size: 0.7rem; font-weight: 600; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.05em; }
        .filter-select { height: 36px; padding: 0 32px 0 12px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); font-size: 0.85rem; font-family: inherit; color: var(--cw-gray-700); background: var(--cw-white) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") no-repeat right 8px center; appearance: none; cursor: pointer; min-width: 160px; }
        .filter-select:focus { outline: none; border-color: var(--cw-accent); box-shadow: 0 0 0 3px rgba(8,145,178,0.1); }
        .search-input { width: 100%; height: 36px; padding: 0 12px 0 36px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); font-size: 0.85rem; font-family: inherit; color: var(--cw-gray-700); }
        .search-input:focus { outline: none; border-color: var(--cw-accent); box-shadow: 0 0 0 3px rgba(8,145,178,0.1); }
        .search-group svg { position: absolute; left: 10px; bottom: 10px; width: 18px; height: 18px; color: var(--cw-gray-400); pointer-events: none; }
        .filter-search { position: relative; flex: 1; min-width: 200px; }
        .filter-search input { width: 100%; height: 36px; padding: 0 12px 0 36px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); font-size: 0.85rem; font-family: inherit; }
        .filter-search input:focus { outline: none; border-color: var(--cw-accent); box-shadow: 0 0 0 3px rgba(8,145,178,0.1); }
        .filter-search svg { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: var(--cw-gray-400); pointer-events: none; }
        .filter-divider { width: 1px; height: 36px; background: var(--cw-gray-200); }
        
        /* Tables */
        .table-container { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; }
        .table-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 20px; border-bottom: 1px solid var(--cw-gray-200); background: var(--cw-gray-50); flex-wrap: wrap; gap: 12px; }
        .table-header-left { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; }
        .table-title { font-size: 0.9rem; font-weight: 600; color: var(--cw-gray-800); }
        .table-count { font-size: 0.8rem; color: var(--cw-gray-500); }
        .selected-actions { display: none; align-items: center; gap: 8px; padding: 6px 12px; background: var(--cw-primary); border-radius: var(--border-radius); color: var(--cw-white); font-size: 0.8rem; }
        .selected-actions.show { display: flex; }
        .selected-count { font-weight: 600; }
        .bulk-action-btn { padding: 4px 10px; background: rgba(255,255,255,0.2); border: none; border-radius: 4px; color: var(--cw-white); font-size: 0.75rem; font-weight: 500; font-family: inherit; cursor: pointer; }
        .bulk-action-btn:hover { background: rgba(255,255,255,0.3); }
        .table-header-right { display: flex; align-items: center; gap: 8px; }
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        thead { background: var(--cw-gray-50); border-bottom: 1px solid var(--cw-gray-200); }
        th { padding: 12px 16px; text-align: left; font-weight: 600; color: var(--cw-gray-600); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; white-space: nowrap; }
        th.sortable { cursor: pointer; user-select: none; }
        th.sortable:hover { background: var(--cw-gray-100); }
        th.sortable::after { content: ''; display: inline-block; width: 16px; height: 16px; margin-left: 4px; vertical-align: middle; background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpath d='m7 15 5 5 5-5'/%3E%3Cpath d='m7 9 5-5 5 5'/%3E%3C/svg%3E") no-repeat center; opacity: 0.5; }
        th.sorted-asc::after { background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300495d' stroke-width='2'%3E%3Cpath d='m18 15-6-6-6 6'/%3E%3C/svg%3E") no-repeat center; opacity: 1; }
        th.sorted-desc::after { background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300495d' stroke-width='2'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") no-repeat center; opacity: 1; }
        tbody tr { border-bottom: 1px solid var(--cw-gray-100); transition: background var(--transition-fast); }
        tbody tr:hover { background: var(--cw-gray-50); }
        tbody tr.selected { background: rgba(8,145,178,0.05); }
        td { padding: 14px 16px; vertical-align: middle; }
        
        /* Checkbox */
        .checkbox-cell { width: 48px; }
        .custom-checkbox { width: 18px; height: 18px; border: 2px solid var(--cw-gray-300); border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--transition-fast); }
        .custom-checkbox:hover { border-color: var(--cw-accent); }
        .custom-checkbox.checked { background: var(--cw-primary); border-color: var(--cw-primary); }
        .custom-checkbox svg { display: none; }
        .custom-checkbox.checked svg { display: block; color: var(--cw-white); }
        
        /* Avatar Cell */
        .avatar-cell { display: flex; align-items: center; gap: 12px; min-width: 200px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-600); flex-shrink: 0; }
        .avatar-info { display: flex; flex-direction: column; min-width: 0; }
        .avatar-name { font-weight: 600; color: var(--cw-gray-900); cursor: pointer; }
        .avatar-name:hover { color: var(--cw-accent); }
        .avatar-meta { font-size: 0.75rem; color: var(--cw-gray-500); font-family: 'JetBrains Mono', monospace; }
        
        /* Badges */
        .badge { display: inline-flex; align-items: center; padding: 4px 10px; border-radius: 4px; font-size: 0.8rem; font-weight: 600; }
        .badge-officer { background: rgba(8,145,178,0.1); color: var(--cw-accent); }
        .badge-rating { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        
        /* Status Badges */
        .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; white-space: nowrap; }
        .status-badge .dot { width: 6px; height: 6px; border-radius: 50%; }
        .status-endorsed { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .status-endorsed .dot { background: var(--status-endorsed); }
        .status-on-approval { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .status-on-approval .dot { background: var(--status-on-approval); }
        .status-on-preparation { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .status-on-preparation .dot { background: var(--status-on-preparation); }
        .status-ready { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .status-ready .dot { background: var(--status-ready); }
        .status-embarked { background: rgba(5,150,105,0.15); color: var(--status-embarked); }
        .status-embarked .dot { background: var(--status-embarked); }
        .status-inactive { background: rgba(107,114,128,0.1); color: var(--status-inactive); }
        .status-inactive .dot { background: var(--status-inactive); }
        .status-new { background: rgba(99,102,241,0.1); color: var(--rfa-new); }
        .status-new .dot { background: var(--rfa-new); }
        .status-in-progress { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .status-in-progress .dot { background: var(--status-on-approval); }
        .status-pending-approval { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .status-pending-approval .dot { background: var(--status-endorsed); }
        .status-approved { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .status-approved .dot { background: var(--status-ready); }
        .status-in-preparation { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .status-in-preparation .dot { background: var(--status-on-preparation); }
        .status-completed { background: rgba(4,120,87,0.1); color: var(--rfa-completed); }
        .status-completed .dot { background: var(--rfa-completed); }
        .status-cancelled { background: rgba(220,38,38,0.1); color: var(--rfa-cancelled); }
        .status-cancelled .dot { background: var(--rfa-cancelled); }
        
        /* Tags */
        .tags-cell { display: flex; flex-wrap: wrap; gap: 4px; }
        .tag { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.02em; }
        .tag-dedicated { background: rgba(14,165,233,0.1); color: var(--tag-dedicated); }
        .tag-non-dedicated { background: rgba(139,92,246,0.1); color: var(--tag-non-dedicated); }
        .tag-assigned { background: rgba(16,185,129,0.1); color: var(--tag-assigned); }
        .tag-unassigned { background: rgba(245,158,11,0.1); color: var(--tag-unassigned); }
        .tag-on-leave { background: rgba(236,72,153,0.1); color: var(--tag-on-leave); }
        .tag-nfr { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .tag-embark { background: rgba(16,185,129,0.1); color: #059669; }
        .tag-signoff { background: rgba(239,68,68,0.1); color: #DC2626; }
        .tag-promotion { background: rgba(139,92,246,0.1); color: #7C3AED; }
        .tag-extension { background: rgba(59,130,246,0.1); color: #2563EB; }
        .tag-replace { background: rgba(245,158,11,0.1); color: #D97706; }
        
        /* Progress */
        .progress-cell { min-width: 100px; }
        .progress-bar-wrapper { display: flex; align-items: center; gap: 8px; }
        .progress-bar { flex: 1; height: 6px; background: var(--cw-gray-200); border-radius: 3px; overflow: hidden; }
        .progress-bar-fill { height: 100%; border-radius: 3px; }
        .progress-bar-fill.complete { background: var(--status-ready); }
        .progress-bar-fill.warning { background: var(--status-on-approval); }
        .progress-bar-fill.danger { background: var(--tag-nfr); }
        .progress-text { font-size: 0.75rem; font-weight: 600; color: var(--cw-gray-600); min-width: 45px; }
        
        /* Date/Text Cells */
        .date-cell { font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; color: var(--cw-gray-600); }
        .date-cell.warning { color: var(--status-on-approval); }
        .date-cell.danger { color: var(--tag-nfr); }
        .text-cell { min-width: 120px; }
        .text-primary { font-weight: 500; color: var(--cw-gray-800); }
        .text-secondary { font-size: 0.75rem; color: var(--cw-gray-500); }
        .text-muted { color: var(--cw-gray-400); }
        
        /* Actions */
        .actions-cell { width: 48px; }
        .actions-btn { width: 32px; height: 32px; border-radius: var(--border-radius); border: none; background: transparent; color: var(--cw-gray-500); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .actions-btn:hover { background: var(--cw-gray-100); color: var(--cw-gray-700); }
        
        /* Pagination */
        .table-footer { display: flex; align-items: center; justify-content: space-between; padding: 12px 20px; border-top: 1px solid var(--cw-gray-200); background: var(--cw-gray-50); flex-wrap: wrap; gap: 12px; }
        .pagination-info { font-size: 0.85rem; color: var(--cw-gray-600); }
        .pagination { display: flex; align-items: center; gap: 4px; }
        .pagination-btn { min-width: 36px; height: 36px; padding: 0 12px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); background: var(--cw-white); color: var(--cw-gray-700); font-size: 0.85rem; font-weight: 500; font-family: inherit; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .pagination-btn:hover:not(:disabled) { border-color: var(--cw-accent); color: var(--cw-accent); }
        .pagination-btn.active { background: var(--cw-primary); border-color: var(--cw-primary); color: var(--cw-white); }
        .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .pagination-ellipsis { padding: 0 8px; color: var(--cw-gray-400); }
        
        /* Panels */
        .panel-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.4); z-index: 200; opacity: 0; visibility: hidden; transition: all var(--transition-base); }
        .panel-overlay.open { opacity: 1; visibility: visible; }
        .slide-panel { position: fixed; top: 0; right: 0; bottom: 0; width: 480px; max-width: 100%; background: var(--cw-white); z-index: 201; transform: translateX(100%); transition: transform var(--transition-slow); display: flex; flex-direction: column; box-shadow: var(--shadow-lg); }
        .slide-panel.open { transform: translateX(0); }
        .slide-panel.large { width: 640px; }
        .panel-header { padding: 20px 24px; border-bottom: 1px solid var(--cw-gray-200); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
        .panel-title { font-size: 1.1rem; font-weight: 600; color: var(--cw-gray-900); }
        .panel-close { width: 32px; height: 32px; border-radius: var(--border-radius); border: none; background: transparent; color: var(--cw-gray-500); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .panel-close:hover { background: var(--cw-gray-100); color: var(--cw-gray-700); }
        .panel-content { flex: 1; overflow-y: auto; padding: 24px; }
        .panel-section { margin-bottom: 24px; }
        .panel-section-title { font-size: 0.75rem; font-weight: 600; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px; }
        .panel-footer { padding: 16px 24px; border-top: 1px solid var(--cw-gray-200); display: flex; gap: 12px; flex-shrink: 0; }
        .panel-footer .btn { flex: 1; }
        
        /* Modals */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 300; display: flex; align-items: center; justify-content: center; padding: 24px; opacity: 0; visibility: hidden; transition: all var(--transition-base); }
        .modal-overlay.open { opacity: 1; visibility: visible; }
        .modal { background: var(--cw-white); border-radius: 16px; width: 100%; max-width: 480px; max-height: 90vh; display: flex; flex-direction: column; transform: scale(0.95) translateY(10px); transition: transform var(--transition-base); }
        .modal-overlay.open .modal { transform: scale(1) translateY(0); }
        .modal.large { max-width: 640px; }
        .modal-header { padding: 20px 24px; border-bottom: 1px solid var(--cw-gray-200); display: flex; align-items: center; justify-content: space-between; }
        .modal-title { font-size: 1.1rem; font-weight: 600; color: var(--cw-gray-900); }
        .modal-close { width: 32px; height: 32px; border-radius: var(--border-radius); border: none; background: transparent; color: var(--cw-gray-500); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .modal-close:hover { background: var(--cw-gray-100); color: var(--cw-gray-700); }
        .modal-body { padding: 24px; overflow-y: auto; }
        .modal-footer { padding: 16px 24px; border-top: 1px solid var(--cw-gray-200); display: flex; justify-content: flex-end; gap: 12px; }
        
        /* Forms */
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-size: 0.8rem; font-weight: 600; color: var(--cw-gray-500); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        .form-label .required { color: var(--tag-nfr); }
        .form-input, .form-select, .form-textarea { width: 100%; border: 2px solid var(--cw-gray-200); border-radius: 10px; font-size: 0.95rem; font-family: inherit; color: var(--cw-gray-800); transition: all var(--transition-fast); background: var(--cw-gray-50); }
        .form-input { height: 48px; padding: 0 16px; }
        .form-select { height: 48px; padding: 0 40px 0 16px; background: var(--cw-gray-50) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") no-repeat right 16px center; appearance: none; cursor: pointer; }
        .form-textarea { min-height: 100px; padding: 14px 16px; resize: vertical; }
        .form-input:hover, .form-select:hover, .form-textarea:hover { border-color: var(--cw-gray-300); background: white; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--cw-accent); box-shadow: 0 0 0 4px rgba(8,145,178,0.1); background: white; }
        .form-input::placeholder, .form-textarea::placeholder { color: var(--cw-gray-400); }
        .form-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .form-section { margin-bottom: 28px; padding-bottom: 24px; border-bottom: 1px solid var(--cw-gray-100); }
        .form-section:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
        .form-section-title { font-size: 0.9rem; font-weight: 700; color: var(--cw-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px; }
        .form-section-title i { width: 18px; height: 18px; }
        .form-hint { font-size: 0.75rem; color: var(--cw-gray-400); margin-top: 6px; }
        .form-input-icon { position: relative; }
        .form-input-icon i { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: var(--cw-gray-400); pointer-events: none; }
        .form-input-icon .form-input, .form-input-icon .form-select { padding-left: 44px; }
        .form-radio-group { display: flex; gap: 12px; flex-wrap: wrap; }
        .form-radio-card { flex: 1; min-width: 120px; padding: 14px 16px; border: 2px solid var(--cw-gray-200); border-radius: 10px; cursor: pointer; transition: all var(--transition-fast); text-align: center; background: var(--cw-gray-50); }
        .form-radio-card:hover { border-color: var(--cw-gray-300); background: white; }
        .form-radio-card.selected { border-color: var(--cw-accent); background: rgba(8,145,178,0.05); }
        .form-radio-card input { display: none; }
        .form-radio-card-label { font-weight: 600; color: var(--cw-gray-700); font-size: 0.9rem; }
        .form-radio-card-desc { font-size: 0.75rem; color: var(--cw-gray-500); margin-top: 4px; }
        
        /* Empty State */
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 48px 24px; text-align: center; }
        .empty-state-icon { width: 64px; height: 64px; border-radius: 50%; background: var(--cw-gray-100); display: flex; align-items: center; justify-content: center; margin-bottom: 16px; }
        .empty-state-icon svg { width: 32px; height: 32px; color: var(--cw-gray-400); }
        .empty-state-title { font-size: 1.1rem; font-weight: 600; color: var(--cw-gray-800); margin-bottom: 8px; }
        .empty-state-description { font-size: 0.9rem; color: var(--cw-gray-500); max-width: 360px; margin-bottom: 24px; }
        
        /* Info Box */
        .info-box { background: var(--cw-gray-50); border-radius: var(--border-radius); padding: 16px; }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .info-item-label { font-size: 0.75rem; color: var(--cw-gray-500); margin-bottom: 2px; }
        .info-item-value { font-weight: 600; color: var(--cw-gray-800); }
        .contact-list { display: flex; flex-direction: column; gap: 8px; }
        .contact-item { display: flex; align-items: center; gap: 12px; font-size: 0.9rem; }
        .contact-item svg { width: 16px; height: 16px; color: var(--cw-gray-400); }
        
        /* Utility */
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        
        /* Gantt Timeline */
        .gantt-container { display: flex; flex-direction: column; min-height: 400px; max-height: 600px; }
        .gantt-header { display: flex; border-bottom: 2px solid var(--cw-gray-200); background: var(--cw-gray-50); position: sticky; top: 0; z-index: 10; }
        .gantt-header-fixed { width: 280px; min-width: 280px; padding: 12px 16px; border-right: 1px solid var(--cw-gray-200); display: flex; align-items: center; }
        .gantt-vessel-header { font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-700); }
        .gantt-header-scroll { display: flex; flex: 1; overflow-x: auto; }
        .gantt-month { min-width: 120px; padding: 8px 12px; text-align: center; border-right: 1px solid var(--cw-gray-200); }
        .gantt-month-name { font-weight: 600; font-size: 0.8rem; color: var(--cw-gray-700); }
        .gantt-month-year { font-size: 0.7rem; color: var(--cw-gray-500); }
        .gantt-month.current { background: rgba(8,145,178,0.1); }
        .gantt-body { flex: 1; overflow: auto; }
        .gantt-vessel-group { border-bottom: 1px solid var(--cw-gray-200); }
        .gantt-vessel-row { display: flex; background: var(--cw-gray-50); border-bottom: 1px solid var(--cw-gray-100); cursor: pointer; }
        .gantt-vessel-row:hover { background: var(--cw-gray-100); }
        .gantt-vessel-info { width: 280px; min-width: 280px; padding: 12px 16px; border-right: 1px solid var(--cw-gray-200); display: flex; align-items: center; gap: 12px; }
        .gantt-vessel-icon { width: 32px; height: 32px; background: var(--cw-primary); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; }
        .gantt-vessel-icon svg { width: 18px; height: 18px; }
        .gantt-vessel-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); }
        .gantt-vessel-meta { font-size: 0.75rem; color: var(--cw-gray-500); }
        .gantt-vessel-timeline { display: flex; flex: 1; }
        .gantt-crew-row { display: flex; border-bottom: 1px solid var(--cw-gray-100); }
        .gantt-crew-row:last-child { border-bottom: none; }
        .gantt-crew-info { width: 280px; min-width: 280px; padding: 8px 16px 8px 48px; border-right: 1px solid var(--cw-gray-200); display: flex; align-items: center; gap: 10px; }
        .gantt-crew-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; color: var(--cw-gray-600); }
        .gantt-crew-details { flex: 1; min-width: 0; }
        .gantt-crew-name { font-size: 0.85rem; font-weight: 500; color: var(--cw-gray-800); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .gantt-crew-rank { font-size: 0.7rem; color: var(--cw-gray-500); }
        .gantt-crew-timeline { display: flex; flex: 1; position: relative; }
        .gantt-cell { min-width: 120px; height: 44px; border-right: 1px solid var(--cw-gray-100); position: relative; }
        .gantt-cell.current { background: rgba(8,145,178,0.05); }
        .gantt-bar { position: absolute; top: 8px; height: 28px; border-radius: 4px; display: flex; align-items: center; padding: 0 8px; font-size: 0.7rem; font-weight: 500; color: white; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease; z-index: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .gantt-bar:hover { transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); z-index: 5; }
        .gantt-bar.onboard { background: var(--status-embarked); }
        .gantt-bar.scheduled { background: var(--status-on-preparation); }
        .gantt-bar.expiring { background: var(--status-on-approval); }
        .gantt-bar.vacancy { background: var(--tag-nfr); opacity: 0.3; }
        .gantt-bar.extension { background: repeating-linear-gradient(45deg, var(--status-on-approval), var(--status-on-approval) 4px, rgba(245,158,11,0.7) 4px, rgba(245,158,11,0.7) 8px); }
        .gantt-today-line { position: absolute; top: 0; bottom: 0; width: 2px; background: var(--tag-nfr); z-index: 10; pointer-events: none; }
        .gantt-today-line::before { content: 'Today'; position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 0.65rem; font-weight: 600; color: var(--tag-nfr); background: white; padding: 2px 6px; border-radius: 4px; white-space: nowrap; }
        .gantt-expand-btn { width: 20px; height: 20px; border-radius: 4px; border: none; background: var(--cw-gray-200); color: var(--cw-gray-600); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.15s ease; }
        .gantt-expand-btn:hover { background: var(--cw-gray-300); }
        .gantt-expand-btn.expanded svg { transform: rotate(90deg); }
        
        /* Kanban Board */
        .kanban-container { display: flex; gap: 16px; overflow-x: auto; padding-bottom: 16px; min-height: 500px; }
        .kanban-column { flex: 0 0 300px; background: var(--cw-gray-100); border-radius: var(--border-radius-lg); display: flex; flex-direction: column; max-height: calc(100vh - 320px); }
        .kanban-column-header { padding: 16px; border-bottom: 2px solid transparent; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
        .kanban-column-header.new { border-bottom-color: var(--rfa-new); }
        .kanban-column-header.screening { border-bottom-color: var(--status-on-approval); }
        .kanban-column-header.interview { border-bottom-color: var(--status-on-preparation); }
        .kanban-column-header.negotiation { border-bottom-color: var(--status-endorsed); }
        .kanban-column-header.endorsed { border-bottom-color: var(--status-ready); }
        .kanban-column-header.rejected { border-bottom-color: var(--tag-nfr); }
        .kanban-column-title { display: flex; align-items: center; gap: 8px; }
        .kanban-column-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); }
        .kanban-column-count { background: var(--cw-gray-300); color: var(--cw-gray-700); font-size: 0.75rem; font-weight: 600; padding: 2px 8px; border-radius: 10px; }
        .kanban-column-actions { display: flex; gap: 4px; }
        .kanban-column-btn { width: 28px; height: 28px; border: none; background: transparent; color: var(--cw-gray-500); cursor: pointer; border-radius: var(--border-radius); display: flex; align-items: center; justify-content: center; }
        .kanban-column-btn:hover { background: var(--cw-gray-200); color: var(--cw-gray-700); }
        .kanban-cards { flex: 1; overflow-y: auto; padding: 8px 12px 12px; display: flex; flex-direction: column; gap: 10px; }
        .kanban-card { background: var(--cw-white); border-radius: var(--border-radius); padding: 14px; box-shadow: var(--shadow-sm); border: 1px solid var(--cw-gray-200); cursor: pointer; transition: all var(--transition-fast); }
        .kanban-card:hover { box-shadow: var(--shadow-md); border-color: var(--cw-gray-300); transform: translateY(-2px); }
        .kanban-card-header { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px; }
        .kanban-card-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.8rem; color: var(--cw-gray-600); flex-shrink: 0; }
        .kanban-card-info { flex: 1; min-width: 0; }
        .kanban-card-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); margin-bottom: 2px; }
        .kanban-card-rank { font-size: 0.8rem; color: var(--cw-gray-500); }
        .kanban-card-body { display: flex; flex-direction: column; gap: 8px; }
        .kanban-card-meta { display: flex; align-items: center; gap: 6px; font-size: 0.75rem; color: var(--cw-gray-500); }
        .kanban-card-meta svg { width: 14px; height: 14px; }
        .kanban-card-tags { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 4px; }
        .kanban-card-tag { font-size: 0.65rem; font-weight: 600; padding: 2px 6px; border-radius: 4px; text-transform: uppercase; }
        .kanban-card-tag.urgent { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .kanban-card-tag.high { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .kanban-card-tag.rfc { background: rgba(99,102,241,0.1); color: var(--rfa-new); }
        .kanban-card-tag.docs-ok { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .kanban-card-tag.docs-pending { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .kanban-card-footer { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--cw-gray-100); }
        .kanban-card-days { font-size: 0.7rem; color: var(--cw-gray-400); }
        .kanban-card-days.warning { color: var(--status-on-approval); }
        .kanban-card-days.danger { color: var(--tag-nfr); }
        .kanban-card-actions { display: flex; gap: 4px; }
        .kanban-add-card { width: 100%; padding: 10px; border: 2px dashed var(--cw-gray-300); border-radius: var(--border-radius); background: transparent; color: var(--cw-gray-500); font-size: 0.85rem; font-weight: 500; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; transition: all var(--transition-fast); margin-top: 4px; }
        .kanban-add-card:hover { border-color: var(--cw-accent); color: var(--cw-accent); background: rgba(8,145,178,0.05); }
        
        /* Fleet & Vessels Grid */
        .fleet-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 20px; }
        .vessel-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all var(--transition-fast); cursor: pointer; }
        .vessel-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .vessel-card-header { padding: 16px; display: flex; align-items: flex-start; gap: 14px; border-bottom: 1px solid var(--cw-gray-100); }
        .vessel-card-icon { width: 48px; height: 48px; border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .vessel-card-icon.bulk { background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%); color: white; }
        .vessel-card-icon.tanker { background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%); color: white; }
        .vessel-card-icon.container { background: linear-gradient(135deg, #10B981 0%, #059669 100%); color: white; }
        .vessel-card-icon.lng { background: linear-gradient(135deg, #8B5CF6 0%, #6D28D9 100%); color: white; }
        .vessel-card-icon svg { width: 24px; height: 24px; }
        .vessel-card-info { flex: 1; min-width: 0; }
        .vessel-card-name { font-weight: 700; font-size: 1rem; color: var(--cw-gray-900); margin-bottom: 2px; }
        .vessel-card-type { font-size: 0.8rem; color: var(--cw-gray-500); margin-bottom: 6px; }
        .vessel-card-principal { display: inline-flex; align-items: center; gap: 4px; font-size: 0.75rem; font-weight: 500; color: var(--cw-primary); background: rgba(0,73,93,0.08); padding: 3px 8px; border-radius: 4px; }
        .vessel-card-status { display: flex; align-items: center; gap: 6px; }
        .vessel-status-dot { width: 10px; height: 10px; border-radius: 50%; }
        .vessel-status-dot.active { background: var(--status-ready); box-shadow: 0 0 0 3px rgba(16,185,129,0.2); }
        .vessel-status-dot.maintenance { background: var(--status-on-approval); box-shadow: 0 0 0 3px rgba(245,158,11,0.2); }
        .vessel-status-dot.inactive { background: var(--cw-gray-400); }
        .vessel-card-body { padding: 16px; }
        .vessel-card-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 14px; }
        .vessel-stat { text-align: center; padding: 10px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .vessel-stat-value { font-size: 1.25rem; font-weight: 700; color: var(--cw-gray-900); }
        .vessel-stat-label { font-size: 0.7rem; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.03em; }
        .vessel-card-crew { display: flex; align-items: center; gap: 8px; }
        .vessel-crew-avatars { display: flex; }
        .vessel-crew-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--cw-gray-200); border: 2px solid var(--cw-white); margin-left: -8px; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 600; color: var(--cw-gray-600); }
        .vessel-crew-avatar:first-child { margin-left: 0; }
        .vessel-crew-avatar.more { background: var(--cw-primary); color: var(--cw-white); }
        .vessel-crew-text { font-size: 0.8rem; color: var(--cw-gray-600); }
        .vessel-card-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .vessel-card-meta { display: flex; align-items: center; gap: 12px; font-size: 0.75rem; color: var(--cw-gray-500); }
        .vessel-card-meta-item { display: flex; align-items: center; gap: 4px; }
        .vessel-card-meta-item svg { width: 14px; height: 14px; }
        .vessel-card-actions { display: flex; gap: 4px; }
        
        /* Vessel Detail Panel */
        .vessel-detail-header { display: flex; align-items: center; gap: 16px; padding-bottom: 20px; border-bottom: 1px solid var(--cw-gray-200); margin-bottom: 20px; }
        .vessel-detail-icon { width: 64px; height: 64px; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
        .vessel-detail-icon svg { width: 32px; height: 32px; }
        .vessel-crew-list { display: flex; flex-direction: column; gap: 8px; }
        .vessel-crew-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .vessel-crew-item-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.8rem; color: var(--cw-gray-600); }
        .vessel-crew-item-info { flex: 1; }
        .vessel-crew-item-name { font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-800); }
        .vessel-crew-item-rank { font-size: 0.75rem; color: var(--cw-gray-500); }
        .vessel-crew-item-contract { font-size: 0.7rem; color: var(--cw-gray-400); font-family: 'JetBrains Mono', monospace; }
        
        /* Documents Module */
        .doc-expiry-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .doc-expiry-badge.valid { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .doc-expiry-badge.expiring-soon { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .doc-expiry-badge.critical { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .doc-expiry-badge.expired { background: rgba(107,114,128,0.2); color: var(--cw-gray-600); }
        .doc-type-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .doc-type-icon svg { width: 18px; height: 18px; }
        .doc-type-icon.stcw { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .doc-type-icon.flag { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .doc-type-icon.medical { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .doc-type-icon.national { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .doc-type-icon.company { background: rgba(0,73,93,0.1); color: var(--cw-primary); }
        .doc-progress-ring { position: relative; width: 48px; height: 48px; }
        .doc-progress-ring svg { transform: rotate(-90deg); }
        .doc-progress-ring circle { fill: none; stroke-width: 4; }
        .doc-progress-ring .bg { stroke: var(--cw-gray-200); }
        .doc-progress-ring .progress { stroke-linecap: round; transition: stroke-dashoffset 0.3s ease; }
        .doc-progress-ring .progress.valid { stroke: var(--status-ready); }
        .doc-progress-ring .progress.warning { stroke: var(--status-on-approval); }
        .doc-progress-ring .progress.danger { stroke: var(--tag-nfr); }
        .doc-progress-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.7rem; font-weight: 700; }
        .doc-alert-card { display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); border-left: 4px solid; }
        .doc-alert-card.critical { border-left-color: var(--tag-nfr); background: rgba(239,68,68,0.02); }
        .doc-alert-card.warning { border-left-color: var(--status-on-approval); background: rgba(245,158,11,0.02); }
        .doc-alert-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .doc-alert-icon.critical { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .doc-alert-icon.warning { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .doc-alert-content { flex: 1; }
        .doc-alert-title { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); margin-bottom: 2px; }
        .doc-alert-subtitle { font-size: 0.8rem; color: var(--cw-gray-500); }
        .doc-alert-action { flex-shrink: 0; }
        
        /* Contracts Module */
        .contract-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all var(--transition-fast); }
        .contract-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .contract-card-header { padding: 16px; border-bottom: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .contract-card-id { font-family: 'JetBrains Mono', monospace; font-weight: 600; font-size: 0.9rem; color: var(--cw-primary); }
        .contract-status { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .contract-status.draft { background: rgba(107,114,128,0.1); color: var(--cw-gray-600); }
        .contract-status.pending-peme { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .contract-status.peme-cleared { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .contract-status.signed { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .contract-status.active { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .contract-status.completed { background: rgba(4,120,87,0.1); color: var(--rfa-completed); }
        .contract-status.cancelled { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .contract-card-body { padding: 16px; }
        .contract-parties { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .contract-party { display: flex; align-items: center; gap: 10px; flex: 1; }
        .contract-party-avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.85rem; }
        .contract-party-avatar.seafarer { background: var(--cw-gray-200); color: var(--cw-gray-600); }
        .contract-party-avatar.vessel { background: var(--cw-primary); color: var(--cw-white); }
        .contract-party-info { flex: 1; min-width: 0; }
        .contract-party-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .contract-party-meta { font-size: 0.75rem; color: var(--cw-gray-500); }
        .contract-arrow { color: var(--cw-gray-400); }
        .contract-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; padding: 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .contract-detail-item { text-align: center; }
        .contract-detail-label { font-size: 0.7rem; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.03em; margin-bottom: 2px; }
        .contract-detail-value { font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-800); }
        .contract-card-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .contract-timeline { display: flex; align-items: center; gap: 4px; }
        .contract-timeline-step { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 600; }
        .contract-timeline-step.completed { background: var(--status-ready); color: white; }
        .contract-timeline-step.current { background: var(--status-on-preparation); color: white; }
        .contract-timeline-step.pending { background: var(--cw-gray-200); color: var(--cw-gray-500); }
        .contract-timeline-line { width: 20px; height: 2px; background: var(--cw-gray-200); }
        .contract-timeline-line.completed { background: var(--status-ready); }
        .peme-status { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: var(--border-radius); font-size: 0.8rem; font-weight: 500; }
        .peme-status.pending { background: rgba(245,158,11,0.1); color: var(--status-on-approval); border: 1px dashed var(--status-on-approval); }
        .peme-status.scheduled { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); border: 1px solid var(--status-on-preparation); }
        .peme-status.cleared { background: rgba(16,185,129,0.1); color: var(--status-ready); border: 1px solid var(--status-ready); }
        .peme-status.failed { background: rgba(239,68,68,0.1); color: var(--tag-nfr); border: 1px solid var(--tag-nfr); }
        
        /* Clients Module */
        .client-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all var(--transition-fast); }
        .client-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .client-card-header { padding: 20px; background: linear-gradient(135deg, var(--cw-primary) 0%, var(--cw-primary-light) 100%); color: white; position: relative; overflow: hidden; }
        .client-card-header::before { content: ''; position: absolute; top: -50%; right: -50%; width: 100%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); }
        .client-card-logo { width: 56px; height: 56px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 12px; backdrop-filter: blur(4px); }
        .client-card-logo svg { width: 28px; height: 28px; }
        .client-card-name { font-size: 1.25rem; font-weight: 700; margin-bottom: 4px; }
        .client-card-country { font-size: 0.85rem; opacity: 0.8; display: flex; align-items: center; gap: 6px; }
        .client-card-body { padding: 20px; }
        .client-stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px; }
        .client-stat { background: var(--cw-gray-50); border-radius: var(--border-radius); padding: 12px; text-align: center; }
        .client-stat-value { font-size: 1.5rem; font-weight: 700; color: var(--cw-gray-900); }
        .client-stat-label { font-size: 0.7rem; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.03em; }
        .client-fleet-preview { display: flex; flex-direction: column; gap: 8px; }
        .client-fleet-item { display: flex; align-items: center; gap: 10px; padding: 8px 10px; background: var(--cw-gray-50); border-radius: var(--border-radius); font-size: 0.85rem; }
        .client-fleet-item-icon { width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center; }
        .client-fleet-item-icon.bulk { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .client-fleet-item-icon.tanker { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .client-fleet-item-icon.container { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .client-fleet-item-icon.lng { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .client-fleet-item-icon svg { width: 14px; height: 14px; }
        .client-fleet-item-name { flex: 1; font-weight: 500; color: var(--cw-gray-700); }
        .client-fleet-item-crew { font-size: 0.75rem; color: var(--cw-gray-500); }
        .client-card-footer { padding: 12px 20px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .client-contact { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--cw-gray-600); }
        .client-contact svg { width: 14px; height: 14px; color: var(--cw-gray-400); }
        .client-since { font-size: 0.75rem; color: var(--cw-gray-400); }
        
        /* Analytics Module */
        .analytics-grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 20px; }
        .analytics-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; }
        .analytics-card.span-4 { grid-column: span 4; }
        .analytics-card.span-6 { grid-column: span 6; }
        .analytics-card.span-8 { grid-column: span 8; }
        .analytics-card.span-12 { grid-column: span 12; }
        .analytics-card-header { padding: 16px 20px; border-bottom: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .analytics-card-title { font-weight: 600; font-size: 0.95rem; color: var(--cw-gray-800); }
        .analytics-card-subtitle { font-size: 0.8rem; color: var(--cw-gray-500); }
        .analytics-card-body { padding: 20px; }
        
        /* Bar Chart */
        .bar-chart { display: flex; flex-direction: column; gap: 12px; }
        .bar-chart-item { display: flex; align-items: center; gap: 12px; }
        .bar-chart-label { width: 100px; font-size: 0.8rem; color: var(--cw-gray-600); text-align: right; flex-shrink: 0; }
        .bar-chart-track { flex: 1; height: 24px; background: var(--cw-gray-100); border-radius: 4px; overflow: hidden; position: relative; }
        .bar-chart-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; }
        .bar-chart-fill.primary { background: linear-gradient(90deg, var(--cw-primary) 0%, var(--cw-accent) 100%); }
        .bar-chart-fill.success { background: linear-gradient(90deg, #059669 0%, #10B981 100%); }
        .bar-chart-fill.warning { background: linear-gradient(90deg, #D97706 0%, #F59E0B 100%); }
        .bar-chart-fill.danger { background: linear-gradient(90deg, #DC2626 0%, #EF4444 100%); }
        .bar-chart-fill.info { background: linear-gradient(90deg, #2563EB 0%, #3B82F6 100%); }
        .bar-chart-value { font-size: 0.7rem; font-weight: 600; color: white; }
        
        /* Donut Chart */
        .donut-chart-container { display: flex; align-items: center; gap: 24px; }
        .donut-chart { position: relative; width: 140px; height: 140px; }
        .donut-chart svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .donut-chart circle { fill: none; stroke-width: 20; }
        .donut-chart .bg { stroke: var(--cw-gray-100); }
        .donut-chart .segment { stroke-linecap: round; transition: stroke-dashoffset 0.5s ease; }
        .donut-chart-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .donut-chart-value { font-size: 1.75rem; font-weight: 700; color: var(--cw-gray-900); }
        .donut-chart-label { font-size: 0.75rem; color: var(--cw-gray-500); }
        .donut-legend { display: flex; flex-direction: column; gap: 10px; }
        .donut-legend-item { display: flex; align-items: center; gap: 8px; }
        .donut-legend-color { width: 12px; height: 12px; border-radius: 3px; }
        .donut-legend-text { font-size: 0.85rem; color: var(--cw-gray-700); }
        .donut-legend-value { margin-left: auto; font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-900); }
        
        /* Trend Line */
        .trend-chart { height: 120px; display: flex; align-items: flex-end; gap: 8px; padding-top: 20px; }
        .trend-bar { flex: 1; background: var(--cw-gray-100); border-radius: 4px 4px 0 0; position: relative; transition: height 0.3s ease; min-height: 4px; }
        .trend-bar:hover { background: var(--cw-accent); }
        .trend-bar-tooltip { position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); background: var(--cw-gray-800); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; white-space: nowrap; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
        .trend-bar:hover .trend-bar-tooltip { opacity: 1; }
        .trend-labels { display: flex; justify-content: space-between; margin-top: 8px; }
        .trend-label { font-size: 0.7rem; color: var(--cw-gray-500); }
        
        /* KPI Big Number */
        .kpi-big { text-align: center; padding: 20px; }
        .kpi-big-value { font-size: 3rem; font-weight: 700; color: var(--cw-gray-900); line-height: 1; }
        .kpi-big-value.success { color: var(--status-ready); }
        .kpi-big-value.warning { color: var(--status-on-approval); }
        .kpi-big-value.danger { color: var(--tag-nfr); }
        .kpi-big-label { font-size: 0.9rem; color: var(--cw-gray-500); margin-top: 8px; }
        .kpi-big-change { display: inline-flex; align-items: center; gap: 4px; font-size: 0.85rem; font-weight: 600; margin-top: 8px; padding: 4px 10px; border-radius: 20px; }
        .kpi-big-change.up { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .kpi-big-change.down { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        
        /* Mini Stats Row */
        .mini-stats-row { display: flex; gap: 16px; }
        .mini-stat { flex: 1; text-align: center; padding: 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .mini-stat-value { font-size: 1.25rem; font-weight: 700; color: var(--cw-gray-900); }
        .mini-stat-label { font-size: 0.7rem; color: var(--cw-gray-500); text-transform: uppercase; }
        
        @media (max-width: 1024px) {
            .analytics-card.span-4, .analytics-card.span-6, .analytics-card.span-8 { grid-column: span 12; }
        }
        
        /* RFC Tasks Module */
        .rfc-task-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all var(--transition-fast); }
        .rfc-task-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .rfc-task-card.urgent { border-left: 4px solid var(--tag-nfr); }
        .rfc-task-card.high { border-left: 4px solid var(--status-on-approval); }
        .rfc-task-card.normal { border-left: 4px solid var(--status-on-preparation); }
        .rfc-task-header { padding: 16px; display: flex; align-items: flex-start; justify-content: space-between; border-bottom: 1px solid var(--cw-gray-100); }
        .rfc-task-id { font-family: 'JetBrains Mono', monospace; font-weight: 600; font-size: 0.9rem; color: var(--cw-primary); }
        .rfc-task-date { font-size: 0.75rem; color: var(--cw-gray-500); margin-top: 4px; }
        .rfc-task-priority { padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
        .rfc-task-priority.urgent { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .rfc-task-priority.high { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .rfc-task-priority.normal { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .rfc-task-body { padding: 16px; }
        .rfc-task-position { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
        .rfc-task-position-icon { width: 48px; height: 48px; border-radius: 10px; background: var(--cw-gray-100); display: flex; align-items: center; justify-content: center; }
        .rfc-task-position-icon svg { width: 24px; height: 24px; color: var(--cw-gray-600); }
        .rfc-task-position-info { flex: 1; }
        .rfc-task-rank { font-weight: 700; font-size: 1rem; color: var(--cw-gray-900); }
        .rfc-task-vessel { font-size: 0.85rem; color: var(--cw-gray-500); }
        .rfc-task-details { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px; }
        .rfc-task-detail { background: var(--cw-gray-50); padding: 10px 12px; border-radius: var(--border-radius); }
        .rfc-task-detail-label { font-size: 0.7rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 2px; }
        .rfc-task-detail-value { font-weight: 600; font-size: 0.85rem; color: var(--cw-gray-800); }
        .rfc-task-progress { margin-bottom: 12px; }
        .rfc-task-progress-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .rfc-task-progress-label { font-size: 0.8rem; color: var(--cw-gray-600); }
        .rfc-task-progress-value { font-size: 0.8rem; font-weight: 600; color: var(--cw-gray-800); }
        .rfc-task-progress-bar { height: 6px; background: var(--cw-gray-200); border-radius: 3px; overflow: hidden; }
        .rfc-task-progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s ease; }
        .rfc-task-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .rfc-task-candidates { display: flex; align-items: center; gap: 8px; }
        .rfc-task-candidates-avatars { display: flex; }
        .rfc-task-candidates-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--cw-gray-200); border: 2px solid var(--cw-white); margin-left: -8px; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 600; color: var(--cw-gray-600); }
        .rfc-task-candidates-avatar:first-child { margin-left: 0; }
        .rfc-task-candidates-count { font-size: 0.8rem; color: var(--cw-gray-600); }
        .rfc-task-status { padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .rfc-task-status.open { background: rgba(99,102,241,0.1); color: var(--rfa-new); }
        .rfc-task-status.sourcing { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .rfc-task-status.shortlisted { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .rfc-task-status.filled { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .rfc-task-status.cancelled { background: rgba(107,114,128,0.1); color: var(--cw-gray-600); }
        
        /* Interviews Module */
        .interview-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all var(--transition-fast); }
        .interview-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .interview-card-header { padding: 14px 16px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--cw-gray-100); }
        .interview-datetime { display: flex; align-items: center; gap: 10px; }
        .interview-date-box { background: var(--cw-primary); color: white; border-radius: 8px; padding: 8px 12px; text-align: center; min-width: 54px; }
        .interview-date-day { font-size: 1.25rem; font-weight: 700; line-height: 1; }
        .interview-date-month { font-size: 0.65rem; text-transform: uppercase; opacity: 0.8; }
        .interview-time { font-size: 0.9rem; font-weight: 600; color: var(--cw-gray-800); }
        .interview-time-duration { font-size: 0.75rem; color: var(--cw-gray-500); }
        .interview-status { padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
        .interview-status.scheduled { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .interview-status.in-progress { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .interview-status.completed { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .interview-status.cancelled { background: rgba(107,114,128,0.1); color: var(--cw-gray-600); }
        .interview-status.no-show { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .interview-card-body { padding: 16px; }
        .interview-candidate { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; padding-bottom: 14px; border-bottom: 1px solid var(--cw-gray-100); }
        .interview-candidate-avatar { width: 44px; height: 44px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-600); }
        .interview-candidate-info { flex: 1; }
        .interview-candidate-name { font-weight: 600; font-size: 0.95rem; color: var(--cw-gray-900); }
        .interview-candidate-rank { font-size: 0.8rem; color: var(--cw-gray-500); }
        .interview-candidate-rfc { font-size: 0.7rem; color: var(--cw-accent); font-family: 'JetBrains Mono', monospace; }
        .interview-details-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 14px; }
        .interview-detail { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--cw-gray-600); }
        .interview-detail svg { width: 16px; height: 16px; color: var(--cw-gray-400); }
        .interview-assessment { background: var(--cw-gray-50); border-radius: var(--border-radius); padding: 12px; }
        .interview-assessment-title { font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 8px; }
        .interview-scores { display: flex; gap: 12px; }
        .interview-score { flex: 1; text-align: center; }
        .interview-score-value { font-size: 1.1rem; font-weight: 700; }
        .interview-score-value.pass { color: var(--status-ready); }
        .interview-score-value.pending { color: var(--cw-gray-400); }
        .interview-score-value.fail { color: var(--tag-nfr); }
        .interview-score-label { font-size: 0.65rem; color: var(--cw-gray-500); }
        .interview-card-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .interview-interviewer { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--cw-gray-600); }
        .interview-interviewer-avatar { width: 24px; height: 24px; border-radius: 50%; background: var(--cw-accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.6rem; font-weight: 600; }
        .interview-result { padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .interview-result.passed { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .interview-result.failed { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .interview-result.pending { background: rgba(107,114,128,0.1); color: var(--cw-gray-500); }
        
        /* Embarkation Prep Module */
        .embark-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; }
        .embark-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .embark-card.ready { border-left: 4px solid var(--status-ready); }
        .embark-card.pending { border-left: 4px solid var(--status-on-approval); }
        .embark-card.blocked { border-left: 4px solid var(--tag-nfr); }
        .embark-header { padding: 16px; display: flex; align-items: center; gap: 14px; border-bottom: 1px solid var(--cw-gray-100); }
        .embark-avatar { width: 48px; height: 48px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1rem; color: var(--cw-gray-600); }
        .embark-info { flex: 1; }
        .embark-name { font-weight: 700; font-size: 1rem; color: var(--cw-gray-900); }
        .embark-rank { font-size: 0.85rem; color: var(--cw-gray-500); }
        .embark-date-box { text-align: center; padding: 8px 12px; background: var(--cw-primary); color: white; border-radius: 8px; }
        .embark-date-label { font-size: 0.6rem; text-transform: uppercase; opacity: 0.8; }
        .embark-date-value { font-size: 1rem; font-weight: 700; }
        .embark-date-days { font-size: 0.7rem; opacity: 0.8; }
        .embark-body { padding: 16px; }
        .embark-vessel { display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); margin-bottom: 14px; }
        .embark-vessel-icon { width: 32px; height: 32px; border-radius: 8px; background: var(--cw-primary); color: white; display: flex; align-items: center; justify-content: center; }
        .embark-vessel-icon svg { width: 16px; height: 16px; }
        .embark-vessel-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); }
        .embark-vessel-port { font-size: 0.8rem; color: var(--cw-gray-500); }
        .embark-checklist { display: flex; flex-direction: column; gap: 8px; }
        .embark-check-item { display: flex; align-items: center; gap: 10px; padding: 8px 10px; border-radius: var(--border-radius); background: var(--cw-gray-50); }
        .embark-check-item.complete { background: rgba(16,185,129,0.05); }
        .embark-check-item.incomplete { background: rgba(245,158,11,0.05); }
        .embark-check-item.blocked { background: rgba(239,68,68,0.05); }
        .embark-check-icon { width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .embark-check-icon.complete { background: var(--status-ready); color: white; }
        .embark-check-icon.incomplete { background: var(--status-on-approval); color: white; }
        .embark-check-icon.blocked { background: var(--tag-nfr); color: white; }
        .embark-check-icon svg { width: 12px; height: 12px; }
        .embark-check-label { flex: 1; font-size: 0.85rem; color: var(--cw-gray-700); }
        .embark-check-status { font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
        .embark-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .embark-actions { padding: 12px 16px; border-top: 1px solid var(--cw-gray-100); display: flex; gap: 8px; justify-content: flex-end; }
        .embark-check-item:not(.complete) { transition: all 0.2s; }
        .embark-check-item:not(.complete):hover { background: rgba(0,73,93,0.05); border-radius: 6px; margin: 0 -8px; padding: 0 8px; }
        .embark-progress { display: flex; align-items: center; gap: 10px; }
        .embark-progress-bar { width: 80px; height: 6px; background: var(--cw-gray-200); border-radius: 3px; overflow: hidden; }
        .embark-progress-fill { height: 100%; border-radius: 3px; background: var(--status-ready); }
        .embark-progress-text { font-size: 0.8rem; font-weight: 600; color: var(--cw-gray-700); }
        .embark-readiness { padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .embark-readiness.ready { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .embark-readiness.pending { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .embark-readiness.blocked { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        
        /* Pending Transactions Module */
        .pending-table { width: 100%; }
        .pending-row { display: grid; grid-template-columns: 60px 1.5fr 1fr 1fr 120px 100px 80px; gap: 12px; padding: 14px 16px; align-items: center; border-bottom: 1px solid var(--cw-gray-100); transition: background 0.15s; }
        .pending-row:hover { background: var(--cw-gray-50); }
        .pending-row.header { background: var(--cw-gray-50); font-weight: 600; font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; letter-spacing: 0.03em; }
        .pending-priority { width: 8px; height: 8px; border-radius: 50%; }
        .pending-priority.urgent { background: var(--tag-nfr); box-shadow: 0 0 0 3px rgba(239,68,68,0.2); }
        .pending-priority.high { background: var(--status-on-approval); }
        .pending-priority.normal { background: var(--status-on-preparation); }
        .pending-type-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 600; }
        .pending-type-badge.rfa { background: rgba(99,102,241,0.1); color: var(--rfa-new); }
        .pending-type-badge.contract { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .pending-type-badge.document { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .pending-type-badge.travel { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .pending-type-badge.peme { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .pending-age { font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; }
        .pending-age.overdue { color: var(--tag-nfr); font-weight: 600; }
        .pending-age.warning { color: var(--status-on-approval); }
        .pending-actions { display: flex; gap: 6px; }
        .pending-action-btn { width: 32px; height: 32px; border-radius: 6px; border: 1px solid var(--cw-gray-200); background: white; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.15s; }
        .pending-action-btn:hover { border-color: var(--cw-accent); background: var(--cw-gray-50); }
        .pending-action-btn.approve { color: var(--status-ready); }
        .pending-action-btn.approve:hover { background: rgba(16,185,129,0.1); border-color: var(--status-ready); }
        .pending-action-btn.reject { color: var(--tag-nfr); }
        .pending-action-btn.reject:hover { background: rgba(239,68,68,0.1); border-color: var(--tag-nfr); }
        .pending-action-btn svg { width: 16px; height: 16px; }
        .pending-summary-cards { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: 20px; }
        .pending-summary-card { background: white; border: 1px solid var(--cw-gray-200); border-radius: var(--border-radius); padding: 14px; display: flex; align-items: center; gap: 12px; }
        .pending-summary-icon { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .pending-summary-icon svg { width: 20px; height: 20px; }
        .pending-summary-count { font-size: 1.5rem; font-weight: 700; color: var(--cw-gray-900); }
        .pending-summary-label { font-size: 0.75rem; color: var(--cw-gray-500); }
        
        /* Tickets Module */
        .ticket-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; transition: all 0.2s ease; }
        .ticket-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,0.12); border-color: var(--cw-primary); }
        .ticket-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .ticket-header { padding: 14px 16px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--cw-gray-100); background: linear-gradient(135deg, rgba(0,73,93,0.03) 0%, rgba(0,159,147,0.03) 100%); }
        .ticket-pnr { font-family: 'JetBrains Mono', monospace; font-weight: 700; font-size: 1rem; color: var(--cw-primary); letter-spacing: 0.05em; }
        .ticket-status { padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
        .ticket-status.confirmed { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .ticket-detail-status-badge { padding: 6px 16px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; }
        .ticket-detail-status-badge.confirmed { background: rgba(16,185,129,0.2); color: var(--status-ready); }
        .ticket-detail-status-badge.pending { background: rgba(245,158,11,0.2); color: var(--status-on-approval); }
        .ticket-detail-status-badge.cancelled { background: rgba(239,68,68,0.2); color: var(--tag-nfr); }
        .ticket-detail-status-badge.completed { background: rgba(59,130,246,0.2); color: #3b82f6; }
        .ticket-status.pending { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .ticket-status.cancelled { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .ticket-status.completed { background: rgba(107,114,128,0.1); color: var(--cw-gray-600); }
        .ticket-body { padding: 16px; }
        .ticket-route { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .ticket-airport { flex: 1; }
        .ticket-airport-code { font-size: 1.5rem; font-weight: 700; color: var(--cw-gray-900); }
        .ticket-airport-city { font-size: 0.8rem; color: var(--cw-gray-500); }
        .ticket-flight-info { text-align: center; flex-shrink: 0; }
        .ticket-flight-line { display: flex; align-items: center; gap: 8px; color: var(--cw-gray-400); }
        .ticket-flight-line::before, .ticket-flight-line::after { content: ''; flex: 1; height: 1px; background: var(--cw-gray-300); min-width: 30px; }
        .ticket-duration { font-size: 0.75rem; color: var(--cw-gray-500); margin-top: 4px; }
        .ticket-details { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); margin-bottom: 12px; }
        .ticket-detail-item { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--cw-gray-600); }
        .ticket-detail-item svg { width: 14px; height: 14px; color: var(--cw-gray-400); }
        .ticket-passenger { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .ticket-passenger-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.8rem; }
        .ticket-passenger-name { font-weight: 600; font-size: 0.9rem; color: var(--cw-gray-800); }
        .ticket-passenger-rank { font-size: 0.75rem; color: var(--cw-gray-500); }
        .ticket-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .ticket-price { font-weight: 700; font-size: 1.1rem; color: var(--cw-gray-900); }
        .ticket-airline { display: flex; align-items: center; gap: 6px; font-size: 0.8rem; color: var(--cw-gray-600); }
        
        /* Evaluations Module */
        .eval-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; }
        .eval-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); }
        .eval-header { padding: 16px; display: flex; align-items: center; gap: 14px; border-bottom: 1px solid var(--cw-gray-100); }
        .eval-avatar { width: 48px; height: 48px; border-radius: 50%; background: var(--cw-gray-200); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1rem; }
        .eval-info { flex: 1; }
        .eval-name { font-weight: 700; font-size: 1rem; color: var(--cw-gray-900); }
        .eval-meta { font-size: 0.8rem; color: var(--cw-gray-500); }
        .eval-score-badge { padding: 8px 14px; border-radius: 10px; text-align: center; }
        .eval-score-badge.excellent { background: linear-gradient(135deg, #059669 0%, #10B981 100%); color: white; }
        .eval-score-badge.good { background: linear-gradient(135deg, #2563EB 0%, #3B82F6 100%); color: white; }
        .eval-score-badge.average { background: linear-gradient(135deg, #D97706 0%, #F59E0B 100%); color: white; }
        .eval-score-badge.poor { background: linear-gradient(135deg, #DC2626 0%, #EF4444 100%); color: white; }
        .eval-score-value { font-size: 1.25rem; font-weight: 700; }
        .eval-score-label { font-size: 0.65rem; text-transform: uppercase; opacity: 0.9; }
        .eval-body { padding: 16px; }
        .eval-criteria { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 14px; }
        .eval-criterion { display: flex; align-items: center; justify-content: space-between; padding: 8px 10px; background: var(--cw-gray-50); border-radius: var(--border-radius); }
        .eval-criterion-label { font-size: 0.8rem; color: var(--cw-gray-600); }
        .eval-criterion-stars { display: flex; gap: 2px; }
        .eval-criterion-stars svg { width: 14px; height: 14px; }
        .eval-criterion-stars svg.filled { color: #F59E0B; fill: #F59E0B; }
        .eval-criterion-stars svg.empty { color: var(--cw-gray-300); }
        .eval-vessel { display: flex; align-items: center; gap: 8px; padding: 10px; background: var(--cw-gray-50); border-radius: var(--border-radius); font-size: 0.85rem; }
        .eval-vessel svg { width: 16px; height: 16px; color: var(--cw-gray-400); }
        .eval-comment { padding: 12px; background: var(--cw-gray-50); border-radius: var(--border-radius); border-left: 3px solid var(--cw-accent); margin-top: 12px; }
        .eval-comment-text { font-size: 0.85rem; color: var(--cw-gray-600); font-style: italic; }
        .eval-comment-author { font-size: 0.75rem; color: var(--cw-gray-500); margin-top: 6px; }
        .eval-footer { padding: 12px 16px; background: var(--cw-gray-50); border-top: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; font-size: 0.8rem; color: var(--cw-gray-500); }
        
        /* Compliance Module */
        .compliance-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .compliance-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); overflow: hidden; }
        .compliance-card-header { padding: 16px; border-bottom: 1px solid var(--cw-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .compliance-card-title { font-weight: 600; font-size: 0.95rem; color: var(--cw-gray-800); }
        .compliance-score-ring { position: relative; width: 60px; height: 60px; }
        .compliance-score-ring svg { transform: rotate(-90deg); }
        .compliance-score-ring circle { fill: none; stroke-width: 6; }
        .compliance-score-ring .bg { stroke: var(--cw-gray-200); }
        .compliance-score-ring .progress { stroke-linecap: round; }
        .compliance-score-ring .progress.high { stroke: var(--status-ready); }
        .compliance-score-ring .progress.medium { stroke: var(--status-on-approval); }
        .compliance-score-ring .progress.low { stroke: var(--tag-nfr); }
        .compliance-score-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.9rem; font-weight: 700; }
        .compliance-card-body { padding: 16px; }
        .compliance-item { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--cw-gray-100); }
        .compliance-item:last-child { border-bottom: none; }
        .compliance-item-info { display: flex; align-items: center; gap: 10px; }
        .compliance-item-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .compliance-item-icon.ok { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .compliance-item-icon.warning { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .compliance-item-icon.error { background: rgba(239,68,68,0.1); color: var(--tag-nfr); }
        .compliance-item-icon svg { width: 16px; height: 16px; }
        .compliance-item-label { font-size: 0.85rem; color: var(--cw-gray-700); }
        .compliance-item-value { font-size: 0.85rem; font-weight: 600; }
        .compliance-item-value.ok { color: var(--status-ready); }
        .compliance-item-value.warning { color: var(--status-on-approval); }
        .compliance-item-value.error { color: var(--tag-nfr); }
        @media (max-width: 1024px) { .compliance-grid { grid-template-columns: 1fr; } }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; }
            .menu-toggle { display: flex; }
            .header-center { display: none; }
        }
        /* Compliance Module */
        .compliance-summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .compliance-score-card { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); padding: 24px; text-align: center; }
        .compliance-score-ring { width: 100px; height: 100px; margin: 0 auto 16px; position: relative; }
        .compliance-score-ring svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .compliance-score-ring circle { fill: none; stroke-width: 8; }
        .compliance-score-ring .bg { stroke: var(--cw-gray-200); }
        .compliance-score-ring .progress { stroke-linecap: round; transition: stroke-dashoffset 0.5s ease; }
        .compliance-score-ring .progress.excellent { stroke: var(--status-ready); }
        .compliance-score-ring .progress.good { stroke: var(--status-on-preparation); }
        .compliance-score-ring .progress.warning { stroke: var(--status-on-approval); }
        .compliance-score-ring .progress.critical { stroke: var(--tag-nfr); }
        .compliance-score-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.5rem; font-weight: 700; }
        .compliance-score-label { font-size: 0.9rem; color: var(--cw-gray-600); font-weight: 500; }
        .compliance-category { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); margin-bottom: 16px; overflow: hidden; }
        .compliance-category-header { padding: 16px 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--cw-gray-100); cursor: pointer; }
        .compliance-category-header:hover { background: var(--cw-gray-50); }
        .compliance-category-title { display: flex; align-items: center; gap: 12px; font-weight: 600; font-size: 0.95rem; color: var(--cw-gray-800); }
        .compliance-category-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .compliance-category-icon svg { width: 18px; height: 18px; }
        .compliance-category-icon.stcw { background: rgba(59,130,246,0.1); color: var(--status-on-preparation); }
        .compliance-category-icon.medical { background: rgba(16,185,129,0.1); color: var(--status-ready); }
        .compliance-category-icon.flag { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .compliance-category-icon.training { background: rgba(245,158,11,0.1); color: var(--status-on-approval); }
        .compliance-category-icon.audit { background: rgba(0,73,93,0.1); color: var(--cw-primary); }
        .compliance-category-stats { display: flex; align-items: center; gap: 16px; }
        .compliance-category-stat { text-align: center; }
        .compliance-category-stat-value { font-size: 1.1rem; font-weight: 700; }
        .compliance-category-stat-value.success { color: var(--status-ready); }
        .compliance-category-stat-value.warning { color: var(--status-on-approval); }
        .compliance-category-stat-value.danger { color: var(--tag-nfr); }
        .compliance-category-stat-label { font-size: 0.65rem; color: var(--cw-gray-500); text-transform: uppercase; }
        .compliance-category-progress { width: 120px; height: 8px; background: var(--cw-gray-200); border-radius: 4px; overflow: hidden; }
        .compliance-category-progress-fill { height: 100%; border-radius: 4px; }
        .compliance-item { display: flex; align-items: center; gap: 12px; padding: 12px 20px; border-bottom: 1px solid var(--cw-gray-100); }
        .compliance-item:last-child { border-bottom: none; }
        .compliance-item-status { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .compliance-item-status.valid { background: var(--status-ready); }
        .compliance-item-status.expiring { background: var(--status-on-approval); }
        .compliance-item-status.expired { background: var(--tag-nfr); }
        .compliance-item-info { flex: 1; }
        .compliance-item-name { font-weight: 500; font-size: 0.85rem; color: var(--cw-gray-800); }
        .compliance-item-meta { font-size: 0.75rem; color: var(--cw-gray-500); }
        .compliance-item-expiry { font-size: 0.8rem; font-weight: 500; }
        
        /* Calendar View */
        .calendar-header { display: flex; align-items: center; justify-content: center; margin-bottom: 16px; padding: 12px; background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: var(--cw-gray-200); border-radius: var(--border-radius-lg); overflow: hidden; }
        .calendar-day-header { background: var(--cw-primary); color: white; padding: 12px 8px; text-align: center; font-weight: 600; font-size: 0.8rem; }
        .calendar-day { background: var(--cw-white); min-height: 120px; padding: 8px; position: relative; }
        .calendar-day.today { background: rgba(8,145,178,0.05); }
        .calendar-day.other-month { background: var(--cw-gray-50); }
        .calendar-day-number { font-size: 0.85rem; font-weight: 600; color: var(--cw-gray-700); margin-bottom: 8px; }
        .calendar-day.today .calendar-day-number { background: var(--cw-accent); color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .calendar-event { background: var(--cw-primary); color: white; padding: 4px 6px; border-radius: 4px; font-size: 0.7rem; margin-bottom: 4px; cursor: pointer; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .calendar-event:hover { background: var(--cw-primary-dark); }
        .calendar-event.completed { background: var(--status-ready); }
        .calendar-event.cancelled { background: var(--cw-gray-400); }
        .calendar-event.no-show { background: var(--tag-nfr); }
        .calendar-more { font-size: 0.7rem; color: var(--cw-accent); cursor: pointer; padding: 2px 4px; }
        
        /* Settings Module */
        .settings-container { display: grid; grid-template-columns: 240px 1fr; gap: 24px; }
        .settings-nav { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); padding: 16px; height: fit-content; }
        .settings-nav-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: var(--border-radius); color: var(--cw-gray-600); font-size: 0.9rem; cursor: pointer; transition: all var(--transition-fast); margin-bottom: 4px; }
        .settings-nav-item:hover { background: var(--cw-gray-100); color: var(--cw-gray-800); }
        .settings-nav-item.active { background: var(--cw-primary); color: white; }
        .settings-nav-item svg { width: 18px; height: 18px; }
        .settings-panel { background: var(--cw-white); border-radius: var(--border-radius-lg); border: 1px solid var(--cw-gray-200); }
        .settings-panel-header { padding: 20px 24px; border-bottom: 1px solid var(--cw-gray-100); }
        .settings-panel-title { font-size: 1.1rem; font-weight: 600; color: var(--cw-gray-900); margin-bottom: 4px; }
        .settings-panel-subtitle { font-size: 0.85rem; color: var(--cw-gray-500); }
        .settings-panel-body { padding: 24px; }
        .settings-section { margin-bottom: 32px; }
        .settings-section:last-child { margin-bottom: 0; }
        .settings-section-title { font-size: 0.85rem; font-weight: 600; color: var(--cw-gray-800); margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(--cw-gray-100); }

        /* Assignment & Proposal Module */
        .assignment-container { display: grid; grid-template-columns: 1fr 400px; gap: 24px; height: calc(100vh - 200px); }
        .rfa-matrix-board, .crew-pool-panel { background: var(--cw-white); border-radius: var(--border-radius-lg); padding: 20px; overflow-y: auto; }
        .board-header, .panel-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid var(--cw-gray-100); }
        .board-header h2, .panel-header h2 { font-size: 1.1rem; font-weight: 700; color: var(--cw-gray-900); display: flex; align-items: center; gap: 8px; }
        .rfa-matrix-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        .rfa-matrix-card { background: var(--cw-white); border: 2px solid var(--cw-gray-200); border-radius: var(--border-radius); padding: 16px; cursor: pointer; transition: all var(--transition-fast); }
        .rfa-matrix-card:hover { border-color: var(--cw-accent); box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .rfa-matrix-card.has-proposals { border-left: 4px solid #10B981; }
        .rfa-matrix-card.urgent { border-left: 4px solid #EF4444; }
        .rfa-card-header { display: flex; justify-content: space-between; margin-bottom: 12px; }
        .rfa-card-id { font-size: 0.7rem; font-weight: 600; color: var(--cw-gray-500); text-transform: uppercase; }
        .rfa-card-type { padding: 4px 8px; background: rgba(8,145,178,0.1); color: var(--cw-accent); border-radius: 4px; font-size: 0.7rem; font-weight: 600; }
        .rfa-card-vessel { font-size: 0.95rem; font-weight: 700; color: var(--cw-gray-900); margin-bottom: 8px; }
        .rfa-card-rank { font-size: 0.85rem; color: var(--cw-gray-600); margin-bottom: 12px; }
        .rfa-card-meta { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px; font-size: 0.75rem; }
        .rfa-meta-label { color: var(--cw-gray-500); }
        .rfa-meta-value { color: var(--cw-gray-900); font-weight: 600; }
        .rfa-card-proposals { padding: 8px; background: var(--cw-gray-50); border-radius: 6px; font-size: 0.75rem; display: flex; justify-content: space-between; }
        .rfa-card-proposals.has-proposals { background: rgba(16,185,129,0.1); color: #059669; }
        .rfa-card-footer { display: flex; gap: 6px; margin-top: 12px; }
        .rfa-card-btn { flex: 1; padding: 6px; background: var(--cw-accent); color: white; border: none; border-radius: 6px; font-size: 0.75rem; font-weight: 600; cursor: pointer; }
        .rfa-card-btn:hover { background: var(--cw-primary); }
        .rfa-card-btn.secondary { background: var(--cw-gray-200); color: var(--cw-gray-700); }
        .crew-pool-panel { display: flex; flex-direction: column; overflow: hidden; }
        .crew-count { background: var(--cw-accent); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 700; }
        .pool-tabs { display: flex; border-bottom: 1px solid var(--cw-gray-200); padding: 0 20px; }
        .pool-tab { background: none; border: none; padding: 12px 16px; font-size: 0.85rem; font-weight: 600; color: var(--cw-gray-500); cursor: pointer; border-bottom: 3px solid transparent; }
        .pool-tab:hover { color: var(--cw-accent); }
        .pool-tab.active { color: var(--cw-accent); border-bottom-color: var(--cw-accent); }
        .pool-tab .tab-badge { background: var(--cw-gray-200); color: var(--cw-gray-700); padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; margin-left: 6px; }
        .pool-tab.active .tab-badge { background: var(--cw-accent); color: white; }
        .crew-pool-list { flex: 1; overflow-y: auto; padding: 16px; }
        .crew-pool-card { background: var(--cw-gray-50); border: 1px solid var(--cw-gray-200); border-radius: var(--border-radius); padding: 12px; margin-bottom: 12px; cursor: pointer; }
        .crew-pool-card:hover { background: white; border-color: var(--cw-accent); }
        .crew-pool-card.eligible { border-left: 3px solid #10B981; }
        .crew-card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .crew-card-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--cw-primary), var(--cw-accent)); color: white; display: flex; align-items: center; justify-content: center; font-weight: 700; }
        .crew-card-info { flex: 1; }
        .crew-card-name { font-size: 0.9rem; font-weight: 700; color: var(--cw-gray-900); }
        .crew-card-rank { font-size: 0.75rem; color: var(--cw-gray-600); }
        .crew-card-badges { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 8px; }
        .crew-badge { padding: 3px 8px; border-radius: 4px; font-size: 0.65rem; font-weight: 600; }
        .crew-badge.dedicated { background: rgba(14,165,233,0.1); color: var(--tag-dedicated); }
        .crew-badge.non-dedicated { background: rgba(139,92,246,0.1); color: var(--tag-non-dedicated); }
        .crew-badge.endorsed { background: rgba(139,92,246,0.1); color: var(--status-endorsed); }
        .crew-eligibility { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; }
        .eligibility-indicator { font-size: 0.7rem; padding: 4px; background: var(--cw-gray-100); border-radius: 4px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 3px; }
        .eligibility-indicator.ok { background: rgba(16,185,129,0.1); color: #059669; }
        .eligibility-indicator.warning { background: rgba(245,158,11,0.1); color: #D97706; }
        .eligibility-indicator.error { background: rgba(239,68,68,0.1); color: #DC2626; }
        .settings-row { display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--cw-gray-100); }
        .settings-row:last-child { border-bottom: none; }
        .settings-row-info { flex: 1; }
        .settings-row-label { font-weight: 500; font-size: 0.9rem; color: var(--cw-gray-800); }
        .settings-row-desc { font-size: 0.8rem; color: var(--cw-gray-500); margin-top: 2px; }
        .settings-toggle { width: 44px; height: 24px; background: var(--cw-gray-300); border-radius: 12px; position: relative; cursor: pointer; transition: background 0.2s ease; }
        .settings-toggle.active { background: var(--cw-accent); }
        .settings-toggle::after { content: ''; position: absolute; width: 20px; height: 20px; background: white; border-radius: 50%; top: 2px; left: 2px; transition: transform 0.2s ease; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
        .settings-toggle.active::after { transform: translateX(20px); }
        .settings-input { width: 200px; padding: 8px 12px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); font-size: 0.85rem; }
        .settings-select { width: 200px; padding: 8px 12px; border: 1px solid var(--cw-gray-300); border-radius: var(--border-radius); font-size: 0.85rem; background: white; }
        @media (max-width: 1024px) {
            .settings-container { grid-template-columns: 1fr; }
            .settings-nav { display: flex; flex-wrap: wrap; gap: 8px; }
            .settings-nav-item { margin-bottom: 0; }
            .compliance-summary { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .filters-row { flex-direction: column; align-items: stretch; }
            .filter-group { width: 100%; }
            .filter-select { width: 100%; }
            .filter-search { min-width: 100%; }
            .filter-divider { display: none; }
            .slide-panel { width: 100%; }
            .form-row { grid-template-columns: 1fr; }
            .page-header { flex-direction: column; align-items: stretch; }
        }
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: 1fr; }
            .page-content { padding: 16px; }
        }

        /* Analytics 3D Styles */
        .analytics-tabs { display: flex; gap: 4px; background: var(--cw-gray-100); padding: 4px; border-radius: 12px; margin-bottom: 24px; flex-wrap: wrap; }
        .analytics-tab { display: flex; align-items: center; gap: 8px; padding: 12px 20px; border: none; background: transparent; border-radius: 10px; cursor: pointer; font-size: 0.9rem; font-weight: 600; color: var(--cw-gray-500); transition: all 0.2s; }
        .analytics-tab:hover { background: var(--cw-gray-200); color: var(--cw-gray-700); }
        .analytics-tab.active { background: white; color: var(--cw-primary); box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .analytics-tab i { width: 18px; height: 18px; }
        .analytics-tab-content { display: none; }
        .analytics-tab-content.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* 3D KPI Cards */
        .kpi-card-3d { background: white; border-radius: 16px; padding: 24px; display: flex; align-items: center; gap: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08), 0 8px 32px rgba(0,0,0,0.04); transition: all 0.3s; transform-style: preserve-3d; }
        .kpi-card-3d:hover { transform: translateY(-4px) rotateX(2deg); box-shadow: 0 12px 40px rgba(0,0,0,0.12), 0 16px 56px rgba(0,0,0,0.08); }
        .kpi-card-3d-icon { width: 64px; height: 64px; border-radius: 16px; display: flex; align-items: center; justify-content: center; color: white; box-shadow: 0 8px 24px rgba(0,0,0,0.2); transform: translateZ(20px); }
        .kpi-card-3d-icon i { width: 28px; height: 28px; }
        .kpi-card-3d-content { flex: 1; }
        .kpi-card-3d-value { font-size: 2rem; font-weight: 800; color: var(--cw-gray-800); line-height: 1; }
        .kpi-card-3d-label { font-size: 0.85rem; color: var(--cw-gray-500); margin-top: 4px; }
        .kpi-card-3d-change { font-size: 0.8rem; margin-top: 8px; display: flex; align-items: center; gap: 4px; }
        .kpi-card-3d-change.up { color: #059669; }
        .kpi-card-3d-change.down { color: #ef4444; }
        .kpi-card-3d-change i { width: 14px; height: 14px; }

        /* 3D Chart Cards */
        .chart-card-3d { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 24px rgba(0,0,0,0.06), 0 12px 48px rgba(0,0,0,0.04); transform-style: preserve-3d; transition: all 0.3s; }
        .chart-card-3d:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,0,0,0.1), 0 16px 56px rgba(0,0,0,0.06); }
        .chart-card-3d-header { padding: 20px 24px; border-bottom: 1px solid var(--cw-gray-100); display: flex; justify-content: space-between; align-items: center; }
        .chart-card-3d-header h3 { font-size: 1rem; font-weight: 700; color: var(--cw-gray-800); margin: 0; }
        .chart-card-3d-header span { font-size: 0.8rem; color: var(--cw-gray-500); }
        .chart-card-3d-legend { display: flex; gap: 16px; font-size: 0.8rem; color: var(--cw-gray-600); }
        .chart-card-3d-legend span { display: flex; align-items: center; gap: 6px; }
        .chart-card-3d-legend i { width: 12px; height: 12px; border-radius: 3px; }
        .chart-card-3d-body { padding: 24px; position: relative; }

        /* API Hub Styles */
        .api-category-card { background: white; border-radius: 16px; padding: 24px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; box-shadow: 0 4px 16px rgba(0,0,0,0.06); }
        .api-category-card:hover { transform: translateY(-4px); border-color: var(--cw-primary); box-shadow: 0 12px 32px rgba(0,0,0,0.12); }
        .api-category-icon { width: 56px; height: 56px; border-radius: 14px; display: flex; align-items: center; justify-content: center; color: white; margin-bottom: 16px; }
        .api-category-icon i { width: 28px; height: 28px; }
        .api-category-card h3 { font-size: 1.1rem; font-weight: 700; margin: 0 0 8px; color: var(--cw-gray-800); }
        .api-category-card p { font-size: 0.85rem; color: var(--cw-gray-500); margin: 0 0 12px; }
        .api-endpoints-count { font-size: 0.75rem; color: var(--cw-primary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }

        .api-endpoint-group { padding: 20px 0; border-bottom: 1px solid var(--cw-gray-100); }
        .api-endpoint-group:last-child { border-bottom: none; }
        .api-endpoint { display: flex; align-items: center; gap: 12px; padding: 12px 16px; margin: 8px 0; background: var(--cw-gray-50); border-radius: 8px; transition: all 0.2s; }
        .api-endpoint:hover { background: var(--cw-gray-100); }
        .api-endpoint code { font-family: 'Monaco', 'Consolas', monospace; font-size: 0.85rem; color: var(--cw-gray-700); flex: 1; }
        .api-desc { font-size: 0.8rem; color: var(--cw-gray-500); }
        .api-method-badge { padding: 4px 10px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .api-method-badge.get { background: #dcfce7; color: #059669; }
        .api-method-badge.post { background: #dbeafe; color: #3b82f6; }
        .api-method-badge.put { background: #fef3c7; color: #d97706; }
        .api-method-badge.delete { background: #fee2e2; color: #dc2626; }

        /* ==========================================
           SPECTACULAR REAL-TIME DASHBOARD
           ========================================== */
        .realtime-dashboard-wrapper {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            border-radius: 24px;
            padding: 32px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3), 0 0 100px rgba(6,182,212,0.1);
        }
        .realtime-dashboard-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at 20% 20%, rgba(6,182,212,0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at 80% 80%, rgba(139,92,246,0.15) 0%, transparent 50%);
            pointer-events: none;
        }
        .realtime-dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }
        .realtime-dashboard-title h2 {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 8px 0 4px;
        }
        .realtime-dashboard-title p {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
            margin: 0;
        }
        .realtime-live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(239,68,68,0.2);
            color: #ef4444;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 1px;
        }
        .live-dot {
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            animation: livePulse 1.5s ease-in-out infinite;
            box-shadow: 0 0 10px #ef4444;
        }
        @keyframes livePulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }
        .realtime-dashboard-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .last-updated {
            color: rgba(255,255,255,0.5);
            font-size: 0.8rem;
        }
        .last-updated strong {
            color: rgba(255,255,255,0.8);
        }
        .btn-realtime-refresh {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: white;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-realtime-refresh:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }
        .btn-realtime-refresh i {
            width: 16px;
            height: 16px;
        }

        /* Metric Cards Grid */
        .realtime-metrics-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        @media (max-width: 1400px) {
            .realtime-metrics-grid { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 900px) {
            .realtime-metrics-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* Individual Metric Card */
        .realtime-metric-card {
            position: relative;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 24px 20px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }
        .realtime-metric-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--accent-color);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 40px var(--glow-color);
        }
        .realtime-metric-card.alert {
            animation: alertPulse 2s ease-in-out infinite;
        }
        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(239,68,68,0.2); }
            50% { box-shadow: 0 0 40px rgba(239,68,68,0.4); }
        }
        .metric-card-glow {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--glow-color) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s;
            pointer-events: none;
        }
        .realtime-metric-card:hover .metric-card-glow {
            opacity: 0.3;
        }
        .metric-card-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        /* Circular Progress Ring */
        .metric-ring-container {
            position: relative;
            width: 90px;
            height: 90px;
            margin-bottom: 16px;
        }
        .metric-ring {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        .ring-bg {
            fill: none;
            stroke: rgba(255,255,255,0.1);
            stroke-width: 6;
        }
        .ring-progress {
            fill: none;
            stroke-width: 6;
            stroke-linecap: round;
            transition: stroke-dasharray 1s ease;
            filter: drop-shadow(0 0 8px currentColor);
        }
        .pulse-ring {
            animation: ringPulse 2s ease-in-out infinite;
        }
        @keyframes ringPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        .metric-ring-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
        }
        .metric-ring-icon i {
            width: 24px;
            height: 24px;
        }

        /* Metric Info */
        .metric-info {
            margin-bottom: 12px;
        }
        .metric-value-large {
            font-size: 2.25rem;
            font-weight: 800;
            color: white;
            line-height: 1;
            margin-bottom: 4px;
            text-shadow: 0 2px 20px rgba(255,255,255,0.2);
        }
        .metric-unit {
            font-size: 1.25rem;
            font-weight: 600;
            opacity: 0.8;
        }
        .metric-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255,255,255,0.9);
            margin-bottom: 2px;
        }
        .metric-sublabel {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
        }

        /* Sparkline placeholder */
        .metric-sparkline {
            width: 100%;
            height: 30px;
            margin: 8px 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,0.05) 20%, 
                rgba(255,255,255,0.1) 40%, 
                rgba(255,255,255,0.05) 60%, 
                rgba(255,255,255,0.15) 80%, 
                rgba(255,255,255,0.1) 100%);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }
        .metric-sparkline::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            100% { left: 100%; }
        }

        /* Trend Indicator */
        .metric-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(255,255,255,0.1);
        }
        .metric-trend i {
            width: 14px;
            height: 14px;
        }
        .metric-trend.up {
            color: #10b981;
            background: rgba(16,185,129,0.15);
        }
        .metric-trend.down {
            color: #ef4444;
            background: rgba(239,68,68,0.15);
        }
        .metric-trend.down.good {
            color: #10b981;
            background: rgba(16,185,129,0.15);
        }
        .metric-trend.alert {
            color: #fbbf24;
            background: rgba(251,191,36,0.15);
            animation: alertBlink 1s ease-in-out infinite;
        }
        @keyframes alertBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Clickable Seafarer Styling */
        .clickable-seafarer {
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 8px;
            padding: 4px;
            margin: -4px;
        }
        .clickable-seafarer:hover {
            background: rgba(0,73,93,0.08);
        }
        .clickable-seafarer:hover .avatar-name,
        .clickable-seafarer:hover .embark-name,
        .clickable-seafarer:hover .ticket-passenger-name,
        .clickable-seafarer:hover .interview-candidate-name,
        .clickable-seafarer:hover .eval-name {
            color: var(--cw-primary);
            text-decoration: underline;
        }
        .clickable-seafarer:hover .avatar,
        .clickable-seafarer:hover .embark-avatar,
        .clickable-seafarer:hover .ticket-passenger-avatar,
        .clickable-seafarer:hover .interview-candidate-avatar,
        .clickable-seafarer:hover .eval-avatar {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,73,93,0.2);
        }

        /* Employment History Timeline */
        .history-timeline-list { display: flex; flex-direction: column; gap: 0; }
        .history-item { display: flex; gap: 16px; }
        .history-timeline { display: flex; flex-direction: column; align-items: center; width: 24px; }
        .history-dot { width: 12px; height: 12px; border-radius: 50%; background: var(--cw-gray-300); border: 2px solid var(--cw-gray-100); flex-shrink: 0; }
        .history-dot.current { background: var(--cw-primary); border-color: rgba(0,73,93,0.2); width: 16px; height: 16px; }
        .history-line { width: 2px; flex: 1; background: var(--cw-gray-200); min-height: 60px; }
        .history-content { flex: 1; padding-bottom: 24px; }
        .history-content h4 { margin: 0 0 4px; font-size: 1rem; font-weight: 600; color: var(--cw-gray-800); }
        .history-content p { margin: 0 0 8px; font-size: 0.85rem; color: var(--cw-gray-600); }
        .history-date { font-size: 0.75rem; color: var(--cw-gray-500); font-weight: 500; }
        .history-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; margin-bottom: 8px; }
        .history-badge.current { background: rgba(16,185,129,0.1); color: var(--status-ready); }

        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="#" class="logo">
                    <div class="logo-icon"><i data-lucide="compass"></i></div>
                    <div class="logo-text">
                        <span class="logo-brand">Crossworld</span>
                        <span class="logo-system">ATLANTIS ERP</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <a class="nav-item active" data-view="dashboard"><i data-lucide="layout-dashboard"></i><span>Dashboard</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Recruitment</div>
                    <a class="nav-item" data-view="candidates"><i data-lucide="user-plus"></i><span>Candidates</span><span class="nav-item-badge">24</span></a>
                    <a class="nav-item" data-view="interviews"><i data-lucide="clipboard-list"></i><span>Interviews</span></a>
                    <a class="nav-item" data-view="rfc-tasks"><i data-lucide="file-text"></i><span>RFC Tasks</span><span class="nav-item-badge warning">8</span></a>
                    <a class="nav-item" data-view="talent-pool"><i data-lucide="settings-2"></i><span>Talent-Pool Settings</span></a>
                    
                <div class="nav-section">CREW MANAGEMENT</div>
                    <a class="nav-item" data-view="seafarer-profile"><i data-lucide="user-circle"></i><span>Seafarer Profile</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Crew Operations</div>
                    <a class="nav-item" data-view="clients"><i data-lucide="building-2"></i><span>Clients</span></a>
                    <a class="nav-item" data-view="fleet"><i data-lucide="ship"></i><span>Fleet & Vessels</span></a>
                    <a class="nav-item" data-view="rfa-hub"><i data-lucide="git-pull-request"></i><span>RFA Hub</span><span class="nav-item-badge danger">12</span></a>
                    <a class="nav-item" data-view="assignment-proposal"><i data-lucide="users-round"></i><span>Assignment & Proposal</span><span class="nav-item-badge">8</span></a>
                    <a class="nav-item" data-view="contracts"><i data-lucide="file-signature"></i><span>Contracts</span></a>
                    <a class="nav-item" data-view="rotation-plan"><i data-lucide="calendar-range"></i><span>Rotation Plan</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Crew Management</div>
                    <a class="nav-item" data-view="seafarer-roster"><i data-lucide="users"></i><span>Seafarer Roster</span></a>
                    <a class="nav-item" data-view="supernumerary"><i data-lucide="user-check"></i><span>Supernumerary</span><span class="nav-item-badge">3</span></a>
                    <a class="nav-item" data-view="documents"><i data-lucide="folder-open"></i><span>Documents</span></a>
                    <a class="nav-item" data-view="pending-transactions"><i data-lucide="list-checks"></i><span>Pending Transactions</span><span class="nav-item-badge">5</span></a>
                    <a class="nav-item" data-view="embarkation-prep"><i data-lucide="plane"></i><span>Embarkation Prep</span></a>
                    <a class="nav-item" data-view="crew-changes"><i data-lucide="repeat"></i><span>Crew Changes</span><span class="nav-item-badge">12</span></a>
                    <a class="nav-item" data-view="tickets"><i data-lucide="ticket"></i><span>Tickets</span></a>
                    <a class="nav-item" data-view="evaluations"><i data-lucide="star"></i><span>Evaluations</span></a>
                    <a class="nav-item" data-view="complaints"><i data-lucide="message-square-warning"></i><span>Complaints</span><span class="nav-item-badge danger">7</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Reports</div>
                    <a class="nav-item" data-view="analytics"><i data-lucide="bar-chart-3"></i><span>Analytics</span></a>
                    <a class="nav-item" data-view="compliance"><i data-lucide="bar-chart-2"></i><span>Complaints Analytics</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">System</div>
                    <a class="nav-item" data-view="settings"><i data-lucide="settings"></i><span>Settings</span></a>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">MA</div>
                    <div class="user-info">
                        <div class="user-name">Maria Santos</div>
                        <div class="user-role">Crew Manager</div>
                    </div>
                    <i data-lucide="chevron-down" style="width:16px;height:16px;opacity:0.6;"></i>
                </div>
                <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.1);text-align:center;">
                    <span style="font-size:0.75rem;color:rgba(255,255,255,0.9);letter-spacing:0.05em;font-weight:600;">ATLANTIS_v2_35_ANALYTICS_1_WORKING</span>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="toggleSidebar()"><i data-lucide="menu" style="width:20px;height:20px;"></i></button>
                    <nav class="breadcrumb" id="breadcrumb">
                        <span class="breadcrumb-item">Overview</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item active">Dashboard</span>
                    </nav>
                </div>
                <div class="header-center">
                    <div class="global-search">
                        <i data-lucide="search" class="global-search-icon" style="width:18px;height:18px;"></i>
                        <input type="text" placeholder="Search seafarers, vessels, principals..." id="globalSearch">
                        <span class="global-search-shortcut">âŒ˜K</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-action" title="Notifications"><i data-lucide="bell" style="width:20px;height:20px;"></i><span class="notification-badge"></span></button>
                    <button class="header-action" title="Help"><i data-lucide="help-circle" style="width:20px;height:20px;"></i></button>
                    <button class="header-action" title="Settings"><i data-lucide="settings" style="width:20px;height:20px;"></i></button>
                </div>
            </header>

            <div class="page-content" id="pageContent">
                <!-- VIEW: DASHBOARD -->
                <div class="view active" id="view-dashboard">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Dashboard</h1>
                            <p class="page-subtitle">Welcome back, Maria. Here's your operational overview.</p>
                        </div>
                        <div class="page-actions"><button class="btn btn-secondary"><i data-lucide="download"></i>Export Report</button></div>
                    </div>
                    <div class="stats-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="stat-card"><div class="stat-icon primary"><i data-lucide="users"></i></div><div class="stat-label">Total Seafarers</div><div class="stat-value">2,847</div><div class="stat-change positive"><i data-lucide="trending-up" style="width:14px;height:14px;"></i>+12% from last month</div></div>
                        <div class="stat-card"><div class="stat-icon success"><i data-lucide="anchor"></i></div><div class="stat-label">Currently Embarked</div><div class="stat-value">1,456</div><div class="stat-change positive"><i data-lucide="trending-up" style="width:14px;height:14px;"></i>+8%</div></div>
                        <div class="stat-card"><div class="stat-icon warning"><i data-lucide="clock"></i></div><div class="stat-label">Pending RFAs</div><div class="stat-value">47</div><div class="stat-change negative"><i data-lucide="trending-up" style="width:14px;height:14px;"></i>+15 this week</div></div>
                        <div class="stat-card"><div class="stat-icon info"><i data-lucide="ship"></i></div><div class="stat-label">Active Vessels</div><div class="stat-value">89</div></div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                        <div class="card">
                            <div class="card-header"><h3 class="card-title">Quick Actions</h3></div>
                            <div class="card-body">
                                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">
                                    <button class="btn btn-secondary" onclick="navigateTo('rfa-hub')"><i data-lucide="plus"></i>New RFA</button>
                                    <button class="btn btn-secondary" onclick="navigateTo('candidates')"><i data-lucide="user-plus"></i>Add Candidate</button>
                                    <button class="btn btn-secondary" onclick="navigateTo('seafarer-roster')"><i data-lucide="search"></i>Find Seafarer</button>
                                    <button class="btn btn-secondary" onclick="navigateTo('rotation-plan')"><i data-lucide="calendar"></i>View Rotation</button>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header"><h3 class="card-title">Alerts & Notifications</h3><span class="nav-item-badge danger">5</span></div>
                            <div class="card-body">
                                <div style="display:flex;flex-direction:column;gap:12px;">
                                    <div style="display:flex;align-items:center;gap:12px;padding:12px;background:rgba(239,68,68,0.05);border-radius:var(--border-radius);border-left:3px solid var(--tag-nfr);">
                                        <i data-lucide="alert-triangle" style="width:20px;height:20px;color:var(--tag-nfr);"></i>
                                        <div><div style="font-weight:600;font-size:0.85rem;">3 certificates expiring this week</div><div style="font-size:0.75rem;color:var(--cw-gray-500);">Requires immediate attention</div></div>
                                    </div>
                                    <div style="display:flex;align-items:center;gap:12px;padding:12px;background:rgba(245,158,11,0.05);border-radius:var(--border-radius);border-left:3px solid var(--status-on-approval);">
                                        <i data-lucide="clock" style="width:20px;height:20px;color:var(--status-on-approval);"></i>
                                        <div><div style="font-weight:600;font-size:0.85rem;">8 RFAs pending approval</div><div style="font-size:0.75rem;color:var(--cw-gray-500);">Average wait: 2.3 days</div></div>
                                    </div>
                                    <div style="display:flex;align-items:center;gap:12px;padding:12px;background:rgba(59,130,246,0.05);border-radius:var(--border-radius);border-left:3px solid var(--status-on-preparation);">
                                        <i data-lucide="users" style="width:20px;height:20px;color:var(--status-on-preparation);"></i>
                                        <div><div style="font-weight:600;font-size:0.85rem;">5 seafarers ready for embarkation</div><div style="font-size:0.75rem;color:var(--cw-gray-500);">Scheduled within 7 days</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: SEAFARER ROSTER -->
                <div class="view" id="view-seafarer-roster">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Seafarer Roster</h1>
                            <p class="page-subtitle">Manage dedicated and non-dedicated crew pools across all principals</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-secondary"><i data-lucide="upload"></i>Import</button>
                            <button class="btn btn-primary" onclick="openModal('addSeafarerModal')"><i data-lucide="plus"></i>Add Seafarer</button>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card active"><div class="stat-label">Total Seafarers</div><div class="stat-value">2,847</div><div class="stat-change positive"><i data-lucide="trending-up" style="width:14px;height:14px;"></i>+12% this month</div></div>
                        <div class="stat-card"><div class="stat-label">Embarked</div><div class="stat-value">1,456</div></div>
                        <div class="stat-card"><div class="stat-label">On Preparation</div><div class="stat-value">234</div></div>
                        <div class="stat-card"><div class="stat-label">Available</div><div class="stat-value">892</div></div>
                        <div class="stat-card"><div class="stat-label">Dedicated Pool</div><div class="stat-value">1,123</div></div>
                        <div class="stat-card"><div class="stat-label">Non-Dedicated</div><div class="stat-value">1,724</div></div>
                    </div>
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select"><option value="">All Statuses</option><option value="endorsed">Endorsed</option><option value="on-approval">On Approval</option><option value="on-preparation">On Preparation</option><option value="ready">Ready</option><option value="embarked">Embarked</option><option value="inactive">Inactive</option></select></div>
                            <div class="filter-group"><label class="filter-label">Pool Type</label><select class="filter-select"><option value="">All Pools</option><option value="dedicated">Dedicated</option><option value="non-dedicated">Non-Dedicated</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option><option value="eurobulk">Eurobulk</option></select></div>
                            <div class="filter-group"><label class="filter-label">Rank</label><select class="filter-select"><option value="">All Ranks</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option></optgroup><optgroup label="Ratings"><option>Bosun</option><option>AB Seaman</option><option>OS Seaman</option><option>Oiler</option><option>Cook</option></optgroup></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search by name, ID, or vessel..."></div>
                            <button class="btn btn-ghost btn-sm"><i data-lucide="sliders-horizontal"></i>More Filters</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <div class="table-header">
                            <div class="table-header-left">
                                <span class="table-title">Seafarers</span>
                                <span class="table-count">Showing 1-10 of 2,847 results</span>
                                <div class="selected-actions" id="rosterSelectedActions"><span class="selected-count">0 selected</span><button class="bulk-action-btn">Change Status</button><button class="bulk-action-btn">Assign Pool</button><button class="bulk-action-btn">Export</button></div>
                            </div>
                            <div class="table-header-right">
                                <button class="btn btn-ghost btn-sm btn-icon" title="Columns"><i data-lucide="columns-3"></i></button>
                                <button class="btn btn-ghost btn-sm btn-icon" title="Refresh"><i data-lucide="refresh-cw"></i></button>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <thead><tr>
                                    <th class="checkbox-cell"><div class="custom-checkbox" onclick="toggleAllCheckboxes('roster')"><i data-lucide="check" style="width:12px;height:12px;"></i></div></th>
                                    <th class="sortable sorted-asc">Seafarer</th><th class="sortable">Rank</th><th class="sortable">Status</th><th>Pool / Tags</th><th class="sortable">Vessel</th><th class="sortable">Principal</th><th class="sortable">Contract End</th><th>Documents</th><th class="actions-cell"></th>
                                </tr></thead>
                                <tbody id="rosterTableBody"></tbody>
                            </table>
                        </div>
                        <div class="table-footer">
                            <div class="pagination-info">Showing <strong>1</strong> to <strong>10</strong> of <strong>2,847</strong> seafarers</div>
                            <div class="pagination">
                                <button class="pagination-btn" disabled><i data-lucide="chevron-left" style="width:16px;height:16px;"></i></button>
                                <button class="pagination-btn active">1</button><button class="pagination-btn">2</button><button class="pagination-btn">3</button><span class="pagination-ellipsis">...</span><button class="pagination-btn">284</button><button class="pagination-btn">285</button>
                                <button class="pagination-btn"><i data-lucide="chevron-right" style="width:16px;height:16px;"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: RFA HUB -->
                <div class="view" id="view-rfa-hub">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">RFA Hub</h1>
                            <p class="page-subtitle">Manage all Request for Action items - Embark, Sign-off, Promotion, Extension, Replace</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportRfas()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('newRfaModal')"><i data-lucide="plus"></i>New RFA</button>
                        </div>
                    </div>
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterRfasByType('embark')"><div class="stat-label">Embark</div><div class="stat-value" id="rfaEmbarkCount">28</div><span class="tag tag-embark">EMBARK</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterRfasByType('signoff')"><div class="stat-label">Sign-off</div><div class="stat-value" id="rfaSignoffCount">15</div><span class="tag tag-signoff">SIGN-OFF</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterRfasByType('promotion')"><div class="stat-label">Promotion</div><div class="stat-value" id="rfaPromotionCount">4</div><span class="tag tag-promotion">PROMOTION</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterRfasByType('extension')"><div class="stat-label">Extension</div><div class="stat-value" id="rfaExtensionCount">7</div><span class="tag tag-extension">EXTENSION</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterRfasByType('replace')"><div class="stat-label">Replace</div><div class="stat-value" id="rfaReplaceCount">3</div><span class="tag tag-replace">REPLACE</span></div>
                    </div>
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">RFA Type</label><select class="filter-select" id="rfaTypeFilter" onchange="renderRfaTable()"><option value="">All Types</option><option value="embark">Embark</option><option value="signoff">Sign-off</option><option value="promotion">Promotion</option><option value="extension">Extension</option><option value="replace">Replace</option></select></div>
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="rfaStatusFilter" onchange="renderRfaTable()"><option value="">All Statuses</option><option value="new">New</option><option value="in-progress">In Progress</option><option value="pending-approval">Pending Approval</option><option value="approved">Approved</option><option value="in-preparation">In Preparation</option><option value="ready">Ready</option><option value="completed">Completed</option><option value="cancelled">Cancelled</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="rfaPrincipalFilter" onchange="renderRfaTable()"><option value="">All Principals</option><option value="Diana Shipping">Diana Shipping</option><option value="Centrofin">Centrofin</option><option value="Pioneer Marine">Pioneer Marine</option><option value="Neda Maritime">Neda Maritime</option></select></div>
                            <div class="filter-group"><label class="filter-label">Priority</label><select class="filter-select" id="rfaPriorityFilter" onchange="renderRfaTable()"><option value="">All Priorities</option><option value="urgent">Urgent</option><option value="high">High</option><option value="normal">Normal</option><option value="low">Low</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search by RFA ID, vessel, seafarer..." id="rfaSearchInput" oninput="renderRfaTable()"></div>
                        </div>
                    </div>
                    <div class="table-container">
                        <div class="table-header">
                            <div class="table-header-left"><span class="table-title">Requests for Action</span><span class="table-count" id="rfaTableCount">Showing 1-10 of 57 RFAs</span></div>
                            <div class="table-header-right"><button class="btn btn-ghost btn-sm btn-icon" title="Refresh" onclick="renderRfaTable(); showNotification('RFA list refreshed', 'success');"><i data-lucide="refresh-cw"></i></button></div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <thead><tr><th class="sortable">RFA ID</th><th>Type</th><th class="sortable">Status</th><th class="sortable">Vessel</th><th>Position</th><th>Seafarer</th><th class="sortable">Target Date</th><th class="sortable">Created</th><th class="actions-cell"></th></tr></thead>
                                <tbody id="rfaTableBody"></tbody>
                            </table>
                        </div>
                        <div class="table-footer">
                            <div class="pagination-info">Showing <strong>1</strong> to <strong>10</strong> of <strong>57</strong> RFAs</div>
                            <div class="pagination">
                                <button class="pagination-btn" disabled><i data-lucide="chevron-left" style="width:16px;height:16px;"></i></button>
                                <button class="pagination-btn active">1</button><button class="pagination-btn">2</button><button class="pagination-btn">3</button><button class="pagination-btn">4</button><button class="pagination-btn">5</button><button class="pagination-btn">6</button>
                                <button class="pagination-btn"><i data-lucide="chevron-right" style="width:16px;height:16px;"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: CANDIDATES -->
                <div class="view" id="view-candidates">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Candidate Pipeline</h1>
                            <p class="page-subtitle">Sourcing, evaluating, and endorsing candidates in response to RFCs</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary"><i data-lucide="filter"></i>Filter</button>
                            <button class="btn btn-secondary"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-secondary" onclick="openModal('publicRegistrationModal')" style="background:linear-gradient(135deg,#10b981,#059669);color:white;"><i data-lucide="link"></i>Public Registration</button>
                            <button class="btn btn-primary" onclick="openModal('addCandidateModal')"><i data-lucide="plus"></i>Add Candidate</button>
                        </div>
                    </div>

                    <!-- Pipeline Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(6,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterKanban('new')"><div class="stat-label">New</div><div class="stat-value">42</div><div class="stat-change"><i data-lucide="clock" style="width:12px;height:12px;"></i> Avg 2.3 days</div></div>
                        <div class="stat-card" onclick="filterKanban('screening')"><div class="stat-label">Screening</div><div class="stat-value">28</div><div class="stat-change"><i data-lucide="clock" style="width:12px;height:12px;"></i> Avg 4.1 days</div></div>
                        <div class="stat-card" onclick="filterKanban('interview')"><div class="stat-label">Interview</div><div class="stat-value">15</div><div class="stat-change"><i data-lucide="clock" style="width:12px;height:12px;"></i> Avg 3.5 days</div></div>
                        <div class="stat-card" onclick="filterKanban('negotiation')"><div class="stat-label">Negotiation</div><div class="stat-value">8</div><div class="stat-change"><i data-lucide="clock" style="width:12px;height:12px;"></i> Avg 5.2 days</div></div>
                        <div class="stat-card" onclick="filterKanban('endorsed')"><div class="stat-label">Endorsed</div><div class="stat-value">156</div><div class="stat-change positive"><i data-lucide="check" style="width:12px;height:12px;"></i> This month: 23</div></div>
                        <div class="stat-card" onclick="filterKanban('rejected')"><div class="stat-label">Rejected</div><div class="stat-value">34</div><div class="stat-change negative"><i data-lucide="x" style="width:12px;height:12px;"></i> This month: 8</div></div>
                    </div>

                    <!-- Filters Bar -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">RFC</label><select class="filter-select" id="candidateRfcFilter" onchange="renderKanbanBoard()"><option value="">All RFCs</option><option value="RFC-2025-042">RFC-2025-042 (Chief Officer)</option><option value="RFC-2025-041">RFC-2025-041 (2nd Engineer)</option><option value="RFC-2025-040">RFC-2025-040 (AB Seaman)</option><option value="RFC-2025-039">RFC-2025-039 (Bosun)</option><option value="RFC-2025-038">RFC-2025-038 (Master)</option></select></div>
                            <div class="filter-group"><label class="filter-label">Rank</label><select class="filter-select" id="candidateRankFilter" onchange="renderKanbanBoard()"><option value="">All Ranks</option><option value="Master">Master</option><option value="Chief Officer">Chief Officer</option><option value="2nd Officer">2nd Officer</option><option value="3rd Officer">3rd Officer</option><option value="Chief Engineer">Chief Engineer</option><option value="2nd Engineer">2nd Engineer</option><option value="Bosun">Bosun</option><option value="AB Seaman">AB Seaman</option><option value="Oiler">Oiler</option></select></div>
                            <div class="filter-group"><label class="filter-label">Source</label><select class="filter-select" id="candidateSourceFilter" onchange="renderKanbanBoard()"><option value="">All Sources</option><option value="walk-in">Walk-in</option><option value="referral">Referral</option><option value="agency">Agency</option><option value="online">Online</option><option value="job-fair">Job Fair</option></select></div>
                            <div class="filter-group"><label class="filter-label">Priority</label><select class="filter-select" id="candidatePriorityFilter" onchange="renderKanbanBoard()"><option value="">All Priorities</option><option value="urgent">Urgent</option><option value="high">High</option><option value="normal">Normal</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search candidates..." id="candidateSearchInput" oninput="renderKanbanBoard()"></div>
                        </div>
                    </div>

                    <!-- Kanban Board -->
                    <div class="kanban-container" id="kanbanBoard">
                        <!-- Columns rendered by JavaScript -->
                    </div>
                </div>

                <!-- PLACEHOLDER VIEWS -->
                <div class="view" id="view-interviews">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Interviews & Assessment</h1>
                            <p class="page-subtitle">Schedule, conduct, and evaluate candidate interviews</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" id="toggleCalendarBtn" onclick="toggleInterviewCalendar()"><i data-lucide="calendar"></i><span id="calendarBtnText">Calendar View</span></button>
                            <button class="btn btn-secondary" onclick="exportInterviews()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('scheduleInterviewModal')"><i data-lucide="plus"></i>Schedule Interview</button>
                        </div>
                    </div>

                    <!-- Interview Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(6,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterInterviewsByDate('today')"><div class="stat-label">Today</div><div class="stat-value" id="interviewTodayCount">4</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-preparation);cursor:pointer;" onclick="filterInterviewsByStatus('scheduled')"><div class="stat-label">Scheduled</div><div class="stat-value" style="color:var(--status-on-preparation);" id="interviewScheduledCount">12</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-approval);cursor:pointer;" onclick="filterInterviewsByStatus('in-progress')"><div class="stat-label">In Progress</div><div class="stat-value" style="color:var(--status-on-approval);" id="interviewInProgressCount">2</div></div>
                        <div class="stat-card" style="border-color:var(--status-ready);cursor:pointer;" onclick="filterInterviewsByStatus('completed')"><div class="stat-label">Completed (MTD)</div><div class="stat-value" style="color:var(--status-ready);" id="interviewCompletedCount">28</div></div>
                        <div class="stat-card"><div class="stat-label">Pass Rate</div><div class="stat-value">76%</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterInterviewsByStatus('no-show')"><div class="stat-label">No Shows</div><div class="stat-value" id="interviewNoShowCount">3</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="interviewStatusFilter" onchange="renderInterviews()"><option value="">All Status</option><option value="scheduled">Scheduled</option><option value="in-progress">In Progress</option><option value="completed">Completed</option><option value="cancelled">Cancelled</option><option value="no-show">No Show</option></select></div>
                            <div class="filter-group"><label class="filter-label">Date Range</label><select class="filter-select" id="interviewDateFilter" onchange="renderInterviews()"><option value="">All Dates</option><option value="today">Today</option><option value="week">This Week</option><option value="month">This Month</option></select></div>
                            <div class="filter-group"><label class="filter-label">Interviewer</label><select class="filter-select" id="interviewerFilter" onchange="renderInterviews()"><option value="">All Interviewers</option><option value="Maria Santos">Maria Santos</option><option value="Carlos Reyes">Carlos Reyes</option><option value="Ana Garcia">Ana Garcia</option></select></div>
                            <div class="filter-group"><label class="filter-label">Result</label><select class="filter-select" id="interviewResultFilter" onchange="renderInterviews()"><option value="">All Results</option><option value="passed">Passed</option><option value="failed">Failed</option><option value="pending">Pending</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search candidate..." id="interviewSearchInput" oninput="renderInterviews()"></div>
                        </div>
                    </div>

                    <!-- Calendar View (hidden by default) -->
                    <div id="interviewCalendarView" style="display:none;">
                        <div class="calendar-header">
                            <button class="btn btn-ghost" onclick="changeCalendarWeek(-1)"><i data-lucide="chevron-left"></i></button>
                            <h3 id="calendarWeekTitle" style="margin:0 16px;font-size:1rem;">February 10 - 16, 2025</h3>
                            <button class="btn btn-ghost" onclick="changeCalendarWeek(1)"><i data-lucide="chevron-right"></i></button>
                        </div>
                        <div class="calendar-grid" id="calendarGrid"></div>
                    </div>

                    <!-- Interviews Grid -->
                    <div class="fleet-grid" id="interviewsGrid" style="grid-template-columns:repeat(auto-fill,minmax(360px,1fr));">
                        <!-- Interview cards rendered by JavaScript -->
                    </div>
                </div>
                <div class="view" id="view-rfc-tasks">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">RFC Tasks</h1>
                            <p class="page-subtitle">Request for Candidates - sourcing tasks when pools cannot fill demand</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportRfcTasks()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('createRfcModal')"><i data-lucide="plus"></i>Create RFC</button>
                        </div>
                    </div>

                    <!-- RFC Stats - Clickable -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="border-color:var(--rfa-new);cursor:pointer;" onclick="filterRfcByStatus('open')"><div class="stat-label">Open</div><div class="stat-value" style="color:var(--rfa-new);" id="rfcOpenCount">8</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-approval);cursor:pointer;" onclick="filterRfcByStatus('sourcing')"><div class="stat-label">Sourcing</div><div class="stat-value" style="color:var(--status-on-approval);" id="rfcSourcingCount">12</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-preparation);cursor:pointer;" onclick="filterRfcByStatus('shortlisted')"><div class="stat-label">Shortlisted</div><div class="stat-value" style="color:var(--status-on-preparation);" id="rfcShortlistedCount">6</div></div>
                        <div class="stat-card" style="border-color:var(--status-ready);cursor:pointer;" onclick="filterRfcByStatus('filled')"><div class="stat-label">Filled (MTD)</div><div class="stat-value" style="color:var(--status-ready);">23</div></div>
                        <div class="stat-card"><div class="stat-label">Avg Fill Time</div><div class="stat-value">11.3</div><span class="text-secondary">days</span></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="rfcStatusFilter" onchange="renderRfcTasks()"><option value="">All Status</option><option value="open">Open</option><option value="sourcing">Sourcing</option><option value="shortlisted">Shortlisted</option><option value="filled">Filled</option><option value="cancelled">Cancelled</option></select></div>
                            <div class="filter-group"><label class="filter-label">Priority</label><select class="filter-select" id="rfcPriorityFilter" onchange="renderRfcTasks()"><option value="">All Priorities</option><option value="urgent">Urgent</option><option value="high">High</option><option value="normal">Normal</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="rfcPrincipalFilter" onchange="renderRfcTasks()"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option><option value="oldendorff">Oldendorff</option></select></div>
                            <div class="filter-group"><label class="filter-label">Rank</label><select class="filter-select" id="rfcRankFilter" onchange="renderRfcTasks()"><option value="">All Ranks</option><option value="Master">Master</option><option value="Chief Officer">Chief Officer</option><option value="Chief Engineer">Chief Engineer</option><option value="2nd Engineer">2nd Engineer</option><option value="Bosun">Bosun</option><option value="AB Seaman">AB Seaman</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search RFC..." id="rfcSearchInput" oninput="renderRfcTasks()"></div>
                        </div>
                    </div>

                    <!-- RFC Tasks Grid -->
                    <div class="fleet-grid" id="rfcTasksGrid" style="grid-template-columns:repeat(auto-fill,minmax(360px,1fr));">
                        <!-- RFC task cards rendered by JavaScript -->
                    </div>
                </div>
                <div class="view" id="view-clients">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Clients & Principals</h1>
                            <p class="page-subtitle">Manage shipping principals, fleet assignments, and commercial relationships</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportClients()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('addClientModal')"><i data-lucide="plus"></i>Add Client</button>
                        </div>
                    </div>

                    <!-- Client Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterClientsByStatus('')"><div class="stat-icon primary"><i data-lucide="building-2"></i></div><div class="stat-label">Total Principals</div><div class="stat-value" id="clientsTotalCount">34</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="navigateTo('fleet')"><div class="stat-icon success"><i data-lucide="ship"></i></div><div class="stat-label">Managed Vessels</div><div class="stat-value">89</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="navigateTo('seafarer-roster')"><div class="stat-icon info"><i data-lucide="users"></i></div><div class="stat-label">Active Crew</div><div class="stat-value">1,456</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterClientsByStatus('active')"><div class="stat-icon warning"><i data-lucide="file-signature"></i></div><div class="stat-label">Active Contracts</div><div class="stat-value">1,523</div></div>
                        <div class="stat-card"><div class="stat-label">Avg Vessels/Client</div><div class="stat-value">2.6</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Country</label><select class="filter-select" id="clientCountryFilter" onchange="renderClientsGrid()"><option value="">All Countries</option><option value="greece">Greece</option><option value="germany">Germany</option><option value="norway">Norway</option><option value="japan">Japan</option></select></div>
                            <div class="filter-group"><label class="filter-label">Fleet Size</label><select class="filter-select" id="clientFleetSizeFilter" onchange="renderClientsGrid()"><option value="">Any Size</option><option value="small">1-5 vessels</option><option value="medium">6-15 vessels</option><option value="large">16+ vessels</option></select></div>
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="clientStatusFilter" onchange="renderClientsGrid()"><option value="">All Status</option><option value="active">Active</option><option value="prospect">Prospect</option><option value="inactive">Inactive</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search principals..." id="clientSearchInput" oninput="renderClientsGrid()"></div>
                        </div>
                    </div>

                    <!-- Clients Grid -->
                    <div class="fleet-grid" id="clientsGrid" style="grid-template-columns:repeat(auto-fill,minmax(340px,1fr));">
                        <!-- Client cards rendered by JavaScript -->
                    </div>
                </div>
                <div class="view" id="view-fleet">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Fleet & Vessels</h1>
                            <p class="page-subtitle">Manage vessel registry, crew assignments, and fleet operations</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportFleet()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-secondary" onclick="showFleetMap()"><i data-lucide="map"></i>Fleet Map</button>
                            <button class="btn btn-primary" onclick="openModal('addVesselModal')"><i data-lucide="plus"></i>Add Vessel</button>
                        </div>
                    </div>

                    <!-- Fleet Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterFleetByStatus('')"><div class="stat-icon primary"><i data-lucide="ship"></i></div><div class="stat-label">Total Vessels</div><div class="stat-value" id="fleetTotalCount">89</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterFleetByStatus('active')"><div class="stat-icon success"><i data-lucide="anchor"></i></div><div class="stat-label">Active</div><div class="stat-value" id="fleetActiveCount">82</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterFleetByStatus('maintenance')"><div class="stat-icon warning"><i data-lucide="wrench"></i></div><div class="stat-label">In Maintenance</div><div class="stat-value" id="fleetMaintenanceCount">5</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="navigateTo('seafarer-roster')"><div class="stat-icon info"><i data-lucide="users"></i></div><div class="stat-label">Total Crew</div><div class="stat-value">1,456</div></div>
                        <div class="stat-card"><div class="stat-label">Avg Crew/Vessel</div><div class="stat-value">17.8</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="fleetPrincipalFilter" onchange="renderFleetGrid()"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option></select></div>
                            <div class="filter-group"><label class="filter-label">Vessel Type</label><select class="filter-select" id="fleetTypeFilter" onchange="renderFleetGrid()"><option value="">All Types</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container Ship</option><option value="lng">LNG Carrier</option></select></div>
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="fleetStatusFilter" onchange="renderFleetGrid()"><option value="">All Status</option><option value="active">Active</option><option value="maintenance">In Maintenance</option><option value="inactive">Inactive</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search vessels..." id="fleetSearchInput" oninput="renderFleetGrid()"></div>
                            <button class="btn btn-ghost btn-sm"><i data-lucide="grid-3x3"></i></button>
                            <button class="btn btn-ghost btn-sm"><i data-lucide="list"></i></button>
                        </div>
                    </div>

                    <!-- Fleet Grid -->
                    <div class="fleet-grid" id="fleetGrid">
                        <!-- Vessel cards rendered by JavaScript -->
                    </div>
                </div>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- ASSIGNMENT & PROPOSAL MODULE -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="view" id="view-assignment-proposal">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Assignment & Proposal</h1>
                            <p class="page-subtitle">Match crew to RFAs â€¢ Manage crew pools â€¢ Submit proposals</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="refreshAssignmentBoard()"><i data-lucide="refresh-cw"></i>Refresh</button>
                            <button class="btn btn-primary" onclick="openCreateProposalModal()"><i data-lucide="user-plus"></i>Create Proposal</button>
                        </div>
                    </div>
                    
                    <div class="filters-bar">
                        <div class="filter-group">
                            <label class="filter-label">Status</label>
                            <select id="assignmentStatusFilter" class="filter-select" onchange="renderAssignmentBoard()">
                                <option value="">All Statuses</option>
                                <option value="open">Open RFAs</option>
                                <option value="proposed">Proposed</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Client</label>
                            <select id="assignmentClientFilter" class="filter-select" onchange="renderAssignmentBoard()">
                                <option value="">All Clients</option>
                                <option value="Diana Shipping">Diana Shipping</option>
                                <option value="Centrofin">Centrofin</option>
                                <option value="Pioneer Marine">Pioneer Marine</option>
                                <option value="Neda Maritime">Neda Maritime</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Rank</label>
                            <select id="assignmentRankFilter" class="filter-select" onchange="renderAssignmentBoard()">
                                <option value="">All Ranks</option>
                                <option value="Master">Master</option>
                                <option value="Chief Officer">Chief Officer</option>
                                <option value="2nd Officer">2nd Officer</option>
                                <option value="Chief Engineer">Chief Engineer</option>
                                <option value="2nd Engineer">2nd Engineer</option>
                                <option value="Bosun">Bosun</option>
                                <option value="AB">AB</option>
                                <option value="Oiler">Oiler</option>
                            </select>
                        </div>
                        <div class="filter-group search-group">
                            <input type="text" id="assignmentSearchInput" class="search-input" placeholder="Search RFAs or Crew..." onkeyup="renderAssignmentBoard()">
                            <i data-lucide="search"></i>
                        </div>
                    </div>

                    <div class="assignment-container">
                        <div class="rfa-matrix-board">
                            <div class="board-header">
                                <h2><i data-lucide="layout-grid"></i>Open RFAs (8)</h2>
                            </div>
                            <div id="rfaMatrixGrid" class="rfa-matrix-grid"></div>
                        </div>
                        <div class="crew-pool-panel">
                            <div class="panel-header">
                                <h2><i data-lucide="users"></i>Available Crew</h2>
                                <span class="crew-count" id="crewPoolCount">24</span>
                            </div>
                            <div class="pool-tabs">
                                <button class="pool-tab active" onclick="switchCrewPool('all')" data-pool="all">All <span class="tab-badge">24</span></button>
                                <button class="pool-tab" onclick="switchCrewPool('dedicated')" data-pool="dedicated">Dedicated <span class="tab-badge">12</span></button>
                                <button class="pool-tab" onclick="switchCrewPool('non-dedicated')" data-pool="non-dedicated">Non-Dedicated <span class="tab-badge">12</span></button>
                            </div>
                            <div id="crewPoolList" class="crew-pool-list"></div>
                        </div>
                    </div>
                </div>

                <div class="view" id="view-contracts">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Contracts</h1>
                            <p class="page-subtitle">Contract generation, PEME clearance, and employment agreement management</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportContracts()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('newContractModal')"><i data-lucide="plus"></i>New Contract</button>
                        </div>
                    </div>

                    <!-- Contract Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(6,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterContractsByStatus('draft')"><div class="stat-label">Draft</div><div class="stat-value">12</div></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--status-on-approval);" onclick="filterContractsByStatus('pending-peme')"><div class="stat-label">Pending PEME</div><div class="stat-value" style="color:var(--status-on-approval);">8</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterContractsByStatus('peme-cleared')"><div class="stat-label">PEME Cleared</div><div class="stat-value">15</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterContractsByStatus('signed')"><div class="stat-label">Signed</div><div class="stat-value">23</div></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--status-ready);" onclick="filterContractsByStatus('active')"><div class="stat-label">Active</div><div class="stat-value" style="color:var(--status-ready);">1,456</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterContractsByStatus('')"><div class="stat-label">Completed</div><div class="stat-value">3,847</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="contractStatusFilter" onchange="renderContractsGrid()"><option value="">All Status</option><option value="draft">Draft</option><option value="pending-peme">Pending PEME</option><option value="peme-cleared">PEME Cleared</option><option value="signed">Signed</option><option value="active">Active</option><option value="completed">Completed</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="contractPrincipalFilter" onchange="renderContractsGrid()"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option></select></div>
                            <div class="filter-group"><label class="filter-label">Contract Type</label><select class="filter-select"><option value="">All Types</option><option value="standard">Standard (9 months)</option><option value="extended">Extended (12 months)</option><option value="short">Short-term (6 months)</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search by seafarer or vessel..." id="contractSearchInput" oninput="renderContractsGrid()"></div>
                        </div>
                    </div>

                    <!-- Contracts Grid -->
                    <div class="fleet-grid" id="contractsGrid" style="grid-template-columns:repeat(auto-fill,minmax(380px,1fr));">
                        <!-- Contract cards rendered by JavaScript -->
                    </div>
                </div>
                <!-- VIEW: ROTATION PLAN -->
                <div class="view" id="view-rotation-plan">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Rotation Plan</h1>
                            <p class="page-subtitle">Rolling 16-month crew rotation scheduler by vessel with vacancy forecast</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportRotationPlan()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-secondary" onclick="shiftTimeline(-3)"><i data-lucide="chevron-left"></i>Prev Quarter</button>
                            <button class="btn btn-secondary" onclick="shiftTimeline(3)">Next Quarter<i data-lucide="chevron-right"></i></button>
                            <button class="btn btn-primary" onclick="openModal('planRotationModal')"><i data-lucide="plus"></i>Plan Rotation</button>
                        </div>
                    </div>
                    
                    <!-- Rotation Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="navigateTo('fleet')"><div class="stat-label">Active Vessels</div><div class="stat-value">89</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="navigateTo('seafarer-roster')"><div class="stat-label">Crew On Board</div><div class="stat-value">1,456</div></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--status-on-approval);" onclick="filterRotationByType('expiring')"><div class="stat-label">Upcoming Rotations</div><div class="stat-value" style="color:var(--status-on-approval);">47</div><span class="text-secondary">Next 30 days</span></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--tag-nfr);" onclick="filterRotationByType('vacancies')"><div class="stat-label">Vacancies</div><div class="stat-value" style="color:var(--tag-nfr);">12</div><span class="text-secondary">Unfilled positions</span></div>
                        <div class="stat-card"><div class="stat-label">Avg Contract</div><div class="stat-value">8.2</div><span class="text-secondary">months</span></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="rotationPrincipalFilter" onchange="renderRotationPlan()"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option></select></div>
                            <div class="filter-group"><label class="filter-label">Vessel Type</label><select class="filter-select" id="rotationVesselTypeFilter" onchange="renderRotationPlan()"><option value="">All Types</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container</option><option value="lng">LNG Carrier</option></select></div>
                            <div class="filter-group"><label class="filter-label">Rank</label><select class="filter-select" id="rotationRankFilter" onchange="renderRotationPlan()"><option value="">All Ranks</option><option value="officers">Officers Only</option><option value="ratings">Ratings Only</option></select></div>
                            <div class="filter-group"><label class="filter-label">Show</label><select class="filter-select" id="rotationShowFilter" onchange="renderRotationPlan()"><option value="all">All Positions</option><option value="vacancies">Vacancies Only</option><option value="expiring">Expiring Soon</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" id="rotationSearchInput" oninput="renderRotationPlan()" placeholder="Search vessel or seafarer..."></div>
                        </div>
                    </div>

                    <!-- Gantt Timeline -->
                    <div class="card" style="overflow:hidden;">
                        <div class="gantt-container">
                            <!-- Timeline Header -->
                            <div class="gantt-header">
                                <div class="gantt-header-fixed">
                                    <div class="gantt-vessel-header">Vessel / Position</div>
                                </div>
                                <div class="gantt-header-scroll" id="ganttHeaderScroll">
                                    <!-- Months will be rendered by JS -->
                                </div>
                            </div>
                            <!-- Timeline Body -->
                            <div class="gantt-body" id="ganttBody">
                                <!-- Rows will be rendered by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Legend -->
                    <div class="card" style="margin-top:16px;">
                        <div class="card-body" style="padding:12px 20px;">
                            <div style="display:flex;align-items:center;gap:24px;flex-wrap:wrap;">
                                <span style="font-weight:600;color:var(--cw-gray-600);font-size:0.85rem;">Legend:</span>
                                <div style="display:flex;align-items:center;gap:8px;"><div style="width:20px;height:12px;background:var(--status-embarked);border-radius:3px;"></div><span style="font-size:0.8rem;">On Board</span></div>
                                <div style="display:flex;align-items:center;gap:8px;"><div style="width:20px;height:12px;background:var(--status-on-preparation);border-radius:3px;"></div><span style="font-size:0.8rem;">Scheduled</span></div>
                                <div style="display:flex;align-items:center;gap:8px;"><div style="width:20px;height:12px;background:var(--status-on-approval);border-radius:3px;"></div><span style="font-size:0.8rem;">Expiring Soon</span></div>
                                <div style="display:flex;align-items:center;gap:8px;"><div style="width:20px;height:12px;background:var(--tag-nfr);border-radius:3px;opacity:0.3;"></div><span style="font-size:0.8rem;">Vacancy</span></div>
                                <div style="display:flex;align-items:center;gap:8px;"><div style="width:20px;height:12px;background:repeating-linear-gradient(45deg,var(--cw-gray-300),var(--cw-gray-300) 2px,transparent 2px,transparent 4px);border-radius:3px;"></div><span style="font-size:0.8rem;">Extension Pending</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="view" id="view-documents">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Documents & Certificates</h1>
                            <p class="page-subtitle">Certificate repository, compliance monitoring, and expiry tracking</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportDocuments()"><i data-lucide="download"></i>Export Report</button>
                            <button class="btn btn-secondary" onclick="openModal('alertSettingsModal')"><i data-lucide="bell"></i>Alert Settings</button>
                            <button class="btn btn-primary" onclick="openModal('uploadDocumentModal')"><i data-lucide="upload"></i>Upload Document</button>
                        </div>
                    </div>

                    <!-- Document Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="cursor:pointer;" onclick="filterDocsByStatus('')"><div class="stat-icon primary"><i data-lucide="file-check"></i></div><div class="stat-label">Total Documents</div><div class="stat-value">12,847</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterDocsByStatus('valid')"><div class="stat-icon success"><i data-lucide="shield-check"></i></div><div class="stat-label">Valid</div><div class="stat-value">11,923</div><div class="stat-change positive">92.8%</div></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--status-on-approval);" onclick="filterDocsByStatus('expiring-soon')"><div class="stat-icon warning"><i data-lucide="clock"></i></div><div class="stat-label">Expiring 30 Days</div><div class="stat-value" style="color:var(--status-on-approval);">156</div></div>
                        <div class="stat-card" style="cursor:pointer;border-color:var(--tag-nfr);" onclick="filterDocsByStatus('critical')"><div class="stat-icon" style="background:rgba(239,68,68,0.1);color:var(--tag-nfr);"><i data-lucide="alert-triangle"></i></div><div class="stat-label">Expiring 7 Days</div><div class="stat-value" style="color:var(--tag-nfr);">23</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterDocsByStatus('expired')"><div class="stat-icon" style="background:rgba(107,114,128,0.1);color:var(--cw-gray-500);"><i data-lucide="x-circle"></i></div><div class="stat-label">Expired</div><div class="stat-value">45</div></div>
                    </div>

                    <!-- Critical Alerts -->
                    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:24px;" id="docAlertsContainer">
                        <!-- Rendered by JS -->
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Document Type</label><select class="filter-select" id="docTypeFilter" onchange="renderDocumentsTable()"><option value="">All Types</option><option value="stcw">STCW Certificates</option><option value="flag">Flag Documents</option><option value="medical">Medical Certificates</option><option value="national">National Documents</option><option value="company">Company Documents</option></select></div>
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="docStatusFilter" onchange="renderDocumentsTable()"><option value="">All Status</option><option value="valid">Valid</option><option value="expiring-soon">Expiring Soon (30 days)</option><option value="critical">Critical (7 days)</option><option value="expired">Expired</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select"><option value="">All Principals</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search by seafarer or document..." id="docSearchInput" oninput="renderDocumentsTable()"></div>
                        </div>
                    </div>

                    <!-- Documents Table -->
                    <div class="table-container">
                        <div class="table-header">
                            <div class="table-header-left">
                                <span class="table-title">Certificate Registry</span>
                                <span class="table-count" id="docTableCount">Showing documents</span>
                            </div>
                            <div class="table-header-right">
                                <button class="btn btn-ghost btn-sm btn-icon" title="Refresh"><i data-lucide="refresh-cw"></i></button>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <thead><tr>
                                    <th class="sortable">Seafarer</th>
                                    <th>Document Type</th>
                                    <th class="sortable">Document Name</th>
                                    <th>Number</th>
                                    <th class="sortable">Issue Date</th>
                                    <th class="sortable">Expiry Date</th>
                                    <th>Status</th>
                                    <th>Days Left</th>
                                    <th class="actions-cell"></th>
                                </tr></thead>
                                <tbody id="documentsTableBody"></tbody>
                            </table>
                        </div>
                        <div class="table-footer">
                            <div class="pagination-info">Showing <strong>1</strong> to <strong>15</strong> of <strong>156</strong> documents</div>
                            <div class="pagination">
                                <button class="pagination-btn" disabled><i data-lucide="chevron-left" style="width:16px;height:16px;"></i></button>
                                <button class="pagination-btn active">1</button><button class="pagination-btn">2</button><button class="pagination-btn">3</button><span class="pagination-ellipsis">...</span><button class="pagination-btn">11</button>
                                <button class="pagination-btn"><i data-lucide="chevron-right" style="width:16px;height:16px;"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="view" id="view-pending-transactions">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Pending Transactions</h1>
                            <p class="page-subtitle">Unified approval queue - RFAs, contracts, documents, and travel requests</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="approveSelectedTransactions()"><i data-lucide="check-square"></i>Approve Selected</button>
                            <button class="btn btn-secondary" onclick="exportPendingTransactions()"><i data-lucide="download"></i>Export</button>
                        </div>
                    </div>

                    <!-- Summary Cards -->
                    <div class="pending-summary-cards">
                        <div class="pending-summary-card" style="cursor:pointer;" onclick="filterPendingByType('rfa')"><div class="pending-summary-icon" style="background:rgba(99,102,241,0.1);color:var(--rfa-new);"><i data-lucide="file-text"></i></div><div><div class="pending-summary-count">12</div><div class="pending-summary-label">RFA Approvals</div></div></div>
                        <div class="pending-summary-card" style="cursor:pointer;" onclick="filterPendingByType('contract')"><div class="pending-summary-icon" style="background:rgba(139,92,246,0.1);color:var(--status-endorsed);"><i data-lucide="file-signature"></i></div><div><div class="pending-summary-count">8</div><div class="pending-summary-label">Contracts</div></div></div>
                        <div class="pending-summary-card" style="cursor:pointer;" onclick="filterPendingByType('document')"><div class="pending-summary-icon" style="background:rgba(59,130,246,0.1);color:var(--status-on-preparation);"><i data-lucide="folder"></i></div><div><div class="pending-summary-count">15</div><div class="pending-summary-label">Documents</div></div></div>
                        <div class="pending-summary-card" style="cursor:pointer;" onclick="filterPendingByType('travel')"><div class="pending-summary-icon" style="background:rgba(245,158,11,0.1);color:var(--status-on-approval);"><i data-lucide="plane"></i></div><div><div class="pending-summary-count">6</div><div class="pending-summary-label">Travel</div></div></div>
                        <div class="pending-summary-card" style="cursor:pointer;" onclick="filterPendingByType('peme')"><div class="pending-summary-icon" style="background:rgba(16,185,129,0.1);color:var(--status-ready);"><i data-lucide="heart-pulse"></i></div><div><div class="pending-summary-count">4</div><div class="pending-summary-label">PEME</div></div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Type</label><select class="filter-select" id="pendingTypeFilter" onchange="renderPendingTable()"><option value="">All Types</option><option value="rfa">RFA</option><option value="contract">Contract</option><option value="document">Document</option><option value="travel">Travel</option><option value="peme">PEME</option></select></div>
                            <div class="filter-group"><label class="filter-label">Priority</label><select class="filter-select" id="pendingPriorityFilter" onchange="renderPendingTable()"><option value="">All</option><option value="urgent">Urgent</option><option value="high">High</option><option value="normal">Normal</option></select></div>
                            <div class="filter-group"><label class="filter-label">Age</label><select class="filter-select" id="pendingAgeFilter" onchange="renderPendingTable()"><option value="">All</option><option value="overdue">Overdue</option><option value="today">Due Today</option><option value="week">This Week</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search..." id="pendingSearchInput" oninput="renderPendingTable()"></div>
                        </div>
                    </div>

                    <!-- Pending Table -->
                    <div class="card">
                        <div class="pending-table">
                            <div class="pending-row header">
                                <div><input type="checkbox" id="selectAllPending" onchange="toggleSelectAllPending(this)"></div><div>Transaction</div><div>Seafarer</div><div>Related To</div><div>Age</div><div>Status</div><div>Actions</div>
                            </div>
                            <div id="pendingTableBody">
                                <!-- Rows rendered by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="view" id="view-embarkation-prep">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Embarkation Preparation</h1>
                            <p class="page-subtitle">Gatekeeper for boarding readiness - documents, training, and logistics</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportEmbarkChecklist()"><i data-lucide="download"></i>Export Checklist</button>
                            <button class="btn btn-secondary" onclick="sendEmbarkReminders()"><i data-lucide="send"></i>Send Reminders</button>
                        </div>
                    </div>

                    <!-- Embark Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="border-color:var(--status-ready);cursor:pointer;" onclick="filterEmbarkByStatus('ready')"><div class="stat-label">Ready to Board</div><div class="stat-value" style="color:var(--status-ready);" id="embarkReadyCount">12</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-approval);cursor:pointer;" onclick="filterEmbarkByStatus('pending')"><div class="stat-label">Pending Items</div><div class="stat-value" style="color:var(--status-on-approval);" id="embarkPendingCount">8</div></div>
                        <div class="stat-card" style="border-color:var(--tag-nfr);cursor:pointer;" onclick="filterEmbarkByStatus('blocked')"><div class="stat-label">Blocked</div><div class="stat-value" style="color:var(--tag-nfr);" id="embarkBlockedCount">3</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterEmbarkByTimeframe('week')"><div class="stat-label">This Week</div><div class="stat-value" id="embarkWeekCount">15</div></div>
                        <div class="stat-card"><div class="stat-label">Avg Readiness</div><div class="stat-value" id="embarkAvgReadiness">87%</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Readiness</label><select class="filter-select" id="embarkReadinessFilter" onchange="renderEmbarkations()"><option value="">All Status</option><option value="ready">Ready</option><option value="pending">Pending</option><option value="blocked">Blocked</option></select></div>
                            <div class="filter-group"><label class="filter-label">Timeframe</label><select class="filter-select" id="embarkTimeframeFilter" onchange="renderEmbarkations()"><option value="">All</option><option value="today">Today</option><option value="week">This Week</option><option value="month">This Month</option></select></div>
                            <div class="filter-group"><label class="filter-label">Principal</label><select class="filter-select" id="embarkPrincipalFilter" onchange="renderEmbarkations()"><option value="">All Principals</option><option value="Diana Shipping">Diana Shipping</option><option value="Centrofin">Centrofin</option><option value="Pioneer Marine">Pioneer Marine</option><option value="Neda Maritime">Neda Maritime</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search seafarer..." id="embarkSearchInput" oninput="renderEmbarkations()"></div>
                        </div>
                    </div>

                    <!-- Embarkation Cards Grid -->
                    <div class="fleet-grid" id="embarkationsGrid" style="grid-template-columns:repeat(auto-fill,minmax(360px,1fr));">
                        <!-- Cards rendered by JavaScript -->
                    </div>
                </div>
                <div class="view" id="view-tickets">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Tickets & Travel</h1>
                            <p class="page-subtitle">Flight bookings, transport logistics, and travel arrangements</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportTickets()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('bookTicketModal')"><i data-lucide="plus"></i>Book Ticket</button>
                        </div>
                    </div>

                    <!-- Ticket Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card" style="border-color:var(--status-ready);cursor:pointer;" onclick="filterTicketsByStatus('confirmed')"><div class="stat-label">Confirmed</div><div class="stat-value" style="color:var(--status-ready);" id="ticketConfirmedCount">24</div></div>
                        <div class="stat-card" style="border-color:var(--status-on-approval);cursor:pointer;" onclick="filterTicketsByStatus('pending')"><div class="stat-label">Pending</div><div class="stat-value" style="color:var(--status-on-approval);" id="ticketPendingCount">8</div></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterTicketsByDate('week')"><div class="stat-label">This Week</div><div class="stat-value" id="ticketWeekCount">15</div></div>
                        <div class="stat-card"><div class="stat-label">Total Spend (MTD)</div><div class="stat-value" id="ticketTotalSpend">$47.2K</div></div>
                        <div class="stat-card"><div class="stat-label">Avg Ticket Cost</div><div class="stat-value" id="ticketAvgCost">$1,180</div></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="ticketStatusFilter" onchange="renderTickets()"><option value="">All</option><option value="confirmed">Confirmed</option><option value="pending">Pending</option><option value="completed">Completed</option><option value="cancelled">Cancelled</option></select></div>
                            <div class="filter-group"><label class="filter-label">Type</label><select class="filter-select" id="ticketTypeFilter" onchange="renderTickets()"><option value="">All</option><option value="embark">Embarkation</option><option value="sign-off">Sign-off</option><option value="transit">Transit</option></select></div>
                            <div class="filter-group"><label class="filter-label">Date Range</label><select class="filter-select" id="ticketDateFilter" onchange="renderTickets()"><option value="">All</option><option value="today">Today</option><option value="week">This Week</option><option value="month">This Month</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search PNR or seafarer..." id="ticketSearchInput" oninput="renderTickets()"></div>
                        </div>
                    </div>

                    <!-- Tickets Grid -->
                    <div class="fleet-grid" id="ticketsGrid" style="grid-template-columns:repeat(auto-fill,minmax(380px,1fr));">
                        <!-- Rendered by JavaScript -->
                    </div>
                </div>
                <div class="view" id="view-evaluations">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Evaluations</h1>
                            <p class="page-subtitle">Post-service performance reviews and seafarer ratings</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportEvaluations()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('newEvaluationModal')"><i data-lucide="plus"></i>New Evaluation</button>
                        </div>
                    </div>

                    <!-- Eval Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(5,1fr);">
                        <div class="stat-card"><div class="stat-label">Total Evaluations</div><div class="stat-value" id="evalTotalCount">1,847</div></div>
                        <div class="stat-card" style="border-color:var(--status-ready);cursor:pointer;" onclick="filterEvalsByRating('excellent')"><div class="stat-label">Excellent</div><div class="stat-value" style="color:var(--status-ready);" id="evalExcellentCount">823</div><span class="text-secondary">45%</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterEvalsByRating('good')"><div class="stat-label">Good</div><div class="stat-value" id="evalGoodCount">712</div><span class="text-secondary">38%</span></div>
                        <div class="stat-card" style="cursor:pointer;" onclick="filterEvalsByRating('average')"><div class="stat-label">Average</div><div class="stat-value" id="evalAverageCount">267</div><span class="text-secondary">14%</span></div>
                        <div class="stat-card"><div class="stat-label">Avg Score</div><div class="stat-value" id="evalAvgScore">4.2</div><span class="text-secondary">/ 5.0</span></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Rating</label><select class="filter-select" id="evalRatingFilter" onchange="renderEvaluations()"><option value="">All</option><option value="excellent">Excellent (4.5+)</option><option value="good">Good (3.5-4.4)</option><option value="average">Average (2.5-3.4)</option><option value="poor">Poor (&lt;2.5)</option></select></div>
                            <div class="filter-group"><label class="filter-label">Period</label><select class="filter-select" id="evalPeriodFilter" onchange="renderEvaluations()"><option value="">All Time</option><option value="month">This Month</option><option value="quarter">This Quarter</option><option value="year">This Year</option></select></div>
                            <div class="filter-group"><label class="filter-label">Rank</label><select class="filter-select" id="evalRankFilter" onchange="renderEvaluations()"><option value="">All Ranks</option><option value="officers">Officers</option><option value="ratings">Ratings</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search seafarer..." id="evalSearchInput" oninput="renderEvaluations()"></div>
                        </div>
                    </div>

                    <!-- Evaluations Grid -->
                    <div class="fleet-grid" id="evaluationsGrid" style="grid-template-columns:repeat(auto-fill,minmax(380px,1fr));">
                        <!-- Rendered by JavaScript -->
                    </div>
                </div>

                <!-- COMPLAINTS MANAGEMENT MODULE -->
                <div class="view" id="view-complaints">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Complaints & Grievances</h1>
                            <p class="page-subtitle">MLC-compliant seafarer complaint management and resolution tracking</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportComplaints()"><i data-lucide="download"></i>Export</button>
                            <button class="btn btn-primary" onclick="openModal('newComplaintModal')"><i data-lucide="plus"></i>New Complaint</button>
                        </div>
                    </div>

                    <!-- Complaints Stats -->
                    <div class="stats-grid" style="grid-template-columns:repeat(6,1fr);">
                        <div class="stat-card"><div class="stat-label">Total Complaints</div><div class="stat-value" id="complaintTotalCount">156</div><span class="text-secondary">All time</span></div>
                        <div class="stat-card" style="border-color:#ef4444;cursor:pointer;" onclick="filterComplaintsByStatus('open')"><div class="stat-label">Open</div><div class="stat-value" style="color:#ef4444;" id="complaintOpenCount">7</div><span class="text-secondary">Requires action</span></div>
                        <div class="stat-card" style="border-color:#f59e0b;cursor:pointer;" onclick="filterComplaintsByStatus('in-progress')"><div class="stat-label">In Progress</div><div class="stat-value" style="color:#f59e0b;" id="complaintProgressCount">12</div><span class="text-secondary">Being handled</span></div>
                        <div class="stat-card" style="border-color:#10b981;cursor:pointer;" onclick="filterComplaintsByStatus('resolved')"><div class="stat-label">Resolved</div><div class="stat-value" style="color:#10b981;" id="complaintResolvedCount">134</div><span class="text-secondary">86% resolved</span></div>
                        <div class="stat-card"><div class="stat-label">Avg Resolution</div><div class="stat-value">4.2</div><span class="text-secondary">days</span></div>
                        <div class="stat-card"><div class="stat-label">Satisfaction</div><div class="stat-value" style="color:#10b981;">92%</div><span class="text-secondary">Post-resolution</span></div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group"><label class="filter-label">Status</label><select class="filter-select" id="complaintStatusFilter" onchange="renderComplaints()"><option value="">All Status</option><option value="open">Open</option><option value="in-progress">In Progress</option><option value="resolved">Resolved</option><option value="escalated">Escalated</option><option value="closed">Closed</option></select></div>
                            <div class="filter-group"><label class="filter-label">Category</label><select class="filter-select" id="complaintCategoryFilter" onchange="renderComplaints()"><option value="">All Categories</option><option value="wages">Wages & Benefits</option><option value="working-conditions">Working Conditions</option><option value="safety">Safety & Health</option><option value="harassment">Harassment/Discrimination</option><option value="contract">Contract Issues</option><option value="food">Food & Accommodation</option><option value="management">Management Issues</option><option value="other">Other</option></select></div>
                            <div class="filter-group"><label class="filter-label">Priority</label><select class="filter-select" id="complaintPriorityFilter" onchange="renderComplaints()"><option value="">All Priorities</option><option value="critical">Critical</option><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option></select></div>
                            <div class="filter-group"><label class="filter-label">Period</label><select class="filter-select" id="complaintPeriodFilter" onchange="renderComplaints()"><option value="">All Time</option><option value="week">This Week</option><option value="month">This Month</option><option value="quarter">This Quarter</option></select></div>
                            <div class="filter-divider"></div>
                            <div class="filter-search"><i data-lucide="search"></i><input type="text" placeholder="Search by ID, seafarer, vessel..." id="complaintSearchInput" oninput="renderComplaints()"></div>
                        </div>
                    </div>

                    <!-- Complaints Grid -->
                    <div class="fleet-grid" id="complaintsGrid" style="grid-template-columns:repeat(auto-fill,minmax(400px,1fr));">
                        <!-- Rendered by JavaScript -->
                    </div>
                </div>

                <div class="view" id="view-analytics">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Analytics & Reports</h1>
                            <p class="page-subtitle">KPIs, 3D visualizations, business intelligence, and API documentation</p>
                        </div>
                        <div class="page-actions">
                            <select class="filter-select" id="analyticsTimeRange" style="width:auto;" onchange="updateAllCharts()">
                                <option value="30">Last 30 Days</option>
                                <option value="90">Last 90 Days</option>
                                <option value="365" selected>This Year</option>
                                <option value="all">All Time</option>
                            </select>
                            <button class="btn btn-secondary" onclick="exportAnalyticsReport()"><i data-lucide="download"></i>Export Report</button>
                            <button class="btn btn-secondary" onclick="refreshAnalytics()"><i data-lucide="refresh-cw"></i>Refresh</button>
                            <button class="btn btn-primary" onclick="switchAnalyticsTab('api')"><i data-lucide="code"></i>API Hub</button>
                        </div>
                    </div>

                    <!-- Analytics Tabs -->
                    <div class="analytics-tabs" style="display:flex;gap:4px;background:var(--cw-gray-100);padding:4px;border-radius:12px;margin-bottom:24px;">
                        <button class="analytics-tab active" onclick="switchAnalyticsTab('overview')" data-tab="overview"><i data-lucide="layout-dashboard"></i>Overview</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('seafarers')" data-tab="seafarers"><i data-lucide="users"></i>Seafarers</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('recruitment')" data-tab="recruitment"><i data-lucide="user-plus"></i>Recruitment</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('contracts')" data-tab="contracts"><i data-lucide="file-signature"></i>Contracts</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('fleet')" data-tab="fleet"><i data-lucide="ship"></i>Fleet</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('documents')" data-tab="documents"><i data-lucide="file-check"></i>Documents</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('travel')" data-tab="travel"><i data-lucide="plane"></i>Travel</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('evaluations-analytics')" data-tab="evaluations-analytics"><i data-lucide="star"></i>Evaluations</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('crew-changes-analytics')" data-tab="crew-changes-analytics"><i data-lucide="repeat"></i>Crew Changes</button>
                        <button class="analytics-tab" onclick="switchAnalyticsTab('api')" data-tab="api"><i data-lucide="code"></i>API Hub</button>
                    </div>

                    <!-- TAB: Overview -->
                    <div class="analytics-tab-content active" id="tab-overview">
                        <!-- KPI Cards Row -->
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="users"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="2847">0</div>
                                    <div class="kpi-card-3d-label">Total Seafarers</div>
                                    <div class="kpi-card-3d-change up"><i data-lucide="trending-up"></i>+156 this month</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);"><i data-lucide="file-signature"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="1456">0</div>
                                    <div class="kpi-card-3d-label">Active Contracts</div>
                                    <div class="kpi-card-3d-change up"><i data-lucide="trending-up"></i>+89 this month</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);"><i data-lucide="ship"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="89">0</div>
                                    <div class="kpi-card-3d-label">Fleet Vessels</div>
                                    <div class="kpi-card-3d-change up"><i data-lucide="trending-up"></i>+5 this quarter</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="building-2"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="34">0</div>
                                    <div class="kpi-card-3d-label">Principals</div>
                                    <div class="kpi-card-3d-change up"><i data-lucide="trending-up"></i>+3 new clients</div>
                                </div>
                            </div>
                        </div>

                        <!-- Charts Row 1 -->
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Monthly Embarkations</h3><span>Trend analysis over 12 months</span></div>
                                    <div class="chart-card-3d-legend">
                                        <span><i style="background:linear-gradient(135deg,#00495D,#0891b2);"></i>Embarkations</span>
                                        <span><i style="background:linear-gradient(135deg,#059669,#10b981);"></i>Sign-offs</span>
                                    </div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;">
                                    <canvas id="embarkationsChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Crew Distribution</h3><span>By status</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;">
                                    <canvas id="crewDistributionChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Charts Row 2 -->
                        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header"><div><h3>Top Principals</h3><span>By active crew</span></div></div>
                                <div class="chart-card-3d-body" style="height:280px;">
                                    <canvas id="principalsChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header"><div><h3>RFC Performance</h3><span>Filling rate by type</span></div></div>
                                <div class="chart-card-3d-body" style="height:280px;">
                                    <canvas id="rfcPerformanceChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header"><div><h3>Document Compliance</h3><span>Expiry status</span></div></div>
                                <div class="chart-card-3d-body" style="height:280px;">
                                    <canvas id="documentComplianceChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Operations Dashboard - SPECTACULAR VERSION -->
                        <div class="realtime-dashboard-wrapper">
                            <div class="realtime-dashboard-header">
                                <div class="realtime-dashboard-title">
                                    <div class="realtime-live-indicator"><span class="live-dot"></span>LIVE</div>
                                    <h2>Real-time Operations Dashboard</h2>
                                    <p>Mission-critical metrics updated every 30 seconds</p>
                                </div>
                                <div class="realtime-dashboard-actions">
                                    <span class="last-updated">Last updated: <strong id="lastUpdateTime">just now</strong></span>
                                    <button class="btn-realtime-refresh" onclick="refreshRealtimeMetrics()"><i data-lucide="refresh-cw"></i>Refresh</button>
                                </div>
                            </div>
                            
                            <div class="realtime-metrics-grid">
                                <!-- Metric 1: On Board Now -->
                                <div class="realtime-metric-card" onclick="navigateTo('seafarer-roster')" style="--accent-color:#10b981;--glow-color:rgba(16,185,129,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress" cx="50" cy="50" r="42" style="stroke-dasharray:220 264;stroke:#10b981;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#10b981,#059669);"><i data-lucide="anchor"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large" data-target="1456">0</div>
                                            <div class="metric-label">On Board Now</div>
                                            <div class="metric-sublabel">51.2% of total pool</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline1"></div>
                                        <div class="metric-trend up"><i data-lucide="trending-up"></i>+23 today</div>
                                    </div>
                                </div>
                                
                                <!-- Metric 2: Open RFCs -->
                                <div class="realtime-metric-card" onclick="navigateTo('rfc')" style="--accent-color:#f59e0b;--glow-color:rgba(245,158,11,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress" cx="50" cy="50" r="42" style="stroke-dasharray:165 264;stroke:#f59e0b;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#f59e0b,#d97706);"><i data-lucide="file-plus"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large" data-target="47">0</div>
                                            <div class="metric-label">Open RFCs</div>
                                            <div class="metric-sublabel">12 urgent priority</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline2"></div>
                                        <div class="metric-trend down"><i data-lucide="trending-down"></i>-5 this week</div>
                                    </div>
                                </div>
                                
                                <!-- Metric 3: Pending Embark -->
                                <div class="realtime-metric-card" onclick="navigateTo('contracts')" style="--accent-color:#3b82f6;--glow-color:rgba(59,130,246,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress" cx="50" cy="50" r="42" style="stroke-dasharray:132 264;stroke:#3b82f6;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#3b82f6,#2563eb);"><i data-lucide="plane-takeoff"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large" data-target="23">0</div>
                                            <div class="metric-label">Pending Embark</div>
                                            <div class="metric-sublabel">Next 7 days</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline3"></div>
                                        <div class="metric-trend up"><i data-lucide="trending-up"></i>+8 scheduled</div>
                                    </div>
                                </div>
                                
                                <!-- Metric 4: Docs Expiring -->
                                <div class="realtime-metric-card alert" onclick="navigateTo('documents')" style="--accent-color:#ef4444;--glow-color:rgba(239,68,68,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress pulse-ring" cx="50" cy="50" r="42" style="stroke-dasharray:66 264;stroke:#ef4444;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#ef4444,#dc2626);"><i data-lucide="alert-triangle"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large" data-target="156">0</div>
                                            <div class="metric-label">Docs Expiring</div>
                                            <div class="metric-sublabel">23 critical (7 days)</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline4"></div>
                                        <div class="metric-trend alert"><i data-lucide="alert-circle"></i>Action required</div>
                                    </div>
                                </div>
                                
                                <!-- Metric 5: Active Vessels -->
                                <div class="realtime-metric-card" onclick="navigateTo('fleet')" style="--accent-color:#8b5cf6;--glow-color:rgba(139,92,246,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress" cx="50" cy="50" r="42" style="stroke-dasharray:243 264;stroke:#8b5cf6;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);"><i data-lucide="ship"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large" data-target="89">0</div>
                                            <div class="metric-label">Active Vessels</div>
                                            <div class="metric-sublabel">92% fleet utilization</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline5"></div>
                                        <div class="metric-trend up"><i data-lucide="trending-up"></i>+2 this month</div>
                                    </div>
                                </div>
                                
                                <!-- Metric 6: Avg Fill Time -->
                                <div class="realtime-metric-card" onclick="switchAnalyticsTab('recruitment')" style="--accent-color:#06b6d4;--glow-color:rgba(6,182,212,0.4);">
                                    <div class="metric-card-glow"></div>
                                    <div class="metric-card-content">
                                        <div class="metric-ring-container">
                                            <svg class="metric-ring" viewBox="0 0 100 100">
                                                <circle class="ring-bg" cx="50" cy="50" r="42"/>
                                                <circle class="ring-progress" cx="50" cy="50" r="42" style="stroke-dasharray:185 264;stroke:#06b6d4;"/>
                                            </svg>
                                            <div class="metric-ring-icon" style="background:linear-gradient(135deg,#06b6d4,#0891b2);"><i data-lucide="timer"></i></div>
                                        </div>
                                        <div class="metric-info">
                                            <div class="metric-value-large">14.2<span class="metric-unit">d</span></div>
                                            <div class="metric-label">Avg Fill Time</div>
                                            <div class="metric-sublabel">Target: 12 days</div>
                                        </div>
                                        <div class="metric-sparkline" id="sparkline6"></div>
                                        <div class="metric-trend down good"><i data-lucide="trending-down"></i>-2.1d improved</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Seafarers -->
                    <div class="analytics-tab-content" id="tab-seafarers">
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="anchor"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">1,456</div><div class="kpi-card-3d-label">Embarked</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="loader"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">389</div><div class="kpi-card-3d-label">On Preparation</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);"><i data-lucide="check-circle"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">512</div><div class="kpi-card-3d-label">Ready Pool</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);"><i data-lucide="user-x"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">45</div><div class="kpi-card-3d-label">Inactive</div></div></div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Seafarers by Rank</h3><span>Officers vs Ratings</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="seafarersByRankChart"></canvas></div></div>
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Pool Utilization</h3><span>Dedicated vs Non-dedicated</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="poolUtilizationChart"></canvas></div></div>
                        </div>
                        <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Seafarer Growth Trend</h3><span>Monthly pool size over 12 months</span></div></div><div class="chart-card-3d-body" style="height:300px;"><canvas id="seafarerGrowthChart"></canvas></div></div>
                    </div>

                    <!-- TAB: Recruitment -->
                    <div class="analytics-tab-content" id="tab-recruitment">
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#dc2626,#f87171);"><i data-lucide="file-plus"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">47</div><div class="kpi-card-3d-label">Open RFCs</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="user-plus"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">89</div><div class="kpi-card-3d-label">Active Candidates</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);"><i data-lucide="calendar"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">12</div><div class="kpi-card-3d-label">Interviews Today</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#0891b2,#22d3ee);"><i data-lucide="timer"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">14.2d</div><div class="kpi-card-3d-label">Avg Fill Time</div></div></div>
                        </div>
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Recruitment Funnel</h3><span>Candidate conversion pipeline</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="recruitmentFunnelChart"></canvas></div></div>
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Source Analysis</h3><span>Where candidates come from</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="candidateSourceChart"></canvas></div></div>
                        </div>
                        <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>RFC Completion by Month</h3><span>Filled positions over time</span></div></div><div class="chart-card-3d-body" style="height:280px;"><canvas id="rfcCompletionChart"></canvas></div></div>
                    </div>

                    <!-- TAB: Contracts -->
                    <div class="analytics-tab-content" id="tab-contracts">
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="file-check"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">1,456</div><div class="kpi-card-3d-label">Active Contracts</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="heart-pulse"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">23</div><div class="kpi-card-3d-label">Pending PEME</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);"><i data-lucide="pen-tool"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">38</div><div class="kpi-card-3d-label">Awaiting Signature</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#6b7280,#9ca3af);"><i data-lucide="archive"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">3,847</div><div class="kpi-card-3d-label">Completed</div></div></div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Contract Status</h3><span>Current distribution</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="contractStatusChart"></canvas></div></div>
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>PEME Clearance Rate</h3><span>Medical examination results</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="pemeRateChart"></canvas></div></div>
                        </div>
                        <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Monthly Contract Value</h3><span>Total salary commitments (USD)</span></div></div><div class="chart-card-3d-body" style="height:280px;"><canvas id="contractValueChart"></canvas></div></div>
                    </div>

                    <!-- TAB: Fleet -->
                    <div class="analytics-tab-content" id="tab-fleet">
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#00495D,#0891b2);"><i data-lucide="ship"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">89</div><div class="kpi-card-3d-label">Total Vessels</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="anchor"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">82</div><div class="kpi-card-3d-label">Active</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="wrench"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">5</div><div class="kpi-card-3d-label">In Maintenance</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);"><i data-lucide="users"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">17.8</div><div class="kpi-card-3d-label">Avg Crew/Vessel</div></div></div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Fleet by Vessel Type</h3><span>Distribution by category</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="fleetByTypeChart"></canvas></div></div>
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Vessels by Principal</h3><span>Client fleet distribution</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="vesselsByPrincipalChart"></canvas></div></div>
                        </div>
                        <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Fleet Growth</h3><span>Vessels managed over time</span></div></div><div class="chart-card-3d-body" style="height:280px;"><canvas id="fleetGrowthChart"></canvas></div></div>
                    </div>

                    <!-- TAB: Documents -->
                    <div class="analytics-tab-content" id="tab-documents">
                        <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#00495D,#0891b2);"><i data-lucide="files"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">12,847</div><div class="kpi-card-3d-label">Total Docs</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="shield-check"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">92.8%</div><div class="kpi-card-3d-label">Compliance</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="clock"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">156</div><div class="kpi-card-3d-label">Expiring 30d</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);"><i data-lucide="alert-triangle"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">23</div><div class="kpi-card-3d-label">Critical</div></div></div>
                            <div class="kpi-card-3d"><div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#6b7280,#9ca3af);"><i data-lucide="x-circle"></i></div><div class="kpi-card-3d-content"><div class="kpi-card-3d-value">45</div><div class="kpi-card-3d-label">Expired</div></div></div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Documents by Type</h3><span>Category breakdown</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="docsByTypeChart"></canvas></div></div>
                            <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Expiry Distribution</h3><span>30/60/90 day outlook</span></div></div><div class="chart-card-3d-body" style="height:350px;"><canvas id="expiryDistributionChart"></canvas></div></div>
                        </div>
                        <div class="chart-card-3d"><div class="chart-card-3d-header"><div><h3>Compliance Trend</h3><span>Monthly compliance rate</span></div></div><div class="chart-card-3d-body" style="height:280px;"><canvas id="complianceTrendChart"></canvas></div></div>
                    </div>

                    <!-- TAB: Travel Analytics -->
                    <div class="analytics-tab-content" id="tab-travel">
                        <!-- Travel Header with Key Metrics -->
                        <div style="background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);border-radius:16px;padding:32px;color:white;margin-bottom:24px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                                <div>
                                    <h2 style="margin:0 0 8px;font-size:1.75rem;display:flex;align-items:center;gap:12px;"><i data-lucide="plane" style="width:32px;height:32px;"></i>Travel Analytics</h2>
                                    <p style="margin:0;opacity:0.8;">Comprehensive insights into flight bookings, costs, and travel patterns</p>
                                </div>
                                <div style="display:flex;gap:12px;">
                                    <div style="background:rgba(255,255,255,0.1);padding:16px 24px;border-radius:12px;text-align:center;">
                                        <div style="font-size:2rem;font-weight:700;" id="travelTotalBookings">847</div>
                                        <div style="font-size:0.8rem;opacity:0.7;">Total Bookings YTD</div>
                                    </div>
                                    <div style="background:rgba(255,255,255,0.1);padding:16px 24px;border-radius:12px;text-align:center;">
                                        <div style="font-size:2rem;font-weight:700;" id="travelTotalSpend">$1.2M</div>
                                        <div style="font-size:0.8rem;opacity:0.7;">Total Spend YTD</div>
                                    </div>
                                    <div style="background:rgba(16,185,129,0.2);padding:16px 24px;border-radius:12px;text-align:center;">
                                        <div style="font-size:2rem;font-weight:700;color:#10b981;">-12%</div>
                                        <div style="font-size:0.8rem;opacity:0.7;">Cost Savings</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- KPI Cards Row -->
                        <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:16px;margin-bottom:24px;">
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#059669,#10b981);width:40px;height:40px;"><i data-lucide="check-circle" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">724</div>
                                    <div class="kpi-card-3d-label">Confirmed</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);width:40px;height:40px;"><i data-lucide="clock" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">47</div>
                                    <div class="kpi-card-3d-label">Pending</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);width:40px;height:40px;"><i data-lucide="plane-takeoff" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">412</div>
                                    <div class="kpi-card-3d-label">Embarkations</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);width:40px;height:40px;"><i data-lucide="plane-landing" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">358</div>
                                    <div class="kpi-card-3d-label">Sign-offs</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ec4899,#f472b6);width:40px;height:40px;"><i data-lucide="repeat" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">77</div>
                                    <div class="kpi-card-3d-label">Transits</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:16px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);width:40px;height:40px;"><i data-lucide="x-circle" style="width:20px;height:20px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.5rem;">23</div>
                                    <div class="kpi-card-3d-label">Cancelled</div>
                                </div>
                            </div>
                        </div>

                        <!-- Charts Row 1: Spend Trend & Bookings by Type -->
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Monthly Travel Spend</h3><span>Cost trend over 12 months</span></div>
                                    <div style="font-size:0.85rem;color:var(--cw-gray-500);">Total: $1,247,850</div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="travelSpendChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Bookings by Type</h3><span>Travel purpose breakdown</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="travelTypeChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Charts Row 2: Airlines & Destinations -->
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Top Airlines</h3><span>By number of bookings</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="topAirlinesChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Top Destinations</h3><span>Most frequent arrival airports</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="topDestinationsChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Charts Row 3: Cost Analysis & Monthly Bookings -->
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Average Ticket Cost by Route</h3><span>Cost comparison across routes</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="routeCostChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Monthly Bookings Trend</h3><span>Volume over time</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="monthlyBookingsChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Travel Summary Table -->
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Route Performance Summary</h3><span>Key metrics by popular routes</span></div>
                                <button class="btn btn-secondary btn-sm" onclick="exportTravelAnalytics()"><i data-lucide="download"></i>Export Report</button>
                            </div>
                            <div class="chart-card-3d-body" style="padding:0;">
                                <table style="width:100%;border-collapse:collapse;">
                                    <thead>
                                        <tr style="background:var(--cw-gray-50);">
                                            <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Route</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Bookings</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Avg Cost</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Total Spend</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Top Airline</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);border-bottom:1px solid var(--cw-gray-200);">Trend</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,#3b82f6,#60a5fa);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.7rem;">MNL</div><div><strong>Manila â†’ Singapore</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">MNL - SIN</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">156</td>
                                            <td style="padding:14px 16px;text-align:center;">$485</td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;color:var(--cw-primary);">$75,660</td>
                                            <td style="padding:14px 16px;text-align:center;">Philippine Airlines</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:var(--status-ready);font-weight:600;">â†‘ 12%</span></td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,#8b5cf6,#a78bfa);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.7rem;">MNL</div><div><strong>Manila â†’ Amsterdam</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">MNL - AMS</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">98</td>
                                            <td style="padding:14px 16px;text-align:center;">$1,245</td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;color:var(--cw-primary);">$122,010</td>
                                            <td style="padding:14px 16px;text-align:center;">KLM</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:var(--status-ready);font-weight:600;">â†‘ 8%</span></td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,#f59e0b,#fbbf24);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.7rem;">MNL</div><div><strong>Manila â†’ Rotterdam</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">MNL - RTM</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">87</td>
                                            <td style="padding:14px 16px;text-align:center;">$1,320</td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;color:var(--cw-primary);">$114,840</td>
                                            <td style="padding:14px 16px;text-align:center;">Emirates</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:var(--tag-nfr);font-weight:600;">â†“ 3%</span></td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.7rem;">MNL</div><div><strong>Manila â†’ Piraeus</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">MNL - PIR</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">74</td>
                                            <td style="padding:14px 16px;text-align:center;">$980</td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;color:var(--cw-primary);">$72,520</td>
                                            <td style="padding:14px 16px;text-align:center;">Qatar Airways</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:var(--status-ready);font-weight:600;">â†‘ 15%</span></td>
                                        </tr>
                                        <tr>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,#ec4899,#f472b6);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.7rem;">MNL</div><div><strong>Manila â†’ Dubai</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">MNL - DXB</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">65</td>
                                            <td style="padding:14px 16px;text-align:center;">$720</td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;color:var(--cw-primary);">$46,800</td>
                                            <td style="padding:14px 16px;text-align:center;">Emirates</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:var(--status-ready);font-weight:600;">â†‘ 22%</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Evaluations Analytics -->
                    <div class="analytics-tab-content" id="tab-evaluations-analytics">
                        <!-- Evaluations Analytics Header -->
                        <div style="background:linear-gradient(135deg,#f59e0b 0%,#d97706 50%,#b45309 100%);border-radius:20px;padding:36px;color:white;margin-bottom:28px;position:relative;overflow:hidden;">
                            <div style="position:absolute;top:-50px;right:-50px;width:200px;height:200px;background:rgba(255,255,255,0.1);border-radius:50%;"></div>
                            <div style="position:absolute;bottom:-30px;left:20%;width:100px;height:100px;background:rgba(255,255,255,0.05);border-radius:50%;"></div>
                            <div style="display:flex;justify-content:space-between;align-items:center;position:relative;z-index:1;">
                                <div>
                                    <h2 style="margin:0 0 8px;font-size:2rem;display:flex;align-items:center;gap:14px;"><i data-lucide="star" style="width:36px;height:36px;"></i>Evaluations Analytics</h2>
                                    <p style="margin:0;opacity:0.9;font-size:1.05rem;">Comprehensive performance insights, ratings distribution, and seafarer excellence metrics</p>
                                </div>
                                <div style="display:flex;gap:16px;">
                                    <div style="background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);padding:20px 28px;border-radius:16px;text-align:center;border:1px solid rgba(255,255,255,0.2);">
                                        <div style="font-size:2.5rem;font-weight:800;">1,847</div>
                                        <div style="font-size:0.85rem;opacity:0.85;margin-top:4px;">Total Evaluations</div>
                                    </div>
                                    <div style="background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);padding:20px 28px;border-radius:16px;text-align:center;border:1px solid rgba(255,255,255,0.2);">
                                        <div style="font-size:2.5rem;font-weight:800;">4.2</div>
                                        <div style="font-size:0.85rem;opacity:0.85;margin-top:4px;">Avg Score / 5.0</div>
                                    </div>
                                    <div style="background:rgba(16,185,129,0.3);backdrop-filter:blur(10px);padding:20px 28px;border-radius:16px;text-align:center;border:1px solid rgba(16,185,129,0.4);">
                                        <div style="font-size:2.5rem;font-weight:800;color:#a7f3d0;">84%</div>
                                        <div style="font-size:0.85rem;opacity:0.85;margin-top:4px;">Excellence Rate</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- KPI Cards Row - 3D Style -->
                        <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:16px;margin-bottom:28px;">
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#10b981,#34d399);width:44px;height:44px;"><i data-lucide="trophy" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;color:#10b981;">823</div>
                                    <div class="kpi-card-3d-label">Excellent</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">45% of total</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);width:44px;height:44px;"><i data-lucide="thumbs-up" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;color:#3b82f6;">712</div>
                                    <div class="kpi-card-3d-label">Good</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">39% of total</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);width:44px;height:44px;"><i data-lucide="minus-circle" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;color:#f59e0b;">267</div>
                                    <div class="kpi-card-3d-label">Average</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">14% of total</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);width:44px;height:44px;"><i data-lucide="alert-circle" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;color:#ef4444;">45</div>
                                    <div class="kpi-card-3d-label">Needs Improvement</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">2% of total</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);width:44px;height:44px;"><i data-lucide="users" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;">1,245</div>
                                    <div class="kpi-card-3d-label">Seafarers Evaluated</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">This year</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d" style="padding:20px;">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#06b6d4,#22d3ee);width:44px;height:44px;"><i data-lucide="trending-up" style="width:22px;height:22px;"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" style="font-size:1.6rem;color:#06b6d4;">+8%</div>
                                    <div class="kpi-card-3d-label">YoY Improvement</div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);">vs last year</div>
                                </div>
                            </div>
                        </div>

                        <!-- Charts Row 1: Rating Distribution & Score Trend -->
                        <div style="display:grid;grid-template-columns:1fr 2fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Rating Distribution</h3><span>Overall breakdown by category</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="evalRatingDistChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Average Score Trend</h3><span>Monthly performance progression over 12 months</span></div>
                                    <div style="display:flex;gap:8px;">
                                        <span style="display:flex;align-items:center;gap:4px;font-size:0.8rem;"><span style="width:12px;height:12px;background:#10b981;border-radius:50%;"></span>Overall</span>
                                        <span style="display:flex;align-items:center;gap:4px;font-size:0.8rem;"><span style="width:12px;height:12px;background:#3b82f6;border-radius:50%;"></span>Officers</span>
                                        <span style="display:flex;align-items:center;gap:4px;font-size:0.8rem;"><span style="width:12px;height:12px;background:#f59e0b;border-radius:50%;"></span>Ratings</span>
                                    </div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="evalScoreTrendChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Charts Row 2: Criteria Breakdown & By Rank -->
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Performance by Criteria</h3><span>Average scores across all evaluations</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="evalCriteriaChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Scores by Rank</h3><span>Performance comparison by position</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="evalByRankChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Charts Row 3: By Principal & By Vessel Type -->
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Performance by Principal</h3><span>Average ratings per shipping company</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="evalByPrincipalChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Performance by Vessel Type</h3><span>Ratings across vessel categories</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="evalByVesselTypeChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Charts Row 4: Monthly Volume & Evaluator Activity -->
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Monthly Evaluation Volume</h3><span>Number of evaluations completed per month</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:280px;"><canvas id="evalVolumeChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Top Evaluators</h3><span>Most active reviewers</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:280px;"><canvas id="evalEvaluatorsChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Radar Chart: Skills Analysis -->
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Skills Radar Analysis</h3><span>Officers vs Ratings competency comparison</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="evalRadarChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Excellence Rate by Department</h3><span>Percentage of 4.5+ ratings</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:320px;"><canvas id="evalExcellenceChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Top Performers Table -->
                        <div class="chart-card-3d" style="margin-bottom:24px;">
                            <div class="chart-card-3d-header">
                                <div><h3>ðŸ† Top Performing Seafarers</h3><span>Highest rated crew members this year</span></div>
                                <button class="btn btn-secondary btn-sm" onclick="exportEvalAnalytics()"><i data-lucide="download"></i>Export Report</button>
                            </div>
                            <div class="chart-card-3d-body" style="padding:0;">
                                <table style="width:100%;border-collapse:collapse;">
                                    <thead>
                                        <tr style="background:linear-gradient(135deg,#fef3c7,#fde68a);">
                                            <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Rank</th>
                                            <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Seafarer</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Position</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Vessel</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Technical</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Teamwork</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Avg Score</th>
                                            <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-600);border-bottom:2px solid #f59e0b;">Evaluations</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);background:linear-gradient(90deg,rgba(255,215,0,0.1),transparent);">
                                            <td style="padding:14px 16px;"><div style="width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#fbbf24,#f59e0b);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;">ðŸ¥‡</div></td>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#00495D,#0891b2);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;">JDC</div><div><strong>Juan Dela Cruz</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: SF-2019-0845</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;">Chief Officer</td>
                                            <td style="padding:14px 16px;text-align:center;">MV Diana Star</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="background:linear-gradient(135deg,#10b981,#34d399);color:white;padding:6px 14px;border-radius:20px;font-weight:700;">4.9</span></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">12</td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);background:linear-gradient(90deg,rgba(192,192,192,0.1),transparent);">
                                            <td style="padding:14px 16px;"><div style="width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#9ca3af,#6b7280);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;">ðŸ¥ˆ</div></td>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#8b5cf6,#a78bfa);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;">EP</div><div><strong>Eduardo Pascual</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: SF-2018-0623</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;">Chief Engineer</td>
                                            <td style="padding:14px 16px;text-align:center;">MV Centrofin Glory</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜†</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="background:linear-gradient(135deg,#10b981,#34d399);color:white;padding:6px 14px;border-radius:20px;font-weight:700;">4.8</span></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">9</td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);background:linear-gradient(90deg,rgba(205,127,50,0.1),transparent);">
                                            <td style="padding:14px 16px;"><div style="width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#d97706,#b45309);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;">ðŸ¥‰</div></td>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#059669,#10b981);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;">RS</div><div><strong>Ricardo Santos</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: SF-2020-1102</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;">2nd Officer</td>
                                            <td style="padding:14px 16px;text-align:center;">MV Pioneer Spirit</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="background:linear-gradient(135deg,#10b981,#34d399);color:white;padding:6px 14px;border-radius:20px;font-weight:700;">4.8</span></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">7</td>
                                        </tr>
                                        <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                            <td style="padding:14px 16px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--cw-gray-200);display:flex;align-items:center;justify-content:center;color:var(--cw-gray-600);font-weight:700;">4</div></td>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#f59e0b,#fbbf24);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;">MR</div><div><strong>Mario Reyes</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: SF-2021-0234</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;">2nd Engineer</td>
                                            <td style="padding:14px 16px;text-align:center;">MV Neda Horizon</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜†</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="background:linear-gradient(135deg,#3b82f6,#60a5fa);color:white;padding:6px 14px;border-radius:20px;font-weight:700;">4.7</span></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">8</td>
                                        </tr>
                                        <tr>
                                            <td style="padding:14px 16px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--cw-gray-200);display:flex;align-items:center;justify-content:center;color:var(--cw-gray-600);font-weight:700;">5</div></td>
                                            <td style="padding:14px 16px;"><div style="display:flex;align-items:center;gap:12px;"><div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#ec4899,#f472b6);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;">AC</div><div><strong>Antonio Cruz</strong><div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: SF-2019-0912</div></div></div></td>
                                            <td style="padding:14px 16px;text-align:center;">Bosun</td>
                                            <td style="padding:14px 16px;text-align:center;">MV Oldendorff Star</td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜…</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="color:#f59e0b;">â˜…â˜…â˜…â˜…â˜†</span></td>
                                            <td style="padding:14px 16px;text-align:center;"><span style="background:linear-gradient(135deg,#3b82f6,#60a5fa);color:white;padding:6px 14px;border-radius:20px;font-weight:700;">4.6</span></td>
                                            <td style="padding:14px 16px;text-align:center;font-weight:600;">11</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Performance Insights Cards -->
                        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;">
                            <div style="background:linear-gradient(135deg,#ecfdf5,#d1fae5);border-radius:16px;padding:24px;border:1px solid #a7f3d0;">
                                <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                    <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="trending-up" style="width:24px;height:24px;color:white;"></i></div>
                                    <h4 style="margin:0;color:#065f46;">Improvement Areas</h4>
                                </div>
                                <p style="margin:0 0 12px;color:#047857;font-size:0.95rem;">Communication skills improved by <strong>12%</strong> this quarter across all departments.</p>
                                <div style="display:flex;align-items:center;gap:8px;"><span style="color:#10b981;font-weight:600;">â†‘ Best improvement in Deck Officers</span></div>
                            </div>
                            <div style="background:linear-gradient(135deg,#fef3c7,#fde68a);border-radius:16px;padding:24px;border:1px solid #fcd34d;">
                                <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                    <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#f59e0b,#fbbf24);display:flex;align-items:center;justify-content:center;"><i data-lucide="award" style="width:24px;height:24px;color:white;"></i></div>
                                    <h4 style="margin:0;color:#92400e;">Excellence Leaders</h4>
                                </div>
                                <p style="margin:0 0 12px;color:#a16207;font-size:0.95rem;"><strong>Diana Shipping</strong> vessels have the highest average rating at 4.5/5.0</p>
                                <div style="display:flex;align-items:center;gap:8px;"><span style="color:#d97706;font-weight:600;">â­ 92% of crew rated Excellent</span></div>
                            </div>
                            <div style="background:linear-gradient(135deg,#ede9fe,#ddd6fe);border-radius:16px;padding:24px;border:1px solid #c4b5fd;">
                                <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                    <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#8b5cf6,#a78bfa);display:flex;align-items:center;justify-content:center;"><i data-lucide="target" style="width:24px;height:24px;color:white;"></i></div>
                                    <h4 style="margin:0;color:#5b21b6;">Focus Area</h4>
                                </div>
                                <p style="margin:0 0 12px;color:#6d28d9;font-size:0.95rem;"><strong>Reliability</strong> scores need attention in Engine department (avg 3.8)</p>
                                <div style="display:flex;align-items:center;gap:8px;"><span style="color:#7c3aed;font-weight:600;">ðŸ“Š Recommended: Mentorship program</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Crew Changes Analytics -->
                    <div class="analytics-tab-content" id="tab-crew-changes-analytics">
                        <!-- KPI Cards Row -->
                        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#10b981,#34d399);"><i data-lucide="repeat"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="12">0</div>
                                    <div class="kpi-card-3d-label">Total Crew Changes</div>
                                    <div class="kpi-card-3d-change up"><i data-lucide="trending-up"></i>Next 30 days</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);"><i data-lucide="arrow-up"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="7">0</div>
                                    <div class="kpi-card-3d-label">Embarkations</div>
                                    <div class="kpi-card-3d-change neutral"><i data-lucide="activity"></i>Scheduled</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);"><i data-lucide="arrow-down"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="5">0</div>
                                    <div class="kpi-card-3d-label">Sign-offs</div>
                                    <div class="kpi-card-3d-change neutral"><i data-lucide="activity"></i>Scheduled</div>
                                </div>
                            </div>
                            <div class="kpi-card-3d">
                                <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="alert-triangle"></i></div>
                                <div class="kpi-card-3d-content">
                                    <div class="kpi-card-3d-value" data-count="2">0</div>
                                    <div class="kpi-card-3d-label">Active Alerts</div>
                                    <div class="kpi-card-3d-change down"><i data-lucide="trending-down"></i>Require action</div>
                                </div>
                            </div>
                        </div>

                        <!-- Charts Row -->
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px;">
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Crew Changes by Port</h3><span>Distribution across major ports</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="crewChangesByPortChart"></canvas></div>
                            </div>
                            <div class="chart-card-3d">
                                <div class="chart-card-3d-header">
                                    <div><h3>Status Breakdown</h3><span>Current status overview</span></div>
                                </div>
                                <div class="chart-card-3d-body" style="height:300px;"><canvas id="crewChangesStatusChart"></canvas></div>
                            </div>
                        </div>

                        <!-- Summary Table -->
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Upcoming Crew Changes Summary</h3><span>Next 30 days overview</span></div>
                            </div>
                            <div style="overflow-x:auto;">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Seafarer</th>
                                            <th>Rank</th>
                                            <th>Vessel</th>
                                            <th>Port</th>
                                            <th>Type</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="crewChangesTableBody">
                                        <!-- Will be filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: API Hub -->
                    <div class="analytics-tab-content" id="tab-api">
                        <div class="api-hub-header" style="background:linear-gradient(135deg,#1e293b 0%,#334155 100%);border-radius:16px;padding:32px;color:white;margin-bottom:24px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                                <div>
                                    <h2 style="margin:0 0 8px;font-size:1.75rem;">ðŸš€ ATLANTIS API Hub</h2>
                                    <p style="margin:0;opacity:0.8;">RESTful APIs for seamless integration with your systems</p>
                                </div>
                                <div style="display:flex;gap:12px;">
                                    <div style="background:rgba(255,255,255,0.1);padding:12px 20px;border-radius:8px;text-align:center;"><div style="font-size:1.5rem;font-weight:700;">18</div><div style="font-size:0.8rem;opacity:0.7;">Endpoints</div></div>
                                    <div style="background:rgba(255,255,255,0.1);padding:12px 20px;border-radius:8px;text-align:center;"><div style="font-size:1.5rem;font-weight:700;">v2.5</div><div style="font-size:0.8rem;opacity:0.7;">API Version</div></div>
                                    <div style="background:rgba(16,185,129,0.2);padding:12px 20px;border-radius:8px;text-align:center;"><div style="font-size:1.5rem;font-weight:700;color:#10b981;">99.9%</div><div style="font-size:0.8rem;opacity:0.7;">Uptime</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- API Categories -->
                        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:24px;">
                            <div class="api-category-card" onclick="showApiEndpoints('seafarers')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#059669,#10b981);"><i data-lucide="users"></i></div>
                                <h3>Seafarers API</h3>
                                <p>Manage crew database, profiles, status updates</p>
                                <div class="api-endpoints-count">5 endpoints</div>
                            </div>
                            <div class="api-category-card" onclick="showApiEndpoints('recruitment')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#dc2626,#f87171);"><i data-lucide="user-plus"></i></div>
                                <h3>Recruitment API</h3>
                                <p>RFCs, candidates, interviews management</p>
                                <div class="api-endpoints-count">6 endpoints</div>
                            </div>
                            <div class="api-category-card" onclick="showApiEndpoints('contracts')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#0d9488,#14b8a6);"><i data-lucide="file-signature"></i></div>
                                <h3>Contracts API</h3>
                                <p>Employment contracts, PEME, rotations</p>
                                <div class="api-endpoints-count">4 endpoints</div>
                            </div>
                            <div class="api-category-card" onclick="showApiEndpoints('fleet')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);"><i data-lucide="ship"></i></div>
                                <h3>Fleet API</h3>
                                <p>Vessels, principals, assignments</p>
                                <div class="api-endpoints-count">4 endpoints</div>
                            </div>
                            <div class="api-category-card" onclick="showApiEndpoints('documents')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);"><i data-lucide="file-check"></i></div>
                                <h3>Documents API</h3>
                                <p>Certificates, compliance, expiry tracking</p>
                                <div class="api-endpoints-count">5 endpoints</div>
                            </div>
                            <div class="api-category-card" onclick="showApiEndpoints('analytics')">
                                <div class="api-category-icon" style="background:linear-gradient(135deg,#3b82f6,#60a5fa);"><i data-lucide="bar-chart-3"></i></div>
                                <h3>Analytics API</h3>
                                <p>KPIs, reports, dashboards data</p>
                                <div class="api-endpoints-count">4 endpoints</div>
                            </div>
                        </div>

                        <!-- API Documentation Preview -->
                        <div class="chart-card-3d" id="apiDocumentation">
                            <div class="chart-card-3d-header" style="background:var(--cw-gray-50);">
                                <div><h3>ðŸ“– API Documentation</h3><span>Select a category above to view endpoints</span></div>
                                <div style="display:flex;gap:8px;">
                                    <span class="api-method-badge get">GET</span>
                                    <span class="api-method-badge post">POST</span>
                                    <span class="api-method-badge put">PUT</span>
                                    <span class="api-method-badge delete">DELETE</span>
                                </div>
                            </div>
                            <div class="chart-card-3d-body" id="apiEndpointsList" style="max-height:500px;overflow-y:auto;">
                                <!-- Default: Show all endpoints overview -->
                                <div class="api-endpoint-group">
                                    <h4 style="color:var(--cw-primary);margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="users" style="width:20px;height:20px;"></i>Seafarers API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/seafarers</code><span class="api-desc">Get all seafarers with filters</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/seafarers/{id}</code><span class="api-desc">Get seafarer by ID</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/seafarers</code><span class="api-desc">Create new seafarer</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge put">PUT</span><code>/api/v2/seafarers/{id}</code><span class="api-desc">Update seafarer</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/seafarers/{id}/documents</code><span class="api-desc">Get seafarer documents</span></div>
                                </div>
                                <div class="api-endpoint-group">
                                    <h4 style="color:#dc2626;margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="user-plus" style="width:20px;height:20px;"></i>Recruitment API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/rfcs</code><span class="api-desc">Get all RFCs</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/rfcs</code><span class="api-desc">Create new RFC</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/candidates</code><span class="api-desc">Get all candidates</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/candidates</code><span class="api-desc">Add candidate</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge put">PUT</span><code>/api/v2/candidates/{id}/stage</code><span class="api-desc">Update candidate stage</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/interviews</code><span class="api-desc">Get interviews</span></div>
                                </div>
                                <div class="api-endpoint-group">
                                    <h4 style="color:#0d9488;margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="file-signature" style="width:20px;height:20px;"></i>Contracts API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/contracts</code><span class="api-desc">Get all contracts</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/contracts</code><span class="api-desc">Create contract</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge put">PUT</span><code>/api/v2/contracts/{id}/peme</code><span class="api-desc">Update PEME status</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/rotations</code><span class="api-desc">Get rotation plan</span></div>
                                </div>
                                <div class="api-endpoint-group">
                                    <h4 style="color:#8b5cf6;margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="ship" style="width:20px;height:20px;"></i>Fleet API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/vessels</code><span class="api-desc">Get all vessels</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/vessels</code><span class="api-desc">Add vessel</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/principals</code><span class="api-desc">Get all principals</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/vessels/{id}/crew</code><span class="api-desc">Get vessel crew</span></div>
                                </div>
                                <div class="api-endpoint-group">
                                    <h4 style="color:#f59e0b;margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="file-check" style="width:20px;height:20px;"></i>Documents API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/documents</code><span class="api-desc">Get all documents</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/documents</code><span class="api-desc">Upload document</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/documents/expiring</code><span class="api-desc">Get expiring documents</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/documents/compliance</code><span class="api-desc">Get compliance report</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge delete">DELETE</span><code>/api/v2/documents/{id}</code><span class="api-desc">Delete document</span></div>
                                </div>
                                <div class="api-endpoint-group">
                                    <h4 style="color:#3b82f6;margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="bar-chart-3" style="width:20px;height:20px;"></i>Analytics API</h4>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/analytics/kpis</code><span class="api-desc">Get KPI dashboard data</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/analytics/trends</code><span class="api-desc">Get trend data</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge get">GET</span><code>/api/v2/analytics/reports</code><span class="api-desc">Generate reports</span></div>
                                    <div class="api-endpoint"><span class="api-method-badge post">POST</span><code>/api/v2/analytics/export</code><span class="api-desc">Export data</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="view" id="view-compliance">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Complaints Analytics</h1>
                            <p class="page-subtitle">MLC 2006 compliant grievance analytics, resolution metrics, and trend analysis</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="exportComplaintsAnalytics()"><i data-lucide="download"></i>Export Report</button>
                            <button class="btn btn-secondary" onclick="showNotification('Generating compliance audit...', 'info')"><i data-lucide="clipboard-check"></i>MLC Audit</button>
                            <button class="btn btn-primary" onclick="refreshComplaintsAnalytics()"><i data-lucide="refresh-cw"></i>Refresh</button>
                        </div>
                    </div>

                    <!-- Hero Stats Header -->
                    <div style="background:linear-gradient(135deg,#dc2626 0%,#ef4444 50%,#f97316 100%);border-radius:24px;padding:36px;color:white;margin-bottom:28px;position:relative;overflow:hidden;">
                        <div style="position:absolute;top:-80px;right:-80px;width:250px;height:250px;background:rgba(255,255,255,0.08);border-radius:50%;"></div>
                        <div style="position:absolute;bottom:-40px;left:20%;width:150px;height:150px;background:rgba(255,255,255,0.05);border-radius:50%;"></div>
                        <div style="display:flex;justify-content:space-between;align-items:center;position:relative;z-index:1;">
                            <div>
                                <h2 style="margin:0 0 8px;font-size:2rem;display:flex;align-items:center;gap:14px;"><i data-lucide="message-square-warning" style="width:40px;height:40px;"></i>Complaints Overview</h2>
                                <p style="margin:0;opacity:0.9;font-size:1.1rem;">Real-time grievance monitoring and resolution tracking</p>
                            </div>
                            <div style="display:flex;gap:20px;">
                                <div style="background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);padding:24px 32px;border-radius:20px;text-align:center;border:1px solid rgba(255,255,255,0.2);">
                                    <div style="font-size:3rem;font-weight:800;">156</div>
                                    <div style="font-size:0.9rem;opacity:0.9;margin-top:4px;">Total Complaints</div>
                                </div>
                                <div style="background:rgba(16,185,129,0.3);backdrop-filter:blur(10px);padding:24px 32px;border-radius:20px;text-align:center;border:1px solid rgba(16,185,129,0.4);">
                                    <div style="font-size:3rem;font-weight:800;color:#a7f3d0;">86%</div>
                                    <div style="font-size:0.9rem;opacity:0.9;margin-top:4px;">Resolution Rate</div>
                                </div>
                                <div style="background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);padding:24px 32px;border-radius:20px;text-align:center;border:1px solid rgba(255,255,255,0.2);">
                                    <div style="font-size:3rem;font-weight:800;">4.2</div>
                                    <div style="font-size:0.9rem;opacity:0.9;margin-top:4px;">Avg Days to Resolve</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- KPI Cards Row -->
                    <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:16px;margin-bottom:28px;">
                        <div class="kpi-card-3d" style="padding:20px;cursor:pointer;" onclick="navigateTo('complaints'); filterComplaintsByStatus('open')">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#ef4444,#f87171);width:44px;height:44px;"><i data-lucide="alert-circle" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;color:#ef4444;">7</div>
                                <div class="kpi-card-3d-label">Open</div>
                                <div style="font-size:0.75rem;color:#ef4444;font-weight:600;">âš ï¸ Requires action</div>
                            </div>
                        </div>
                        <div class="kpi-card-3d" style="padding:20px;cursor:pointer;" onclick="navigateTo('complaints'); filterComplaintsByStatus('in-progress')">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#f59e0b,#fbbf24);width:44px;height:44px;"><i data-lucide="clock" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;color:#f59e0b;">12</div>
                                <div class="kpi-card-3d-label">In Progress</div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);">Being handled</div>
                            </div>
                        </div>
                        <div class="kpi-card-3d" style="padding:20px;cursor:pointer;" onclick="navigateTo('complaints'); filterComplaintsByStatus('escalated')">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#7f1d1d,#dc2626);width:44px;height:44px;"><i data-lucide="alert-triangle" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;color:#7f1d1d;">3</div>
                                <div class="kpi-card-3d-label">Escalated</div>
                                <div style="font-size:0.75rem;color:#dc2626;font-weight:600;">ðŸ”´ Critical</div>
                            </div>
                        </div>
                        <div class="kpi-card-3d" style="padding:20px;cursor:pointer;" onclick="navigateTo('complaints'); filterComplaintsByStatus('resolved')">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#10b981,#34d399);width:44px;height:44px;"><i data-lucide="check-circle" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;color:#10b981;">134</div>
                                <div class="kpi-card-3d-label">Resolved</div>
                                <div style="font-size:0.75rem;color:#10b981;font-weight:600;">âœ“ 86% rate</div>
                            </div>
                        </div>
                        <div class="kpi-card-3d" style="padding:20px;">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#8b5cf6,#a78bfa);width:44px;height:44px;"><i data-lucide="eye-off" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;">23</div>
                                <div class="kpi-card-3d-label">Anonymous</div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);">15% of total</div>
                            </div>
                        </div>
                        <div class="kpi-card-3d" style="padding:20px;">
                            <div class="kpi-card-3d-icon" style="background:linear-gradient(135deg,#06b6d4,#22d3ee);width:44px;height:44px;"><i data-lucide="thumbs-up" style="width:22px;height:22px;"></i></div>
                            <div class="kpi-card-3d-content">
                                <div class="kpi-card-3d-value" style="font-size:1.8rem;color:#06b6d4;">92%</div>
                                <div class="kpi-card-3d-label">Satisfaction</div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);">Post-resolution</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row 1: Status Distribution & Monthly Trend -->
                    <div style="display:grid;grid-template-columns:1fr 2fr;gap:24px;margin-bottom:24px;">
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Status Distribution</h3><span>Current complaint status breakdown</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:320px;"><canvas id="complaintStatusChart"></canvas></div>
                        </div>
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Monthly Complaints Trend</h3><span>Complaints received vs resolved over 12 months</span></div>
                                <div style="display:flex;gap:12px;">
                                    <span style="display:flex;align-items:center;gap:4px;font-size:0.8rem;"><span style="width:12px;height:12px;background:#ef4444;border-radius:50%;"></span>Received</span>
                                    <span style="display:flex;align-items:center;gap:4px;font-size:0.8rem;"><span style="width:12px;height:12px;background:#10b981;border-radius:50%;"></span>Resolved</span>
                                </div>
                            </div>
                            <div class="chart-card-3d-body" style="height:320px;"><canvas id="complaintTrendChart"></canvas></div>
                        </div>
                    </div>

                    <!-- Charts Row 2: Category & Priority -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Complaints by Category</h3><span>Distribution across complaint types</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:300px;"><canvas id="complaintCategoryChart"></canvas></div>
                        </div>
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Priority Distribution</h3><span>Severity levels of all complaints</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:300px;"><canvas id="complaintPriorityChart"></canvas></div>
                        </div>
                    </div>

                    <!-- Charts Row 3: By Vessel & Resolution Time -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Complaints by Vessel</h3><span>Top 8 vessels by complaint volume</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:300px;"><canvas id="complaintByVesselChart"></canvas></div>
                        </div>
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Resolution Time Analysis</h3><span>Average days to resolve by category</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:300px;"><canvas id="complaintResolutionTimeChart"></canvas></div>
                        </div>
                    </div>

                    <!-- Charts Row 4: By Principal & Handler Performance -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;">
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Complaints by Principal</h3><span>Distribution across shipping companies</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:280px;"><canvas id="complaintByPrincipalChart"></canvas></div>
                        </div>
                        <div class="chart-card-3d">
                            <div class="chart-card-3d-header">
                                <div><h3>Handler Performance</h3><span>Resolution rate by assigned handler</span></div>
                            </div>
                            <div class="chart-card-3d-body" style="height:280px;"><canvas id="complaintHandlerChart"></canvas></div>
                        </div>
                    </div>

                    <!-- Recent Critical Complaints Table -->
                    <div class="chart-card-3d" style="margin-bottom:24px;">
                        <div class="chart-card-3d-header">
                            <div><h3>ðŸš¨ Recent Critical & Escalated Complaints</h3><span>Requires immediate attention</span></div>
                            <button class="btn btn-sm" style="background:#dc2626;color:white;" onclick="navigateTo('complaints')"><i data-lucide="external-link"></i>View All</button>
                        </div>
                        <div class="chart-card-3d-body" style="padding:0;">
                            <table style="width:100%;border-collapse:collapse;">
                                <thead>
                                    <tr style="background:linear-gradient(135deg,#fef2f2,#fee2e2);">
                                        <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">ID</th>
                                        <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Subject</th>
                                        <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Category</th>
                                        <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Vessel</th>
                                        <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Priority</th>
                                        <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Days Open</th>
                                        <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:#7f1d1d;border-bottom:2px solid #ef4444;">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-bottom:1px solid var(--cw-gray-100);background:rgba(220,38,38,0.05);">
                                        <td style="padding:14px 16px;font-weight:700;color:#dc2626;">CMP-2025-002</td>
                                        <td style="padding:14px 16px;">Verbal harassment by senior officer</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#fef2f2;color:#dc2626;padding:4px 10px;border-radius:12px;font-size:0.8rem;">ðŸš« Harassment</span></td>
                                        <td style="padding:14px 16px;text-align:center;">MV Diana Star</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#dc2626;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:700;">CRITICAL</span></td>
                                        <td style="padding:14px 16px;text-align:center;font-weight:700;color:#dc2626;">5</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#7f1d1d;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;">ESCALATED</span></td>
                                    </tr>
                                    <tr style="border-bottom:1px solid var(--cw-gray-100);background:rgba(220,38,38,0.03);">
                                        <td style="padding:14px 16px;font-weight:700;color:#dc2626;">CMP-2025-003</td>
                                        <td style="padding:14px 16px;">Defective safety equipment in engine room</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#fef3c7;color:#92400e;padding:4px 10px;border-radius:12px;font-size:0.8rem;">âš ï¸ Safety</span></td>
                                        <td style="padding:14px 16px;text-align:center;">MV Centrofin Glory</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#dc2626;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:700;">CRITICAL</span></td>
                                        <td style="padding:14px 16px;text-align:center;font-weight:700;color:#f59e0b;">6</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#f59e0b;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;">IN PROGRESS</span></td>
                                    </tr>
                                    <tr style="border-bottom:1px solid var(--cw-gray-100);">
                                        <td style="padding:14px 16px;font-weight:700;color:#f59e0b;">CMP-2025-005</td>
                                        <td style="padding:14px 16px;">Excessive working hours beyond MLC limits</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#dbeafe;color:#1e40af;padding:4px 10px;border-radius:12px;font-size:0.8rem;">â° Working Cond.</span></td>
                                        <td style="padding:14px 16px;text-align:center;">MV Neda Harmony</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#f59e0b;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:700;">HIGH</span></td>
                                        <td style="padding:14px 16px;text-align:center;font-weight:700;color:#f59e0b;">4</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#ef4444;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;">OPEN</span></td>
                                    </tr>
                                    <tr>
                                        <td style="padding:14px 16px;font-weight:700;color:#f59e0b;">CMP-2025-001</td>
                                        <td style="padding:14px 16px;">Overtime payment discrepancy</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#ecfdf5;color:#065f46;padding:4px 10px;border-radius:12px;font-size:0.8rem;">ðŸ’° Wages</span></td>
                                        <td style="padding:14px 16px;text-align:center;">MV Pioneer Spirit</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#f59e0b;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:700;">HIGH</span></td>
                                        <td style="padding:14px 16px;text-align:center;font-weight:700;color:#f59e0b;">3</td>
                                        <td style="padding:14px 16px;text-align:center;"><span style="background:#ef4444;color:white;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;">OPEN</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Insights Cards -->
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:24px;">
                        <div style="background:linear-gradient(135deg,#fef2f2,#fee2e2);border-radius:16px;padding:24px;border:1px solid #fecaca;">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#dc2626,#ef4444);display:flex;align-items:center;justify-content:center;"><i data-lucide="trending-up" style="width:24px;height:24px;color:white;"></i></div>
                                <h4 style="margin:0;color:#7f1d1d;">Top Issue Category</h4>
                            </div>
                            <p style="margin:0 0 12px;color:#991b1b;font-size:0.95rem;"><strong>Wages & Benefits</strong> accounts for 32% of all complaints this quarter.</p>
                            <div style="display:flex;align-items:center;gap:8px;"><span style="color:#dc2626;font-weight:600;">â†‘ 8% increase vs last quarter</span></div>
                        </div>
                        <div style="background:linear-gradient(135deg,#ecfdf5,#d1fae5);border-radius:16px;padding:24px;border:1px solid #a7f3d0;">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="award" style="width:24px;height:24px;color:white;"></i></div>
                                <h4 style="margin:0;color:#065f46;">Best Performing</h4>
                            </div>
                            <p style="margin:0 0 12px;color:#047857;font-size:0.95rem;"><strong>Diana Shipping</strong> vessels have lowest complaint rate at 2.1 per 100 crew.</p>
                            <div style="display:flex;align-items:center;gap:8px;"><span style="color:#10b981;font-weight:600;">â­ 98% resolution satisfaction</span></div>
                        </div>
                        <div style="background:linear-gradient(135deg,#fef3c7,#fde68a);border-radius:16px;padding:24px;border:1px solid #fcd34d;">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                                <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#f59e0b,#fbbf24);display:flex;align-items:center;justify-content:center;"><i data-lucide="clock" style="width:24px;height:24px;color:white;"></i></div>
                                <h4 style="margin:0;color:#92400e;">Resolution Alert</h4>
                            </div>
                            <p style="margin:0 0 12px;color:#a16207;font-size:0.95rem;"><strong>3 complaints</strong> approaching SLA deadline (7 days).</p>
                            <div style="display:flex;align-items:center;gap:8px;"><span style="color:#d97706;font-weight:600;">âš ï¸ Action required within 48hrs</span></div>
                        </div>
                    </div>

                    <!-- MLC Compliance Summary -->
                    <div class="chart-card-3d">
                        <div class="chart-card-3d-header">
                            <div><h3>ðŸ“‹ MLC 2006 Compliance Summary</h3><span>Standard A5.1.5 - On-board complaint procedures</span></div>
                            <div style="display:flex;align-items:center;gap:8px;background:#ecfdf5;padding:8px 16px;border-radius:20px;">
                                <span style="width:10px;height:10px;background:#10b981;border-radius:50%;"></span>
                                <span style="color:#065f46;font-weight:600;">Fully Compliant</span>
                            </div>
                        </div>
                        <div class="chart-card-3d-body" style="padding:24px;">
                            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;">
                                <div style="text-align:center;padding:20px;background:var(--cw-gray-50);border-radius:12px;">
                                    <div style="width:60px;height:60px;margin:0 auto 12px;border-radius:50%;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:28px;height:28px;color:white;"></i></div>
                                    <div style="font-weight:700;color:#065f46;">Documented Procedure</div>
                                    <div style="font-size:0.85rem;color:var(--cw-gray-500);margin-top:4px;">In place & communicated</div>
                                </div>
                                <div style="text-align:center;padding:20px;background:var(--cw-gray-50);border-radius:12px;">
                                    <div style="width:60px;height:60px;margin:0 auto 12px;border-radius:50%;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:28px;height:28px;color:white;"></i></div>
                                    <div style="font-weight:700;color:#065f46;">Confidential Handling</div>
                                    <div style="font-size:0.85rem;color:var(--cw-gray-500);margin-top:4px;">Anonymous option available</div>
                                </div>
                                <div style="text-align:center;padding:20px;background:var(--cw-gray-50);border-radius:12px;">
                                    <div style="width:60px;height:60px;margin:0 auto 12px;border-radius:50%;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:28px;height:28px;color:white;"></i></div>
                                    <div style="font-weight:700;color:#065f46;">Timely Resolution</div>
                                    <div style="font-size:0.85rem;color:var(--cw-gray-500);margin-top:4px;">Avg 4.2 days (target: 7)</div>
                                </div>
                                <div style="text-align:center;padding:20px;background:var(--cw-gray-50);border-radius:12px;">
                                    <div style="width:60px;height:60px;margin:0 auto 12px;border-radius:50%;background:linear-gradient(135deg,#10b981,#34d399);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:28px;height:28px;color:white;"></i></div>
                                    <div style="font-weight:700;color:#065f46;">No Victimization</div>
                                    <div style="font-size:0.85rem;color:var(--cw-gray-500);margin-top:4px;">Protected complainants</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: SUPERNUMERARY PERSONNEL -->
                <div class="view" id="view-supernumerary">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Supernumerary Personnel</h1>
                            <p class="page-subtitle">Non-crew riders â€¢ Inspectors â€¢ Observers â€¢ Superintendents</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="renderSupernumeraryGrid();showNotification('Supernumerary list refreshed','success')"><i data-lucide="refresh-cw"></i>Refresh</button>
                            <button class="btn btn-primary" onclick="openModal('addSupernumeraryModal')"><i data-lucide="user-plus"></i>Add Supernumerary</button>
                        </div>
                    </div>

                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label class="filter-label">CATEGORY</label>
                                <select class="filter-select" id="supCategoryFilter" onchange="filterSupernumerary()">
                                    <option value="">All Categories</option>
                                    <option value="inspector">Flag State Inspector</option>
                                    <option value="observer">Port State Observer</option>
                                    <option value="superintendent">Technical Superintendent</option>
                                    <option value="auditor">Safety Auditor</option>
                                    <option value="trainer">Training Officer</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">STATUS</label>
                                <select class="filter-select" id="supStatusFilter" onchange="filterSupernumerary()">
                                    <option value="">All Status</option>
                                    <option value="embarked">Embarked</option>
                                    <option value="pending">Pending</option>
                                    <option value="disembarked">Disembarked</option>
                                </select>
                            </div>
                            <div class="filter-divider"></div>
                            <div class="filter-search">
                                <i data-lucide="search"></i>
                                <input type="text" placeholder="Search by name, vessel..." id="supSearch" oninput="filterSupernumerary()">
                            </div>
                        </div>
                    </div>

                    <div id="supernumeraryGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(380px,1fr));gap:20px;margin-top:24px;">
                        <!-- Cards will be rendered here by JavaScript -->
                    </div>
                </div>

                <!-- VIEW: CREW CHANGES -->
                <div class="view" id="view-crew-changes">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Crew Changes</h1>
                            <p class="page-subtitle">Embark/Disembark execution â€¢ Port coordination â€¢ Sign-on/Sign-off tracking</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary" onclick="renderCrewChanges();showNotification('Crew changes refreshed','success')"><i data-lucide="refresh-cw"></i>Refresh</button>
                            <button class="btn btn-primary" onclick="showNotification('Plan crew change feature coming soon','info')"><i data-lucide="calendar-plus"></i>Plan Crew Change</button>
                        </div>
                    </div>

                    <div class="filters-panel">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label class="filter-label">TYPE</label>
                                <select class="filter-select" id="crewChangeTypeFilter" onchange="filterCrewChanges()">
                                    <option value="">All Types</option>
                                    <option value="embark">Embarkation</option>
                                    <option value="signoff">Sign-off</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">STATUS</label>
                                <select class="filter-select" id="crewChangeStatusFilter" onchange="filterCrewChanges()">
                                    <option value="">All Statuses</option>
                                    <option value="planned">Planned</option>
                                    <option value="confirmed">Confirmed</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">PORT</label>
                                <select class="filter-select" id="crewChangePortFilter" onchange="filterCrewChanges()">
                                    <option value="">All Ports</option>
                                    <option value="piraeus">Piraeus</option>
                                    <option value="singapore">Singapore</option>
                                    <option value="rotterdam">Rotterdam</option>
                                    <option value="dubai">Dubai</option>
                                </select>
                            </div>
                            <div class="filter-divider"></div>
                            <div class="filter-search">
                                <i data-lucide="search"></i>
                                <input type="text" placeholder="Search vessel, seafarer, port..." id="crewChangeSearch" oninput="filterCrewChanges()">
                            </div>
                        </div>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 350px;gap:24px;margin-top:24px;">
                        <!-- Main Content -->
                        <div>
                            <h3 style="display:flex;align-items:center;gap:12px;margin:0 0 20px 0;font-size:1.1rem;font-weight:600;">
                                <i data-lucide="calendar"></i>
                                Upcoming Crew Changes (30 days)
                            </h3>
                            <div id="crewChangesGrid" style="display:flex;flex-direction:column;gap:16px;">
                                <!-- Crew change cards will be rendered here -->
                            </div>
                        </div>

                        <!-- Sidebar -->
                        <div>
                            <!-- Port Agents -->
                            <div style="background:white;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:var(--shadow-sm);">
                                <h4 style="display:flex;align-items:center;gap:8px;margin:0 0 16px 0;font-size:0.95rem;font-weight:600;">
                                    <i data-lucide="anchor"></i>
                                    Port Agents
                                </h4>
                                <div style="display:flex;flex-direction:column;gap:12px;">
                                    <div onclick="filterByPort('Piraeus')" style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='var(--cw-primary)';this.style.color='white';this.querySelector('span').style.color='rgba(255,255,255,0.8)';" onmouseout="this.style.background='var(--cw-gray-50)';this.style.color='inherit';this.querySelector('span').style.color='var(--cw-gray-600)';">
                                        <span style="font-weight:500;">Piraeus</span>
                                        <span style="color:var(--cw-gray-600);">3 changes</span>
                                    </div>
                                    <div onclick="filterByPort('Singapore')" style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='var(--cw-primary)';this.style.color='white';this.querySelector('span').style.color='rgba(255,255,255,0.8)';" onmouseout="this.style.background='var(--cw-gray-50)';this.style.color='inherit';this.querySelector('span').style.color='var(--cw-gray-600)';">
                                        <span style="font-weight:500;">Singapore</span>
                                        <span style="color:var(--cw-gray-600);">5 changes</span>
                                    </div>
                                    <div onclick="filterByPort('Rotterdam')" style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='var(--cw-primary)';this.style.color='white';this.querySelector('span').style.color='rgba(255,255,255,0.8)';" onmouseout="this.style.background='var(--cw-gray-50)';this.style.color='inherit';this.querySelector('span').style.color='var(--cw-gray-600)';">
                                        <span style="font-weight:500;">Rotterdam</span>
                                        <span style="color:var(--cw-gray-600);">2 changes</span>
                                    </div>
                                    <div onclick="filterByPort('Dubai')" style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='var(--cw-primary)';this.style.color='white';this.querySelector('span').style.color='rgba(255,255,255,0.8)';" onmouseout="this.style.background='var(--cw-gray-50)';this.style.color='inherit';this.querySelector('span').style.color='var(--cw-gray-600)';">
                                        <span style="font-weight:500;">Dubai</span>
                                        <span style="color:var(--cw-gray-600);">2 changes</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Alerts & Blockers -->
                            <div style="background:white;border-radius:12px;padding:20px;box-shadow:var(--shadow-sm);">
                                <h4 style="display:flex;align-items:center;gap:8px;margin:0 0 16px 0;font-size:0.95rem;font-weight:600;">
                                    <i data-lucide="alert-triangle"></i>
                                    Alerts & Blockers
                                </h4>
                                <div style="display:flex;flex-direction:column;gap:12px;">
                                    <div onclick="viewAlertDetail('visa-pending')" style="padding:12px;background:#fee2e2;border-left:3px solid #ef4444;border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';this.style.transform='translateY(-2px)';" onmouseout="this.style.boxShadow='none';this.style.transform='translateY(0)';">
                                        <div style="font-weight:600;font-size:0.85rem;color:#991b1b;margin-bottom:4px;">Visa Pending</div>
                                        <div style="font-size:0.75rem;color:#7f1d1d;">SF-2847: India visa processing</div>
                                    </div>
                                    <div onclick="viewAlertDetail('port-agent')" style="padding:12px;background:#fef3c7;border-left:3px solid #f59e0b;border-radius:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';this.style.transform='translateY(-2px)';" onmouseout="this.style.boxShadow='none';this.style.transform='translateY(0)';">
                                        <div style="font-weight:600;font-size:0.85rem;color:#92400e;margin-bottom:4px;">Port Agent Unconfirmed</div>
                                        <div style="font-size:0.75rem;color:#78350f;">Dubai: Awaiting confirmation</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="view" id="view-settings">
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1 class="page-title">Settings</h1>
                            <p class="page-subtitle">System configuration, user preferences, and integrations</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-secondary"><i data-lucide="rotate-ccw"></i>Reset to Defaults</button>
                            <button class="btn btn-primary"><i data-lucide="save"></i>Save Changes</button>
                        </div>
                    </div>

                    <div class="settings-container">
                        <nav class="settings-nav">
                            <div class="settings-nav-item active"><i data-lucide="user"></i>Profile</div>
                            <div class="settings-nav-item"><i data-lucide="bell"></i>Notifications</div>
                            <div class="settings-nav-item"><i data-lucide="shield"></i>Security</div>
                            <div class="settings-nav-item"><i data-lucide="palette"></i>Appearance</div>
                            <div class="settings-nav-item"><i data-lucide="plug"></i>Integrations</div>
                            <div class="settings-nav-item"><i data-lucide="database"></i>Data Management</div>
                            <div class="settings-nav-item"><i data-lucide="users"></i>Team & Roles</div>
                        </nav>

                        <div class="settings-panel">
                            <div class="settings-panel-header">
                                <div class="settings-panel-title">Profile Settings</div>
                                <div class="settings-panel-subtitle">Manage your account information and preferences</div>
                            </div>
                            <div class="settings-panel-body">
                                <div class="settings-section">
                                    <div class="settings-section-title">Personal Information</div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Full Name</div><div class="settings-row-desc">Your display name across the platform</div></div>
                                        <input type="text" class="settings-input" value="Maria Santos">
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Email Address</div><div class="settings-row-desc">Primary email for notifications</div></div>
                                        <input type="email" class="settings-input" value="m.santos@crossworld.com.ph">
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Department</div><div class="settings-row-desc">Your organizational unit</div></div>
                                        <select class="settings-select"><option selected>Crewing Operations</option><option>Recruitment</option><option>Training</option><option>Administration</option></select>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Role</div><div class="settings-row-desc">Your access level in the system</div></div>
                                        <select class="settings-select"><option>Administrator</option><option selected>Crewing Manager</option><option>Recruitment Officer</option><option>Viewer</option></select>
                                    </div>
                                </div>

                                <div class="settings-section">
                                    <div class="settings-section-title">Preferences</div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Language</div><div class="settings-row-desc">Display language for the interface</div></div>
                                        <select class="settings-select"><option selected>English</option><option>Filipino</option><option>Greek</option></select>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Timezone</div><div class="settings-row-desc">Used for scheduling and timestamps</div></div>
                                        <select class="settings-select"><option selected>Asia/Manila (GMT+8)</option><option>Europe/Athens (GMT+2)</option><option>UTC</option></select>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Date Format</div><div class="settings-row-desc">How dates are displayed</div></div>
                                        <select class="settings-select"><option selected>YYYY-MM-DD</option><option>DD/MM/YYYY</option><option>MM/DD/YYYY</option></select>
                                    </div>
                                </div>

                                <div class="settings-section">
                                    <div class="settings-section-title">Notifications</div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Email Notifications</div><div class="settings-row-desc">Receive updates via email</div></div>
                                        <div class="settings-toggle active" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Document Expiry Alerts</div><div class="settings-row-desc">Get notified when certificates are expiring</div></div>
                                        <div class="settings-toggle active" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">RFA Status Updates</div><div class="settings-row-desc">Notify on RFA stage changes</div></div>
                                        <div class="settings-toggle active" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Interview Reminders</div><div class="settings-row-desc">Get reminded before scheduled interviews</div></div>
                                        <div class="settings-toggle" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Weekly Summary Report</div><div class="settings-row-desc">Receive weekly activity digest</div></div>
                                        <div class="settings-toggle active" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                </div>

                                <div class="settings-section">
                                    <div class="settings-section-title">System</div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Dark Mode</div><div class="settings-row-desc">Use dark color scheme</div></div>
                                        <div class="settings-toggle" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Compact View</div><div class="settings-row-desc">Reduce spacing for more content</div></div>
                                        <div class="settings-toggle" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-row">
                                        <div class="settings-row-info"><div class="settings-row-label">Auto-refresh Data</div><div class="settings-row-desc">Automatically refresh dashboard data</div></div>
                                        <div class="settings-toggle active" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- TALENT-POOL SETTINGS VIEW -->
            <div class="view" id="view-talent-pool" style="overflow-y:auto;padding:24px;">
                <div class="page-header">
                    <div class="page-title-section">
                        <h1 class="page-title">Talent-Pool Settings</h1>
                        <p class="page-subtitle">Configure sourcing channels, negotiation ranges, NFR list, and auto-tagging rules</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="exportTalentPoolSettings()"><i data-lucide="download"></i>Export</button>
                        <button class="btn btn-primary" onclick="importTalentPoolSettings()"><i data-lucide="upload"></i>Import</button>
                    </div>
                </div>
                
                <div class="stats-grid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:24px;">
                    <div class="stat-card" style="cursor:pointer;" onclick="switchTalentPoolTab('channels')"><div class="stat-icon" style="background:#10b981;"><i data-lucide="git-branch"></i></div><div class="stat-label">ACTIVE CHANNELS</div><div class="stat-value">8</div></div>
                    <div class="stat-card" style="cursor:pointer;" onclick="switchTalentPoolTab('negotiation')"><div class="stat-icon" style="background:#3b82f6;"><i data-lucide="dollar-sign"></i></div><div class="stat-label">SALARY RANGES</div><div class="stat-value">12</div></div>
                    <div class="stat-card" style="cursor:pointer;" onclick="switchTalentPoolTab('nfr')"><div class="stat-icon" style="background:#ef4444;"><i data-lucide="user-x"></i></div><div class="stat-label">NFR LIST</div><div class="stat-value">5</div></div>
                    <div class="stat-card" style="cursor:pointer;" onclick="switchTalentPoolTab('autotag')"><div class="stat-icon" style="background:#8b5cf6;"><i data-lucide="tags"></i></div><div class="stat-label">AUTO-TAG RULES</div><div class="stat-value">6</div></div>
                </div>
                
                <div class="analytics-tabs" style="display:flex;gap:8px;margin-bottom:24px;border-bottom:2px solid var(--cw-gray-200);padding-bottom:12px;">
                    <button class="analytics-tab active" onclick="switchTalentPoolTab('channels')" id="tp-tab-channels"><i data-lucide="git-branch"></i>Sourcing Channels</button>
                    <button class="analytics-tab" onclick="switchTalentPoolTab('negotiation')" id="tp-tab-negotiation"><i data-lucide="dollar-sign"></i>Negotiation Ranges</button>
                    <button class="analytics-tab" onclick="switchTalentPoolTab('nfr')" id="tp-tab-nfr"><i data-lucide="user-x"></i>NFR / Watch List</button>
                    <button class="analytics-tab" onclick="switchTalentPoolTab('autotag')" id="tp-tab-autotag"><i data-lucide="tags"></i>Auto-Tagging Rules</button>
                </div>
                
                <div class="tp-tab-content" id="tp-content-channels">
                    <div class="card"><div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                        <h3 class="card-title">Sourcing Channels</h3>
                        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                                        <div style="position:relative;width:200px;"><i data-lucide="search" style="position:absolute;left:14px;top:50%;transform:translateY(-50%);width:18px;height:18px;color:var(--cw-gray-400);pointer-events:none;"></i><input type="text" class="form-input" placeholder="Search channels..." onkeyup="filterChannels()" id="channelSearch" style="height:40px;padding-left:44px;"></div>
                            <select class="form-select" style="width:150px;height:40px;" onchange="filterChannels()" id="channelTypeFilter"><option value="">All Types</option><option value="agency">Agency</option><option value="job-board">Job Board</option><option value="walk-in">Walk-in</option><option value="referral">Referral</option><option value="social-media">Social Media</option><option value="school">Maritime School</option><option value="returning">Returning Crew</option></select>
                            <select class="form-select" style="width:120px;height:40px;" onchange="filterChannels()" id="channelStatusFilter"><option value="">All Status</option><option value="active">Active</option><option value="inactive">Inactive</option></select>
                            <button class="btn btn-primary btn-sm" onclick="openModal('tpChannelModal')"><i data-lucide="plus"></i>Add Channel</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding:0;"><table class="data-table"><thead><tr><th>Channel Name</th><th>Type</th><th>Cost/Hire</th><th>Success Rate</th><th>Status</th><th>Actions</th></tr></thead><tbody id="channelsTableBody"></tbody></table></div></div>
                </div>
                
                <div class="tp-tab-content" id="tp-content-negotiation" style="display:none;">
                    <div class="card"><div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                        <h3 class="card-title">Default Salary Ranges by Rank</h3>
                        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                            <select class="form-select" style="width:160px;height:40px;" onchange="filterSalaryRanges()" id="salaryRankFilter"><option value="">All Ranks</option><optgroup label="Officers"><option value="Master">Master</option><option value="Chief Officer">Chief Officer</option><option value="2nd Officer">2nd Officer</option><option value="3rd Officer">3rd Officer</option><option value="Chief Engineer">Chief Engineer</option><option value="2nd Engineer">2nd Engineer</option></optgroup><optgroup label="Ratings"><option value="Electrician">Electrician</option><option value="Bosun">Bosun</option><option value="AB">AB</option><option value="Oiler">Oiler</option><option value="Cook">Cook</option><option value="Cadet">Cadet</option></optgroup></select>
                            <select class="form-select" style="width:150px;height:40px;" onchange="filterSalaryRanges()" id="salaryVesselFilter"><option value="">All Vessel Types</option><option value="all">Generic (All)</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container</option><option value="lng">LNG/LPG</option></select>
                            <select class="form-select" style="width:140px;height:40px;" onchange="filterSalaryRanges()" id="salaryCurrencyFilter"><option value="">All Currencies</option><option value="USD">USD</option><option value="EUR">EUR</option><option value="PHP">PHP</option><option value="GBP">GBP</option></select>
                            <button class="btn btn-primary btn-sm" onclick="openModal('tpSalaryModal')"><i data-lucide="plus"></i>Add Range</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding:0;"><table class="data-table"><thead><tr><th>Rank</th><th>Vessel Type</th><th>Min (USD)</th><th>Max (USD)</th><th>Currencies</th><th>Actions</th></tr></thead><tbody id="salaryRangesTableBody"></tbody></table></div></div>
                </div>
                
                <div class="tp-tab-content" id="tp-content-nfr" style="display:none;">
                    <div class="card"><div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                        <h3 class="card-title">Not for Rehire / Watch List</h3>
                        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                                        <div style="position:relative;width:200px;"><i data-lucide="search" style="position:absolute;left:14px;top:50%;transform:translateY(-50%);width:18px;height:18px;color:var(--cw-gray-400);pointer-events:none;"></i><input type="text" class="form-input" placeholder="Search by name..." onkeyup="filterNfr()" id="nfrSearch" style="height:40px;padding-left:44px;"></div>
                            <select class="form-select" style="width:150px;height:40px;" onchange="filterNfr()" id="nfrTypeFilter"><option value="">All Types</option><option value="nfr">NFR</option><option value="watchlist">Watch List</option><option value="blacklist">Blacklisted</option><option value="principal-ban">Principal Ban</option></select>
                            <select class="form-select" style="width:150px;height:40px;" onchange="filterNfr()" id="nfrCategoryFilter"><option value="">All Categories</option><option value="performance">Poor Performance</option><option value="misconduct">Misconduct</option><option value="abandonment">Abandonment</option><option value="medical">Medical</option><option value="principal">Principal Request</option></select>
                            <select class="form-select" style="width:150px;height:40px;" onchange="filterNfr()" id="nfrPrincipalFilter"><option value="">All Principals</option><option value="Diana Shipping">Diana Shipping</option><option value="Centrofin">Centrofin</option><option value="Pioneer Marine">Pioneer Marine</option><option value="Neda Maritime">Neda Maritime</option></select>
                            <button class="btn btn-primary btn-sm" onclick="openModal('tpNfrModal')" style="background:#ef4444;"><i data-lucide="user-x"></i>Add to NFR</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding:0;"><table class="data-table"><thead><tr><th>Seafarer</th><th>Rank</th><th>Reason</th><th>Added By</th><th>Date</th><th>Type</th><th>Actions</th></tr></thead><tbody id="nfrTableBody"></tbody></table></div></div>
                </div>
                
                <div class="tp-tab-content" id="tp-content-autotag" style="display:none;">
                    <div class="card"><div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                        <h3 class="card-title">Auto-Tagging Rules</h3>
                        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                                        <div style="position:relative;width:180px;"><i data-lucide="search" style="position:absolute;left:14px;top:50%;transform:translateY(-50%);width:18px;height:18px;color:var(--cw-gray-400);pointer-events:none;"></i><input type="text" class="form-input" placeholder="Search tags..." onkeyup="filterAutoTags()" id="autoTagSearch" style="height:40px;padding-left:44px;"></div>
                            <select class="form-select" style="width:160px;height:40px;" onchange="filterAutoTags()" id="autoTagConditionFilter"><option value="">All Conditions</option><option value="first-contract">First Contract</option><option value="returning">Returning</option><option value="experience">Experience</option><option value="source">Source Channel</option><option value="rank">Specific Rank</option><option value="principal">Principal</option><option value="performance">Performance</option></select>
                            <select class="form-select" style="width:130px;height:40px;" onchange="filterAutoTags()" id="autoTagApplyFilter"><option value="">All Apply</option><option value="yes">Auto</option><option value="suggest">Suggest</option><option value="manual">Manual</option></select>
                            <select class="form-select" style="width:120px;height:40px;" onchange="filterAutoTags()" id="autoTagStatusFilter"><option value="">All Status</option><option value="active">Active</option><option value="inactive">Inactive</option></select>
                            <button class="btn btn-primary btn-sm" onclick="openModal('tpAutoTagModal')"><i data-lucide="plus"></i>Add Rule</button>
                        </div>
                    </div>
                    <div class="card-body" style="padding:0;"><table class="data-table"><thead><tr><th>Tag</th><th>Condition</th><th>Value</th><th>Auto-Apply</th><th>Status</th><th>Actions</th></tr></thead><tbody id="autoTagTableBody"></tbody></table></div></div>
                </div>
            </div>
            
            <!-- SEAFARER PROFILE VIEW -->
            <div class="view" id="view-seafarer-profile" style="overflow-y:auto;">
                <!-- Profile Header -->
                <div class="seafarer-profile-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;padding:32px;margin:-24px -24px 24px -24px;">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:24px;">
                        <div style="display:flex;gap:24px;align-items:center;">
                            <div id="spAvatar" style="width:100px;height:100px;border-radius:20px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:2.5rem;font-weight:700;border:3px solid rgba(255,255,255,0.3);">JD</div>
                            <div>
                                <div style="display:flex;align-items:center;gap:12px;margin-bottom:4px;">
                                    <h1 id="spName" style="margin:0;font-size:1.75rem;font-weight:700;">Juan Dela Cruz</h1>
                                    <span id="spStatus" class="status-badge status-embarked" style="font-size:0.75rem;">Embarked</span>
                                </div>
                                <p id="spRank" style="margin:0;font-size:1.1rem;opacity:0.9;">Chief Officer</p>
                                <div style="display:flex;gap:16px;margin-top:12px;flex-wrap:wrap;">
                                    <span style="display:flex;align-items:center;gap:6px;font-size:0.85rem;opacity:0.85;"><i data-lucide="hash" style="width:14px;height:14px;"></i><span id="spId">SEA-2024-0847</span></span>
                                    <span style="display:flex;align-items:center;gap:6px;font-size:0.85rem;opacity:0.85;"><i data-lucide="flag" style="width:14px;height:14px;"></i><span id="spNationality">Filipino</span></span>
                                    <span style="display:flex;align-items:center;gap:6px;font-size:0.85rem;opacity:0.85;"><i data-lucide="calendar" style="width:14px;height:14px;"></i><span id="spAge">38 years old</span></span>
                                </div>
                                <div style="display:flex;gap:8px;margin-top:12px;">
                                    <span class="tag" style="background:rgba(255,255,255,0.2);color:white;font-size:0.75rem;" id="spPoolTag">Dedicated</span>
                                    <span class="tag" style="background:rgba(16,185,129,0.3);color:#6ee7b7;font-size:0.75rem;" id="spAssignTag">Assigned</span>
                                </div>
                            </div>
                        </div>
                        <div style="display:flex;gap:8px;flex-wrap:wrap;">
                            <button class="btn btn-secondary" style="background:rgba(255,255,255,0.15);border-color:rgba(255,255,255,0.3);color:white;" onclick="printSeafarerProfile()"><i data-lucide="printer"></i>Print</button>
                            <button class="btn btn-secondary" style="background:rgba(255,255,255,0.15);border-color:rgba(255,255,255,0.3);color:white;" onclick="emailSeafarer()"><i data-lucide="mail"></i>Email</button>
                            <button class="btn btn-primary" style="background:white;color:var(--cw-primary);" onclick="editSeafarerProfile()"><i data-lucide="edit-3"></i>Edit Profile</button>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Cards -->
                <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:24px;padding:0 24px;">
                    <div class="stat-card" style="cursor:pointer;" onclick="switchProfileTab('documents')">
                        <div class="stat-icon" style="background:#10b981;"><i data-lucide="file-check"></i></div>
                        <div class="stat-label">DOCUMENTS</div>
                        <div class="stat-value" id="spDocsCount">24/24</div>
                        <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">All Valid</div>
                    </div>
                    <div class="stat-card" style="cursor:pointer;" onclick="switchProfileTab('sea-service')">
                        <div class="stat-icon" style="background:#3b82f6;"><i data-lucide="anchor"></i></div>
                        <div class="stat-label">SEA TIME</div>
                        <div class="stat-value" id="spSeaTime">12.5</div>
                        <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Years Experience</div>
                    </div>
                    <div class="stat-card" style="cursor:pointer;" onclick="switchProfileTab('evaluations')">
                        <div class="stat-icon" style="background:#8b5cf6;"><i data-lucide="star"></i></div>
                        <div class="stat-label">EVAL SCORE</div>
                        <div class="stat-value" id="spEvalScore">4.7</div>
                        <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Last 5 Contracts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#f59e0b;"><i data-lucide="ship"></i></div>
                        <div class="stat-label">CONTRACTS</div>
                        <div class="stat-value" id="spContracts">18</div>
                        <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Total Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#06b6d4;"><i data-lucide="calendar-check"></i></div>
                        <div class="stat-label">AVAILABILITY</div>
                        <div class="stat-value" id="spAvailability" style="font-size:1.25rem;">Aug 15</div>
                        <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Contract End</div>
                    </div>
                </div>
                
                <!-- Profile Tabs -->
                <div style="padding:0 24px;">
                    <div class="analytics-tabs" style="display:flex;gap:8px;margin-bottom:24px;border-bottom:2px solid var(--cw-gray-200);padding-bottom:12px;">
                        <button class="analytics-tab active" onclick="switchProfileTab('overview')" id="sp-tab-overview"><i data-lucide="user"></i>Overview</button>
                        <button class="analytics-tab" onclick="switchProfileTab('documents')" id="sp-tab-documents"><i data-lucide="file-text"></i>Documents</button>
                        <button class="analytics-tab" onclick="switchProfileTab('sea-service')" id="sp-tab-sea-service"><i data-lucide="anchor"></i>Sea Service</button>
                        <button class="analytics-tab" onclick="switchProfileTab('salary')" id="sp-tab-salary"><i data-lucide="dollar-sign"></i>Salary & Allotment</button>
                        <button class="analytics-tab" onclick="switchProfileTab('evaluations')" id="sp-tab-evaluations"><i data-lucide="star"></i>Evaluations</button>
                        <button class="analytics-tab" onclick="switchProfileTab('notes')" id="sp-tab-notes"><i data-lucide="message-square"></i>Notes & Timeline</button>
                    </div>
                    
                    <!-- OVERVIEW TAB -->
                    <div class="sp-tab-content" id="sp-content-overview">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                            <!-- Personal Information -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="user" style="width:18px;height:18px;"></i> Personal Information</h3></div>
                                <div class="card-body">
                                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">First Name</label><div style="font-weight:500;" id="spFirstName">Juan</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Last Name</label><div style="font-weight:500;" id="spLastName">Dela Cruz</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Middle Name</label><div style="font-weight:500;" id="spMiddleName">Santos</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Date of Birth</label><div style="font-weight:500;" id="spDOB">March 15, 1986</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Place of Birth</label><div style="font-weight:500;" id="spPOB">Manila, Philippines</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Gender</label><div style="font-weight:500;" id="spGender">Male</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Civil Status</label><div style="font-weight:500;" id="spCivilStatus">Married</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Religion</label><div style="font-weight:500;" id="spReligion">Roman Catholic</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contact Information -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="phone" style="width:18px;height:18px;"></i> Contact Information</h3></div>
                                <div class="card-body">
                                    <div style="display:grid;gap:16px;">
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Email Address</label><div style="font-weight:500;display:flex;align-items:center;gap:8px;" id="spEmail"><i data-lucide="mail" style="width:16px;height:16px;color:var(--cw-gray-400);"></i><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aac0dfcbc484cecfc6cbc9d8dfd0eacfc7cbc3c684c9c5c7">[email&#160;protected]</a></div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Mobile Phone</label><div style="font-weight:500;display:flex;align-items:center;gap:8px;" id="spMobile"><i data-lucide="phone" style="width:16px;height:16px;color:var(--cw-gray-400);"></i>+63 917 123 4567</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Home Phone</label><div style="font-weight:500;display:flex;align-items:center;gap:8px;" id="spHomePhone"><i data-lucide="phone" style="width:16px;height:16px;color:var(--cw-gray-400);"></i>+63 2 8123 4567</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Permanent Address</label><div style="font-weight:500;display:flex;align-items:center;gap:8px;" id="spAddress"><i data-lucide="map-pin" style="width:16px;height:16px;color:var(--cw-gray-400);"></i>123 Mabini St., Brgy. San Antonio, Quezon City</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Next of Kin -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="users" style="width:18px;height:18px;"></i> Next of Kin / Emergency Contact</h3></div>
                                <div class="card-body">
                                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Name</label><div style="font-weight:500;" id="spNokName">Maria Dela Cruz</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Relationship</label><div style="font-weight:500;" id="spNokRelation">Spouse</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Contact Number</label><div style="font-weight:500;" id="spNokPhone">+63 918 765 4321</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Email</label><div style="font-weight:500;" id="spNokEmail"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1a777b68737b347e7f767b79686f605a7f777b737634797577">[email&#160;protected]</a></div></div>
                                        <div style="grid-column:span 2;"><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Address</label><div style="font-weight:500;" id="spNokAddress">Same as permanent address</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Current Assignment -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="ship" style="width:18px;height:18px;"></i> Current Assignment</h3></div>
                                <div class="card-body" id="spCurrentAssignment">
                                    <div style="display:flex;align-items:center;gap:16px;padding:16px;background:var(--cw-gray-50);border-radius:12px;margin-bottom:16px;">
                                        <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#00495D,#0891b2);display:flex;align-items:center;justify-content:center;"><i data-lucide="ship" style="width:28px;height:28px;color:white;"></i></div>
                                        <div style="flex:1;">
                                            <div style="font-weight:600;font-size:1.1rem;" id="spVesselName">MV Diana Star</div>
                                            <div style="color:var(--cw-gray-500);font-size:0.85rem;" id="spVesselDetails">Bulk Carrier â€¢ IMO 9876543</div>
                                            <div style="color:var(--cw-gray-500);font-size:0.85rem;" id="spPrincipal">Diana Shipping</div>
                                        </div>
                                        <span class="status-badge status-embarked">Onboard</span>
                                    </div>
                                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Contract Start</label><div style="font-weight:500;" id="spContractStart">Feb 15, 2025</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Contract End</label><div style="font-weight:500;" id="spContractEnd">Aug 15, 2025</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Days Remaining</label><div style="font-weight:500;color:var(--cw-primary);" id="spDaysRemaining">156 days</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Sign-on Port</label><div style="font-weight:500;" id="spSignOnPort">Manila, Philippines</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- DOCUMENTS TAB -->
                    <div class="sp-tab-content" id="sp-content-documents" style="display:none;">
                        <div class="card">
                            <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                <h3 class="card-title"><i data-lucide="file-text" style="width:18px;height:18px;"></i> Certificates & Documents</h3>
                                <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
                                    <div style="position:relative;width:180px;">
                                        <i data-lucide="search" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--cw-gray-400);pointer-events:none;"></i>
                                        <input type="text" class="form-input" id="docSearchInput" placeholder="Search documents..." style="height:38px;padding-left:36px;" onkeyup="filterDocuments()">
                                    </div>
                                    <select class="form-select" style="width:150px;height:38px;" id="docCategoryFilter" onchange="filterDocuments()">
                                        <option value="">All Categories</option>
                                        <option value="license">Licenses</option>
                                        <option value="certificate">Certificates</option>
                                        <option value="training">Training</option>
                                        <option value="medical">Medical</option>
                                        <option value="travel">Travel</option>
                                    </select>
                                    <select class="form-select" style="width:130px;height:38px;" id="docStatusFilter" onchange="filterDocuments()">
                                        <option value="">All Status</option>
                                        <option value="valid">Valid</option>
                                        <option value="expiring">Expiring Soon</option>
                                        <option value="expired">Expired</option>
                                    </select>
                                    <button class="btn btn-primary btn-sm" onclick="openModal('addDocumentModal')"><i data-lucide="plus"></i>Add Document</button>
                                </div>
                            </div>
                            <div class="card-body" style="padding:0;">
                                <table class="data-table">
                                    <thead>
                                        <tr><th>Document</th><th>Number</th><th>Issue Date</th><th>Expiry Date</th><th>Status</th><th>Actions</th></tr>
                                    </thead>
                                    <tbody id="documentsTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SEA SERVICE TAB -->
                    <div class="sp-tab-content" id="sp-content-sea-service" style="display:none;">
                        <div class="card">
                            <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                <h3 class="card-title"><i data-lucide="anchor" style="width:18px;height:18px;"></i> Sea Service Record</h3>
                                <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                    <div style="position:relative;width:200px;">
                                        <i data-lucide="search" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--cw-gray-400);pointer-events:none;"></i>
                                        <input type="text" class="form-input" id="seaServiceSearch" placeholder="Search vessels..." style="height:38px;padding-left:36px;" onkeyup="searchSeaService()">
                                    </div>
                                    <div style="background:var(--cw-gray-100);padding:8px 16px;border-radius:8px;">
                                        <span style="color:var(--cw-gray-500);font-size:0.85rem;">Total Sea Time:</span>
                                        <strong style="color:var(--cw-primary);margin-left:8px;">12 years, 6 months</strong>
                                    </div>
                                    <button class="btn btn-primary btn-sm" onclick="openModal('addSeaServiceModal')"><i data-lucide="plus"></i>Add Record</button>
                                </div>
                            </div>
                            <div class="card-body" style="padding:0;">
                                <table class="data-table">
                                    <thead>
                                        <tr><th>Vessel</th><th>Company</th><th>Rank</th><th>Sign On</th><th>Sign Off</th><th>Duration</th><th>Actions</th></tr>
                                    </thead>
                                    <tbody id="seaServiceTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SALARY & ALLOTMENT TAB -->
                    <div class="sp-tab-content" id="sp-content-salary" style="display:none;">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                            <!-- Salary Information -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="dollar-sign" style="width:18px;height:18px;"></i> Salary Information</h3></div>
                                <div class="card-body">
                                    <div style="display:grid;gap:16px;">
                                        <div style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;">
                                            <span style="color:var(--cw-gray-600);">Basic Wage</span>
                                            <strong id="spBasicWage">$5,500.00</strong>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;">
                                            <span style="color:var(--cw-gray-600);">Fixed Overtime</span>
                                            <strong id="spFixedOT">$1,650.00</strong>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;">
                                            <span style="color:var(--cw-gray-600);">Leave Pay</span>
                                            <strong id="spLeavePay">$550.00</strong>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;">
                                            <span style="color:var(--cw-gray-600);">Subsistence</span>
                                            <strong id="spSubsistence">$300.00</strong>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;padding:16px;background:linear-gradient(135deg,#00495D,#0891b2);border-radius:8px;color:white;">
                                            <span style="font-weight:500;">Total Monthly</span>
                                            <strong style="font-size:1.25rem;" id="spTotalSalary">$8,000.00</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bank Details -->
                            <div class="card">
                                <div class="card-header"><h3 class="card-title"><i data-lucide="building" style="width:18px;height:18px;"></i> Bank Account Details</h3></div>
                                <div class="card-body">
                                    <div style="display:grid;gap:16px;">
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Bank Name</label><div style="font-weight:500;" id="spBankName">BDO Unibank</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Account Name</label><div style="font-weight:500;" id="spAccountName">Juan Santos Dela Cruz</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">Account Number</label><div style="font-weight:500;" id="spAccountNumber">â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 4567</div></div>
                                        <div><label style="font-size:0.75rem;color:var(--cw-gray-500);display:block;margin-bottom:4px;">SWIFT Code</label><div style="font-weight:500;" id="spSwiftCode">BNORPHMM</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Allotments -->
                            <div class="card" style="grid-column:span 2;">
                                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                    <h3 class="card-title"><i data-lucide="send" style="width:18px;height:18px;"></i> Allotments</h3>
                                    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                        <div style="position:relative;width:180px;">
                                            <i data-lucide="search" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--cw-gray-400);pointer-events:none;"></i>
                                            <input type="text" class="form-input" id="allotmentSearch" placeholder="Search beneficiary..." style="height:38px;padding-left:36px;" onkeyup="filterAllotments()">
                                        </div>
                                        <select class="form-select" style="width:140px;height:38px;" id="allotmentRelationFilter" onchange="filterAllotments()">
                                            <option value="">All Relations</option>
                                            <option value="Spouse">Spouse</option>
                                            <option value="Parent">Parent</option>
                                            <option value="Child">Child</option>
                                            <option value="Sibling">Sibling</option>
                                        </select>
                                        <div style="background:var(--cw-gray-100);padding:8px 16px;border-radius:8px;">
                                            <span style="color:var(--cw-gray-500);font-size:0.85rem;">Total:</span>
                                            <strong style="color:var(--cw-primary);margin-left:8px;" id="totalAllotments">$4,500.00</strong>
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="openModal('addAllotmentModal')"><i data-lucide="plus"></i>Add Allotment</button>
                                    </div>
                                </div>
                                <div class="card-body" style="padding:0;">
                                    <table class="data-table">
                                        <thead>
                                            <tr><th>Beneficiary</th><th>Relationship</th><th>Bank</th><th>Account</th><th>Amount</th><th>Actions</th></tr>
                                        </thead>
                                        <tbody id="allotmentsTableBody"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- EVALUATIONS TAB -->
                    <div class="sp-tab-content" id="sp-content-evaluations" style="display:none;">
                        <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;">
                            <!-- Evaluation History -->
                            <div class="card">
                                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                    <h3 class="card-title"><i data-lucide="star" style="width:18px;height:18px;"></i> Evaluation History</h3>
                                    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                        <div style="position:relative;width:180px;">
                                            <i data-lucide="search" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--cw-gray-400);pointer-events:none;"></i>
                                            <input type="text" class="form-input" id="evalSearch" placeholder="Search vessel..." style="height:38px;padding-left:36px;" onkeyup="filterEvaluations()">
                                        </div>
                                        <select class="form-select" style="width:140px;height:38px;" id="evalScoreFilter" onchange="filterEvaluations()">
                                            <option value="">All Scores</option>
                                            <option value="5">5.0 (Excellent)</option>
                                            <option value="4">4.0+ (Good)</option>
                                            <option value="3">3.0+ (Average)</option>
                                            <option value="2">Below 3.0</option>
                                        </select>
                                        <select class="form-select" style="width:120px;height:38px;" id="evalYearFilter" onchange="filterEvaluations()">
                                            <option value="">All Years</option>
                                            <option value="2025">2025</option>
                                            <option value="2024">2024</option>
                                            <option value="2023">2023</option>
                                            <option value="2022">2022</option>
                                            <option value="2021">2021</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card-body" style="padding:0;">
                                    <table class="data-table">
                                        <thead>
                                            <tr><th>Contract</th><th>Vessel</th><th>Evaluator</th><th>Date</th><th>Score</th><th>Actions</th></tr>
                                        </thead>
                                        <tbody id="evaluationsTableBody"></tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Score Summary -->
                            <div>
                                <div class="card" style="margin-bottom:24px;">
                                    <div class="card-header"><h3 class="card-title">Average Scores</h3></div>
                                    <div class="card-body">
                                        <div style="display:grid;gap:12px;">
                                            <div>
                                                <div style="display:flex;justify-content:space-between;margin-bottom:4px;"><span style="font-size:0.85rem;">Technical Skills</span><span style="font-weight:600;">4.8</span></div>
                                                <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div style="width:96%;height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;"></div></div>
                                            </div>
                                            <div>
                                                <div style="display:flex;justify-content:space-between;margin-bottom:4px;"><span style="font-size:0.85rem;">Leadership</span><span style="font-weight:600;">4.6</span></div>
                                                <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div style="width:92%;height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;"></div></div>
                                            </div>
                                            <div>
                                                <div style="display:flex;justify-content:space-between;margin-bottom:4px;"><span style="font-size:0.85rem;">Safety Awareness</span><span style="font-weight:600;">4.9</span></div>
                                                <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div style="width:98%;height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;"></div></div>
                                            </div>
                                            <div>
                                                <div style="display:flex;justify-content:space-between;margin-bottom:4px;"><span style="font-size:0.85rem;">Communication</span><span style="font-weight:600;">4.5</span></div>
                                                <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div style="width:90%;height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;"></div></div>
                                            </div>
                                            <div>
                                                <div style="display:flex;justify-content:space-between;margin-bottom:4px;"><span style="font-size:0.85rem;">Teamwork</span><span style="font-weight:600;">4.7</span></div>
                                                <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div style="width:94%;height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;"></div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-header"><h3 class="card-title">Overall Rating</h3></div>
                                    <div class="card-body" style="text-align:center;">
                                        <div style="font-size:4rem;font-weight:700;color:var(--cw-primary);">4.7</div>
                                        <div style="display:flex;justify-content:center;gap:4px;margin:8px 0;">
                                            <i data-lucide="star" style="width:24px;height:24px;fill:#f59e0b;color:#f59e0b;"></i>
                                            <i data-lucide="star" style="width:24px;height:24px;fill:#f59e0b;color:#f59e0b;"></i>
                                            <i data-lucide="star" style="width:24px;height:24px;fill:#f59e0b;color:#f59e0b;"></i>
                                            <i data-lucide="star" style="width:24px;height:24px;fill:#f59e0b;color:#f59e0b;"></i>
                                            <i data-lucide="star" style="width:24px;height:24px;color:#f59e0b;"></i>
                                        </div>
                                        <div style="color:var(--cw-gray-500);font-size:0.9rem;">Based on 18 evaluations</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- NOTES & TIMELINE TAB -->
                    <div class="sp-tab-content" id="sp-content-notes" style="display:none;">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                            <!-- Notes -->
                            <div class="card">
                                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                    <h3 class="card-title"><i data-lucide="message-square" style="width:18px;height:18px;"></i> Notes</h3>
                                    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                        <div style="position:relative;width:160px;">
                                            <i data-lucide="search" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--cw-gray-400);pointer-events:none;"></i>
                                            <input type="text" class="form-input" id="notesSearch" placeholder="Search notes..." style="height:38px;padding-left:36px;" onkeyup="filterNotes()">
                                        </div>
                                        <select class="form-select" style="width:130px;height:38px;" id="notesTypeFilter" onchange="filterNotes()">
                                            <option value="">All Types</option>
                                            <option value="info">Information</option>
                                            <option value="positive">Positive</option>
                                            <option value="warning">Warning</option>
                                            <option value="reminder">Reminder</option>
                                        </select>
                                        <button class="btn btn-primary btn-sm" onclick="openModal('addNoteModal')"><i data-lucide="plus"></i>Add Note</button>
                                    </div>
                                </div>
                                <div class="card-body" id="notesContainer" style="max-height:500px;overflow-y:auto;"></div>
                            </div>
                            
                            <!-- Timeline -->
                            <div class="card">
                                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
                                    <h3 class="card-title"><i data-lucide="clock" style="width:18px;height:18px;"></i> Activity Timeline</h3>
                                    <div style="display:flex;gap:12px;align-items:center;">
                                        <select class="form-select" style="width:140px;height:38px;" id="timelineTypeFilter" onchange="filterTimeline()">
                                            <option value="">All Events</option>
                                            <option value="embark">Embarkation</option>
                                            <option value="signoff">Sign-off</option>
                                            <option value="contract">Contract</option>
                                            <option value="medical">Medical</option>
                                            <option value="evaluation">Evaluation</option>
                                        </select>
                                        <select class="form-select" style="width:110px;height:38px;" id="timelineYearFilter" onchange="filterTimeline()">
                                            <option value="">All Years</option>
                                            <option value="2025">2025</option>
                                            <option value="2024">2024</option>
                                            <option value="2023">2023</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card-body" id="timelineContainer" style="max-height:500px;overflow-y:auto;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    
    
    <!-- Public Registration Modal -->
    <div class="modal-overlay" id="publicRegistrationModal" onclick="closeModalOnOverlay(event,'publicRegistrationModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:white;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:56px;height:56px;border-radius:12px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;">
                        <i data-lucide="link" style="width:28px;height:28px;"></i>
                    </div>
                    <div>
                        <h3 style="margin:0;">Public Registration</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Self-service candidate registration</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('publicRegistrationModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <!-- URL Section -->
                <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:24px;">
                    <h4 style="margin:0 0 12px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;">Public Registration URL</h4>
                    <div style="display:flex;align-items:center;gap:12px;">
                        <input type="text" id="publicRegURL" value="https://crossworld-marine.com/register" readonly style="flex:1;padding:12px;border:1px solid var(--cw-gray-300);border-radius:8px;font-family:monospace;background:white;">
                        <button class="btn btn-primary" onclick="copyPublicRegURL()" style="white-space:nowrap;">
                            <i data-lucide="copy"></i>Copy
                        </button>
                    </div>
                    <p style="margin:12px 0 0;font-size:0.85rem;color:var(--cw-gray-500);">
                        Share this link with candidates for self-service registration.
                    </p>
                </div>

                <!-- Stats Grid -->
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px;">
                    <div style="background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;padding:20px;text-align:center;color:white;">
                        <div style="font-size:2rem;font-weight:700;">247</div>
                        <div style="font-size:0.75rem;opacity:0.9;margin-top:4px;">Total Registered</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:12px;padding:20px;text-align:center;color:white;">
                        <div style="font-size:2rem;font-weight:700;">42</div>
                        <div style="font-size:0.75rem;opacity:0.9;margin-top:4px;">This Month</div>
                    </div>
                    <div style="background:linear-gradient(135deg,#f59e0b,#d97706);border-radius:12px;padding:20px;text-align:center;color:white;">
                        <div style="font-size:2rem;font-weight:700;">68%</div>
                        <div style="font-size:0.75rem;opacity:0.9;margin-top:4px;">Conversion Rate</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                    <button class="btn btn-secondary" onclick="openPublicRegPage()">
                        <i data-lucide="external-link"></i>Open Page
                    </button>
                    <button class="btn btn-secondary" onclick="shareViaEmail()">
                        <i data-lucide="mail"></i>Email Link
                    </button>
                    <button class="btn btn-secondary" onclick="generateQRCode()">
                        <i data-lucide="qr-code"></i>QR Code
                    </button>
                    <button class="btn btn-secondary" onclick="viewRegistrations()">
                        <i data-lucide="users"></i>View List
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('publicRegistrationModal')">Close</button>
                <button class="btn btn-primary" onclick="copyPublicRegURL()">
                    <i data-lucide="copy"></i>Copy Link
                </button>
            </div>
        </div>
    </div>

    <!-- Candidate Detail Modal -->
    <div class="modal-overlay" id="candidateDetailModal" onclick="closeModalOnOverlay(event,'candidateDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div id="candidateModalAvatar" style="width:56px;height:56px;border-radius:12px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:700;">MT</div>
                    <div>
                        <h3 id="candidateModalName" style="margin:0;">Miguel Torres</h3>
                        <p id="candidateModalRank" style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">2nd Engineer â€¢ CAND-002</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('candidateDetailModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" id="candidateModalBody" style="padding:24px;max-height:70vh;overflow-y:auto;">
                <!-- Content will be injected by JavaScript -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('candidateDetailModal')"><i data-lucide="x"></i>Close</button>
                <button class="btn btn-primary" onclick="editCandidateFromModal()"><i data-lucide="edit-3"></i>Edit Profile</button>
            </div>
        </div>
    </div>

<!-- Sea Service Detail Modal -->
    <div class="modal-overlay" id="seaServiceModal" onclick="closeModalOnOverlay(event,'seaServiceModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div id="seaServiceAvatar" style="width:56px;height:56px;border-radius:12px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:700;">MP</div>
                    <div>
                        <h3 id="seaServiceVesselName" style="margin:0;">MV Pacific Voyager</h3>
                        <p id="seaServiceRankCompany" style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Chief Officer - Diana Shipping</p>
                        <span id="seaServiceStatusBadge" style="display:inline-block;margin-top:8px;padding:4px 12px;background:rgba(255,255,255,0.2);border-radius:6px;font-size:0.75rem;font-weight:600;color:white;">COMPLETED</span>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('seaServiceModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div id="seaServiceStats" style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:24px;">
                    <!-- Will be filled by JS -->
                </div>
                <div id="seaServiceContent">
                    <!-- Will be filled by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('seaServiceModal')"><i data-lucide="x"></i>Close</button>
                <button class="btn btn-primary" onclick="editSeaServiceFromModal()"><i data-lucide="edit-3"></i>Edit Profile</button>
            </div>
        </div>
    </div>


    <!-- RFC Detail Modal -->
    <div class="modal-overlay" id="rfcDetailModal" onclick="closeModalOnOverlay(event,'rfcDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:900px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;">
                <div>
                    <h3 id="rfcModalTitle" style="margin:0;">RFC-2025-042</h3>
                    <p id="rfcModalSubtitle" style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Created 2025-02-01</p>
                </div>
                <button class="modal-close" onclick="closeModal('rfcDetailModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" id="rfcModalBody" style="overflow-y:auto;flex:1;padding:24px;">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('rfcDetailModal')">Close</button>
                <button class="btn btn-primary" onclick="navigateTo('view-candidates');closeModal('rfcDetailModal');"><i data-lucide="user-plus"></i>Add Candidate</button>
            </div>
        </div>
    </div>

<!-- SLIDE PANELS -->
    <div class="panel-overlay" id="rfaPanelOverlay" onclick="closePanel('rfaPanel')"></div>
    <div class="slide-panel large" id="rfaPanel">
        <div class="panel-header"><h3 class="panel-title">RFA Details</h3><button class="panel-close" onclick="closePanel('rfaPanel')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
        <div class="panel-content" id="rfaPanelContent"></div>
        <div class="panel-footer">
            <button class="btn btn-secondary" onclick="cancelRfa()"><i data-lucide="x"></i>Cancel RFA</button>
            <button class="btn btn-secondary" onclick="printRfa()"><i data-lucide="printer"></i>Print</button>
            <button class="btn btn-primary" onclick="openUpdateRfaStatusModal()"><i data-lucide="refresh-cw"></i>Update Status</button>
        </div>
    </div>

    <!-- MODALS -->
    <div class="modal-overlay" id="addSeafarerModal" onclick="closeModalOnOverlay(event,'addSeafarerModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add New Seafarer</h3><button class="modal-close" onclick="closeModal('addSeafarerModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <form id="addSeafarerForm">
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">First Name <span class="required">*</span></label><input type="text" class="form-input" placeholder="Enter first name" required></div>
                        <div class="form-group"><label class="form-label">Last Name <span class="required">*</span></label><input type="text" class="form-input" placeholder="Enter last name" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Rank <span class="required">*</span></label><select class="form-select" required><option value="">Select rank...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option></optgroup><optgroup label="Ratings"><option>Bosun</option><option>AB Seaman</option><option>OS Seaman</option><option>Oiler</option><option>Cook</option></optgroup></select></div>
                        <div class="form-group"><label class="form-label">Pool Type <span class="required">*</span></label><select class="form-select" required><option value="">Select pool type...</option><option value="dedicated">Dedicated</option><option value="non-dedicated">Non-Dedicated</option></select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" placeholder="Enter email address"></div>
                        <div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" placeholder="Enter phone number"></div>
                    </div>
                    <div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" placeholder="Additional notes..."></textarea></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('addSeafarerModal')">Cancel</button><button class="btn btn-primary"><i data-lucide="plus"></i>Add Seafarer</button></div>
        </div>
    </div>

    <!-- ADD SUPERNUMERARY MODAL -->
    <div class="modal-overlay" id="addSupernumeraryModal" onclick="closeModalOnOverlay(event,'addSupernumeraryModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Add New Supernumerary Personnel</h3>
                <button class="modal-close" onclick="closeModal('addSupernumeraryModal')">
                    <i data-lucide="x" style="width:20px;height:20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addSupernumeraryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Full Name <span class="required">*</span></label>
                            <input type="text" class="form-input" id="newSupName" placeholder="Enter full name" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category <span class="required">*</span></label>
                            <select class="form-select" id="newSupCategory" required>
                                <option value="">Select category...</option>
                                <option value="inspector">Flag State Inspector</option>
                                <option value="observer">Port State Observer</option>
                                <option value="superintendent">Technical Superintendent</option>
                                <option value="auditor">Safety Auditor</option>
                                <option value="trainer">Training Officer</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Email <span class="required">*</span></label>
                            <input type="email" class="form-input" id="newSupEmail" placeholder="Enter email address" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone</label>
                            <input type="tel" class="form-input" id="newSupPhone" placeholder="Enter phone number">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Company</label>
                            <input type="text" class="form-input" id="newSupCompany" placeholder="Enter company name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nationality</label>
                            <input type="text" class="form-input" id="newSupNationality" placeholder="Enter nationality">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vessel</label>
                            <input type="text" class="form-input" id="newSupVessel" placeholder="Enter vessel name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Port</label>
                            <input type="text" class="form-input" id="newSupPort" placeholder="Enter port name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Purpose</label>
                        <input type="text" class="form-input" id="newSupPurpose" placeholder="Enter assignment purpose">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" id="newSupRemarks" placeholder="Additional notes..." rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addSupernumeraryModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveNewSupernumerary()">
                    <i data-lucide="plus"></i>Add Supernumerary
                </button>
            </div>
        </div>
    </div>

    <!-- CREW CHANGE DETAIL MODAL -->
    <div class="modal-overlay" id="crewChangeDetailModal" onclick="closeModalOnOverlay(event,'crewChangeDetailModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="border-bottom:none;padding-bottom:0;">
                <h3 class="modal-title">Crew Change Details</h3>
                <button class="modal-close" onclick="closeModal('crewChangeDetailModal')">
                    <i data-lucide="x" style="width:20px;height:20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="crewChangeDetailContent" style="display:grid;gap:24px;">
                    <!-- Content will be filled by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('crewChangeDetailModal')">Close</button>
                <button class="btn btn-primary" onclick="editCrewChange()">
                    <i data-lucide="edit"></i>Edit Details
                </button>
            </div>
        </div>
    </div>

    <!-- EDIT CREW CHANGE MODAL -->
    <div class="modal-overlay" id="editCrewChangeModal" onclick="closeModalOnOverlay(event,'editCrewChangeModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Edit Crew Change</h3>
                <button class="modal-close" onclick="closeModal('editCrewChangeModal')">
                    <i data-lucide="x" style="width:20px;height:20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editCrewChangeForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Crew Member Name</label>
                            <input type="text" class="form-input" id="editCcName" readonly style="background:var(--cw-gray-50);">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Rank</label>
                            <input type="text" class="form-input" id="editCcRank" readonly style="background:var(--cw-gray-50);">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vessel</label>
                            <input type="text" class="form-input" id="editCcVessel">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Port</label>
                            <select class="form-select" id="editCcPort">
                                <option value="Piraeus">Piraeus</option>
                                <option value="Singapore">Singapore</option>
                                <option value="Rotterdam">Rotterdam</option>
                                <option value="Dubai">Dubai</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Date</label>
                            <input type="date" class="form-input" id="editCcDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="editCcStatus">
                                <option value="planning">Planning</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editCrewChangeModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveCrewChangeEdit()">
                    <i data-lucide="save"></i>Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- ALERT DETAIL MODAL -->
    <div class="modal-overlay" id="alertDetailModal" onclick="closeModalOnOverlay(event,'alertDetailModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header">
                <h3 class="modal-title" id="alertModalTitle">Alert Details</h3>
                <button class="modal-close" onclick="closeModal('alertDetailModal')">
                    <i data-lucide="x" style="width:20px;height:20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="alertDetailContent" style="display:grid;gap:20px;">
                    <!-- Content filled by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('alertDetailModal')">Close</button>
                <button class="btn btn-primary" onclick="openTakeActionModal()">
                    <i data-lucide="check"></i>Take Action
                </button>
            </div>
        </div>
    </div>

    <!-- TAKE ACTION MODAL -->
    <div class="modal-overlay" id="takeActionModal" onclick="closeModalOnOverlay(event,'takeActionModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Take Action on Alert</h3>
                <button class="modal-close" onclick="closeModal('takeActionModal')">
                    <i data-lucide="x" style="width:20px;height:20px;"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="takeActionForm">
                    <div class="form-group">
                        <label class="form-label">Action Type <span class="required">*</span></label>
                        <select class="form-select" id="actionType" required>
                            <option value="">Select action type...</option>
                            <option value="followup">Follow-up</option>
                            <option value="escalate">Escalate</option>
                            <option value="resolve">Mark as Resolved</option>
                            <option value="defer">Defer</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Assigned To</label>
                        <select class="form-select" id="actionAssignee">
                            <option value="">Select team member...</option>
                            <option value="fleet-manager">Fleet Manager</option>
                            <option value="crew-manager">Crew Manager</option>
                            <option value="travel-coordinator">Travel Coordinator</option>
                            <option value="operations-director">Operations Director</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <select class="form-select" id="actionPriority">
                            <option value="urgent">Urgent</option>
                            <option value="high">High</option>
                            <option value="normal" selected>Normal</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="date" class="form-input" id="actionDueDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes <span class="required">*</span></label>
                        <textarea class="form-textarea" id="actionNotes" placeholder="Enter action notes, follow-up details, or resolution comments..." rows="4" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('takeActionModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitAlertAction()">
                    <i data-lucide="send"></i>Submit Action
                </button>
            </div>
        </div>
    </div>

    <!-- SUPERNUMERARY DETAIL MODAL -->
    <div class="modal-overlay" id="supernumeraryDetailModal" onclick="closeModalOnOverlay(event,'supernumeraryDetailModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:900px;">
            <!-- Gradient Header -->
            <div style="background:linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);padding:32px;border-radius:12px 12px 0 0;color:white;position:relative;">
                <button class="modal-close" onclick="closeModal('supernumeraryDetailModal')" style="position:absolute;top:16px;right:16px;background:rgba(255,255,255,0.2);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;">
                    <i data-lucide="x" style="width:18px;height:18px;color:white;"></i>
                </button>
                <div style="display:flex;align-items:center;gap:20px;">
                    <div id="supModalAvatar" style="width:80px;height:80px;border-radius:50%;background:rgba(255,255,255,0.3);display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;color:white;"></div>
                    <div>
                        <h2 id="supModalName" style="margin:0 0 8px 0;font-size:1.75rem;font-weight:700;color:white;"></h2>
                        <div id="supModalCategory" style="font-size:1rem;color:rgba(255,255,255,0.9);margin-bottom:16px;"></div>
                        <div style="display:flex;gap:12px;">
                            <span id="supModalStatusBadge" style="display:inline-block;padding:6px 16px;border-radius:16px;font-size:0.85rem;font-weight:600;background:rgba(255,255,255,0.25);"></span>
                            <span id="supModalDurationBadge" style="display:inline-block;padding:6px 16px;border-radius:16px;font-size:0.85rem;font-weight:600;background:rgba(255,255,255,0.25);"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Body -->
            <div class="modal-body" style="padding:32px;">
                <div style="display:grid;grid-template-columns:1fr 400px;gap:32px;">
                    <!-- Left Column -->
                    <div>
                        <!-- Personal Details -->
                        <div style="background:white;border:1px solid var(--cw-gray-200);border-radius:12px;padding:24px;margin-bottom:24px;">
                            <h3 style="display:flex;align-items:center;gap:12px;margin:0 0 20px 0;font-size:1.1rem;font-weight:600;color:var(--cw-gray-900);">
                                <i data-lucide="user" style="width:20px;height:20px;"></i>
                                Personal Details
                            </h3>
                            <div style="display:grid;gap:16px;">
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">ID:</span>
                                    <span id="supModalId" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Nationality:</span>
                                    <span id="supModalNationality" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Company:</span>
                                    <span id="supModalCompany" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Email:</span>
                                    <span id="supModalEmail" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;">
                                    <span style="color:var(--cw-gray-600);">Phone:</span>
                                    <span id="supModalPhone" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Current Assignment -->
                        <div style="background:white;border:1px solid var(--cw-gray-200);border-radius:12px;padding:24px;margin-bottom:24px;">
                            <h3 style="display:flex;align-items:center;gap:12px;margin:0 0 20px 0;font-size:1.1rem;font-weight:600;color:var(--cw-gray-900);">
                                <i data-lucide="ship" style="width:20px;height:20px;"></i>
                                Current Assignment
                            </h3>
                            <div style="display:grid;gap:16px;">
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Vessel:</span>
                                    <span id="supModalVessel" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Port:</span>
                                    <span id="supModalPort" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Embark Date:</span>
                                    <span id="supModalEmbarkDate" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);">
                                    <span style="color:var(--cw-gray-600);">Disembark Date:</span>
                                    <span id="supModalDisembarkDate" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                                <div style="display:flex;justify-content:space-between;padding:12px 0;">
                                    <span style="color:var(--cw-gray-600);">Purpose:</span>
                                    <span id="supModalPurpose" style="font-weight:600;color:var(--cw-gray-900);"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Notes -->
                        <div id="supModalNotesSection" style="background:#fef3c7;border:2px solid #fbbf24;border-radius:12px;padding:20px;">
                            <h3 style="display:flex;align-items:center;gap:12px;margin:0 0 12px 0;font-size:1rem;font-weight:600;color:#92400e;">
                                <i data-lucide="file-text" style="width:18px;height:18px;color:#f59e0b;"></i>
                                Notes
                            </h3>
                            <p id="supModalNotes" style="margin:0;color:#78350f;line-height:1.6;"></p>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div>
                        <!-- Quick Actions -->
                        <div style="background:white;border:1px solid var(--cw-gray-200);border-radius:12px;padding:20px;margin-bottom:24px;">
                            <h3 style="margin:0 0 16px 0;font-size:1rem;font-weight:600;color:var(--cw-gray-900);">Quick Actions</h3>
                            <div style="display:flex;flex-direction:column;gap:12px;">
                                <button class="btn btn-primary" style="width:100%;justify-content:center;" onclick="editSupernumeraryDetails()">
                                    <i data-lucide="edit" style="width:18px;height:18px;"></i>
                                    Edit Details
                                </button>
                                <button class="btn btn-secondary" style="width:100%;justify-content:center;background:white;border:1px solid var(--cw-gray-300);" onclick="sendSupernumeraryEmail()">
                                    <i data-lucide="mail" style="width:18px;height:18px;"></i>
                                    Send Email
                                </button>
                                <button class="btn btn-secondary" style="width:100%;justify-content:center;background:white;border:1px solid var(--cw-gray-300);" onclick="viewSupernumeraryDocuments()">
                                    <i data-lucide="folder" style="width:18px;height:18px;"></i>
                                    Documents
                                </button>
                            </div>
                        </div>

                        <!-- Timeline -->
                        <div style="background:linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);border:2px solid #0ea5e9;border-radius:12px;padding:20px;">
                            <h3 style="display:flex;align-items:center;gap:12px;margin:0 0 20px 0;font-size:1rem;font-weight:600;color:var(--cw-primary);">
                                <i data-lucide="clock" style="width:18px;height:18px;"></i>
                                Timeline
                            </h3>
                            <div style="display:flex;flex-direction:column;gap:20px;">
                                <div style="display:flex;align-items:start;gap:12px;">
                                    <div style="width:24px;height:24px;border-radius:50%;background:#10b981;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
                                        <i data-lucide="check" style="width:14px;height:14px;color:white;"></i>
                                    </div>
                                    <div style="flex:1;">
                                        <div style="font-weight:600;color:var(--cw-gray-900);margin-bottom:4px;">Created</div>
                                        <div id="supModalCreatedDate" style="font-size:0.85rem;color:var(--cw-gray-600);"></div>
                                    </div>
                                </div>
                                <div style="display:flex;align-items:start;gap:12px;">
                                    <div style="width:24px;height:24px;border-radius:50%;background:#10b981;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
                                        <i data-lucide="check" style="width:14px;height:14px;color:white;"></i>
                                    </div>
                                    <div style="flex:1;">
                                        <div style="font-weight:600;color:var(--cw-gray-900);margin-bottom:4px;">Approved</div>
                                        <div id="supModalApprovedDate" style="font-size:0.85rem;color:var(--cw-gray-600);"></div>
                                    </div>
                                </div>
                                <div id="supModalEmbarkedTimeline" style="display:flex;align-items:start;gap:12px;">
                                    <div style="width:24px;height:24px;border-radius:50%;background:#10b981;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
                                        <i data-lucide="check" style="width:14px;height:14px;color:white;"></i>
                                    </div>
                                    <div style="flex:1;">
                                        <div style="font-weight:600;color:var(--cw-gray-900);margin-bottom:4px;">Embarked</div>
                                        <div id="supModalEmbarkedDate" style="font-size:0.85rem;color:var(--cw-gray-600);"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="newRfaModal" onclick="closeModalOnOverlay(event,'newRfaModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Create New RFA</h3><button class="modal-close" onclick="closeModal('newRfaModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <form id="newRfaForm">
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">RFA Type <span class="required">*</span></label><select class="form-select" required><option value="">Select type...</option><option value="embark">Embark</option><option value="signoff">Sign-off</option><option value="promotion">Promotion</option><option value="extension">Extension</option><option value="replace">Replace</option></select></div>
                        <div class="form-group"><label class="form-label">Priority</label><select class="form-select"><option value="normal">Normal</option><option value="high">High</option><option value="urgent">Urgent</option><option value="low">Low</option></select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Vessel <span class="required">*</span></label><select class="form-select" required><option value="">Select vessel...</option><option>MV Diana Star</option><option>MV Centrofin Glory</option><option>MV Pioneer Spirit</option><option>MV Neda Harmony</option></select></div>
                        <div class="form-group"><label class="form-label">Position <span class="required">*</span></label><select class="form-select" required><option value="">Select position...</option><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>Chief Engineer</option><option>Bosun</option><option>AB Seaman</option></select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label class="form-label">Target Date <span class="required">*</span></label><input type="date" class="form-input" required></div>
                        <div class="form-group"><label class="form-label">Seafarer (if known)</label><select class="form-select"><option value="">Select from pool...</option><option>Juan Dela Cruz</option><option>Mario Reyes</option><option>Antonio Santos</option></select></div>
                    </div>
                    <div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" placeholder="Additional requirements or notes..."></textarea></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('newRfaModal')">Cancel</button><button class="btn btn-primary" onclick="saveNewRfa()"><i data-lucide="plus"></i>Create RFA</button></div>
        </div>
    </div>

    <!-- Update RFA Status Modal -->
    <div class="modal-overlay" id="updateRfaStatusModal" onclick="closeModalOnOverlay(event,'updateRfaStatusModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:500px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;">
                <div style="display:flex;align-items:center;gap:12px;">
                    <i data-lucide="refresh-cw" style="width:24px;height:24px;"></i>
                    <div>
                        <h3 style="margin:0;">Update RFA Status</h3>
                        <p style="margin:4px 0 0;opacity:0.8;font-size:0.9rem;" id="updateRfaId">RFA-2025-0144</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('updateRfaStatusModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div class="form-group">
                    <label class="form-label">Current Status</label>
                    <div id="currentRfaStatus" style="background:var(--cw-gray-100);padding:12px;border-radius:8px;font-weight:600;display:flex;align-items:center;gap:8px;">
                        <span class="status-dot" style="background:#10b981;"></span>New
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">New Status *</label>
                    <select class="form-select" id="newRfaStatus" required>
                        <option value="">Select new status...</option>
                        <option value="new">ðŸ”µ New</option>
                        <option value="in-progress">ðŸŸ  In Progress</option>
                        <option value="pending-approval">ðŸŸ¡ Pending Approval</option>
                        <option value="in-preparation">ðŸ“‹ In Preparation</option>
                        <option value="ready">âœ… Ready</option>
                        <option value="approved">âœ… Approved</option>
                        <option value="completed">ðŸ Completed</option>
                        <option value="cancelled">âŒ Cancelled</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-textarea" id="rfaStatusNotes" rows="3" placeholder="Add notes about this status change..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('updateRfaStatusModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveRfaStatus()"><i data-lucide="check"></i>Update Status</button>
            </div>
        </div>
    </div>

    <!-- Assign Seafarer to RFA Modal -->
    <div class="modal-overlay" id="assignSeafarerRfaModal" onclick="closeModalOnOverlay(event,'assignSeafarerRfaModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#8b5cf6 0%,#a78bfa 100%);color:white;">
                <div style="display:flex;align-items:center;gap:12px;">
                    <i data-lucide="user-plus" style="width:24px;height:24px;"></i>
                    <div>
                        <h3 style="margin:0;">Assign Seafarer</h3>
                        <p style="margin:4px 0 0;opacity:0.8;font-size:0.9rem;" id="assignRfaId">RFA-2025-0144</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('assignSeafarerRfaModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;margin-bottom:20px;">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                        <div><span style="font-size:0.8rem;color:var(--cw-gray-500);">Position Required</span><div style="font-weight:600;" id="assignRfaPosition">AB Seaman</div></div>
                        <div><span style="font-size:0.8rem;color:var(--cw-gray-500);">Vessel</span><div style="font-weight:600;" id="assignRfaVessel">MV Pioneer Spirit</div></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Select Seafarer from Pool *</label>
                    <select class="form-select" id="assignSeafarerSelect" required>
                        <option value="">Choose a seafarer...</option>
                        <optgroup label="Available - AB Seaman">
                            <option value="Roberto Garcia">Roberto Garcia - AB Seaman (Available)</option>
                            <option value="Fernando Bautista">Fernando Bautista - AB Seaman (Available)</option>
                            <option value="Miguel Torres">Miguel Torres - AB Seaman (On Leave)</option>
                        </optgroup>
                        <optgroup label="Other Ranks (Require approval)">
                            <option value="Juan Dela Cruz">Juan Dela Cruz - Chief Officer</option>
                            <option value="Mario Reyes">Mario Reyes - 2nd Engineer</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Assignment Notes</label>
                    <textarea class="form-textarea" id="assignSeafarerNotes" rows="2" placeholder="Any special notes for this assignment..."></textarea>
                </div>
                <div style="background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.3);border-radius:8px;padding:12px;display:flex;align-items:start;gap:10px;">
                    <i data-lucide="info" style="width:20px;height:20px;color:#f59e0b;flex-shrink:0;margin-top:2px;"></i>
                    <span style="font-size:0.9rem;color:#92400e;">Selected seafarer will be notified and their status will be updated to "Assigned".</span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('assignSeafarerRfaModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="confirmAssignSeafarer()"><i data-lucide="user-check"></i>Assign Seafarer</button>
            </div>
        </div>
    </div>

    <!-- Cancel RFA Confirmation Modal -->
    <div class="modal-overlay" id="cancelRfaModal" onclick="closeModalOnOverlay(event,'cancelRfaModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:450px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#dc2626 0%,#ef4444 100%);color:white;">
                <div style="display:flex;align-items:center;gap:12px;">
                    <i data-lucide="alert-triangle" style="width:24px;height:24px;"></i>
                    <div>
                        <h3 style="margin:0;">Cancel RFA</h3>
                        <p style="margin:4px 0 0;opacity:0.8;font-size:0.9rem;" id="cancelRfaId">RFA-2025-0144</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('cancelRfaModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div style="text-align:center;margin-bottom:20px;">
                    <div style="width:64px;height:64px;margin:0 auto 16px;border-radius:50%;background:#fef2f2;display:flex;align-items:center;justify-content:center;">
                        <i data-lucide="x-circle" style="width:32px;height:32px;color:#dc2626;"></i>
                    </div>
                    <p style="margin:0;color:var(--cw-gray-700);">Are you sure you want to cancel this RFA?</p>
                    <p style="margin:8px 0 0;font-size:0.9rem;color:var(--cw-gray-500);">This action cannot be undone.</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Cancellation Reason *</label>
                    <select class="form-select" id="cancelRfaReason" required>
                        <option value="">Select reason...</option>
                        <option value="vessel-delay">Vessel Delay</option>
                        <option value="principal-request">Principal Request</option>
                        <option value="seafarer-unavailable">Seafarer Unavailable</option>
                        <option value="duplicate">Duplicate Request</option>
                        <option value="budget">Budget Constraints</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-textarea" id="cancelRfaNotes" rows="2" placeholder="Provide additional details..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('cancelRfaModal')"><i data-lucide="arrow-left"></i>Go Back</button>
                <button class="btn" onclick="confirmCancelRfa()" style="background:#dc2626;color:white;"><i data-lucide="x"></i>Cancel RFA</button>
            </div>
        </div>
    </div>

    <!-- Vessel Detail Modal (Full Screen) -->
    <div class="modal-overlay" id="vesselDetailModal" onclick="closeModalOnOverlay(event,'vesselDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:1100px;width:95%;">
            <!-- Header -->
            <div class="modal-header" id="vesselDetailHeader" style="background:linear-gradient(135deg,#0369a1 0%,#0ea5e9 100%);color:white;padding:28px 32px;">
                <div style="display:flex;align-items:center;gap:20px;flex:1;">
                    <div id="vesselDetailIcon" style="width:72px;height:72px;border-radius:16px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="ship" style="width:36px;height:36px;"></i></div>
                    <div style="flex:1;">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <h3 style="margin:0;font-size:1.75rem;font-weight:700;" id="vesselDetailName">MV Diana Star</h3>
                            <span id="vesselDetailStatus" style="background:rgba(16,185,129,0.3);padding:6px 14px;border-radius:20px;font-size:0.85rem;font-weight:600;display:flex;align-items:center;gap:6px;"><span style="width:8px;height:8px;border-radius:50%;background:#10b981;"></span>Active</span>
                        </div>
                        <p style="margin:8px 0 0;opacity:0.9;font-size:1.1rem;" id="vesselDetailType">Bulk Carrier â€¢ 82,000 DWT</p>
                        <div style="margin-top:12px;display:flex;gap:12px;">
                            <span id="vesselDetailPrincipal" style="background:rgba(255,255,255,0.15);padding:6px 14px;border-radius:8px;font-size:0.9rem;display:flex;align-items:center;gap:6px;"><i data-lucide="building-2" style="width:14px;height:14px;"></i>Diana Shipping</span>
                        </div>
                    </div>
                    <div style="display:flex;gap:12px;">
                        <div style="text-align:center;background:rgba(255,255,255,0.15);padding:16px 24px;border-radius:12px;">
                            <div style="font-size:2rem;font-weight:700;" id="vesselDetailCrewCount">4</div>
                            <div style="font-size:0.8rem;opacity:0.8;">Crew</div>
                        </div>
                        <div style="text-align:center;background:rgba(239,68,68,0.3);padding:16px 24px;border-radius:12px;">
                            <div style="font-size:2rem;font-weight:700;" id="vesselDetailVacancies">1</div>
                            <div style="font-size:0.8rem;opacity:0.8;">Vacancies</div>
                        </div>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('vesselDetailModal')" style="color:white;opacity:0.8;position:absolute;top:20px;right:20px;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
            </div>
            
            <div class="modal-body" style="padding:0;max-height:65vh;overflow-y:auto;">
                <!-- Vessel Info Bar -->
                <div style="background:var(--cw-gray-50);padding:20px 32px;border-bottom:1px solid var(--cw-gray-200);">
                    <div style="display:flex;gap:40px;flex-wrap:wrap;">
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="hash" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">IMO Number</div><div style="font-weight:600;font-family:monospace;" id="vesselDetailIMO">9876543</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="flag" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Flag State</div><div style="font-weight:600;" id="vesselDetailFlag">Panama</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="calendar" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Built</div><div style="font-weight:600;" id="vesselDetailBuilt">2018</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="weight" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">DWT</div><div style="font-weight:600;" id="vesselDetailDWT">82,000</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="box" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Type</div><div style="font-weight:600;" id="vesselDetailTypeShort">Bulk Carrier</div></div></div>
                    </div>
                </div>
                
                <!-- Crew Section -->
                <div style="padding:24px 32px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h4 style="margin:0;display:flex;align-items:center;gap:10px;"><i data-lucide="users" style="width:22px;height:22px;color:var(--cw-primary);"></i>Crew Onboard</h4>
                        <button class="btn btn-primary btn-sm" onclick="createRfaForVessel()"><i data-lucide="plus"></i>Create RFA</button>
                    </div>
                    
                    <div id="vesselCrewTable" style="background:white;border-radius:12px;border:1px solid var(--cw-gray-200);overflow:hidden;">
                        <table style="width:100%;border-collapse:collapse;">
                            <thead>
                                <tr style="background:var(--cw-gray-50);">
                                    <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Crew Member</th>
                                    <th style="padding:14px 16px;text-align:left;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Rank</th>
                                    <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Contract Start</th>
                                    <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Contract End</th>
                                    <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Status</th>
                                    <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Relief</th>
                                    <th style="padding:14px 16px;text-align:center;font-weight:600;font-size:0.8rem;text-transform:uppercase;color:var(--cw-gray-500);">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="vesselCrewTableBody">
                                <!-- Rendered by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Quick Stats -->
                <div style="padding:0 32px 24px;">
                    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;">
                        <div style="background:linear-gradient(135deg,#ecfdf5,#d1fae5);border-radius:12px;padding:20px;border:1px solid #a7f3d0;">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;"><i data-lucide="check-circle" style="width:20px;height:20px;color:#10b981;"></i><span style="font-weight:600;color:#065f46;">Onboard</span></div>
                            <div style="font-size:1.75rem;font-weight:700;color:#059669;" id="vesselStatOnboard">3</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#fef3c7,#fde68a);border-radius:12px;padding:20px;border:1px solid #fcd34d;">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;"><i data-lucide="clock" style="width:20px;height:20px;color:#f59e0b;"></i><span style="font-weight:600;color:#92400e;">Expiring</span></div>
                            <div style="font-size:1.75rem;font-weight:700;color:#d97706;" id="vesselStatExpiring">1</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#fef2f2,#fee2e2);border-radius:12px;padding:20px;border:1px solid #fecaca;">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;"><i data-lucide="user-x" style="width:20px;height:20px;color:#ef4444;"></i><span style="font-weight:600;color:#991b1b;">Vacancies</span></div>
                            <div style="font-size:1.75rem;font-weight:700;color:#dc2626;" id="vesselStatVacancy">1</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#eff6ff,#dbeafe);border-radius:12px;padding:20px;border:1px solid #bfdbfe;">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;"><i data-lucide="calendar-check" style="width:20px;height:20px;color:#3b82f6;"></i><span style="font-weight:600;color:#1e40af;">Scheduled</span></div>
                            <div style="font-size:1.75rem;font-weight:700;color:#2563eb;" id="vesselStatScheduled">0</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer" style="padding:20px 32px;background:var(--cw-gray-50);display:flex;justify-content:space-between;">
                <button class="btn btn-secondary" onclick="closeModal('vesselDetailModal')"><i data-lucide="x"></i>Close</button>
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" onclick="printVesselDetails()"><i data-lucide="printer"></i>Print</button>
                    <button class="btn btn-secondary" onclick="exportVesselCrew()"><i data-lucide="download"></i>Export Crew</button>
                    <button class="btn btn-secondary" onclick="editVessel()"><i data-lucide="edit"></i>Edit Vessel</button>
                    <button class="btn btn-primary" onclick="createRfaForVessel()"><i data-lucide="plus"></i>Create RFA</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Vessel Modal -->
    <div class="modal-overlay" id="addVesselModal" onclick="closeModalOnOverlay(event,'addVesselModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0369a1 0%,#0ea5e9 100%);color:white;">
                <div style="display:flex;align-items:center;gap:12px;">
                    <i data-lucide="ship" style="width:24px;height:24px;"></i>
                    <h3 style="margin:0;">Add New Vessel</h3>
                </div>
                <button class="modal-close" onclick="closeModal('addVesselModal')" style="color:white;"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                    <div class="form-group"><label class="form-label">Vessel Name *</label><input type="text" class="form-input" id="newVesselName" placeholder="MV Example"></div>
                    <div class="form-group"><label class="form-label">IMO Number *</label><input type="text" class="form-input" id="newVesselIMO" placeholder="1234567"></div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                    <div class="form-group"><label class="form-label">Vessel Type *</label><select class="form-select" id="newVesselType"><option value="">Select type...</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container Ship</option><option value="lng">LNG Carrier</option></select></div>
                    <div class="form-group"><label class="form-label">Principal *</label><select class="form-select" id="newVesselPrincipal"><option value="">Select principal...</option><option value="Diana Shipping">Diana Shipping</option><option value="Centrofin">Centrofin</option><option value="Pioneer Marine">Pioneer Marine</option><option value="Neda Maritime">Neda Maritime</option></select></div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;">
                    <div class="form-group"><label class="form-label">Flag State *</label><select class="form-select" id="newVesselFlag"><option value="">Select flag...</option><option value="Panama">Panama</option><option value="Liberia">Liberia</option><option value="Marshall Islands">Marshall Islands</option><option value="Greece">Greece</option></select></div>
                    <div class="form-group"><label class="form-label">Built Year</label><input type="number" class="form-input" id="newVesselBuilt" placeholder="2020"></div>
                    <div class="form-group"><label class="form-label">DWT</label><input type="number" class="form-input" id="newVesselDWT" placeholder="82000"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addVesselModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewVessel()"><i data-lucide="plus"></i>Add Vessel</button>
            </div>
        </div>
    </div>

    <!-- Add Candidate Modal -->
    <div class="modal-overlay" id="addCandidateModal" onclick="closeModalOnOverlay(event,'addCandidateModal')">
        <div class="modal" style="width:650px;max-width:95%;" onclick="event.stopPropagation()">
            <div class="modal-header" style="background:linear-gradient(135deg,#059669 0%,#10b981 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="user-plus" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Add New Candidate</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Add candidate to recruitment pipeline</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('addCandidateModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form id="addCandidateForm">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user"></i>Personal Information</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">First Name <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" placeholder="Juan" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" placeholder="Dela Cruz" required></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <div class="form-input-icon"><i data-lucide="mail"></i><input type="email" class="form-input" placeholder="juan@email.com"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <div class="form-input-icon"><i data-lucide="phone"></i><input type="tel" class="form-input" placeholder="+63 917 123 4567"></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="anchor"></i>Position Details</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Rank Applied <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="award"></i><select class="form-select" required><option value="">Select rank...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option></optgroup><optgroup label="Ratings"><option>Bosun</option><option>AB Seaman</option><option>OS Seaman</option><option>Oiler</option><option>Cook</option></optgroup></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">RFC (if applicable)</label>
                                <div class="form-input-icon"><i data-lucide="link"></i><select class="form-select"><option value="">No specific RFC</option><option>RFC-2025-042 (Chief Officer)</option><option>RFC-2025-041 (2nd Engineer)</option><option>RFC-2025-040 (AB Seaman)</option></select></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Source</label>
                                <div class="form-input-icon"><i data-lucide="compass"></i><select class="form-select"><option value="">Select source...</option><option value="walk-in">ðŸš¶ Walk-in</option><option value="referral">ðŸ‘¥ Referral</option><option value="agency">ðŸ¢ Agency</option><option value="online">ðŸŒ Online Application</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <div class="form-radio-group">
                                    <label class="form-radio-card selected" onclick="selectFormRadio(this,'candidatePriority','normal')"><input type="radio" name="candPriority" checked><div class="form-radio-card-label">Normal</div></label>
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'candidatePriority','high')"><input type="radio" name="candPriority"><div class="form-radio-card-label">ðŸ”¥ High</div></label>
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'candidatePriority','urgent')"><input type="radio" name="candPriority"><div class="form-radio-card-label">âš¡ Urgent</div></label>
                                </div>
                                <input type="hidden" id="candidatePriority" value="normal">
                            </div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Notes</label>
                            <textarea class="form-textarea" placeholder="Experience, certifications, special skills..."></textarea>
                            <div class="form-hint">Add relevant experience and certifications</div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('addCandidateModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" style="padding:12px 28px;background:#059669;"><i data-lucide="check"></i>Add Candidate</button>
            </div>
        </div>
    </div>

    <!-- Schedule Interview Modal -->
    <div class="modal-overlay" id="scheduleInterviewModal" onclick="closeModalOnOverlay(event,'scheduleInterviewModal')">
        <div class="modal" style="width:650px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#7c3aed 0%,#a855f7 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="calendar-check" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Schedule Interview</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Book an interview slot with a candidate</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('scheduleInterviewModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user"></i>Candidate Selection</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Candidate <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><select class="form-select" id="interviewCandidateSelect" required><option value="">Select candidate...</option><option value="CAND-001">Ricardo Mendoza - Chief Officer</option><option value="CAND-002">Miguel Torres - 2nd Engineer</option><option value="CAND-003">Pablo Cruz - AB Seaman</option><option value="CAND-005">Arturo Bautista - Master</option><option value="CAND-008">Ernesto Garcia - Chief Engineer</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">RFC (Optional)</label>
                                <div class="form-input-icon"><i data-lucide="link"></i><select class="form-select"><option value="">No RFC linked</option><option value="RFC-2025-042">RFC-2025-042 (Chief Officer)</option><option value="RFC-2025-041">RFC-2025-041 (2nd Engineer)</option><option value="RFC-2025-040">RFC-2025-040 (AB Seaman)</option></select></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="clock"></i>Date & Time</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="interviewDateInput" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Time <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="clock"></i><input type="time" class="form-input" id="interviewTimeInput" value="09:00" required></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Duration</label>
                            <div class="form-radio-group">
                                <label class="form-radio-card" onclick="selectFormRadio(this,'interviewDuration','30')"><input type="radio" name="duration"><div class="form-radio-card-label">30 min</div></label>
                                <label class="form-radio-card selected" onclick="selectFormRadio(this,'interviewDuration','45')"><input type="radio" name="duration" checked><div class="form-radio-card-label">45 min</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'interviewDuration','60')"><input type="radio" name="duration"><div class="form-radio-card-label">60 min</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'interviewDuration','90')"><input type="radio" name="duration"><div class="form-radio-card-label">90 min</div></label>
                            </div>
                            <input type="hidden" id="interviewDuration" value="45">
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="settings"></i>Interview Details</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Interview Type <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="clipboard-list"></i><select class="form-select" id="interviewTypeSelect"><option value="Technical">Technical Assessment</option><option value="Basic Assessment">Basic Assessment</option><option value="Senior Assessment">Senior Assessment</option><option value="Technical + Practical">Technical + Practical</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Interviewer <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user-check"></i><select class="form-select" id="interviewerSelect" required><option value="">Select interviewer...</option><option value="Maria Santos">Maria Santos</option><option value="Carlos Reyes">Carlos Reyes</option><option value="Ana Garcia">Ana Garcia</option></select></div>
                            </div>
                        </div>
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Location <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="map-pin"></i><select class="form-select" id="interviewLocationSelect"><option value="Office - Room A">ðŸ¢ Office - Room A</option><option value="Office - Room B">ðŸ¢ Office - Room B</option><option value="Training Center">ðŸ“š Training Center</option><option value="Video Call">ðŸ’» Video Call</option></select></div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('scheduleInterviewModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="scheduleNewInterview()" style="padding:12px 28px;background:#7c3aed;"><i data-lucide="calendar-plus"></i>Schedule Interview</button>
            </div>
        </div>
    </div>

    <!-- RFC Detail Panel -->
    <div class="panel-overlay" id="rfcPanelOverlay" onclick="closePanel('rfcPanel')"></div>
    <div class="slide-panel" id="rfcPanel">
        <div class="panel-header">
            <h3>RFC Details</h3>
            <button class="panel-close" onclick="closePanel('rfcPanel')"><i data-lucide="x"></i></button>
        </div>
        <div class="panel-body" id="rfcPanelBody">
            <!-- Dynamic content -->
        </div>
    </div>

    <!-- Create RFC Modal -->
    <div class="modal-overlay" id="createRfcModal" onclick="closeModalOnOverlay(event,'createRfcModal')">
        <div class="modal" style="width:650px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#dc2626 0%,#f97316 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="file-plus" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Create New RFC</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Request for Crew - Open a new position</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('createRfcModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="anchor"></i>Position Details</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Position/Rank <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="award"></i><select class="form-select" required><option value="">Select rank...</option><optgroup label="Officers"><option value="Master">Master</option><option value="Chief Officer">Chief Officer</option><option value="2nd Officer">2nd Officer</option><option value="3rd Officer">3rd Officer</option><option value="Chief Engineer">Chief Engineer</option><option value="2nd Engineer">2nd Engineer</option></optgroup><optgroup label="Ratings"><option value="Bosun">Bosun</option><option value="AB Seaman">AB Seaman</option><option value="Oiler">Oiler</option><option value="Cook">Cook</option></optgroup></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Priority <span class="required">*</span></label>
                                <div class="form-radio-group">
                                    <label class="form-radio-card selected" onclick="selectFormRadio(this,'rfcPriority','normal')"><input type="radio" name="rfcPrio" checked><div class="form-radio-card-label">Normal</div></label>
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'rfcPriority','high')"><input type="radio" name="rfcPrio"><div class="form-radio-card-label">ðŸ”¥ High</div></label>
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'rfcPriority','urgent')"><input type="radio" name="rfcPrio"><div class="form-radio-card-label">âš¡ Urgent</div></label>
                                </div>
                                <input type="hidden" id="rfcPriority" value="normal">
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="ship"></i>Assignment</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Principal <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="building-2"></i><select class="form-select" id="rfcPrincipalSelect" required onchange="updateRfcVessels()"><option value="">Select principal...</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option><option value="eurobulk">Eurobulk</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Vessel <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="ship"></i><select class="form-select" id="rfcVesselSelect" required><option value="">Select vessel...</option><option>MV Diana Star</option><option>MV Centrofin Glory</option><option>MV Pioneer Spirit</option><option>MV Neda Harmony</option></select></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Target Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Source</label>
                                <div class="form-input-icon"><i data-lucide="info"></i><select class="form-select"><option value="Pool shortage">ðŸ“‰ Pool shortage</option><option value="New requirement">ðŸ†• New requirement</option><option value="Emergency replacement">ðŸš¨ Emergency replacement</option><option value="Promotion gap">ðŸ“ˆ Promotion gap</option><option value="Contract completion">ðŸ“‹ Contract completion</option></select></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="file-text"></i>Additional Info</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Link to RFA (Optional)</label>
                                <div class="form-input-icon"><i data-lucide="link"></i><select class="form-select"><option value="">No linked RFA</option><option value="RFA-2025-0142">RFA-2025-0142</option><option value="RFA-2025-0143">RFA-2025-0143</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Requested By</label>
                                <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" placeholder="Operations Team"></div>
                            </div>
                        </div>
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Requirements / Notes</label>
                            <textarea class="form-textarea" rows="3" placeholder="Specific requirements, certifications needed, experience level, etc."></textarea>
                            <div class="form-hint">Include any special requirements or certifications</div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('createRfcModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="createNewRfc()" style="padding:12px 28px;background:#dc2626;"><i data-lucide="check"></i>Create RFC</button>
            </div>
        </div>
    </div>

    <!-- Edit Candidate Modal -->
    <div class="modal-overlay" id="editCandidateModal" onclick="closeModalOnOverlay(event,'editCandidateModal')">
        <div class="modal" style="width:600px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0891b2 0%,#06b6d4 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="user-cog" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Edit Candidate</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Update candidate information</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('editCandidateModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user"></i>Personal Information</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">First Name <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" id="editCandidateFirstName" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" id="editCandidateLastName" required></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <div class="form-input-icon"><i data-lucide="mail"></i><input type="email" class="form-input" id="editCandidateEmail"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <div class="form-input-icon"><i data-lucide="phone"></i><input type="tel" class="form-input" id="editCandidatePhone"></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="briefcase"></i>Position & Status</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Rank <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="award"></i><select class="form-select" id="editCandidateRank" required><optgroup label="Officers"><option value="Master">Master</option><option value="Chief Officer">Chief Officer</option><option value="2nd Officer">2nd Officer</option><option value="3rd Officer">3rd Officer</option><option value="Chief Engineer">Chief Engineer</option><option value="2nd Engineer">2nd Engineer</option></optgroup><optgroup label="Ratings"><option value="Bosun">Bosun</option><option value="AB Seaman">AB Seaman</option><option value="Oiler">Oiler</option></optgroup></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Stage</label>
                                <div class="form-input-icon"><i data-lucide="git-branch"></i><select class="form-select" id="editCandidateStage"><option value="new">ðŸ†• New</option><option value="screening">ðŸ” Screening</option><option value="interview">ðŸ’¬ Interview</option><option value="negotiation">ðŸ¤ Negotiation</option><option value="endorsed">âœ… Endorsed</option><option value="rejected">âŒ Rejected</option></select></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <div class="form-input-icon"><i data-lucide="flag"></i><select class="form-select" id="editCandidatePriority"><option value="normal">Normal</option><option value="high">ðŸ”¥ High</option><option value="urgent">âš¡ Urgent</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Source</label>
                                <div class="form-input-icon"><i data-lucide="compass"></i><select class="form-select" id="editCandidateSource"><option value="walk-in">ðŸš¶ Walk-in</option><option value="referral">ðŸ‘¥ Referral</option><option value="agency">ðŸ¢ Agency</option><option value="online">ðŸŒ Online</option></select></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('editCandidateModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveEditCandidate()" style="padding:12px 28px;"><i data-lucide="check"></i>Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Full Profile Modal (Large) -->
    <div class="modal-overlay" id="fullProfileModal" onclick="closeModalOnOverlay(event,'fullProfileModal')">
        <div class="modal" style="width:800px;max-width:95%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;">
            <div class="modal-header"><h3 class="modal-title">Full Candidate Profile</h3><button class="modal-close" onclick="closeModal('fullProfileModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" id="fullProfileContent" style="overflow-y:auto;flex:1;">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('fullProfileModal')">Close</button>
                <button class="btn btn-secondary" onclick="printProfile()"><i data-lucide="printer"></i>Print</button>
                <button class="btn btn-primary" onclick="closeModal('fullProfileModal');openEditModal();"><i data-lucide="edit-3"></i>Edit</button>
            </div>
        </div>
    </div>

    <!-- Interview Detail Modal (Large) -->
    <div class="modal-overlay" id="interviewDetailModal" onclick="closeModalOnOverlay(event,'interviewDetailModal')">
        <div class="modal" style="width:900px;max-width:95%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;">
            <div class="modal-header"><h3 class="modal-title">Interview Details</h3><button class="modal-close" onclick="closeModal('interviewDetailModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" id="interviewDetailContent" style="overflow-y:auto;flex:1;">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer" id="interviewDetailFooter">
                <!-- Dynamic buttons based on status -->
            </div>
        </div>
    </div>

    <!-- Score Interview Modal -->
    <div class="modal-overlay" id="scoreInterviewModal" onclick="closeModalOnOverlay(event,'scoreInterviewModal')">
        <div class="modal" style="width:600px;max-width:95%;">
            <div class="modal-header"><h3 class="modal-title">Complete Interview & Score</h3><button class="modal-close" onclick="closeModal('scoreInterviewModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div id="scoreInterviewCandidate" style="margin-bottom:24px;padding:16px;background:var(--cw-gray-50);border-radius:8px;"></div>
                <form class="form">
                    <h4 style="font-size:0.9rem;color:var(--cw-gray-600);margin-bottom:16px;text-transform:uppercase;letter-spacing:0.5px;">Assessment Scores (0-100)</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Technical Knowledge *</label>
                            <input type="number" class="form-control" id="scoreTechnical" min="0" max="100" value="75" required>
                            <small style="color:var(--cw-gray-400);">Industry knowledge, technical skills</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Experience *</label>
                            <input type="number" class="form-control" id="scoreExperience" min="0" max="100" value="80" required>
                            <small style="color:var(--cw-gray-400);">Relevant sea service, vessel types</small>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Communication *</label>
                            <input type="number" class="form-control" id="scoreCommunication" min="0" max="100" value="70" required>
                            <small style="color:var(--cw-gray-400);">English proficiency, clarity</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Average Score</label>
                            <div id="scoreAverage" style="font-size:2rem;font-weight:700;color:var(--cw-primary);padding:8px 0;">75</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Interview Notes</label>
                        <textarea class="form-control" id="interviewNotes" rows="3" placeholder="Key observations, strengths, areas of concern..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Recommendation *</label>
                        <div style="display:flex;gap:12px;">
                            <label style="flex:1;padding:16px;border:2px solid var(--cw-gray-200);border-radius:8px;cursor:pointer;text-align:center;transition:all 0.2s;" onclick="selectRecommendation('passed')">
                                <input type="radio" name="recommendation" value="passed" style="display:none;">
                                <i data-lucide="check-circle" style="width:32px;height:32px;color:var(--status-ready);margin-bottom:8px;"></i>
                                <div style="font-weight:600;color:var(--status-ready);">PASS</div>
                            </label>
                            <label style="flex:1;padding:16px;border:2px solid var(--cw-gray-200);border-radius:8px;cursor:pointer;text-align:center;transition:all 0.2s;" onclick="selectRecommendation('failed')">
                                <input type="radio" name="recommendation" value="failed" style="display:none;">
                                <i data-lucide="x-circle" style="width:32px;height:32px;color:var(--tag-nfr);margin-bottom:8px;"></i>
                                <div style="font-weight:600;color:var(--tag-nfr);">FAIL</div>
                            </label>
                            <label style="flex:1;padding:16px;border:2px solid var(--cw-gray-200);border-radius:8px;cursor:pointer;text-align:center;transition:all 0.2s;" onclick="selectRecommendation('pending')">
                                <input type="radio" name="recommendation" value="pending" style="display:none;" checked>
                                <i data-lucide="clock" style="width:32px;height:32px;color:var(--cw-gray-400);margin-bottom:8px;"></i>
                                <div style="font-weight:600;color:var(--cw-gray-500);">PENDING</div>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('scoreInterviewModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitInterviewScore()"><i data-lucide="check"></i>Submit Assessment</button>
            </div>
        </div>
    </div>

    <!-- Candidate Documents Modal -->
    <div class="modal-overlay" id="candidateDocsModal" onclick="closeModalOnOverlay(event,'candidateDocsModal')">
        <div class="modal" style="width:700px;max-width:95%;">
            <div class="modal-header"><h3 class="modal-title">Candidate Documents</h3><button class="modal-close" onclick="closeModal('candidateDocsModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" id="candidateDocsContent">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('candidateDocsModal')">Close</button>
                <button class="btn btn-primary"><i data-lucide="upload"></i>Upload Document</button>
            </div>
        </div>
    </div>

    <!-- Add Client Modal -->
    <div class="modal-overlay" id="addClientModal" onclick="closeModalOnOverlay(event,'addClientModal')">
        <div class="modal" style="width:600px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,var(--cw-primary) 0%,var(--cw-primary-light) 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="building-2" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Add New Client</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Register a new shipping principal</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('addClientModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <div class="form-section">
                    <div class="form-section-title"><i data-lucide="building"></i>Company Information</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Company Name <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="building-2"></i><input type="text" class="form-input" id="clientName" placeholder="Diana Shipping Inc." required></div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Country <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="globe"></i><select class="form-select" id="clientCountry" required><option value="">Select country...</option><option value="greece">ðŸ‡¬ðŸ‡· Greece</option><option value="germany">ðŸ‡©ðŸ‡ª Germany</option><option value="norway">ðŸ‡³ðŸ‡´ Norway</option><option value="japan">ðŸ‡¯ðŸ‡µ Japan</option><option value="singapore">ðŸ‡¸ðŸ‡¬ Singapore</option><option value="usa">ðŸ‡ºðŸ‡¸ USA</option></select></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div class="form-radio-group">
                            <label class="form-radio-card selected" onclick="selectFormRadio(this,'clientStatusInput','prospect')"><input type="radio" name="clientStatus" checked><div class="form-radio-card-label">ðŸŽ¯ Prospect</div><div class="form-radio-card-desc">Potential client</div></label>
                            <label class="form-radio-card" onclick="selectFormRadio(this,'clientStatusInput','active')"><input type="radio" name="clientStatus"><div class="form-radio-card-label">âœ… Active</div><div class="form-radio-card-desc">Current client</div></label>
                            <label class="form-radio-card" onclick="selectFormRadio(this,'clientStatusInput','vip')"><input type="radio" name="clientStatus"><div class="form-radio-card-label">â­ VIP</div><div class="form-radio-card-desc">Premium client</div></label>
                        </div>
                        <input type="hidden" id="clientStatusInput" value="prospect">
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-section-title"><i data-lucide="user"></i>Primary Contact</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Contact Person</label>
                            <div class="form-input-icon"><i data-lucide="user"></i><input type="text" class="form-input" id="clientContact" placeholder="John Smith"></div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Job Title</label>
                            <div class="form-input-icon"><i data-lucide="briefcase"></i><input type="text" class="form-input" placeholder="Crewing Manager"></div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <div class="form-input-icon"><i data-lucide="mail"></i><input type="email" class="form-input" id="clientEmail" placeholder="contact@company.com"></div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone</label>
                            <div class="form-input-icon"><i data-lucide="phone"></i><input type="tel" class="form-input" id="clientPhone" placeholder="+30 210 123 4567"></div>
                        </div>
                    </div>
                </div>
                <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                    <div class="form-section-title"><i data-lucide="map-pin"></i>Address & Notes</div>
                    <div class="form-group">
                        <label class="form-label">Business Address</label>
                        <div class="form-input-icon"><i data-lucide="map-pin"></i><input type="text" class="form-input" placeholder="123 Maritime Blvd, Piraeus 185 35"></div>
                    </div>
                    <div class="form-group" style="margin-bottom:0;">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" rows="2" placeholder="Any additional information about this client..."></textarea>
                        <div class="form-hint">Optional notes for internal reference</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('addClientModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewClient()" style="padding:12px 28px;"><i data-lucide="check"></i>Save Client</button>
            </div>
        </div>
    </div>

    <!-- Client Detail Modal -->
    <div class="modal-overlay" id="clientDetailModal" onclick="closeModalOnOverlay(event,'clientDetailModal')">
        <div class="modal" style="width:900px;max-width:95%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;">
            <div class="modal-header"><h3 class="modal-title">Client Details</h3><button class="modal-close" onclick="closeModal('clientDetailModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" id="clientDetailContent" style="overflow-y:auto;flex:1;">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('clientDetailModal')">Close</button>
                <button class="btn btn-secondary" onclick="editClient()"><i data-lucide="edit-3"></i>Edit</button>
                <button class="btn btn-primary" onclick="viewClientVessels()"><i data-lucide="ship"></i>View Fleet</button>
            </div>
        </div>
    </div>

    <!-- Add Vessel Modal -->
    <div class="modal-overlay" id="addVesselModal" onclick="closeModalOnOverlay(event,'addVesselModal')">
        <div class="modal" style="width:650px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0891b2 0%,#06b6d4 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="ship" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Add New Vessel</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Register a vessel in the fleet</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('addVesselModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <div class="form-section">
                    <div class="form-section-title"><i data-lucide="ship"></i>Vessel Details</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vessel Name <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="ship"></i><input type="text" class="form-input" id="vesselName" placeholder="MV Diana Star" required></div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">IMO Number <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="hash"></i><input type="text" class="form-input" id="vesselIMO" placeholder="9123456"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Vessel Type <span class="required">*</span></label>
                        <div class="form-radio-group">
                            <label class="form-radio-card" onclick="selectFormRadio(this,'vesselTypeInput','bulk')"><input type="radio" name="vesselType"><div class="form-radio-card-label">ðŸš¢ Bulk</div><div class="form-radio-card-desc">Bulk Carrier</div></label>
                            <label class="form-radio-card" onclick="selectFormRadio(this,'vesselTypeInput','tanker')"><input type="radio" name="vesselType"><div class="form-radio-card-label">ðŸ›¢ï¸ Tanker</div><div class="form-radio-card-desc">Oil/Chemical</div></label>
                            <label class="form-radio-card" onclick="selectFormRadio(this,'vesselTypeInput','container')"><input type="radio" name="vesselType"><div class="form-radio-card-label">ðŸ“¦ Container</div><div class="form-radio-card-desc">Container Ship</div></label>
                            <label class="form-radio-card" onclick="selectFormRadio(this,'vesselTypeInput','lng')"><input type="radio" name="vesselType"><div class="form-radio-card-label">â„ï¸ LNG</div><div class="form-radio-card-desc">Gas Carrier</div></label>
                        </div>
                        <input type="hidden" id="vesselTypeInput" value="">
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-section-title"><i data-lucide="building-2"></i>Assignment & Specs</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Principal <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="building-2"></i><select class="form-select" id="vesselPrincipal" required><option value="">Select principal...</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option></select></div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Flag State</label>
                            <div class="form-input-icon"><i data-lucide="flag"></i><select class="form-select"><option value="">Select flag...</option><option value="greece">ðŸ‡¬ðŸ‡· Greece</option><option value="panama">ðŸ‡µðŸ‡¦ Panama</option><option value="liberia">ðŸ‡±ðŸ‡· Liberia</option><option value="marshall">ðŸ‡²ðŸ‡­ Marshall Islands</option></select></div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">DWT (Deadweight)</label>
                            <div class="form-input-icon"><i data-lucide="weight"></i><input type="number" class="form-input" placeholder="82,000"></div>
                            <div class="form-hint">In metric tons</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Year Built</label>
                            <div class="form-input-icon"><i data-lucide="calendar"></i><input type="number" class="form-input" placeholder="2018"></div>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom:0;">
                        <label class="form-label">Crew Capacity</label>
                        <div class="form-input-icon"><i data-lucide="users"></i><input type="number" class="form-input" placeholder="22"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('addVesselModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewVessel()" style="padding:12px 28px;"><i data-lucide="check"></i>Save Vessel</button>
            </div>
        </div>
    </div>

    <!-- Fleet Map Modal -->
    <div class="modal-overlay" id="fleetMapModal" onclick="closeModalOnOverlay(event,'fleetMapModal')">
        <div class="modal" style="width:95%;max-width:1200px;height:85vh;">
            <div class="modal-header"><h3 class="modal-title">Fleet Map - Global Positions</h3><button class="modal-close" onclick="closeModal('fleetMapModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" style="padding:0;height:calc(100% - 120px);">
                <div id="fleetMapContainer" style="width:100%;height:100%;background:var(--cw-gray-100);display:flex;align-items:center;justify-content:center;">
                    <div style="text-align:center;color:var(--cw-gray-500);">
                        <i data-lucide="map" style="width:64px;height:64px;margin-bottom:16px;"></i>
                        <h3 style="margin-bottom:8px;">Fleet Map View</h3>
                        <p>Interactive map showing vessel positions worldwide</p>
                        <div style="margin-top:24px;display:flex;gap:16px;justify-content:center;flex-wrap:wrap;">
                            <div style="padding:12px 20px;background:white;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                                <div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);">89</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-500);">Total Vessels</div>
                            </div>
                            <div style="padding:12px 20px;background:white;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                                <div style="font-size:1.5rem;font-weight:700;color:var(--status-ready);">45</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-500);">At Sea</div>
                            </div>
                            <div style="padding:12px 20px;background:white;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                                <div style="font-size:1.5rem;font-weight:700;color:var(--status-on-approval);">32</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-500);">In Port</div>
                            </div>
                            <div style="padding:12px 20px;background:white;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                                <div style="font-size:1.5rem;font-weight:700;color:var(--cw-accent);">12</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-500);">Anchored</div>
                            </div>
                        </div>
                        <p style="margin-top:24px;font-size:0.85rem;color:var(--cw-gray-400);">Map integration with AIS data coming soon</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('fleetMapModal')">Close</button></div>
        </div>
    </div>

    <!-- New Contract Modal -->
    <div class="modal-overlay" id="newContractModal" onclick="closeModalOnOverlay(event,'newContractModal')">
        <div class="modal" style="width:700px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0d9488 0%,#14b8a6 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="file-signature" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">New Contract</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Create employment contract for seafarer</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('newContractModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user"></i>Seafarer Details</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Seafarer <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="user"></i><select class="form-select" id="contractSeafarer" required><option value="">Select seafarer...</option><option value="juan">Juan Dela Cruz - Chief Officer</option><option value="mario">Mario Reyes - 2nd Engineer</option><option value="antonio">Antonio Santos - Master</option><option value="roberto">Roberto Garcia - AB Seaman</option><option value="eduardo">Eduardo Pascual - Chief Engineer</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Rank <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="award"></i><select class="form-select" id="contractRank" required><option value="">Select rank...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option></optgroup><optgroup label="Ratings"><option>Bosun</option><option>AB Seaman</option><option>Oiler</option><option>Cook</option></optgroup></select></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="ship"></i>Assignment</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Principal <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="building-2"></i><select class="form-select" id="contractPrincipal" required><option value="">Select principal...</option><option value="diana">Diana Shipping</option><option value="centrofin">Centrofin</option><option value="pioneer">Pioneer Marine</option><option value="neda">Neda Maritime</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Vessel <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="ship"></i><select class="form-select" id="contractVessel" required><option value="">Select vessel...</option><option>MV Diana Star</option><option>MV Centrofin Glory</option><option>MV Pioneer Spirit</option><option>MV Neda Harmony</option></select></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="calendar"></i>Contract Terms</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Start Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="contractStartDate" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Duration</label>
                                <div class="form-radio-group">
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'contractDuration','6')"><input type="radio" name="duration"><div class="form-radio-card-label">6 mo</div></label>
                                    <label class="form-radio-card selected" onclick="selectFormRadio(this,'contractDuration','9')"><input type="radio" name="duration" checked><div class="form-radio-card-label">9 mo</div></label>
                                    <label class="form-radio-card" onclick="selectFormRadio(this,'contractDuration','12')"><input type="radio" name="duration"><div class="form-radio-card-label">12 mo</div></label>
                                </div>
                                <input type="hidden" id="contractDuration" value="9">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Basic Salary (USD)</label>
                                <div class="form-input-icon"><i data-lucide="dollar-sign"></i><input type="number" class="form-input" id="contractSalary" placeholder="4,500"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Leave Pay</label>
                                <div class="form-input-icon"><i data-lucide="wallet"></i><input type="number" class="form-input" placeholder="450"></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="clipboard-check"></i>PEME Status</div>
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Medical Examination</label>
                            <div class="form-radio-group">
                                <label class="form-radio-card selected" onclick="selectFormRadio(this,'contractPeme','pending')"><input type="radio" name="peme" checked><div class="form-radio-card-label">â³ Pending</div><div class="form-radio-card-desc">Not yet done</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'contractPeme','scheduled')"><input type="radio" name="peme"><div class="form-radio-card-label">ðŸ“… Scheduled</div><div class="form-radio-card-desc">Appointment set</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'contractPeme','cleared')"><input type="radio" name="peme"><div class="form-radio-card-label">âœ… Cleared</div><div class="form-radio-card-desc">Fit for duty</div></label>
                            </div>
                            <input type="hidden" id="contractPeme" value="pending">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('newContractModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewContract()" style="padding:12px 28px;background:#0d9488;"><i data-lucide="check"></i>Create Contract</button>
            </div>
        </div>
    </div>

    <!-- Contract Detail Modal (Full Screen) -->
    <div class="modal-overlay" id="contractDetailModal" onclick="closeModalOnOverlay(event,'contractDetailModal')">
        <div class="modal" style="width:95%;max-width:1100px;height:90vh;display:flex;flex-direction:column;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0d9488 0%,#14b8a6 100%);color:white;padding:0;border-radius:12px 12px 0 0;min-height:auto;">
                <div id="contractDetailHeader" style="width:100%;padding:28px 32px;">
                    <!-- Dynamic header content -->
                </div>
                <button class="modal-close" onclick="closeModal('contractDetailModal')" style="position:absolute;top:20px;right:20px;color:white;opacity:0.8;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
            </div>
            <div class="modal-body" id="contractDetailContent" style="flex:1;overflow-y:auto;padding:0;">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer" style="padding:16px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('contractDetailModal')"><i data-lucide="x"></i>Close</button>
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" onclick="printContract()"><i data-lucide="printer"></i>Print</button>
                    <button class="btn btn-secondary" onclick="downloadContract()"><i data-lucide="download"></i>Download PDF</button>
                    <button class="btn btn-primary" style="background:#0d9488;" onclick="editContract()"><i data-lucide="edit-3"></i>Edit Contract</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Plan Rotation Modal -->
    <div class="modal-overlay" id="planRotationModal" onclick="closeModalOnOverlay(event,'planRotationModal')">
        <div class="modal" style="width:700px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#7c3aed 0%,#a855f7 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="calendar-range" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Plan Rotation</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Schedule crew change for a position</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('planRotationModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="ship"></i>Vessel & Position</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Vessel <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="ship"></i><select class="form-select" id="rotationVessel" required><option value="">Select vessel...</option><option value="diana-star">MV Diana Star</option><option value="centrofin-glory">MV Centrofin Glory</option><option value="pioneer-spirit">MV Pioneer Spirit</option><option value="neda-harmony">MV Neda Harmony</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Position <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="award"></i><select class="form-select" id="rotationPosition" required><option value="">Select position...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option></optgroup><optgroup label="Ratings"><option>Bosun</option><option>AB Seaman</option><option>Oiler</option><option>Cook</option></optgroup></select></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user-minus"></i>Sign-Off (Current Crew)</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Current Seafarer</label>
                                <div class="form-input-icon"><i data-lucide="user"></i><select class="form-select" id="rotationCurrentSeafarer"><option value="">Select current crew...</option><option value="juan">Juan Dela Cruz - Chief Officer</option><option value="mario">Mario Reyes - 2nd Engineer</option><option value="antonio">Antonio Santos - Master</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Sign-Off Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="rotationSignOffDate" required></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Sign-Off Reason</label>
                            <div class="form-radio-group">
                                <label class="form-radio-card selected" onclick="selectFormRadio(this,'rotationReason','contract-end')"><input type="radio" name="rotReason" checked><div class="form-radio-card-label">ðŸ“‹ Contract End</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'rotationReason','leave')"><input type="radio" name="rotReason"><div class="form-radio-card-label">ðŸ–ï¸ Leave</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'rotationReason','medical')"><input type="radio" name="rotReason"><div class="form-radio-card-label">ðŸ¥ Medical</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'rotationReason','promotion')"><input type="radio" name="rotReason"><div class="form-radio-card-label">ðŸ“ˆ Promotion</div></label>
                            </div>
                            <input type="hidden" id="rotationReason" value="contract-end">
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="user-plus"></i>Sign-On (Replacement)</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Replacement Seafarer</label>
                                <div class="form-input-icon"><i data-lucide="user-plus"></i><select class="form-select" id="rotationReplacement"><option value="">Select replacement...</option><option value="roberto">Roberto Garcia - AB Seaman (Ready)</option><option value="eduardo">Eduardo Pascual - Chief Engineer (Ready)</option><option value="jose">Jose Martinez - Bosun (Endorsed)</option></select></div>
                                <div class="form-hint">Leave empty to create a vacancy</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Sign-On Date</label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="rotationSignOnDate"></div>
                            </div>
                        </div>
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Notes</label>
                            <textarea class="form-textarea" rows="2" placeholder="Additional notes about this rotation..."></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('planRotationModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="savePlanRotation()" style="padding:12px 28px;background:#7c3aed;"><i data-lucide="check"></i>Plan Rotation</button>
            </div>
        </div>
    </div>

    <!-- Alert Settings Modal -->
    <div class="modal-overlay" id="alertSettingsModal" onclick="closeModalOnOverlay(event,'alertSettingsModal')">
        <div class="modal" style="width:550px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="bell" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Alert Settings</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Configure document expiry notifications</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('alertSettingsModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="clock"></i>Alert Thresholds</div>
                        <div class="form-group">
                            <label class="form-label">Critical Alert (Days Before Expiry)</label>
                            <div class="form-input-icon"><i data-lucide="alert-triangle"></i><input type="number" class="form-input" id="alertCriticalDays" value="7" min="1" max="30"></div>
                            <div class="form-hint">Documents expiring within this period will show as critical</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Warning Alert (Days Before Expiry)</label>
                            <div class="form-input-icon"><i data-lucide="clock"></i><input type="number" class="form-input" id="alertWarningDays" value="30" min="7" max="90"></div>
                            <div class="form-hint">Documents expiring within this period will show as warning</div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="mail"></i>Notification Settings</div>
                        <div class="form-group">
                            <label class="form-label">Email Notifications</label>
                            <div class="form-radio-group">
                                <label class="form-radio-card selected" onclick="selectFormRadio(this,'alertEmailFreq','daily')"><input type="radio" name="emailFreq" checked><div class="form-radio-card-label">ðŸ“§ Daily</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'alertEmailFreq','weekly')"><input type="radio" name="emailFreq"><div class="form-radio-card-label">ðŸ“… Weekly</div></label>
                                <label class="form-radio-card" onclick="selectFormRadio(this,'alertEmailFreq','off')"><input type="radio" name="emailFreq"><div class="form-radio-card-label">ðŸ”• Off</div></label>
                            </div>
                            <input type="hidden" id="alertEmailFreq" value="daily">
                        </div>
                        <div class="form-group" style="margin-bottom:0;">
                            <label class="form-label">Notification Recipients</label>
                            <div class="form-input-icon"><i data-lucide="users"></i><input type="text" class="form-input" value="operations@crossworld.com, compliance@crossworld.com"></div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('alertSettingsModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveAlertSettings()" style="padding:12px 28px;background:#f59e0b;"><i data-lucide="check"></i>Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div class="modal-overlay" id="uploadDocumentModal" onclick="closeModalOnOverlay(event,'uploadDocumentModal')">
        <div class="modal" style="width:650px;max-width:95%;">
            <div class="modal-header" style="background:linear-gradient(135deg,#3b82f6 0%,#60a5fa 100%);color:white;padding:24px 28px;border-radius:12px 12px 0 0;">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div style="width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="upload" style="width:24px;height:24px;"></i></div>
                    <div><h3 class="modal-title" style="margin:0;font-size:1.25rem;">Upload Document</h3><p style="margin:4px 0 0;opacity:0.85;font-size:0.85rem;">Add certificate or document to registry</p></div>
                </div>
                <button class="modal-close" onclick="closeModal('uploadDocumentModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:28px;">
                <form class="form">
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="user"></i>Seafarer</div>
                        <div class="form-group">
                            <label class="form-label">Select Seafarer <span class="required">*</span></label>
                            <div class="form-input-icon"><i data-lucide="user"></i><select class="form-select" id="uploadSeafarer" required><option value="">Select seafarer...</option><option value="juan">Juan Dela Cruz - Chief Officer</option><option value="mario">Mario Reyes - 2nd Engineer</option><option value="antonio">Antonio Santos - Master</option><option value="roberto">Roberto Garcia - AB Seaman</option><option value="eduardo">Eduardo Pascual - Chief Engineer</option></select></div>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-section-title"><i data-lucide="file-text"></i>Document Information</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Document Type <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="folder"></i><select class="form-select" id="uploadDocType" required><option value="">Select type...</option><option value="stcw">ðŸ“œ STCW Certificate</option><option value="flag">ðŸ³ï¸ Flag Document</option><option value="medical">ðŸ¥ Medical Certificate</option><option value="national">ðŸªª National Document</option><option value="company">ðŸ¢ Company Document</option></select></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Document Name <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="file-text"></i><input type="text" class="form-input" id="uploadDocName" placeholder="e.g., Certificate of Competency" required></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Document Number</label>
                                <div class="form-input-icon"><i data-lucide="hash"></i><input type="text" class="form-input" id="uploadDocNumber" placeholder="e.g., COC-2024-12345"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Issuing Authority</label>
                                <div class="form-input-icon"><i data-lucide="building"></i><input type="text" class="form-input" placeholder="e.g., MARINA"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Issue Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="uploadIssueDate" required></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Expiry Date <span class="required">*</span></label>
                                <div class="form-input-icon"><i data-lucide="calendar"></i><input type="date" class="form-input" id="uploadExpiryDate" required></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-section" style="border-bottom:none;margin-bottom:0;padding-bottom:0;">
                        <div class="form-section-title"><i data-lucide="upload-cloud"></i>File Upload</div>
                        <div class="form-group" style="margin-bottom:0;">
                            <div style="border:2px dashed var(--cw-gray-300);border-radius:12px;padding:32px;text-align:center;background:var(--cw-gray-50);cursor:pointer;" onclick="document.getElementById('fileInput').click()">
                                <i data-lucide="upload-cloud" style="width:48px;height:48px;color:var(--cw-gray-400);margin-bottom:12px;"></i>
                                <p style="margin:0 0 8px;color:var(--cw-gray-600);font-weight:600;">Click to upload or drag and drop</p>
                                <p style="margin:0;color:var(--cw-gray-400);font-size:0.85rem;">PDF, JPG, PNG up to 10MB</p>
                                <input type="file" id="fileInput" style="display:none;" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(this)">
                            </div>
                            <div id="filePreview" style="margin-top:12px;display:none;padding:12px;background:var(--cw-gray-100);border-radius:8px;"></div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="padding:20px 28px;background:var(--cw-gray-50);border-top:1px solid var(--cw-gray-100);">
                <button class="btn btn-secondary" onclick="closeModal('uploadDocumentModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveUploadDocument()" style="padding:12px 28px;background:#3b82f6;"><i data-lucide="upload"></i>Upload Document</button>
            </div>
        </div>
    </div>

    <!-- Seafarer History Modal -->
    <div class="modal-overlay" id="seafarerHistoryModal" onclick="closeModalOnOverlay(event,'seafarerHistoryModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;padding:24px;">
                <div>
                    <h3 class="modal-title" style="color:white;margin:0;">Employment History</h3>
                    <p style="margin:8px 0 0;opacity:0.85;font-size:0.9rem;"><span id="historySeafarerName">Juan Dela Cruz</span> â€¢ <span id="historySeafarerId">CW-2024-00142</span></p>
                </div>
                <button class="modal-close" onclick="closeModal('seafarerHistoryModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;max-height:60vh;overflow-y:auto;">
                <div id="employmentHistoryList" class="history-timeline-list">
                    <!-- History items rendered by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('seafarerHistoryModal')"><i data-lucide="x"></i>Close</button>
                <button class="btn btn-primary" onclick="exportSeafarerHistory()"><i data-lucide="download"></i>Export History</button>
            </div>
        </div>
    </div>

    <!-- Edit Seafarer Modal -->
    <div class="modal-overlay" id="editSeafarerModal" onclick="closeModalOnOverlay(event,'editSeafarerModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:640px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;padding:24px;">
                <div>
                    <h3 class="modal-title" style="color:white;margin:0;">Edit Seafarer Profile</h3>
                    <p style="margin:8px 0 0;opacity:0.85;font-size:0.9rem;" id="editSeafarerName">Juan Dela Cruz</p>
                </div>
                <button class="modal-close" onclick="closeModal('editSeafarerModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <form id="editSeafarerForm">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">First Name</label>
                            <input type="text" class="form-input" id="editFirstName" placeholder="First Name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Last Name</label>
                            <input type="text" class="form-input" id="editLastName" placeholder="Last Name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="editEmail" placeholder="email@example.com">
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" id="editPhone" placeholder="+63 917 000 0000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-input" id="editLocation" placeholder="City, Province">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Rank/Position</label>
                        <select class="form-select" id="editRank">
                            <option value="Master">Master</option>
                            <option value="Chief Officer">Chief Officer</option>
                            <option value="2nd Officer">2nd Officer</option>
                            <option value="3rd Officer">3rd Officer</option>
                            <option value="Chief Engineer">Chief Engineer</option>
                            <option value="2nd Engineer">2nd Engineer</option>
                            <option value="3rd Engineer">3rd Engineer</option>
                            <option value="Bosun">Bosun</option>
                            <option value="AB Seaman">AB Seaman</option>
                            <option value="OS Seaman">OS Seaman</option>
                            <option value="Oiler">Oiler</option>
                            <option value="Wiper">Wiper</option>
                            <option value="Cook">Cook</option>
                            <option value="Messman">Messman</option>
                        </select>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Pool Type</label>
                            <select class="form-select" id="editPoolType">
                                <option value="dedicated">Dedicated</option>
                                <option value="non-dedicated">Non-Dedicated</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="editStatus">
                                <option value="ready">Ready</option>
                                <option value="embarked">Embarked</option>
                                <option value="on-preparation">On Preparation</option>
                                <option value="endorsed">Endorsed</option>
                                <option value="on-approval">On Approval</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editSeafarerModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveSeafarerEdit()"><i data-lucide="check"></i>Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Ticket Detail Modal (Full Screen) -->
    <div class="modal-overlay" id="ticketDetailModal" onclick="closeModalOnOverlay(event,'ticketDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:900px;width:95%;">
            <!-- Header with Gradient -->
            <div class="modal-header" style="background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);color:white;padding:28px 32px;">
                <div style="display:flex;align-items:center;gap:20px;">
                    <div style="width:56px;height:56px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="ticket" style="width:28px;height:28px;"></i></div>
                    <div>
                        <div style="display:flex;align-items:center;gap:12px;">
                            <h3 style="margin:0;font-size:1.5rem;font-weight:700;" id="ticketDetailPnr">ABC123</h3>
                            <span class="ticket-detail-status-badge confirmed" id="ticketDetailStatus">Confirmed</span>
                        </div>
                        <p style="margin:8px 0 0;opacity:0.85;">Electronic Ticket / Boarding Pass</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('ticketDetailModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
            </div>
            
            <div class="modal-body" style="padding:0;max-height:70vh;overflow-y:auto;">
                <!-- Flight Route Section -->
                <div style="background:linear-gradient(135deg,#f8fafc,#e2e8f0);padding:32px;border-bottom:1px solid var(--cw-gray-200);">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div style="text-align:center;flex:1;">
                            <div style="font-size:3rem;font-weight:800;color:var(--cw-primary);" id="ticketDetailFrom">MNL</div>
                            <div style="font-size:1rem;color:var(--cw-gray-600);margin-top:4px;" id="ticketDetailFromCity">Manila</div>
                            <div style="font-size:0.8rem;color:var(--cw-gray-500);margin-top:2px;">Ninoy Aquino Intl</div>
                        </div>
                        <div style="flex:1;display:flex;flex-direction:column;align-items:center;padding:0 24px;">
                            <div style="display:flex;align-items:center;width:100%;">
                                <div style="flex:1;height:2px;background:linear-gradient(90deg,var(--cw-gray-300),var(--cw-primary));"></div>
                                <div style="width:48px;height:48px;border-radius:50%;background:var(--cw-primary);display:flex;align-items:center;justify-content:center;margin:0 12px;"><i data-lucide="plane" style="width:24px;height:24px;color:white;transform:rotate(45deg);"></i></div>
                                <div style="flex:1;height:2px;background:linear-gradient(90deg,var(--cw-primary),var(--cw-gray-300));"></div>
                            </div>
                            <div style="font-size:0.9rem;color:var(--cw-gray-600);margin-top:8px;" id="ticketDetailDuration">3h 45m</div>
                            <div style="font-size:0.75rem;color:var(--cw-gray-500);">Direct Flight</div>
                        </div>
                        <div style="text-align:center;flex:1;">
                            <div style="font-size:3rem;font-weight:800;color:var(--cw-primary);" id="ticketDetailTo">SIN</div>
                            <div style="font-size:1rem;color:var(--cw-gray-600);margin-top:4px;" id="ticketDetailToCity">Singapore</div>
                            <div style="font-size:0.8rem;color:var(--cw-gray-500);margin-top:2px;">Changi Airport</div>
                        </div>
                    </div>
                </div>
                
                <!-- Details Grid -->
                <div style="padding:24px 32px;">
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:24px;">
                        <!-- Flight Information -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <h4 style="margin:0 0 16px;font-size:0.8rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="plane" style="width:16px;height:16px;"></i>Flight Information</h4>
                            <div style="display:grid;gap:12px;">
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Date</span><strong id="ticketDetailDate">2025-02-15</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Departure</span><strong id="ticketDetailTime">08:30</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Flight</span><strong id="ticketDetailFlight">PR501</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Airline</span><strong id="ticketDetailAirline">Philippine Airlines</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Class</span><strong id="ticketDetailClass">Economy</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Baggage</span><strong id="ticketDetailBaggage">2 x 23kg</strong></div>
                            </div>
                        </div>
                        
                        <!-- Passenger Information -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <h4 style="margin:0 0 16px;font-size:0.8rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="user" style="width:16px;height:16px;"></i>Passenger Information</h4>
                            <div style="display:flex;align-items:center;gap:16px;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid var(--cw-gray-200);">
                                <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#00495D,#0891b2);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:1.25rem;" id="ticketDetailPassengerInitials">JD</div>
                                <div>
                                    <div style="font-weight:600;font-size:1.1rem;" id="ticketDetailPassengerName">Juan Dela Cruz</div>
                                    <div style="color:var(--cw-gray-500);font-size:0.9rem;" id="ticketDetailPassengerRank">Chief Officer</div>
                                </div>
                            </div>
                            <div style="display:grid;gap:12px;">
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Vessel</span><strong id="ticketDetailPassengerVessel">MV Diana Star</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Seat</span><strong>12A (Window)</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Meal</span><strong>Regular</strong></div>
                            </div>
                        </div>
                        
                        <!-- Booking Information -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <h4 style="margin:0 0 16px;font-size:0.8rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="receipt" style="width:16px;height:16px;"></i>Booking Details</h4>
                            <div style="display:grid;gap:12px;">
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Travel Type</span><strong id="ticketDetailType">Embark</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Ticket Cost</span><strong style="color:var(--cw-primary);font-size:1.1rem;" id="ticketDetailPrice">$850</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Booked By</span><strong id="ticketDetailBookedBy">Maria Santos</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Booked On</span><strong id="ticketDetailBookedDate">2025-02-08</strong></div>
                                <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Payment</span><strong style="color:var(--status-ready);">Paid âœ“</strong></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Timeline -->
                    <div style="margin-top:24px;background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                        <h4 style="margin:0 0 16px;font-size:0.8rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="clock" style="width:16px;height:16px;"></i>Booking Timeline</h4>
                        <div style="display:flex;gap:32px;">
                            <div style="display:flex;align-items:center;gap:12px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--status-ready);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:16px;height:16px;color:white;"></i></div><div><div style="font-weight:600;">Booked</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Feb 8, 14:30</div></div></div>
                            <div style="display:flex;align-items:center;gap:12px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--status-ready);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:16px;height:16px;color:white;"></i></div><div><div style="font-weight:600;">Confirmed</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Feb 8, 15:45</div></div></div>
                            <div style="display:flex;align-items:center;gap:12px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--status-ready);display:flex;align-items:center;justify-content:center;"><i data-lucide="check" style="width:16px;height:16px;color:white;"></i></div><div><div style="font-weight:600;">Payment</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Feb 9, 09:00</div></div></div>
                            <div style="display:flex;align-items:center;gap:12px;"><div style="width:32px;height:32px;border-radius:50%;background:var(--cw-gray-300);display:flex;align-items:center;justify-content:center;"><i data-lucide="plane" style="width:16px;height:16px;color:white;"></i></div><div><div style="font-weight:600;color:var(--cw-gray-500);">Departure</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Feb 15, 08:30</div></div></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer" style="padding:20px 32px;background:var(--cw-gray-50);display:flex;justify-content:space-between;">
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" onclick="printTicket()"><i data-lucide="printer"></i>Print</button>
                    <button class="btn btn-secondary" onclick="downloadTicketPdf()"><i data-lucide="download"></i>Download PDF</button>
                </div>
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" style="color:var(--tag-nfr);" onclick="cancelTicket()"><i data-lucide="x-circle"></i>Cancel Ticket</button>
                    <button class="btn btn-primary" onclick="modifyTicket()"><i data-lucide="edit-3"></i>Modify</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Book Ticket Modal -->
    <div class="modal-overlay" id="bookTicketModal" onclick="closeModalOnOverlay(event,'bookTicketModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);color:white;padding:24px;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="plane" style="width:24px;height:24px;"></i></div>
                    <div>
                        <h3 style="margin:0;font-size:1.25rem;">Book New Ticket</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Create a new flight booking</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('bookTicketModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <form id="bookTicketForm">
                    <div class="form-group">
                        <label class="form-label">Passenger (Seafarer) *</label>
                        <select class="form-select" id="newTicketPassenger" required>
                            <option value="">Select seafarer...</option>
                            <option value="Juan Dela Cruz">Juan Dela Cruz - Chief Officer</option>
                            <option value="Mario Reyes">Mario Reyes - 2nd Engineer</option>
                            <option value="Roberto Garcia">Roberto Garcia - AB Seaman</option>
                            <option value="Eduardo Pascual">Eduardo Pascual - Chief Engineer</option>
                        </select>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">From *</label>
                            <select class="form-select" id="newTicketFrom" required>
                                <option value="">Select origin...</option>
                                <option value="MNL">MNL - Manila</option>
                                <option value="CEB">CEB - Cebu</option>
                                <option value="SIN">SIN - Singapore</option>
                                <option value="HKG">HKG - Hong Kong</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">To *</label>
                            <select class="form-select" id="newTicketTo" required>
                                <option value="">Select destination...</option>
                                <option value="SIN">SIN - Singapore</option>
                                <option value="AMS">AMS - Amsterdam</option>
                                <option value="RTM">RTM - Rotterdam</option>
                                <option value="PIR">PIR - Piraeus</option>
                                <option value="DXB">DXB - Dubai</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Travel Date *</label>
                            <input type="date" class="form-input" id="newTicketDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Travel Type *</label>
                            <select class="form-select" id="newTicketType" required>
                                <option value="embark">Embarkation</option>
                                <option value="sign-off">Sign-off</option>
                                <option value="transit">Transit</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Preferred Airline</label>
                            <select class="form-select" id="newTicketAirline">
                                <option value="">Any airline</option>
                                <option value="Philippine Airlines">Philippine Airlines</option>
                                <option value="Singapore Airlines">Singapore Airlines</option>
                                <option value="Emirates">Emirates</option>
                                <option value="KLM">KLM</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-select" id="newTicketClass">
                                <option value="economy">Economy</option>
                                <option value="premium">Premium Economy</option>
                                <option value="business">Business</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Special Requests</label>
                        <textarea class="form-textarea" id="newTicketNotes" rows="3" placeholder="Meal preference, seating, baggage requirements..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('bookTicketModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewTicket()"><i data-lucide="send"></i>Submit Booking</button>
            </div>
        </div>
    </div>

    <!-- Cancel Ticket Confirmation Modal -->
    <div class="modal-overlay" id="cancelTicketConfirmModal" onclick="closeModalOnOverlay(event,'cancelTicketConfirmModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:500px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#dc2626 0%,#ef4444 100%);color:white;padding:24px;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="alert-triangle" style="width:24px;height:24px;"></i></div>
                    <div>
                        <h3 style="margin:0;font-size:1.25rem;">Cancel Ticket</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">This action cannot be undone</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('cancelTicketConfirmModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <div style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);border-radius:12px;padding:16px;margin-bottom:20px;">
                    <div style="display:grid;gap:8px;">
                        <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">PNR</span><strong id="cancelTicketPnr">ABC123</strong></div>
                        <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Route</span><strong id="cancelTicketRoute">MNL â†’ SIN</strong></div>
                        <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Date</span><strong id="cancelTicketDate">2025-02-15</strong></div>
                        <div style="display:flex;justify-content:space-between;"><span style="color:var(--cw-gray-500);">Passenger</span><strong id="cancelTicketPassenger">Juan Dela Cruz</strong></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Cancellation Reason *</label>
                    <select class="form-select" id="cancelReason" required>
                        <option value="">Select reason...</option>
                        <option value="schedule_change">Schedule Change</option>
                        <option value="vessel_delay">Vessel Delay</option>
                        <option value="medical">Medical Reasons</option>
                        <option value="principal_request">Principal Request</option>
                        <option value="seafarer_request">Seafarer Request</option>
                        <option value="duplicate">Duplicate Booking</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-textarea" id="cancelNotes" rows="2" placeholder="Optional notes..."></textarea>
                </div>
                <div style="background:var(--cw-gray-50);border-radius:8px;padding:12px;font-size:0.85rem;color:var(--cw-gray-600);">
                    <strong>âš ï¸ Note:</strong> Cancellation fees may apply depending on airline policy. Refund will be processed within 5-7 business days.
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('cancelTicketConfirmModal')"><i data-lucide="x"></i>Keep Ticket</button>
                <button class="btn" onclick="confirmCancelTicket()" style="background:var(--tag-nfr);color:white;"><i data-lucide="trash-2"></i>Confirm Cancellation</button>
            </div>
        </div>
    </div>

    <!-- Modify Ticket Modal -->
    <div class="modal-overlay" id="modifyTicketModal" onclick="closeModalOnOverlay(event,'modifyTicketModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:600px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);color:white;padding:24px;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="edit-3" style="width:24px;height:24px;"></i></div>
                    <div>
                        <h3 style="margin:0;font-size:1.25rem;">Modify Ticket</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">PNR: <span id="modifyTicketPnr">ABC123</span></p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('modifyTicketModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;">
                <form id="modifyTicketForm">
                    <div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;margin-bottom:20px;">
                        <h4 style="margin:0 0 12px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;">Current Booking</h4>
                        <div style="display:flex;align-items:center;justify-content:center;gap:24px;">
                            <div style="text-align:center;">
                                <div style="font-size:2rem;font-weight:700;color:var(--cw-primary);" id="modifyCurrentFrom">MNL</div>
                                <div style="font-size:0.85rem;color:var(--cw-gray-500);">Manila</div>
                            </div>
                            <div><i data-lucide="arrow-right" style="width:24px;height:24px;color:var(--cw-gray-400);"></i></div>
                            <div style="text-align:center;">
                                <div style="font-size:2rem;font-weight:700;color:var(--cw-primary);" id="modifyCurrentTo">SIN</div>
                                <div style="font-size:0.85rem;color:var(--cw-gray-500);">Singapore</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">From</label>
                            <select class="form-select" id="modifyTicketFrom">
                                <option value="MNL">MNL - Manila</option>
                                <option value="CEB">CEB - Cebu</option>
                                <option value="SIN">SIN - Singapore</option>
                                <option value="HKG">HKG - Hong Kong</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">To</label>
                            <select class="form-select" id="modifyTicketTo">
                                <option value="SIN">SIN - Singapore</option>
                                <option value="AMS">AMS - Amsterdam</option>
                                <option value="RTM">RTM - Rotterdam</option>
                                <option value="PIR">PIR - Piraeus</option>
                                <option value="DXB">DXB - Dubai</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">New Travel Date *</label>
                            <input type="date" class="form-input" id="modifyTicketDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-select" id="modifyTicketClass">
                                <option value="economy">Economy</option>
                                <option value="premium">Premium Economy</option>
                                <option value="business">Business</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Modification Reason</label>
                        <textarea class="form-textarea" id="modifyTicketNotes" rows="2" placeholder="Reason for modification..."></textarea>
                    </div>
                    <div style="background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.2);border-radius:8px;padding:12px;font-size:0.85rem;color:var(--cw-gray-700);">
                        <strong>ðŸ’¡ Note:</strong> Modification fees may apply. The ticket will be set to "Pending" status until re-confirmed by the airline.
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('modifyTicketModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveTicketModification()"><i data-lucide="check"></i>Submit Modification</button>
            </div>
        </div>
    </div>

    <!-- Evaluation Detail Modal (Full Screen) -->
    <div class="modal-overlay" id="evaluationDetailModal" onclick="closeModalOnOverlay(event,'evaluationDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:900px;width:95%;">
            <!-- Header with Score -->
            <div class="modal-header" style="background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:white;padding:28px 32px;">
                <div style="display:flex;align-items:center;gap:20px;flex:1;">
                    <div style="width:72px;height:72px;border-radius:16px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:1.75rem;font-weight:700;" id="evalDetailInitials">JD</div>
                    <div style="flex:1;">
                        <h3 style="margin:0;font-size:1.5rem;font-weight:700;" id="evalDetailName">Juan Dela Cruz</h3>
                        <p style="margin:6px 0 0;opacity:0.9;" id="evalDetailRank">Chief Officer</p>
                        <p style="margin:4px 0 0;opacity:0.8;font-size:0.9rem;" id="evalDetailPeriod">Nov 2024 - Feb 2025</p>
                    </div>
                    <div style="text-align:center;background:rgba(255,255,255,0.2);padding:16px 24px;border-radius:16px;">
                        <div style="font-size:3rem;font-weight:800;" id="evalDetailScore">4.6</div>
                        <div style="font-size:0.9rem;text-transform:uppercase;font-weight:600;" id="evalDetailRating">Excellent</div>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('evaluationDetailModal')" style="color:white;opacity:0.8;position:absolute;top:20px;right:20px;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
            </div>
            
            <div class="modal-body" style="padding:0;max-height:65vh;overflow-y:auto;">
                <!-- Assignment Info -->
                <div style="background:var(--cw-gray-50);padding:20px 32px;border-bottom:1px solid var(--cw-gray-200);">
                    <div style="display:flex;gap:32px;">
                        <div style="display:flex;align-items:center;gap:12px;"><i data-lucide="ship" style="width:20px;height:20px;color:var(--cw-primary);"></i><div><div style="font-size:0.75rem;color:var(--cw-gray-500);text-transform:uppercase;">Vessel</div><div style="font-weight:600;" id="evalDetailVessel">MV Diana Star</div></div></div>
                        <div style="display:flex;align-items:center;gap:12px;"><i data-lucide="building-2" style="width:20px;height:20px;color:var(--cw-primary);"></i><div><div style="font-size:0.75rem;color:var(--cw-gray-500);text-transform:uppercase;">Principal</div><div style="font-weight:600;" id="evalDetailPrincipal">Diana Shipping</div></div></div>
                        <div style="display:flex;align-items:center;gap:12px;"><i data-lucide="calendar" style="width:20px;height:20px;color:var(--cw-primary);"></i><div><div style="font-size:0.75rem;color:var(--cw-gray-500);text-transform:uppercase;">Evaluation Date</div><div style="font-weight:600;" id="evalDetailDate">2025-02-01</div></div></div>
                        <div style="display:flex;align-items:center;gap:12px;"><i data-lucide="user" style="width:20px;height:20px;color:var(--cw-primary);"></i><div><div style="font-size:0.75rem;color:var(--cw-gray-500);text-transform:uppercase;">Evaluated By</div><div style="font-weight:600;" id="evalDetailEvaluator">Capt. Santos</div></div></div>
                    </div>
                </div>
                
                <!-- Performance Criteria -->
                <div style="padding:24px 32px;">
                    <h4 style="margin:0 0 20px;font-size:1rem;color:var(--cw-gray-700);display:flex;align-items:center;gap:8px;"><i data-lucide="bar-chart-2" style="width:20px;height:20px;color:var(--cw-primary);"></i>Performance Criteria</h4>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
                        <!-- Technical Skills -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                <span style="font-weight:600;">Technical Skills</span>
                                <span style="font-size:1.25rem;font-weight:700;color:var(--cw-primary);" id="evalDetailTechnicalScore">5.0</span>
                            </div>
                            <div style="display:flex;gap:4px;margin-bottom:8px;" id="evalDetailTechnicalStars"></div>
                            <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div id="evalDetailTechnicalBar" style="height:100%;background:var(--status-ready);width:100%;transition:width 0.5s;"></div></div>
                        </div>
                        
                        <!-- Teamwork -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                <span style="font-weight:600;">Teamwork</span>
                                <span style="font-size:1.25rem;font-weight:700;color:var(--cw-primary);" id="evalDetailTeamworkScore">4.0</span>
                            </div>
                            <div style="display:flex;gap:4px;margin-bottom:8px;" id="evalDetailTeamworkStars"></div>
                            <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div id="evalDetailTeamworkBar" style="height:100%;background:#3b82f6;width:80%;transition:width 0.5s;"></div></div>
                        </div>
                        
                        <!-- Communication -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                <span style="font-weight:600;">Communication</span>
                                <span style="font-size:1.25rem;font-weight:700;color:var(--cw-primary);" id="evalDetailCommunicationScore">5.0</span>
                            </div>
                            <div style="display:flex;gap:4px;margin-bottom:8px;" id="evalDetailCommunicationStars"></div>
                            <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div id="evalDetailCommunicationBar" style="height:100%;background:var(--status-ready);width:100%;transition:width 0.5s;"></div></div>
                        </div>
                        
                        <!-- Reliability -->
                        <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                <span style="font-weight:600;">Reliability</span>
                                <span style="font-size:1.25rem;font-weight:700;color:var(--cw-primary);" id="evalDetailReliabilityScore">5.0</span>
                            </div>
                            <div style="display:flex;gap:4px;margin-bottom:8px;" id="evalDetailReliabilityStars"></div>
                            <div style="height:8px;background:var(--cw-gray-200);border-radius:4px;overflow:hidden;"><div id="evalDetailReliabilityBar" style="height:100%;background:var(--status-ready);width:100%;transition:width 0.5s;"></div></div>
                        </div>
                    </div>
                    
                    <!-- Overall Performance Bar -->
                    <div style="margin-top:24px;background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                            <span style="font-weight:600;font-size:1.1rem;">Overall Performance</span>
                            <span style="font-size:1.5rem;font-weight:700;color:var(--status-ready);">92%</span>
                        </div>
                        <div style="height:12px;background:var(--cw-gray-200);border-radius:6px;overflow:hidden;"><div id="evalDetailOverallBar" style="height:100%;background:var(--status-ready);width:92%;transition:width 0.8s;"></div></div>
                    </div>
                </div>
                
                <!-- Evaluator Comments -->
                <div style="padding:0 32px 24px;">
                    <h4 style="margin:0 0 16px;font-size:1rem;color:var(--cw-gray-700);display:flex;align-items:center;gap:8px;"><i data-lucide="message-square" style="width:20px;height:20px;color:var(--cw-primary);"></i>Evaluator's Comments</h4>
                    <div style="background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-left:4px solid var(--status-ready);border-radius:0 12px 12px 0;padding:20px;">
                        <p style="margin:0;font-style:italic;font-size:1.1rem;color:var(--cw-gray-700);line-height:1.6;" id="evalDetailComment">"Exceptional performance throughout the contract. Highly recommended for promotion."</p>
                        <p style="margin:12px 0 0;font-weight:600;color:var(--cw-gray-600);" id="evalDetailCommentAuthor">â€” Capt. Santos</p>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer" style="padding:20px 32px;background:var(--cw-gray-50);display:flex;justify-content:space-between;">
                <button class="btn btn-secondary" onclick="closeModal('evaluationDetailModal')"><i data-lucide="x"></i>Close</button>
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" onclick="printEvaluation()"><i data-lucide="printer"></i>Print</button>
                    <button class="btn btn-secondary" onclick="downloadEvaluationPdf()"><i data-lucide="download"></i>Download PDF</button>
                    <button class="btn btn-primary" onclick="closeModal('evaluationDetailModal'); openSeafarerProfile(window.currentEvaluation?.name)"><i data-lucide="user"></i>View Seafarer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Evaluation Modal -->
    <div class="modal-overlay" id="newEvaluationModal" onclick="closeModalOnOverlay(event,'newEvaluationModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:white;padding:24px;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="star" style="width:24px;height:24px;"></i></div>
                    <div>
                        <h3 style="margin:0;font-size:1.25rem;">New Evaluation</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Create post-service performance review</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('newEvaluationModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;max-height:60vh;overflow-y:auto;">
                <form id="newEvaluationForm">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Seafarer *</label>
                            <select class="form-select" id="newEvalSeafarer" required>
                                <option value="">Select seafarer...</option>
                                <option value="Juan Dela Cruz">Juan Dela Cruz - Chief Officer</option>
                                <option value="Mario Reyes">Mario Reyes - 2nd Engineer</option>
                                <option value="Roberto Garcia">Roberto Garcia - AB Seaman</option>
                                <option value="Eduardo Pascual">Eduardo Pascual - Chief Engineer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vessel *</label>
                            <select class="form-select" id="newEvalVessel" required>
                                <option value="">Select vessel...</option>
                                <option value="MV Diana Star">MV Diana Star</option>
                                <option value="MV Centrofin Glory">MV Centrofin Glory</option>
                                <option value="MV Pioneer Spirit">MV Pioneer Spirit</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Contract Period</label>
                        <input type="text" class="form-input" id="newEvalPeriod" placeholder="e.g., Nov 2024 - Feb 2025">
                    </div>
                    
                    <h4 style="margin:20px 0 16px;font-size:0.9rem;color:var(--cw-gray-600);text-transform:uppercase;">Performance Ratings</h4>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Technical Skills *</label>
                            <select class="form-select" id="newEvalTechnical" required>
                                <option value="">Select rating...</option>
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Teamwork *</label>
                            <select class="form-select" id="newEvalTeamwork" required>
                                <option value="">Select rating...</option>
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Communication *</label>
                            <select class="form-select" id="newEvalCommunication" required>
                                <option value="">Select rating...</option>
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Reliability *</label>
                            <select class="form-select" id="newEvalReliability" required>
                                <option value="">Select rating...</option>
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Comments & Recommendations *</label>
                        <textarea class="form-textarea" id="newEvalComment" rows="4" placeholder="Provide detailed feedback on the seafarer's performance..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Evaluator Name *</label>
                        <input type="text" class="form-input" id="newEvalEvaluator" placeholder="Your name and position" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('newEvaluationModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn btn-primary" onclick="saveNewEvaluation()"><i data-lucide="check"></i>Submit Evaluation</button>
            </div>
        </div>
    </div>

    <!-- New Complaint Modal -->
    <div class="modal-overlay" id="newComplaintModal" onclick="closeModalOnOverlay(event,'newComplaintModal')">
        <div class="modal large" onclick="event.stopPropagation()" style="max-width:700px;">
            <div class="modal-header" style="background:linear-gradient(135deg,#dc2626 0%,#ef4444 100%);color:white;padding:24px;">
                <div style="display:flex;align-items:center;gap:16px;">
                    <div style="width:48px;height:48px;border-radius:12px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="message-square-warning" style="width:24px;height:24px;"></i></div>
                    <div>
                        <h3 style="margin:0;font-size:1.25rem;">Submit New Complaint</h3>
                        <p style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">MLC 2006 Compliant Grievance Procedure</p>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('newComplaintModal')" style="color:white;opacity:0.8;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body" style="padding:24px;max-height:60vh;overflow-y:auto;">
                <div style="background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.3);border-radius:12px;padding:16px;margin-bottom:20px;">
                    <div style="display:flex;align-items:start;gap:12px;">
                        <i data-lucide="shield-check" style="width:24px;height:24px;color:#f59e0b;flex-shrink:0;margin-top:2px;"></i>
                        <div>
                            <strong style="color:#92400e;">Confidentiality Assured</strong>
                            <p style="margin:4px 0 0;font-size:0.9rem;color:#a16207;">All complaints are handled confidentially in accordance with MLC 2006. You may submit anonymously if preferred.</p>
                        </div>
                    </div>
                </div>
                <form id="newComplaintForm">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Complainant *</label>
                            <select class="form-select" id="newComplaintSeafarer" required>
                                <option value="">Select seafarer...</option>
                                <option value="Juan Dela Cruz">Juan Dela Cruz - Chief Officer</option>
                                <option value="Mario Reyes">Mario Reyes - 2nd Engineer</option>
                                <option value="Roberto Garcia">Roberto Garcia - AB Seaman</option>
                                <option value="Eduardo Pascual">Eduardo Pascual - Chief Engineer</option>
                                <option value="anonymous">Submit Anonymously</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vessel *</label>
                            <select class="form-select" id="newComplaintVessel" required>
                                <option value="">Select vessel...</option>
                                <option value="MV Diana Star">MV Diana Star - Diana Shipping</option>
                                <option value="MV Centrofin Glory">MV Centrofin Glory - Centrofin</option>
                                <option value="MV Pioneer Spirit">MV Pioneer Spirit - Pioneer Marine</option>
                                <option value="MV Neda Harmony">MV Neda Harmony - Neda Maritime</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                        <div class="form-group">
                            <label class="form-label">Category *</label>
                            <select class="form-select" id="newComplaintCategory" required>
                                <option value="">Select category...</option>
                                <option value="wages">ðŸ’° Wages & Benefits</option>
                                <option value="working-conditions">â° Working Conditions</option>
                                <option value="safety">âš ï¸ Safety & Health</option>
                                <option value="harassment">ðŸš« Harassment/Discrimination</option>
                                <option value="contract">ðŸ“„ Contract Issues</option>
                                <option value="food">ðŸ½ï¸ Food & Accommodation</option>
                                <option value="management">ðŸ‘” Management Issues</option>
                                <option value="other">ðŸ“‹ Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Priority *</label>
                            <select class="form-select" id="newComplaintPriority" required>
                                <option value="">Select priority...</option>
                                <option value="critical">ðŸ”´ Critical - Immediate attention required</option>
                                <option value="high">ðŸŸ  High - Urgent</option>
                                <option value="medium">ðŸŸ¡ Medium - Standard</option>
                                <option value="low">ðŸŸ¢ Low - Minor issue</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Subject *</label>
                        <input type="text" class="form-input" id="newComplaintSubject" placeholder="Brief description of the complaint" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Detailed Description *</label>
                        <textarea class="form-textarea" id="newComplaintDescription" rows="5" placeholder="Provide detailed information about the complaint including dates, persons involved, and any evidence..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Desired Resolution</label>
                        <textarea class="form-textarea" id="newComplaintResolution" rows="2" placeholder="What outcome would you like to see?"></textarea>
                    </div>
                    <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--cw-gray-50);border-radius:8px;">
                        <input type="checkbox" id="newComplaintAnonymous" style="width:18px;height:18px;">
                        <label for="newComplaintAnonymous" style="font-size:0.9rem;color:var(--cw-gray-700);cursor:pointer;">Submit this complaint anonymously (your identity will be protected)</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('newComplaintModal')"><i data-lucide="x"></i>Cancel</button>
                <button class="btn" onclick="saveNewComplaint()" style="background:#dc2626;color:white;"><i data-lucide="send"></i>Submit Complaint</button>
            </div>
        </div>
    </div>

    <!-- Complaint Detail Modal (Full Screen) -->
    <div class="modal-overlay" id="complaintDetailModal" onclick="closeModalOnOverlay(event,'complaintDetailModal')">
        <div class="modal" onclick="event.stopPropagation()" style="max-width:900px;width:95%;">
            <!-- Header -->
            <div class="modal-header" id="complaintDetailHeader" style="background:linear-gradient(135deg,#dc2626 0%,#ef4444 100%);color:white;padding:28px 32px;">
                <div style="display:flex;align-items:center;gap:20px;flex:1;">
                    <div style="width:64px;height:64px;border-radius:16px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;"><i data-lucide="message-square-warning" style="width:32px;height:32px;"></i></div>
                    <div style="flex:1;">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <h3 style="margin:0;font-size:1.5rem;font-weight:700;" id="complaintDetailId">CMP-2025-001</h3>
                            <span id="complaintDetailStatus" style="background:rgba(255,255,255,0.2);padding:4px 12px;border-radius:20px;font-size:0.8rem;font-weight:600;">OPEN</span>
                            <span id="complaintDetailPriority" style="background:#fbbf24;color:#92400e;padding:4px 12px;border-radius:20px;font-size:0.8rem;font-weight:600;">HIGH</span>
                        </div>
                        <p style="margin:8px 0 0;opacity:0.9;font-size:1.1rem;" id="complaintDetailSubject">Overtime payment discrepancy</p>
                    </div>
                    <div style="text-align:center;background:rgba(255,255,255,0.15);padding:12px 20px;border-radius:12px;">
                        <div style="font-size:2rem;font-weight:700;" id="complaintDetailDays">3</div>
                        <div style="font-size:0.8rem;opacity:0.8;">Days Open</div>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal('complaintDetailModal')" style="color:white;opacity:0.8;position:absolute;top:20px;right:20px;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
            </div>
            
            <div class="modal-body" style="padding:0;max-height:60vh;overflow-y:auto;">
                <!-- Info Bar -->
                <div style="background:var(--cw-gray-50);padding:20px 32px;border-bottom:1px solid var(--cw-gray-200);">
                    <div style="display:flex;gap:32px;flex-wrap:wrap;">
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="user" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Complainant</div><div style="font-weight:600;" id="complaintDetailSeafarer">Roberto Garcia</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="anchor" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Rank</div><div style="font-weight:600;" id="complaintDetailRank">AB Seaman</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="ship" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Vessel</div><div style="font-weight:600;" id="complaintDetailVessel">MV Pioneer Spirit</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="calendar" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Submitted</div><div style="font-weight:600;" id="complaintDetailDate">2025-02-08</div></div></div>
                        <div style="display:flex;align-items:center;gap:10px;"><i data-lucide="user-check" style="width:18px;height:18px;color:var(--cw-primary);"></i><div><div style="font-size:0.7rem;color:var(--cw-gray-500);text-transform:uppercase;">Assigned To</div><div style="font-weight:600;" id="complaintDetailAssigned">Maria Santos</div></div></div>
                    </div>
                </div>
                
                <!-- Description -->
                <div style="padding:24px 32px;">
                    <h4 style="margin:0 0 12px;display:flex;align-items:center;gap:8px;"><i data-lucide="file-text" style="width:20px;height:20px;color:var(--cw-primary);"></i>Complaint Details</h4>
                    <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;border-left:4px solid #ef4444;">
                        <p style="margin:0;line-height:1.7;color:var(--cw-gray-700);" id="complaintDetailDescription">Reported overtime hours for December 2024 not reflected in January payslip. Missing approximately 45 hours of OT.</p>
                    </div>
                </div>
                
                <!-- Category Badge -->
                <div style="padding:0 32px 24px;">
                    <div style="display:flex;gap:12px;flex-wrap:wrap;">
                        <span id="complaintDetailCategory" style="background:linear-gradient(135deg,#fef3c7,#fde68a);color:#92400e;padding:8px 16px;border-radius:20px;font-weight:600;font-size:0.9rem;">ðŸ’° Wages & Benefits</span>
                    </div>
                </div>
                
                <!-- Timeline -->
                <div style="padding:0 32px 24px;">
                    <h4 style="margin:0 0 16px;display:flex;align-items:center;gap:8px;"><i data-lucide="git-branch" style="width:20px;height:20px;color:var(--cw-primary);"></i>Activity Timeline</h4>
                    <div style="position:relative;padding-left:28px;border-left:2px solid var(--cw-gray-200);margin-left:8px;">
                        <div style="position:relative;padding-bottom:20px;">
                            <div style="position:absolute;left:-35px;width:14px;height:14px;border-radius:50%;background:#ef4444;border:3px solid white;box-shadow:0 0 0 2px #ef4444;"></div>
                            <div style="background:var(--cw-gray-50);padding:12px 16px;border-radius:8px;">
                                <div style="font-weight:600;">Complaint Submitted</div>
                                <div style="font-size:0.85rem;color:var(--cw-gray-500);" id="complaintTimelineSubmit">2025-02-08 09:30 by Roberto Garcia</div>
                            </div>
                        </div>
                        <div style="position:relative;padding-bottom:20px;">
                            <div style="position:absolute;left:-35px;width:14px;height:14px;border-radius:50%;background:#f59e0b;border:3px solid white;box-shadow:0 0 0 2px #f59e0b;"></div>
                            <div style="background:var(--cw-gray-50);padding:12px 16px;border-radius:8px;">
                                <div style="font-weight:600;">Assigned to Handler</div>
                                <div style="font-size:0.85rem;color:var(--cw-gray-500);">2025-02-08 10:15 - Assigned to Maria Santos (Crewing Manager)</div>
                            </div>
                        </div>
                        <div style="position:relative;">
                            <div style="position:absolute;left:-35px;width:14px;height:14px;border-radius:50%;background:var(--cw-gray-300);border:3px solid white;box-shadow:0 0 0 2px var(--cw-gray-300);"></div>
                            <div style="background:var(--cw-gray-50);padding:12px 16px;border-radius:8px;opacity:0.7;">
                                <div style="font-weight:600;">Pending Resolution</div>
                                <div style="font-size:0.85rem;color:var(--cw-gray-500);">Awaiting investigation and response</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Add Note Section -->
                <div style="padding:0 32px 24px;">
                    <h4 style="margin:0 0 12px;display:flex;align-items:center;gap:8px;"><i data-lucide="message-circle" style="width:20px;height:20px;color:var(--cw-primary);"></i>Add Note / Update</h4>
                    <div style="display:flex;gap:12px;">
                        <textarea class="form-textarea" id="complaintNewNote" rows="3" placeholder="Add investigation notes, updates, or response..." style="flex:1;"></textarea>
                        <button class="btn btn-primary" onclick="addComplaintNote()" style="height:fit-content;align-self:flex-end;"><i data-lucide="plus"></i>Add Note</button>
                    </div>
                </div>
                
                <!-- Assign Handler Section -->
                <div style="padding:0 32px 24px;">
                    <h4 style="margin:0 0 12px;display:flex;align-items:center;gap:8px;"><i data-lucide="user-check" style="width:20px;height:20px;color:var(--cw-primary);"></i>Assign Handler</h4>
                    <div style="display:flex;gap:12px;align-items:center;">
                        <select class="form-select" id="complaintAssignee" style="flex:1;">
                            <option value="">Select handler...</option>
                            <option value="Maria Santos">Maria Santos - Crewing Manager</option>
                            <option value="HR Manager">HR Manager</option>
                            <option value="Safety Officer">Safety Officer - DPA</option>
                            <option value="Fleet Manager">Fleet Manager</option>
                            <option value="Finance Dept">Finance Department</option>
                            <option value="Legal Dept">Legal Department</option>
                            <option value="Compliance Officer">Compliance Officer</option>
                        </select>
                        <button class="btn btn-secondary" onclick="assignComplaintHandler()"><i data-lucide="user-plus"></i>Assign</button>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer" style="padding:20px 32px;background:var(--cw-gray-50);display:flex;justify-content:space-between;">
                <button class="btn btn-secondary" onclick="closeModal('complaintDetailModal')"><i data-lucide="x"></i>Close</button>
                <div style="display:flex;gap:8px;">
                    <button class="btn btn-secondary" onclick="printComplaint()"><i data-lucide="printer"></i>Print</button>
                    <button class="btn btn-secondary" onclick="downloadComplaintPdf()"><i data-lucide="download"></i>Download</button>
                    <button class="btn btn-secondary" onclick="escalateComplaint()"><i data-lucide="alert-triangle"></i>Escalate</button>
                    <button class="btn" onclick="updateComplaintStatus('in-progress')" style="background:#f59e0b;color:white;"><i data-lucide="clock"></i>In Progress</button>
                    <button class="btn" onclick="resolveComplaintWithNotes()" style="background:#10b981;color:white;"><i data-lucide="check-circle"></i>Resolve</button>
                </div>
            </div>
        </div>
    </div>

    <!-- TALENT-POOL MODALS -->
    <div class="modal-overlay" id="tpChannelModal" onclick="closeModalOnOverlay(event,'tpChannelModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Sourcing Channel</h3><button class="modal-close" onclick="closeModal('tpChannelModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Channel Name <span class="required">*</span></label><input type="text" class="form-input" placeholder="e.g., Maritime Jobs PH"></div>
                    <div class="form-group"><label class="form-label">Channel Type <span class="required">*</span></label><select class="form-select"><option value="">Select type...</option><option value="agency">Agency</option><option value="job-board">Job Board</option><option value="walk-in">Walk-in</option><option value="referral">Referral</option><option value="social-media">Social Media</option><option value="school">Maritime School</option><option value="returning">Returning Crew</option></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Cost per Hire (USD)</label><input type="number" class="form-input" placeholder="0"></div>
                    <div class="form-group"><label class="form-label">Success Rate (%)</label><input type="number" class="form-input" placeholder="0" max="100"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Contact Person</label><input type="text" class="form-input" placeholder="Contact name"></div>
                    <div class="form-group"><label class="form-label">Contact Email</label><input type="email" class="form-input" placeholder="email@example.com"></div>
                </div>
                <div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" placeholder="Additional notes about this channel..."></textarea></div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('tpChannelModal')">Cancel</button><button class="btn btn-primary" onclick="saveChannel()"><i data-lucide="check"></i>Save Channel</button></div>
        </div>
    </div>
    
    <div class="modal-overlay" id="tpSalaryModal" onclick="closeModalOnOverlay(event,'tpSalaryModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Salary Range</h3><button class="modal-close" onclick="closeModal('tpSalaryModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Rank <span class="required">*</span></label><select class="form-select"><option value="">Select rank...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option><option>3rd Engineer</option></optgroup><optgroup label="Ratings"><option>Electrician</option><option>Bosun</option><option>AB</option><option>OS</option><option>Oiler</option><option>Wiper</option><option>Cook</option><option>Steward</option><option>Cadet</option></optgroup></select></div>
                    <div class="form-group"><label class="form-label">Vessel Type</label><select class="form-select"><option value="all">All Vessel Types</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container</option><option value="lng">LNG/LPG</option><option value="roro">RoRo</option></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Minimum Salary (USD) <span class="required">*</span></label><input type="number" class="form-input" placeholder="0"></div>
                    <div class="form-group"><label class="form-label">Maximum Salary (USD) <span class="required">*</span></label><input type="number" class="form-input" placeholder="0"></div>
                </div>
                <div class="form-group"><label class="form-label">Available Currencies</label>
                    <div style="display:flex;gap:20px;margin-top:8px;">
                        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" checked style="width:18px;height:18px;accent-color:var(--cw-accent);"> USD</label>
                        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" style="width:18px;height:18px;accent-color:var(--cw-accent);"> EUR</label>
                        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" style="width:18px;height:18px;accent-color:var(--cw-accent);"> PHP</label>
                        <label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" style="width:18px;height:18px;accent-color:var(--cw-accent);"> GBP</label>
                    </div>
                </div>
                <div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" placeholder="Negotiation notes..."></textarea></div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('tpSalaryModal')">Cancel</button><button class="btn btn-primary" onclick="saveSalaryRange()"><i data-lucide="check"></i>Save Range</button></div>
        </div>
    </div>
    
    <div class="modal-overlay" id="tpNfrModal" onclick="closeModalOnOverlay(event,'tpNfrModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header" style="background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);color:white;">
                <div style="display:flex;align-items:center;gap:12px;">
                    <i data-lucide="user-x" style="width:24px;height:24px;"></i>
                    <h3 class="modal-title" style="color:white;margin:0;">Add to Not for Rehire List</h3>
                </div>
                <button class="modal-close" onclick="closeModal('tpNfrModal')" style="color:white;"><i data-lucide="x" style="width:20px;height:20px;"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Seafarer <span class="required">*</span></label><select class="form-select"><option value="">Select seafarer...</option><option>Juan Dela Cruz (Chief Officer)</option><option>Mario Reyes (2nd Engineer)</option><option>Antonio Santos (Master)</option><option>Roberto Garcia (AB Seaman)</option><option>Eduardo Pascual (Chief Engineer)</option><option>Jose Martinez (Bosun)</option></select></div>
                    <div class="form-group"><label class="form-label">Type <span class="required">*</span></label><select class="form-select"><option value="nfr">Not for Rehire (NFR)</option><option value="watchlist">Watch List</option><option value="blacklist">Blacklisted</option><option value="principal-ban">Principal Ban</option></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Reason Category <span class="required">*</span></label><select class="form-select"><option value="">Select category...</option><option value="performance">Poor Performance</option><option value="misconduct">Misconduct</option><option value="abandonment">Contract Abandonment</option><option value="medical">Medical Disqualification</option><option value="documents">Document Issues</option><option value="principal">Principal Request</option><option value="other">Other</option></select></div>
                    <div class="form-group"><label class="form-label">Principal (if applicable)</label><select class="form-select"><option value="">All Principals</option><option>Diana Shipping</option><option>Centrofin</option><option>Pioneer Marine</option><option>Neda Maritime</option><option>Eurobulk</option></select></div>
                </div>
                <div class="form-group"><label class="form-label">Detailed Reason <span class="required">*</span></label><textarea class="form-textarea" rows="4" placeholder="Provide detailed explanation of the reason for adding to NFR list..."></textarea></div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Review Date (Optional)</label><input type="date" class="form-input"></div>
                    <div class="form-group"><label class="form-label">Supporting Documents</label><input type="file" class="form-input" multiple></div>
                </div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('tpNfrModal')">Cancel</button><button class="btn btn-primary" style="background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);" onclick="saveNfr()"><i data-lucide="user-x"></i>Add to NFR List</button></div>
        </div>
    </div>
    
    <div class="modal-overlay" id="tpAutoTagModal" onclick="closeModalOnOverlay(event,'tpAutoTagModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Auto-Tagging Rule</h3><button class="modal-close" onclick="closeModal('tpAutoTagModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Tag Name <span class="required">*</span></label><input type="text" class="form-input" placeholder="e.g., New Hire, Returning Crew"></div>
                    <div class="form-group"><label class="form-label">Tag Color</label>
                        <div style="display:flex;gap:12px;margin-top:8px;">
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#10b981" checked style="display:none;"><span style="width:36px;height:36px;background:#10b981;border-radius:8px;display:inline-block;border:3px solid #10b981;box-shadow:0 0 0 2px white, 0 0 0 4px #10b981;"></span></label>
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#3b82f6" style="display:none;"><span style="width:36px;height:36px;background:#3b82f6;border-radius:8px;display:inline-block;border:3px solid transparent;"></span></label>
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#8b5cf6" style="display:none;"><span style="width:36px;height:36px;background:#8b5cf6;border-radius:8px;display:inline-block;border:3px solid transparent;"></span></label>
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#f59e0b" style="display:none;"><span style="width:36px;height:36px;background:#f59e0b;border-radius:8px;display:inline-block;border:3px solid transparent;"></span></label>
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#ef4444" style="display:none;"><span style="width:36px;height:36px;background:#ef4444;border-radius:8px;display:inline-block;border:3px solid transparent;"></span></label>
                            <label style="cursor:pointer;"><input type="radio" name="tagColor" value="#06b6d4" style="display:none;"><span style="width:36px;height:36px;background:#06b6d4;border-radius:8px;display:inline-block;border:3px solid transparent;"></span></label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Condition Type <span class="required">*</span></label><select class="form-select"><option value="">Select condition...</option><option value="first-contract">First Contract (New Hire)</option><option value="returning">Gap > 6 months (Returning)</option><option value="experience">Experience Level</option><option value="source">Sourcing Channel</option><option value="rank">Specific Rank</option><option value="principal">Specific Principal</option><option value="performance">Performance Score</option></select></div>
                    <div class="form-group"><label class="form-label">Condition Value</label><input type="text" class="form-input" placeholder="e.g., > 5 years, Diana Shipping"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Auto-Apply</label><select class="form-select"><option value="yes">Yes - Apply automatically</option><option value="suggest">Suggest only</option><option value="manual">Manual confirmation required</option></select></div>
                    <div class="form-group"><label class="form-label">Status</label><select class="form-select"><option value="active">Active</option><option value="inactive">Inactive</option></select></div>
                </div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('tpAutoTagModal')">Cancel</button><button class="btn btn-primary" onclick="saveAutoTag()"><i data-lucide="check"></i>Save Rule</button></div>
        </div>
    </div>

    <!-- SEAFARER PROFILE MODALS -->
    <!-- Add Document Modal -->
    <div class="modal-overlay" id="addDocumentModal" onclick="closeModalOnOverlay(event,'addDocumentModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Document</h3><button class="modal-close" onclick="closeModal('addDocumentModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Document Type <span class="required">*</span></label>
                        <select class="form-select" id="newDocType">
                            <option value="">Select type...</option>
                            <optgroup label="Licenses"><option value="coc">COC (Certificate of Competency)</option><option value="goc">GOC (GMDSS Operator)</option><option value="seamans-book">Seaman's Book</option></optgroup>
                            <optgroup label="Certificates"><option value="stcw">STCW Certificate</option><option value="basic-safety">Basic Safety Training</option><option value="advanced-fire">Advanced Fire Fighting</option><option value="medical-care">Medical First Aid/Care</option><option value="survival-craft">Survival Craft & Rescue</option></optgroup>
                            <optgroup label="Travel"><option value="passport">Passport</option><option value="us-visa">US Visa (C1/D)</option><option value="schengen">Schengen Visa</option><option value="seaman-id">Seafarer ID</option></optgroup>
                            <optgroup label="Medical"><option value="medical-cert">Medical Certificate</option><option value="yellow-fever">Yellow Fever</option><option value="drug-test">Drug & Alcohol Test</option></optgroup>
                        </select>
                    </div>
                    <div class="form-group"><label class="form-label">Document Number <span class="required">*</span></label><input type="text" class="form-input" id="newDocNumber" placeholder="Enter document number"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Issue Date <span class="required">*</span></label><input type="date" class="form-input" id="newDocIssueDate"></div>
                    <div class="form-group"><label class="form-label">Expiry Date <span class="required">*</span></label><input type="date" class="form-input" id="newDocExpiryDate"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Issuing Authority</label><input type="text" class="form-input" id="newDocAuthority" placeholder="e.g., MARINA, DFA"></div>
                    <div class="form-group"><label class="form-label">Place of Issue</label><input type="text" class="form-input" id="newDocPlace" placeholder="e.g., Manila, Philippines"></div>
                </div>
                <div class="form-group"><label class="form-label">Upload Document</label><input type="file" class="form-input" id="newDocFile" accept=".pdf,.jpg,.jpeg,.png"></div>
                <div class="form-group"><label class="form-label">Notes</label><textarea class="form-textarea" id="newDocNotes" placeholder="Additional notes..."></textarea></div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('addDocumentModal')">Cancel</button><button class="btn btn-primary" onclick="saveNewDocument()"><i data-lucide="check"></i>Save Document</button></div>
        </div>
    </div>

    <!-- Add Sea Service Modal -->
    <div class="modal-overlay" id="addSeaServiceModal" onclick="closeModalOnOverlay(event,'addSeaServiceModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Sea Service Record</h3><button class="modal-close" onclick="closeModal('addSeaServiceModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Vessel Name <span class="required">*</span></label><input type="text" class="form-input" id="newSSVessel" placeholder="e.g., MV Pacific Star"></div>
                    <div class="form-group"><label class="form-label">Vessel Type</label>
                        <select class="form-select" id="newSSVesselType"><option value="">Select type...</option><option value="bulk">Bulk Carrier</option><option value="tanker">Tanker</option><option value="container">Container</option><option value="lng">LNG/LPG</option><option value="roro">RoRo</option><option value="passenger">Passenger</option></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Company / Principal <span class="required">*</span></label><input type="text" class="form-input" id="newSSCompany" placeholder="e.g., Diana Shipping"></div>
                    <div class="form-group"><label class="form-label">Flag State</label><input type="text" class="form-input" id="newSSFlag" placeholder="e.g., Panama, Liberia"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Rank <span class="required">*</span></label>
                        <select class="form-select" id="newSSRank"><option value="">Select rank...</option><optgroup label="Officers"><option>Master</option><option>Chief Officer</option><option>2nd Officer</option><option>3rd Officer</option><option>Chief Engineer</option><option>2nd Engineer</option><option>3rd Engineer</option></optgroup><optgroup label="Ratings"><option>Electrician</option><option>Bosun</option><option>AB</option><option>OS</option><option>Oiler</option><option>Wiper</option><option>Cook</option><option>Steward</option></optgroup></select>
                    </div>
                    <div class="form-group"><label class="form-label">GRT / DWT</label><input type="text" class="form-input" id="newSSGRT" placeholder="e.g., 45,000 DWT"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Sign On Date <span class="required">*</span></label><input type="date" class="form-input" id="newSSSignOn"></div>
                    <div class="form-group"><label class="form-label">Sign Off Date</label><input type="date" class="form-input" id="newSSSignOff"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Sign On Port</label><input type="text" class="form-input" id="newSSOnPort" placeholder="e.g., Manila"></div>
                    <div class="form-group"><label class="form-label">Sign Off Port</label><input type="text" class="form-input" id="newSSOffPort" placeholder="e.g., Singapore"></div>
                </div>
                <div class="form-group"><label class="form-label">Remarks</label><textarea class="form-textarea" id="newSSRemarks" placeholder="Additional remarks..."></textarea></div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('addSeaServiceModal')">Cancel</button><button class="btn btn-primary" onclick="saveNewSeaService()"><i data-lucide="check"></i>Save Record</button></div>
        </div>
    </div>

    <!-- Add Allotment Modal -->
    <div class="modal-overlay" id="addAllotmentModal" onclick="closeModalOnOverlay(event,'addAllotmentModal')">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Allotment</h3><button class="modal-close" onclick="closeModal('addAllotmentModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Beneficiary Name <span class="required">*</span></label><input type="text" class="form-input" id="newAllotBeneficiary" placeholder="Full name"></div>
                    <div class="form-group"><label class="form-label">Relationship <span class="required">*</span></label>
                        <select class="form-select" id="newAllotRelation"><option value="">Select...</option><option value="spouse">Spouse</option><option value="parent">Parent</option><option value="child">Child</option><option value="sibling">Sibling</option><option value="other">Other</option></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Bank Name <span class="required">*</span></label><input type="text" class="form-input" id="newAllotBank" placeholder="e.g., BDO Unibank"></div>
                    <div class="form-group"><label class="form-label">Account Number <span class="required">*</span></label><input type="text" class="form-input" id="newAllotAccount" placeholder="Account number"></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label">Amount (USD) <span class="required">*</span></label><input type="number" class="form-input" id="newAllotAmount" placeholder="0.00"></div>
                    <div class="form-group"><label class="form-label">Frequency</label>
                        <select class="form-select" id="newAllotFrequency"><option value="monthly">Monthly</option><option value="bi-weekly">Bi-weekly</option><option value="one-time">One-time</option></select>
                    </div>
                </div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('addAllotmentModal')">Cancel</button><button class="btn btn-primary" onclick="saveNewAllotment()"><i data-lucide="check"></i>Save Allotment</button></div>
        </div>
    </div>

    <!-- Add Note Modal -->
    <div class="modal-overlay" id="addNoteModal" onclick="closeModalOnOverlay(event,'addNoteModal')">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title">Add Note</h3><button class="modal-close" onclick="closeModal('addNoteModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body">
                <div class="form-group"><label class="form-label">Note Type</label>
                    <select class="form-select" id="newNoteType"><option value="info">Information</option><option value="positive">Positive Feedback</option><option value="warning">Warning</option><option value="reminder">Reminder</option></select>
                </div>
                <div class="form-group"><label class="form-label">Note Content <span class="required">*</span></label><textarea class="form-textarea" id="newNoteContent" rows="5" placeholder="Enter your note here..."></textarea></div>
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" id="newNotePrivate" style="width:18px;height:18px;"> Mark as private (only visible to you)</label>
                </div>
            </div>
            <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('addNoteModal')">Cancel</button><button class="btn btn-primary" onclick="saveNewNote()"><i data-lucide="check"></i>Save Note</button></div>
        </div>
    </div>

    <!-- View Document Modal -->
    <div class="modal-overlay" id="viewDocumentModal" onclick="closeModalOnOverlay(event,'viewDocumentModal')">
        <div class="modal large" onclick="event.stopPropagation()">
            <div class="modal-header"><h3 class="modal-title" id="viewDocTitle">Document Details</h3><button class="modal-close" onclick="closeModal('viewDocumentModal')"><i data-lucide="x" style="width:20px;height:20px;"></i></button></div>
            <div class="modal-body" id="viewDocContent"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('viewDocumentModal')">Close</button>
                <button class="btn btn-secondary" onclick="downloadDocument()"><i data-lucide="download"></i>Download</button>
                <button class="btn btn-primary" onclick="editDocument()"><i data-lucide="edit"></i>Edit</button>
            </div>
        </div>
    </div>

    <!-- Seafarer Profile Slide Panel -->
    <div class="panel-overlay" id="seafarerPanelOverlay" onclick="closePanel('seafarerPanel')"></div>
    <div class="slide-panel large" id="seafarerPanel">
        <div class="slide-panel-header" style="background:linear-gradient(135deg,#00495D 0%,#0891b2 100%);color:white;padding:24px;">
            <div style="display:flex;align-items:center;gap:16px;">
                <div id="seafarerPanelAvatar" style="width:64px;height:64px;border-radius:16px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;">JD</div>
                <div>
                    <h3 id="seafarerPanelName" style="margin:0;font-size:1.25rem;">Juan Dela Cruz</h3>
                    <p id="seafarerPanelRank" style="margin:4px 0 0;opacity:0.85;font-size:0.9rem;">Chief Officer</p>
                    <span id="seafarerPanelStatus" class="tag" style="margin-top:8px;background:rgba(255,255,255,0.2);color:white;">Embarked</span>
                </div>
            </div>
            <button class="modal-close" onclick="closePanel('seafarerPanel')" style="color:white;opacity:0.8;position:absolute;top:16px;right:16px;"><i data-lucide="x" style="width:24px;height:24px;"></i></button>
        </div>
        <div class="slide-panel-body" style="flex:1;overflow-y:auto;padding:24px;">
            <!-- Quick Stats -->
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:24px;">
                <div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);" id="seafarerDocsCount">24/24</div>
                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Documents</div>
                </div>
                <div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);" id="seafarerContractDays">156d</div>
                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Contract Left</div>
                </div>
                <div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;color:var(--status-ready);" id="seafarerPoolType">Dedicated</div>
                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Pool Type</div>
                </div>
            </div>
            
            <!-- Contact Info -->
            <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:20px;">
                <h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="user" style="width:16px;height:16px;"></i>Contact Information</h4>
                <div style="display:grid;gap:12px;">
                    <div style="display:flex;align-items:center;gap:12px;">
                        <i data-lucide="mail" style="width:18px;height:18px;color:var(--cw-gray-400);"></i>
                        <span id="seafarerEmail" style="color:var(--cw-gray-700);"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="93e0f6f2f5f2e1f6e1d3f6ebf2fee3fff6bdf0fcfe">[email&#160;protected]</a></span>
                    </div>
                    <div style="display:flex;align-items:center;gap:12px;">
                        <i data-lucide="phone" style="width:18px;height:18px;color:var(--cw-gray-400);"></i>
                        <span id="seafarerPhone" style="color:var(--cw-gray-700);">+63 917 123 4567</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:12px;">
                        <i data-lucide="map-pin" style="width:18px;height:18px;color:var(--cw-gray-400);"></i>
                        <span id="seafarerLocation" style="color:var(--cw-gray-700);">Quezon City, Metro Manila</span>
                    </div>
                </div>
            </div>
            
            <!-- Assignment Info -->
            <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:20px;">
                <h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="anchor" style="width:16px;height:16px;"></i>Current Assignment</h4>
                <div id="seafarerAssignment">
                    <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
                        <div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#00495D,#0891b2);display:flex;align-items:center;justify-content:center;"><i data-lucide="ship" style="width:20px;height:20px;color:white;"></i></div>
                        <div>
                            <div id="seafarerVessel" style="font-weight:600;color:var(--cw-gray-800);">MV Diana Star</div>
                            <div id="seafarerVesselType" style="font-size:0.8rem;color:var(--cw-gray-500);">Bulk Carrier â€¢ Diana Shipping</div>
                        </div>
                    </div>
                    <div style="display:flex;gap:16px;font-size:0.85rem;">
                        <div><span style="color:var(--cw-gray-500);">Contract End:</span> <strong id="seafarerContractEnd">2025-08-15</strong></div>
                    </div>
                </div>
                <div id="seafarerNoAssignment" style="display:none;color:var(--cw-gray-500);font-style:italic;">Not currently assigned to a vessel</div>
            </div>
            
            <!-- Quick Actions -->
            <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;">
                <h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:8px;"><i data-lucide="zap" style="width:16px;height:16px;"></i>Quick Actions</h4>
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px;">
                    <button class="btn btn-secondary btn-sm" onclick="viewSeafarerDocuments()"><i data-lucide="file-check"></i>View Documents</button>
                    <button class="btn btn-secondary btn-sm" onclick="viewSeafarerContracts()"><i data-lucide="file-signature"></i>Contracts</button>
                    <button class="btn btn-secondary btn-sm" onclick="sendSeafarerEmail()"><i data-lucide="mail"></i>Send Email</button>
                    <button class="btn btn-secondary btn-sm" onclick="viewSeafarerHistory()"><i data-lucide="history"></i>History</button>
                </div>
            </div>
        </div>
        <div class="slide-panel-footer" style="padding:16px 24px;border-top:1px solid var(--cw-gray-100);display:flex;gap:12px;">
            <button class="btn btn-secondary" onclick="closePanel('seafarerPanel')" style="flex:1;"><i data-lucide="x"></i>Close</button>
            <button class="btn btn-primary" onclick="editSeafarer()" style="flex:1;"><i data-lucide="edit-3"></i>Edit Profile</button>
        </div>
    </div>

    <script>
        // MOCK DATA - Seafarers
        const MOCK_SEAFARERS = [
            { id: 'CW-2024-00142', firstName: 'Juan', lastName: 'Dela Cruz', rank: 'Chief Officer', rankType: 'officer', status: 'embarked', poolType: 'dedicated', assigned: true, vessel: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', contractEnd: '2025-08-15', docsComplete: 24, docsTotal: 24, email: 'juan.delacruz@email.com', phone: '+63 917 123 4567', location: 'Quezon City, Metro Manila', tags: [] },
            { id: 'CW-2023-00891', firstName: 'Mario', lastName: 'Reyes', rank: '2nd Engineer', rankType: 'officer', status: 'on-preparation', poolType: 'dedicated', assigned: true, vessel: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', contractEnd: '2025-09-20', docsComplete: 18, docsTotal: 24, email: 'mario.reyes@email.com', phone: '+63 917 234 5678', location: 'Cebu City', tags: [] },
            { id: 'CW-2022-00567', firstName: 'Antonio', lastName: 'Santos', rank: 'Master', rankType: 'officer', status: 'embarked', poolType: 'dedicated', assigned: true, vessel: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', contractEnd: '2025-03-28', docsComplete: 24, docsTotal: 24, email: 'antonio.santos@email.com', phone: '+63 917 345 6789', location: 'Manila', tags: [] },
            { id: 'CW-2024-00234', firstName: 'Roberto', lastName: 'Garcia', rank: 'AB Seaman', rankType: 'rating', status: 'endorsed', poolType: 'non-dedicated', assigned: false, vessel: null, vesselType: null, principal: null, contractEnd: null, docsComplete: 20, docsTotal: 20, email: 'roberto.garcia@email.com', phone: '+63 917 456 7890', location: 'Davao City', tags: [] },
            { id: 'CW-2021-00123', firstName: 'Eduardo', lastName: 'Pascual', rank: 'Chief Engineer', rankType: 'officer', status: 'ready', poolType: 'dedicated', assigned: true, vessel: 'MV Neda Harmony', vesselType: 'LNG Carrier', principal: 'Neda Maritime', contractEnd: '2025-07-10', docsComplete: 26, docsTotal: 26, email: 'eduardo.pascual@email.com', phone: '+63 917 567 8901', location: 'Iloilo City', tags: [] },
            { id: 'CW-2023-00456', firstName: 'Jose', lastName: 'Martinez', rank: 'Bosun', rankType: 'rating', status: 'on-approval', poolType: 'non-dedicated', assigned: true, vessel: 'MV Eurobulk Pride', vesselType: 'Bulk Carrier', principal: 'Eurobulk', contractEnd: '2025-10-05', docsComplete: 20, docsTotal: 24, email: 'jose.martinez@email.com', phone: '+63 917 678 9012', location: 'Batangas', tags: [] },
            { id: 'CW-2020-00089', firstName: 'Fernando', lastName: 'Bautista', rank: '3rd Officer', rankType: 'officer', status: 'embarked', poolType: 'dedicated', assigned: true, vessel: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', contractEnd: '2025-02-28', docsComplete: 15, docsTotal: 24, email: 'fernando.bautista@email.com', phone: '+63 917 789 0123', location: 'Pangasinan', tags: ['on-leave'] },
            { id: 'CW-2019-00345', firstName: 'Carlos', lastName: 'Aquino', rank: 'Oiler', rankType: 'rating', status: 'inactive', poolType: 'non-dedicated', assigned: false, vessel: null, vesselType: null, principal: null, contractEnd: null, docsComplete: 8, docsTotal: 20, email: 'carlos.aquino@email.com', phone: '+63 917 890 1234', location: 'Bulacan', tags: ['nfr'] },
            { id: 'CW-2024-00567', firstName: 'Ramon', lastName: 'Lopez', rank: 'Cook', rankType: 'rating', status: 'embarked', poolType: 'dedicated', assigned: true, vessel: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', contractEnd: '2025-11-30', docsComplete: 18, docsTotal: 18, email: 'ramon.lopez@email.com', phone: '+63 917 901 2345', location: 'Zambales', tags: [] },
            { id: 'CW-2022-00789', firstName: 'Daniel', lastName: 'Villanueva', rank: '2nd Officer', rankType: 'officer', status: 'on-preparation', poolType: 'non-dedicated', assigned: true, vessel: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', contractEnd: '2025-06-15', docsComplete: 21, docsTotal: 24, email: 'daniel.villanueva@email.com', phone: '+63 917 012 3456', location: 'Laguna', tags: [] },
        ];

        // MOCK DATA - RFAs
        const MOCK_RFAS = [
            { id: 'RFA-2025-0142', type: 'embark', status: 'in-progress', vessel: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', position: 'Chief Officer', seafarer: 'Juan Dela Cruz', targetDate: '2025-03-15', createdDate: '2025-02-01', priority: 'high' },
            { id: 'RFA-2025-0143', type: 'signoff', status: 'pending-approval', vessel: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', position: '2nd Engineer', seafarer: 'Mario Reyes', targetDate: '2025-03-20', createdDate: '2025-02-05', priority: 'normal' },
            { id: 'RFA-2025-0144', type: 'embark', status: 'new', vessel: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', position: 'AB Seaman', seafarer: null, targetDate: '2025-04-01', createdDate: '2025-02-10', priority: 'normal' },
            { id: 'RFA-2025-0145', type: 'promotion', status: 'approved', vessel: 'MV Neda Harmony', vesselType: 'LNG Carrier', principal: 'Neda Maritime', position: 'Chief Engineer', seafarer: 'Eduardo Pascual', targetDate: '2025-03-25', createdDate: '2025-01-28', priority: 'normal' },
            { id: 'RFA-2025-0146', type: 'extension', status: 'in-preparation', vessel: 'MV Eurobulk Pride', vesselType: 'Bulk Carrier', principal: 'Eurobulk', position: 'Bosun', seafarer: 'Jose Martinez', targetDate: '2025-04-10', createdDate: '2025-02-08', priority: 'low' },
            { id: 'RFA-2025-0147', type: 'replace', status: 'new', vessel: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', position: '3rd Officer', seafarer: null, targetDate: '2025-03-10', createdDate: '2025-02-11', priority: 'urgent' },
            { id: 'RFA-2025-0148', type: 'embark', status: 'ready', vessel: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', position: 'Cook', seafarer: 'Ramon Lopez', targetDate: '2025-02-28', createdDate: '2025-01-20', priority: 'normal' },
            { id: 'RFA-2025-0149', type: 'signoff', status: 'completed', vessel: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', position: '2nd Officer', seafarer: 'Daniel Villanueva', targetDate: '2025-02-15', createdDate: '2025-01-15', priority: 'normal' },
            { id: 'RFA-2025-0150', type: 'embark', status: 'cancelled', vessel: 'MV Neda Harmony', vesselType: 'LNG Carrier', principal: 'Neda Maritime', position: 'Oiler', seafarer: 'Carlos Aquino', targetDate: '2025-02-20', createdDate: '2025-01-10', priority: 'normal' },
            { id: 'RFA-2025-0151', type: 'extension', status: 'pending-approval', vessel: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', position: 'Master', seafarer: 'Antonio Santos', targetDate: '2025-04-15', createdDate: '2025-02-09', priority: 'high' },
        ];

        // MOCK DATA - Vessels with Crew Rotations
        // MOCK DATA - Candidates Pipeline
        const MOCK_CANDIDATES = [
            // NEW
            { id: 'CAND-001', firstName: 'Ricardo', lastName: 'Mendoza', rank: 'Chief Officer', stage: 'new', daysInStage: 1, source: 'walk-in', rfcId: 'RFC-2025-042', priority: 'high', docsStatus: 'pending', phone: '+63 917 111 2222', email: 'ricardo.m@email.com' },
            { id: 'CAND-002', firstName: 'Miguel', lastName: 'Torres', rank: '2nd Engineer', stage: 'new', daysInStage: 2, source: 'referral', rfcId: null, priority: 'normal', docsStatus: 'pending', phone: '+63 917 222 3333', email: 'miguel.t@email.com' },
            { id: 'CAND-003', firstName: 'Pablo', lastName: 'Cruz', rank: 'AB Seaman', stage: 'new', daysInStage: 0, source: 'online', rfcId: 'RFC-2025-040', priority: 'urgent', docsStatus: 'pending', phone: '+63 917 333 4444', email: 'pablo.c@email.com' },
            { id: 'CAND-004', firstName: 'Leonardo', lastName: 'Ramos', rank: 'Bosun', stage: 'new', daysInStage: 3, source: 'agency', rfcId: null, priority: 'normal', docsStatus: 'pending', phone: '+63 917 444 5555', email: 'leo.r@email.com' },
            // SCREENING
            { id: 'CAND-005', firstName: 'Arturo', lastName: 'Bautista', rank: 'Master', stage: 'screening', daysInStage: 4, source: 'referral', rfcId: null, priority: 'high', docsStatus: 'partial', phone: '+63 917 555 6666', email: 'arturo.b@email.com' },
            { id: 'CAND-006', firstName: 'Carlos', lastName: 'Fernandez', rank: 'Chief Officer', stage: 'screening', daysInStage: 2, source: 'walk-in', rfcId: 'RFC-2025-042', priority: 'normal', docsStatus: 'ok', phone: '+63 917 666 7777', email: 'carlos.f@email.com' },
            { id: 'CAND-007', firstName: 'Diego', lastName: 'Villanueva', rank: '3rd Officer', stage: 'screening', daysInStage: 5, source: 'online', rfcId: null, priority: 'normal', docsStatus: 'partial', phone: '+63 917 777 8888', email: 'diego.v@email.com' },
            // INTERVIEW
            { id: 'CAND-008', firstName: 'Ernesto', lastName: 'Garcia', rank: 'Chief Engineer', stage: 'interview', daysInStage: 2, source: 'agency', rfcId: null, priority: 'high', docsStatus: 'ok', phone: '+63 917 888 9999', email: 'ernesto.g@email.com' },
            { id: 'CAND-009', firstName: 'Francisco', lastName: 'Lopez', rank: '2nd Officer', stage: 'interview', daysInStage: 1, source: 'referral', rfcId: null, priority: 'normal', docsStatus: 'ok', phone: '+63 917 999 0000', email: 'francisco.l@email.com' },
            { id: 'CAND-010', firstName: 'Gabriel', lastName: 'Santos', rank: 'AB Seaman', stage: 'interview', daysInStage: 3, source: 'walk-in', rfcId: 'RFC-2025-040', priority: 'normal', docsStatus: 'ok', phone: '+63 917 000 1111', email: 'gabriel.s@email.com' },
            // NEGOTIATION
            { id: 'CAND-011', firstName: 'Hector', lastName: 'Reyes', rank: 'Chief Officer', stage: 'negotiation', daysInStage: 4, source: 'referral', rfcId: 'RFC-2025-042', priority: 'high', docsStatus: 'ok', phone: '+63 917 121 2121', email: 'hector.r@email.com' },
            { id: 'CAND-012', firstName: 'Ivan', lastName: 'Aquino', rank: '2nd Engineer', stage: 'negotiation', daysInStage: 6, source: 'agency', rfcId: 'RFC-2025-041', priority: 'normal', docsStatus: 'ok', phone: '+63 917 131 3131', email: 'ivan.a@email.com' },
            // ENDORSED
            { id: 'CAND-013', firstName: 'Julio', lastName: 'Pascual', rank: 'Master', stage: 'endorsed', daysInStage: 0, source: 'referral', rfcId: null, priority: 'normal', docsStatus: 'ok', phone: '+63 917 141 4141', email: 'julio.p@email.com' },
            { id: 'CAND-014', firstName: 'Kevin', lastName: 'Martinez', rank: 'Chief Officer', stage: 'endorsed', daysInStage: 2, source: 'walk-in', rfcId: 'RFC-2025-042', priority: 'normal', docsStatus: 'ok', phone: '+63 917 151 5151', email: 'kevin.m@email.com' },
            { id: 'CAND-015', firstName: 'Luis', lastName: 'Rivera', rank: 'Bosun', stage: 'endorsed', daysInStage: 1, source: 'agency', rfcId: null, priority: 'normal', docsStatus: 'ok', phone: '+63 917 161 6161', email: 'luis.r@email.com' },
            // REJECTED
            { id: 'CAND-016', firstName: 'Manuel', lastName: 'Ortega', rank: 'Oiler', stage: 'rejected', daysInStage: 0, source: 'online', rfcId: null, priority: 'normal', docsStatus: 'incomplete', phone: '+63 917 171 7171', email: 'manuel.o@email.com' },
        ];

        // MOCK DATA - Supernumerary Personnel
        const MOCK_SUPERNUMERARY = [
            { 
                id: 'SUP-001', 
                name: 'John Smith', 
                initials: 'JS',
                nationality: 'GB United Kingdom',
                company: 'Maritime Inspection Ltd',
                email: 'john.smith@maritime-inspect.com',
                phone: '+44 20 7123 4567',
                category: 'inspector', 
                categoryLabel: 'Flag State Inspector',
                status: 'embarked', 
                vessel: 'MV APOLLON', 
                port: 'Piraeus, Greece',
                embarkedDate: '2026-02-01', 
                disembarkDate: '2026-02-13',
                duration: 12,
                purpose: 'Flag State Inspection',
                remarks: 'Annual safety inspection and crew certification verification.',
                createdDate: '2026-01-15',
                approvedDate: '2026-01-20'
            },
            { 
                id: 'SUP-002', 
                name: 'Maria Santos', 
                initials: 'MS',
                nationality: 'PH Philippines',
                company: 'Port Control Authority',
                email: 'maria.santos@portcontrol.sg',
                phone: '+65 6123 4567',
                category: 'observer', 
                categoryLabel: 'Port State Observer',
                status: 'pending', 
                vessel: 'MV ATHENA', 
                port: 'Singapore',
                embarkedDate: null, 
                disembarkDate: null,
                scheduledDate: '2026-02-18',
                duration: null,
                purpose: 'Audit',
                remarks: 'Scheduled port state control observation',
                createdDate: '2026-01-10',
                approvedDate: '2026-01-25'
            },
            { 
                id: 'SUP-003', 
                name: 'David Lee', 
                initials: 'DL',
                nationality: 'SG Singapore',
                company: 'Marine Technical Services',
                email: 'david.lee@marinetechsg.com',
                phone: '+65 8123 4567',
                category: 'superintendent', 
                categoryLabel: 'Technical Superintendent',
                status: 'disembarked', 
                vessel: 'MV POSEIDON', 
                port: 'Rotterdam',
                embarkedDate: '2026-01-28', 
                disembarkDate: '2026-02-05',
                duration: 7,
                purpose: 'Technical',
                remarks: 'Completed machinery inspection and repairs oversight',
                createdDate: '2026-01-05',
                approvedDate: '2026-01-12'
            }
        ];

        // MOCK DATA - Crew Changes
        const MOCK_CREW_CHANGES = [
            {
                id: 'CC-001',
                type: 'embark',
                name: 'John Doe',
                rank: 'Chief Engineer',
                vessel: 'MV APOLLON',
                port: 'Piraeus',
                date: '2026-02-15',
                status: 'confirmed'
            },
            {
                id: 'CC-002',
                type: 'signoff',
                name: 'Maria Santos',
                rank: '2nd Officer',
                vessel: 'MV ATHENA',
                port: 'Singapore',
                date: '2026-02-18',
                status: 'planning'
            },
            {
                id: 'CC-003',
                type: 'embark',
                name: 'David Chen',
                rank: 'Bosun',
                vessel: 'MV ZEUS',
                port: 'Singapore',
                date: '2026-02-20',
                status: 'confirmed'
            },
            {
                id: 'CC-004',
                type: 'signoff',
                name: 'Robert Taylor',
                rank: 'AB Seaman',
                vessel: 'MV POSEIDON',
                port: 'Rotterdam',
                date: '2026-02-22',
                status: 'planning'
            },
            {
                id: 'CC-005',
                type: 'embark',
                name: 'Ahmed Hassan',
                rank: '3rd Engineer',
                vessel: 'MV ARTEMIS',
                port: 'Dubai',
                date: '2026-02-25',
                status: 'planning'
            },
            {
                id: 'CC-006',
                type: 'signoff',
                name: 'Carlos Rodriguez',
                rank: 'Cook',
                vessel: 'MV HERMES',
                port: 'Singapore',
                date: '2026-02-28',
                status: 'confirmed'
            },
            {
                id: 'CC-007',
                type: 'embark',
                name: 'Li Wang',
                rank: 'Oiler',
                vessel: 'MV ATHENA',
                port: 'Singapore',
                date: '2026-03-02',
                status: 'planning'
            },
            {
                id: 'CC-008',
                type: 'signoff',
                name: 'Jose Garcia',
                rank: 'Chief Officer',
                vessel: 'MV APOLLON',
                port: 'Piraeus',
                date: '2026-03-05',
                status: 'confirmed'
            },
            {
                id: 'CC-009',
                type: 'embark',
                name: 'Michael Brown',
                rank: '2nd Engineer',
                vessel: 'MV ZEUS',
                port: 'Rotterdam',
                date: '2026-03-08',
                status: 'planning'
            },
            {
                id: 'CC-010',
                type: 'signoff',
                name: 'Abdul Rahman',
                rank: 'Fitter',
                vessel: 'MV ARTEMIS',
                port: 'Dubai',
                date: '2026-03-10',
                status: 'confirmed'
            },
            {
                id: 'CC-011',
                type: 'embark',
                name: 'James Wilson',
                rank: 'Master',
                vessel: 'MV HERMES',
                port: 'Piraeus',
                date: '2026-03-12',
                status: 'planning'
            },
            {
                id: 'CC-012',
                type: 'signoff',
                name: 'Thomas Anderson',
                rank: 'Electrician',
                vessel: 'MV POSEIDON',
                port: 'Rotterdam',
                date: '2026-03-14',
                status: 'confirmed'
            }
        ];

        // MOCK DATA - Evaluations
        const MOCK_EVALUATIONS = [
            { id: 'EVAL-001', name: 'Juan Dela Cruz', rank: 'Chief Officer', vessel: 'MV Diana Star', principal: 'Diana Shipping', period: 'Nov 2024 - Feb 2025', scores: { technical: 5, teamwork: 4, communication: 5, reliability: 5, leadership: 4 }, avgScore: 4.6, rating: 'excellent', comment: 'Exceptional performance throughout the contract. Highly recommended for promotion.', evaluator: 'Capt. Santos', date: '2025-02-05' },
            { id: 'EVAL-002', name: 'Mario Reyes', rank: '2nd Engineer', vessel: 'MV Centrofin Glory', principal: 'Centrofin', period: 'Dec 2024 - Feb 2025', scores: { technical: 4, teamwork: 5, communication: 4, reliability: 4, leadership: 4 }, avgScore: 4.2, rating: 'good', comment: 'Solid performance. Good team player with strong technical skills.', evaluator: 'C/E Pascual', date: '2025-02-03' },
            { id: 'EVAL-003', name: 'Roberto Garcia', rank: 'AB Seaman', vessel: 'MV Pioneer Spirit', principal: 'Pioneer Marine', period: 'Oct 2024 - Feb 2025', scores: { technical: 4, teamwork: 4, communication: 3, reliability: 4, leadership: 3 }, avgScore: 3.6, rating: 'good', comment: 'Dependable crew member. Needs improvement in communication.', evaluator: 'Bosun Martinez', date: '2025-02-01' },
            { id: 'EVAL-004', name: 'Antonio Santos', rank: 'Master', vessel: 'MV Neda Harmony', principal: 'Neda Maritime', period: 'Sep 2024 - Jan 2025', scores: { technical: 5, teamwork: 5, communication: 5, reliability: 5, leadership: 5 }, avgScore: 5.0, rating: 'excellent', comment: 'Outstanding captain. Exemplary leadership and safety record.', evaluator: 'Fleet Manager', date: '2025-01-28' },
            { id: 'EVAL-005', name: 'Carlos Aquino', rank: 'Oiler', vessel: 'MV Diana Ocean', principal: 'Diana Shipping', period: 'Nov 2024 - Jan 2025', scores: { technical: 3, teamwork: 3, communication: 3, reliability: 3, leadership: 2 }, avgScore: 2.8, rating: 'average', comment: 'Meets basic requirements. Needs more experience and training.', evaluator: 'C/E Reyes', date: '2025-01-25' },
            { id: 'EVAL-006', name: 'Ramon Lopez', rank: 'Cook', vessel: 'MV Centrofin Titan', principal: 'Centrofin', period: 'Oct 2024 - Feb 2025', scores: { technical: 5, teamwork: 5, communication: 4, reliability: 5, leadership: 4 }, avgScore: 4.6, rating: 'excellent', comment: 'Excellent galley management. Crew very satisfied with meals.', evaluator: 'Capt. Torres', date: '2025-02-04' },
        ];

        // MOCK DATA - Complaints & Grievances
        const MOCK_COMPLAINTS = [
            { id: 'CMP-2025-001', seafarer: 'Roberto Garcia', rank: 'AB Seaman', vessel: 'MV Pioneer Spirit', principal: 'Pioneer Marine', category: 'wages', priority: 'high', status: 'open', subject: 'Overtime payment discrepancy', description: 'Reported overtime hours for December 2024 not reflected in January payslip. Missing approximately 45 hours of OT.', dateSubmitted: '2025-02-08', assignedTo: 'Maria Santos', daysOpen: 3, anonymous: false },
            { id: 'CMP-2025-002', seafarer: 'Anonymous', rank: 'Rating', vessel: 'MV Diana Star', principal: 'Diana Shipping', category: 'harassment', priority: 'critical', status: 'escalated', subject: 'Verbal harassment by senior officer', description: 'Continuous verbal abuse and threatening behavior from deck officer. Creating hostile work environment.', dateSubmitted: '2025-02-06', assignedTo: 'HR Manager', daysOpen: 5, anonymous: true },
            { id: 'CMP-2025-003', seafarer: 'Miguel Torres', rank: '3rd Engineer', vessel: 'MV Centrofin Glory', principal: 'Centrofin', category: 'safety', priority: 'critical', status: 'in-progress', subject: 'Defective safety equipment in engine room', description: 'Fire extinguishers in engine room are past inspection date. Safety shower not functioning properly.', dateSubmitted: '2025-02-05', assignedTo: 'Safety Officer', daysOpen: 6, anonymous: false },
            { id: 'CMP-2025-004', seafarer: 'Carlos Aquino', rank: 'Oiler', vessel: 'MV Diana Ocean', principal: 'Diana Shipping', category: 'food', priority: 'medium', status: 'in-progress', subject: 'Poor food quality and variety', description: 'Food quality has deteriorated significantly. Limited fresh vegetables and fruits. Same menu rotating weekly.', dateSubmitted: '2025-02-04', assignedTo: 'Fleet Manager', daysOpen: 7, anonymous: false },
            { id: 'CMP-2025-005', seafarer: 'Fernando Bautista', rank: '3rd Officer', vessel: 'MV Neda Harmony', principal: 'Neda Maritime', category: 'working-conditions', priority: 'high', status: 'open', subject: 'Excessive working hours beyond MLC limits', description: 'Work/rest hours consistently exceeding MLC 2006 limits. Average 16-hour days for past 3 weeks.', dateSubmitted: '2025-02-07', assignedTo: 'Compliance Officer', daysOpen: 4, anonymous: false },
            { id: 'CMP-2025-006', seafarer: 'Antonio Cruz', rank: 'Bosun', vessel: 'MV Oldendorff Star', principal: 'Oldendorff', category: 'contract', priority: 'medium', status: 'in-progress', subject: 'Contract extension without proper notice', description: 'Contract extended by 2 months without prior consultation or agreement. Family emergency requires return.', dateSubmitted: '2025-02-03', assignedTo: 'Crewing Manager', daysOpen: 8, anonymous: false },
            { id: 'CMP-2025-007', seafarer: 'Anonymous', rank: 'Officer', vessel: 'MV Pioneer Spirit', principal: 'Pioneer Marine', category: 'management', priority: 'low', status: 'open', subject: 'Unfair cabin assignment', description: 'Senior officers assigned better cabins despite same rank. Request for cabin reassignment denied without reason.', dateSubmitted: '2025-02-09', assignedTo: 'Unassigned', daysOpen: 2, anonymous: true },
            { id: 'CMP-2024-148', seafarer: 'Juan Dela Cruz', rank: 'Chief Officer', vessel: 'MV Diana Star', principal: 'Diana Shipping', category: 'wages', priority: 'medium', status: 'resolved', subject: 'Allotment transfer delay', description: 'Monthly allotment to family delayed by 2 weeks. Caused financial hardship for dependents.', dateSubmitted: '2025-01-15', assignedTo: 'Finance Dept', daysOpen: 0, resolvedDate: '2025-01-20', resolution: 'Bank transfer issue identified and corrected. Allotment sent with apology bonus.', anonymous: false },
            { id: 'CMP-2024-147', seafarer: 'Mario Reyes', rank: '2nd Engineer', vessel: 'MV Centrofin Glory', principal: 'Centrofin', category: 'safety', priority: 'high', status: 'resolved', subject: 'PPE not replaced timely', description: 'Safety boots worn out and request for replacement ignored for 3 weeks.', dateSubmitted: '2025-01-10', assignedTo: 'Safety Officer', daysOpen: 0, resolvedDate: '2025-01-15', resolution: 'New PPE issued immediately. Implemented monthly PPE inspection checklist.', anonymous: false },
            { id: 'CMP-2024-145', seafarer: 'Eduardo Pascual', rank: 'Chief Engineer', vessel: 'MV Pioneer Spirit', principal: 'Pioneer Marine', category: 'working-conditions', priority: 'medium', status: 'closed', subject: 'Air conditioning not working in cabin', description: 'Cabin AC unit broken for 2 weeks. Temperature reaching 35Â°C in tropical waters.', dateSubmitted: '2025-01-05', assignedTo: 'Technical Dept', daysOpen: 0, resolvedDate: '2025-01-08', resolution: 'AC unit replaced. Added to preventive maintenance schedule.', anonymous: false },
        ];

        const MOCK_OPEN_RFAS = [
            { id: 'RFA-2026-001', type: 'Embark', vessel: 'MV APOLLON', imo: '9234567', client: 'Diana Shipping', rank: 'Chief Officer', joinDate: '2026-03-15', urgent: true, proposalsCount: 2, status: 'proposed', daysUntil: 31 },
            { id: 'RFA-2026-002', type: 'Sign-off', vessel: 'MV ATHENA', imo: '9345678', client: 'Centrofin', rank: '2nd Engineer', joinDate: '2026-03-20', urgent: false, proposalsCount: 1, status: 'proposed', daysUntil: 36 },
            { id: 'RFA-2026-003', type: 'Embark', vessel: 'MV POSEIDON', imo: '9456789', client: 'Pioneer Marine', rank: 'Bosun', joinDate: '2026-03-10', urgent: true, proposalsCount: 0, status: 'open', daysUntil: 26 },
            { id: 'RFA-2026-004', type: 'Promotion', vessel: 'MV ZEUS', imo: '9567890', client: 'Diana Shipping', rank: 'Chief Engineer', joinDate: '2026-04-01', urgent: false, proposalsCount: 1, status: 'proposed', daysUntil: 48 },
            { id: 'RFA-2026-005', type: 'Embark', vessel: 'MV ARTEMIS', imo: '9678901', client: 'Neda Maritime', rank: 'AB', joinDate: '2026-03-25', urgent: false, proposalsCount: 3, status: 'proposed', daysUntil: 41 },
            { id: 'RFA-2026-006', type: 'Replacement', vessel: 'MV HERMES', imo: '9789012', client: 'Centrofin', rank: '2nd Officer', joinDate: '2026-02-28', urgent: true, proposalsCount: 0, status: 'open', daysUntil: 16 },
            { id: 'RFA-2026-007', type: 'Extension', vessel: 'MV HERA', imo: '9890123', client: 'Pioneer Marine', rank: 'Oiler', joinDate: '2026-04-10', urgent: false, proposalsCount: 1, status: 'proposed', daysUntil: 57 },
            { id: 'RFA-2026-008', type: 'Embark', vessel: 'MV DIONYSUS', imo: '9901234', client: 'Diana Shipping', rank: 'Master', joinDate: '2026-03-18', urgent: false, proposalsCount: 2, status: 'proposed', daysUntil: 34 }
        ];

        const MOCK_CREW_POOL = [
            { id: 'SF-1001', name: 'John Martinez', rank: 'Chief Officer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '12y' },
            { id: 'SF-1002', name: 'Maria Santos', rank: 'Chief Officer', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: false, quotaOK: true, experience: '8y' },
            { id: 'SF-1003', name: 'Ahmed Hassan', rank: '2nd Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '15y' },
            { id: 'SF-1004', name: 'Elena Popov', rank: 'Bosun', pool: 'non-dedicated', status: 'Endorsed', docsOK: false, restOK: true, quotaOK: true, experience: '6y' },
            { id: 'SF-1005', name: 'Carlos Rodriguez', rank: 'Chief Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '18y' },
            { id: 'SF-1006', name: 'Li Wei', rank: 'AB', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: false, experience: '4y' },
            { id: 'SF-1007', name: 'Ivan Petrov', rank: '2nd Officer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '10y' },
            { id: 'SF-1008', name: 'Ana Silva', rank: 'Oiler', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: false, quotaOK: true, experience: '5y' },
            { id: 'SF-1009', name: 'Michael O\'Brien', rank: 'Master', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '22y' },
            { id: 'SF-1010', name: 'Yuki Tanaka', rank: 'Chief Officer', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '14y' },
            { id: 'SF-1011', name: 'Pierre Dubois', rank: '2nd Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: false, restOK: true, quotaOK: true, experience: '9y' },
            { id: 'SF-1012', name: 'Sofia Andersson', rank: 'Bosun', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '7y' },
            { id: 'SF-1013', name: 'Ravi Kumar', rank: 'Chief Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '16y' },
            { id: 'SF-1014', name: 'Isabella Costa', rank: 'AB', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '3y' },
            { id: 'SF-1015', name: 'Hans Mueller', rank: '2nd Officer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: false, quotaOK: true, experience: '11y' },
            { id: 'SF-1016', name: 'Fatima Al-Mansoori', rank: 'Oiler', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '6y' },
            { id: 'SF-1017', name: 'Thomas Anderson', rank: 'Master', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '25y' },
            { id: 'SF-1018', name: 'Olga Ivanova', rank: 'Chief Officer', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: false, experience: '13y' },
            { id: 'SF-1019', name: 'Jorge Fernandez', rank: '2nd Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '8y' },
            { id: 'SF-1020', name: 'Mei Lin', rank: 'Bosun', pool: 'non-dedicated', status: 'Endorsed', docsOK: false, restOK: false, quotaOK: true, experience: '5y' },
            { id: 'SF-1021', name: 'Lars Nielsen', rank: 'Chief Engineer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '19y' },
            { id: 'SF-1022', name: 'Amara Okafor', rank: 'AB', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '4y' },
            { id: 'SF-1023', name: 'Dimitri Papadopoulos', rank: '2nd Officer', pool: 'dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '12y' },
            { id: 'SF-1024', name: 'Natasha Kowalski', rank: 'Oiler', pool: 'non-dedicated', status: 'Endorsed', docsOK: true, restOK: true, quotaOK: true, experience: '7y' }
        ];

        // MOCK DATA - Tickets
        const MOCK_TICKETS = [
            { id: 'TKT-001', pnr: 'ABC123', passenger: 'Juan Dela Cruz', rank: 'Chief Officer', from: 'MNL', fromCity: 'Manila', to: 'SIN', toCity: 'Singapore', date: '2025-02-15', time: '08:30', airline: 'Philippine Airlines', flight: 'PR501', duration: '3h 45m', status: 'confirmed', price: 890, type: 'embark' },
            { id: 'TKT-002', pnr: 'XYZ789', passenger: 'Mario Reyes', rank: '2nd Engineer', from: 'MNL', fromCity: 'Manila', to: 'AMS', toCity: 'Amsterdam', date: '2025-02-14', time: '22:15', airline: 'KLM', flight: 'KL802', duration: '14h 20m', status: 'confirmed', price: 1450, type: 'embark' },
            { id: 'TKT-003', pnr: 'DEF456', passenger: 'Eduardo Pascual', rank: 'Chief Engineer', from: 'MNL', fromCity: 'Manila', to: 'ICN', toCity: 'Seoul', date: '2025-02-13', time: '14:00', airline: 'Korean Air', flight: 'KE622', duration: '4h 15m', status: 'pending', price: 780, type: 'embark' },
            { id: 'TKT-004', pnr: 'GHI321', passenger: 'Antonio Santos', rank: 'Master', from: 'MNL', fromCity: 'Manila', to: 'ATH', toCity: 'Athens', date: '2025-02-12', time: '01:30', airline: 'Emirates', flight: 'EK335', duration: '16h 40m', status: 'confirmed', price: 1680, type: 'embark' },
            { id: 'TKT-005', pnr: 'JKL654', passenger: 'Ramon Lopez', rank: 'Cook', from: 'MNL', fromCity: 'Manila', to: 'RTM', toCity: 'Rotterdam', date: '2025-02-14', time: '11:45', airline: 'Qatar Airways', flight: 'QR337', duration: '18h 10m', status: 'confirmed', price: 1520, type: 'embark' },
            { id: 'TKT-006', pnr: 'MNO987', passenger: 'Carlos Aquino', rank: 'Oiler', from: 'SIN', fromCity: 'Singapore', to: 'MNL', toCity: 'Manila', date: '2025-02-18', time: '16:20', airline: 'Singapore Airlines', flight: 'SQ916', duration: '3h 40m', status: 'pending', price: 650, type: 'signoff' },
            { id: 'TKT-007', pnr: 'PQR147', passenger: 'Fernando Bautista', rank: '3rd Officer', from: 'MNL', fromCity: 'Manila', to: 'SIN', toCity: 'Singapore', date: '2025-02-15', time: '06:00', airline: 'Cebu Pacific', flight: '5J805', duration: '3h 50m', status: 'confirmed', price: 420, type: 'embark' },
            { id: 'TKT-008', pnr: 'STU258', passenger: 'Miguel Torres', rank: 'AB Seaman', from: 'MNL', fromCity: 'Manila', to: 'NRT', toCity: 'Tokyo', date: '2025-02-20', time: '09:15', airline: 'Japan Airlines', flight: 'JL742', duration: '4h 30m', status: 'pending', price: 920, type: 'embark' },
        ];

        // MOCK DATA - Pending Transactions
        const MOCK_PENDING = [
            { id: 'TXN-001', type: 'rfa', title: 'RFA-2025-0156 Approval', seafarer: 'Juan Dela Cruz', rank: 'Chief Officer', relatedTo: 'MV Diana Star', ageHours: 48, priority: 'urgent', status: 'awaiting' },
            { id: 'TXN-002', type: 'contract', title: 'Contract Extension', seafarer: 'Mario Reyes', rank: '2nd Engineer', relatedTo: 'CTR-2025-0143', ageHours: 24, priority: 'high', status: 'awaiting' },
            { id: 'TXN-003', type: 'document', title: 'COC Verification', seafarer: 'Roberto Garcia', rank: 'AB Seaman', relatedTo: 'DOC-2025-003', ageHours: 72, priority: 'urgent', status: 'awaiting' },
            { id: 'TXN-004', type: 'travel', title: 'Flight Booking Approval', seafarer: 'Eduardo Pascual', rank: 'Chief Engineer', relatedTo: 'Singapore â†’ Manila', ageHours: 8, priority: 'high', status: 'awaiting' },
            { id: 'TXN-005', type: 'peme', title: 'PEME Results Review', seafarer: 'Jose Martinez', rank: 'Bosun', relatedTo: 'PEME-2025-089', ageHours: 12, priority: 'normal', status: 'awaiting' },
            { id: 'TXN-006', type: 'rfa', title: 'RFA-2025-0157 Approval', seafarer: 'Fernando Bautista', rank: '3rd Officer', relatedTo: 'MV Pioneer Spirit', ageHours: 36, priority: 'high', status: 'awaiting' },
            { id: 'TXN-007', type: 'document', title: 'Flag Endorsement Upload', seafarer: 'Antonio Santos', rank: 'Master', relatedTo: 'Panama Flag', ageHours: 96, priority: 'urgent', status: 'awaiting' },
            { id: 'TXN-008', type: 'contract', title: 'New Contract Sign-off', seafarer: 'Carlos Aquino', rank: 'Oiler', relatedTo: 'CTR-2025-0152', ageHours: 16, priority: 'normal', status: 'awaiting' },
            { id: 'TXN-009', type: 'travel', title: 'Hotel Booking Approval', seafarer: 'Ramon Lopez', rank: 'Cook', relatedTo: 'Rotterdam Transit', ageHours: 4, priority: 'normal', status: 'awaiting' },
            { id: 'TXN-010', type: 'peme', title: 'Medical Waiver Request', seafarer: 'Miguel Torres', rank: 'AB Seaman', relatedTo: 'PEME-2025-092', ageHours: 120, priority: 'urgent', status: 'awaiting' },
            { id: 'TXN-011', type: 'rfa', title: 'RFA-2025-0158 Approval', seafarer: 'Diego Villanueva', rank: '2nd Officer', relatedTo: 'MV Centrofin Glory', ageHours: 6, priority: 'normal', status: 'awaiting' },
            { id: 'TXN-012', type: 'document', title: 'Training Certificate', seafarer: 'Hector Reyes', rank: 'Chief Officer', relatedTo: 'ECDIS Cert', ageHours: 28, priority: 'high', status: 'awaiting' },
        ];

        // MOCK DATA - Embarkation Prep
        const MOCK_EMBARKATIONS = [
            { id: 'EMB-001', name: 'Juan Dela Cruz', rank: 'Chief Officer', vessel: 'MV Diana Star', port: 'Singapore', embarkDate: '2025-02-15', daysUntil: 4, checklist: { contract: true, peme: true, visa: true, training: true, travel: true, briefing: false }, readiness: 'pending' },
            { id: 'EMB-002', name: 'Mario Reyes', rank: '2nd Engineer', vessel: 'MV Centrofin Glory', port: 'Rotterdam', embarkDate: '2025-02-14', daysUntil: 3, checklist: { contract: true, peme: true, visa: true, training: true, travel: true, briefing: true }, readiness: 'ready' },
            { id: 'EMB-003', name: 'Roberto Garcia', rank: 'AB Seaman', vessel: 'MV Pioneer Spirit', port: 'Hamburg', embarkDate: '2025-02-18', daysUntil: 7, checklist: { contract: true, peme: true, visa: false, training: true, travel: false, briefing: false }, readiness: 'pending' },
            { id: 'EMB-004', name: 'Eduardo Pascual', rank: 'Chief Engineer', vessel: 'MV Neda Harmony', port: 'Busan', embarkDate: '2025-02-13', daysUntil: 2, checklist: { contract: true, peme: false, visa: true, training: true, travel: true, briefing: false }, readiness: 'blocked' },
            { id: 'EMB-005', name: 'Jose Martinez', rank: 'Bosun', vessel: 'MV Diana Ocean', port: 'Shanghai', embarkDate: '2025-02-16', daysUntil: 5, checklist: { contract: true, peme: true, visa: true, training: true, travel: true, briefing: true }, readiness: 'ready' },
            { id: 'EMB-006', name: 'Fernando Bautista', rank: '3rd Officer', vessel: 'MV Diana Star', port: 'Singapore', embarkDate: '2025-02-15', daysUntil: 4, checklist: { contract: true, peme: true, visa: true, training: false, travel: true, briefing: false }, readiness: 'pending' },
            { id: 'EMB-007', name: 'Antonio Santos', rank: 'Master', vessel: 'MV Pioneer Wave', port: 'Piraeus', embarkDate: '2025-02-12', daysUntil: 1, checklist: { contract: true, peme: true, visa: true, training: true, travel: true, briefing: true }, readiness: 'ready' },
            { id: 'EMB-008', name: 'Carlos Aquino', rank: 'Oiler', vessel: 'MV Centrofin Titan', port: 'Fujairah', embarkDate: '2025-02-17', daysUntil: 6, checklist: { contract: false, peme: false, visa: true, training: true, travel: false, briefing: false }, readiness: 'blocked' },
            { id: 'EMB-009', name: 'Ramon Lopez', rank: 'Cook', vessel: 'MV Centrofin Glory', port: 'Rotterdam', embarkDate: '2025-02-14', daysUntil: 3, checklist: { contract: true, peme: true, visa: true, training: true, travel: true, briefing: true }, readiness: 'ready' },
            { id: 'EMB-010', name: 'Miguel Torres', rank: 'AB Seaman', vessel: 'MV Neda Spirit', port: 'Tokyo', embarkDate: '2025-02-20', daysUntil: 9, checklist: { contract: true, peme: true, visa: false, training: true, travel: false, briefing: false }, readiness: 'pending' },
        ];

        // MOCK DATA - Interviews
        const MOCK_INTERVIEWS = [
            { id: 'INT-2025-089', candidateName: 'Ricardo Mendoza', candidateRank: 'Chief Officer', rfcId: 'RFC-2025-042', date: '2025-02-11', time: '09:00', duration: 45, status: 'scheduled', interviewer: 'Maria Santos', interviewerInitials: 'MS', type: 'Technical', location: 'Office - Room A', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
            { id: 'INT-2025-088', candidateName: 'Carlos Fernandez', candidateRank: 'Chief Officer', rfcId: 'RFC-2025-042', date: '2025-02-11', time: '10:30', duration: 45, status: 'in-progress', interviewer: 'Maria Santos', interviewerInitials: 'MS', type: 'Technical', location: 'Office - Room A', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
            { id: 'INT-2025-087', candidateName: 'Ernesto Garcia', candidateRank: 'Chief Engineer', rfcId: 'RFC-2025-036', date: '2025-02-11', time: '14:00', duration: 60, status: 'scheduled', interviewer: 'Carlos Reyes', interviewerInitials: 'CR', type: 'Technical + Practical', location: 'Training Center', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
            { id: 'INT-2025-086', candidateName: 'Hector Reyes', candidateRank: 'Chief Officer', rfcId: 'RFC-2025-042', date: '2025-02-10', time: '15:00', duration: 45, status: 'completed', interviewer: 'Maria Santos', interviewerInitials: 'MS', type: 'Technical', location: 'Office - Room B', scores: { technical: 85, experience: 90, communication: 88 }, result: 'passed' },
            { id: 'INT-2025-085', candidateName: 'Ivan Aquino', candidateRank: '2nd Engineer', rfcId: 'RFC-2025-041', date: '2025-02-10', time: '11:00', duration: 45, status: 'completed', interviewer: 'Carlos Reyes', interviewerInitials: 'CR', type: 'Technical', location: 'Office - Room A', scores: { technical: 78, experience: 82, communication: 75 }, result: 'passed' },
            { id: 'INT-2025-084', candidateName: 'Gabriel Santos', candidateRank: 'AB Seaman', rfcId: 'RFC-2025-040', date: '2025-02-09', time: '09:30', duration: 30, status: 'completed', interviewer: 'Ana Garcia', interviewerInitials: 'AG', type: 'Basic Assessment', location: 'Office - Room C', scores: { technical: 72, experience: 68, communication: 80 }, result: 'passed' },
            { id: 'INT-2025-083', candidateName: 'Manuel Ortega', candidateRank: 'Oiler', rfcId: null, date: '2025-02-09', time: '14:00', duration: 30, status: 'no-show', interviewer: 'Ana Garcia', interviewerInitials: 'AG', type: 'Basic Assessment', location: 'Office - Room C', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
            { id: 'INT-2025-082', candidateName: 'Diego Villanueva', candidateRank: '3rd Officer', rfcId: 'RFC-2025-037', date: '2025-02-08', time: '10:00', duration: 45, status: 'completed', interviewer: 'Maria Santos', interviewerInitials: 'MS', type: 'Technical', location: 'Video Call', scores: { technical: 55, experience: 60, communication: 65 }, result: 'failed' },
            { id: 'INT-2025-081', candidateName: 'Arturo Bautista', candidateRank: 'Master', rfcId: 'RFC-2025-038', date: '2025-02-12', time: '09:00', duration: 60, status: 'scheduled', interviewer: 'Carlos Reyes', interviewerInitials: 'CR', type: 'Senior Assessment', location: 'Office - Room A', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
            { id: 'INT-2025-080', candidateName: 'Francisco Lopez', candidateRank: '2nd Officer', rfcId: null, date: '2025-02-07', time: '11:30', duration: 45, status: 'cancelled', interviewer: 'Maria Santos', interviewerInitials: 'MS', type: 'Technical', location: 'Office - Room B', scores: { technical: null, experience: null, communication: null }, result: 'pending' },
        ];

        // MOCK DATA - RFC Tasks (Request for Candidates)
        const MOCK_RFC_TASKS = [
            { id: 'RFC-2025-042', rank: 'Chief Officer', vessel: 'MV Diana Star', principal: 'Diana Shipping', principalKey: 'diana', priority: 'urgent', status: 'sourcing', createdDate: '2025-02-01', targetDate: '2025-03-01', candidates: 5, shortlisted: 2, source: 'Pool shortage', rfa: 'RFA-2025-0142' },
            { id: 'RFC-2025-041', rank: '2nd Engineer', vessel: 'MV Centrofin Glory', principal: 'Centrofin', principalKey: 'centrofin', priority: 'high', status: 'shortlisted', createdDate: '2025-01-25', targetDate: '2025-02-28', candidates: 8, shortlisted: 3, source: 'Promotion gap', rfa: 'RFA-2025-0143' },
            { id: 'RFC-2025-040', rank: 'AB Seaman', vessel: 'MV Pioneer Spirit', principal: 'Pioneer Marine', principalKey: 'pioneer', priority: 'normal', status: 'open', createdDate: '2025-02-08', targetDate: '2025-04-01', candidates: 0, shortlisted: 0, source: 'New requirement', rfa: 'RFA-2025-0144' },
            { id: 'RFC-2025-039', rank: 'Bosun', vessel: 'MV Diana Ocean', principal: 'Diana Shipping', principalKey: 'diana', priority: 'high', status: 'sourcing', createdDate: '2025-02-03', targetDate: '2025-03-10', candidates: 3, shortlisted: 0, source: 'Emergency replacement', rfa: null },
            { id: 'RFC-2025-038', rank: 'Master', vessel: 'MV Neda Harmony', principal: 'Neda Maritime', principalKey: 'neda', priority: 'urgent', status: 'shortlisted', createdDate: '2025-01-15', targetDate: '2025-02-20', candidates: 4, shortlisted: 2, source: 'Contract extension declined', rfa: null },
            { id: 'RFC-2025-037', rank: '3rd Officer', vessel: 'MV Pioneer Wave', principal: 'Pioneer Marine', principalKey: 'pioneer', priority: 'normal', status: 'filled', createdDate: '2025-01-10', targetDate: '2025-02-15', candidates: 6, shortlisted: 3, source: 'Pool shortage', rfa: 'RFA-2025-0147' },
            { id: 'RFC-2025-036', rank: 'Chief Engineer', vessel: 'MV Centrofin Titan', principal: 'Centrofin', principalKey: 'centrofin', priority: 'high', status: 'sourcing', createdDate: '2025-02-05', targetDate: '2025-03-15', candidates: 2, shortlisted: 0, source: 'Medical sign-off', rfa: null },
            { id: 'RFC-2025-035', rank: 'Cook', vessel: 'MV Diana Star', principal: 'Diana Shipping', principalKey: 'diana', priority: 'normal', status: 'open', createdDate: '2025-02-10', targetDate: '2025-03-20', candidates: 0, shortlisted: 0, source: 'New position', rfa: null },
            { id: 'RFC-2025-034', rank: 'Oiler', vessel: 'MV Neda Spirit', principal: 'Neda Maritime', principalKey: 'neda', priority: 'normal', status: 'cancelled', createdDate: '2025-01-20', targetDate: '2025-02-25', candidates: 2, shortlisted: 1, source: 'Pool shortage', rfa: null },
            { id: 'RFC-2025-033', rank: '2nd Officer', vessel: 'MV Oldendorff Heinrich', principal: 'Oldendorff', principalKey: 'oldendorff', priority: 'high', status: 'filled', createdDate: '2025-01-05', targetDate: '2025-02-10', candidates: 7, shortlisted: 2, source: 'Rotation coverage', rfa: null },
        ];

        // MOCK DATA - Clients/Principals
        const MOCK_CLIENTS = [
            { id: 'CL-001', name: 'Diana Shipping', country: 'Greece', countryKey: 'greece', flag: 'ðŸ‡¬ðŸ‡·', status: 'active', since: 2018, vessels: 12, crew: 245, contracts: 267, contact: 'operations@dianashipping.gr', fleet: [
                { name: 'MV Diana Star', type: 'bulk', crew: 22 },
                { name: 'MV Diana Ocean', type: 'bulk', crew: 21 },
                { name: 'MV Diana Wave', type: 'bulk', crew: 22 },
            ]},
            { id: 'CL-002', name: 'Centrofin Management', country: 'Greece', countryKey: 'greece', flag: 'ðŸ‡¬ðŸ‡·', status: 'active', since: 2019, vessels: 8, crew: 178, contracts: 195, contact: 'crewing@centrofin.gr', fleet: [
                { name: 'MV Centrofin Glory', type: 'tanker', crew: 24 },
                { name: 'MV Centrofin Titan', type: 'tanker', crew: 23 },
            ]},
            { id: 'CL-003', name: 'Pioneer Marine', country: 'Greece', countryKey: 'greece', flag: 'ðŸ‡¬ðŸ‡·', status: 'active', since: 2020, vessels: 6, crew: 134, contracts: 156, contact: 'crew@pioneermarine.gr', fleet: [
                { name: 'MV Pioneer Spirit', type: 'container', crew: 21 },
                { name: 'MV Pioneer Wave', type: 'container', crew: 22 },
            ]},
            { id: 'CL-004', name: 'Neda Maritime', country: 'Greece', countryKey: 'greece', flag: 'ðŸ‡¬ðŸ‡·', status: 'active', since: 2017, vessels: 10, crew: 289, contracts: 312, contact: 'manning@nedamaritime.gr', fleet: [
                { name: 'MV Neda Harmony', type: 'lng', crew: 28 },
                { name: 'MV Neda Spirit', type: 'lng', crew: 27 },
            ]},
            { id: 'CL-005', name: 'Eurobulk Shipping', country: 'Greece', countryKey: 'greece', flag: 'ðŸ‡¬ðŸ‡·', status: 'active', since: 2021, vessels: 5, crew: 98, contracts: 112, contact: 'operations@eurobulk.gr', fleet: [
                { name: 'MV Eurobulk Pride', type: 'bulk', crew: 20 },
            ]},
            { id: 'CL-006', name: 'Oldendorff Carriers', country: 'Germany', countryKey: 'germany', flag: 'ðŸ‡©ðŸ‡ª', status: 'active', since: 2019, vessels: 15, crew: 312, contracts: 345, contact: 'crewing@oldendorff.com', fleet: [
                { name: 'MV Heinrich Oldendorff', type: 'bulk', crew: 22 },
                { name: 'MV Sophie Oldendorff', type: 'bulk', crew: 21 },
            ]},
            { id: 'CL-007', name: 'Mitsui O.S.K. Lines', country: 'Japan', countryKey: 'japan', flag: 'ðŸ‡¯ðŸ‡µ', status: 'active', since: 2020, vessels: 8, crew: 198, contracts: 223, contact: 'manning@mol.co.jp', fleet: [
                { name: 'MV MOL Triumph', type: 'container', crew: 24 },
                { name: 'MV MOL Trust', type: 'lng', crew: 28 },
            ]},
            { id: 'CL-008', name: 'Frontline Ltd', country: 'Norway', countryKey: 'norway', flag: 'ðŸ‡³ðŸ‡´', status: 'active', since: 2022, vessels: 4, crew: 92, contracts: 98, contact: 'crew@frontline.no', fleet: [
                { name: 'MV Front Altair', type: 'tanker', crew: 23 },
            ]},
        ];

        // MOCK DATA - Contracts
        const MOCK_CONTRACTS = [
            { id: 'CTR-2025-0142', seafarerName: 'Juan Dela Cruz', seafarerRank: 'Chief Officer', vesselName: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', principalKey: 'diana', status: 'active', pemeStatus: 'cleared', startDate: '2024-11-15', endDate: '2025-08-15', duration: 9, salary: 4500, signedDate: '2024-11-10' },
            { id: 'CTR-2025-0143', seafarerName: 'Mario Reyes', seafarerRank: '2nd Engineer', vesselName: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', principalKey: 'centrofin', status: 'active', pemeStatus: 'cleared', startDate: '2024-12-01', endDate: '2025-09-20', duration: 9, salary: 4200, signedDate: '2024-11-25' },
            { id: 'CTR-2025-0144', seafarerName: 'Roberto Garcia', seafarerRank: 'AB Seaman', vesselName: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', principalKey: 'pioneer', status: 'pending-peme', pemeStatus: 'scheduled', startDate: '2025-04-01', endDate: '2026-01-01', duration: 9, salary: 1800, signedDate: null },
            { id: 'CTR-2025-0145', seafarerName: 'Eduardo Pascual', seafarerRank: 'Chief Engineer', vesselName: 'MV Neda Harmony', vesselType: 'LNG Carrier', principal: 'Neda Maritime', principalKey: 'neda', status: 'peme-cleared', pemeStatus: 'cleared', startDate: '2025-03-25', endDate: '2025-12-25', duration: 9, salary: 6500, signedDate: null },
            { id: 'CTR-2025-0146', seafarerName: 'Jose Martinez', seafarerRank: 'Bosun', vesselName: 'MV Diana Ocean', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', principalKey: 'diana', status: 'signed', pemeStatus: 'cleared', startDate: '2025-03-15', endDate: '2025-12-15', duration: 9, salary: 2200, signedDate: '2025-02-08' },
            { id: 'CTR-2025-0147', seafarerName: 'Fernando Bautista', seafarerRank: '3rd Officer', vesselName: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', principalKey: 'diana', status: 'pending-peme', pemeStatus: 'pending', startDate: '2025-03-10', endDate: '2025-12-10', duration: 9, salary: 2800, signedDate: null },
            { id: 'CTR-2025-0148', seafarerName: 'Ramon Lopez', seafarerRank: 'Cook', vesselName: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', principalKey: 'centrofin', status: 'signed', pemeStatus: 'cleared', startDate: '2025-02-28', endDate: '2025-11-28', duration: 9, salary: 1600, signedDate: '2025-02-05' },
            { id: 'CTR-2025-0149', seafarerName: 'Daniel Villanueva', seafarerRank: '2nd Officer', vesselName: 'MV Pioneer Spirit', vesselType: 'Container Ship', principal: 'Pioneer Marine', principalKey: 'pioneer', status: 'completed', pemeStatus: 'cleared', startDate: '2024-02-15', endDate: '2025-02-15', duration: 12, salary: 3200, signedDate: '2024-02-01' },
            { id: 'CTR-2025-0150', seafarerName: 'Carlos Aquino', seafarerRank: 'Oiler', vesselName: 'MV Neda Harmony', vesselType: 'LNG Carrier', principal: 'Neda Maritime', principalKey: 'neda', status: 'cancelled', pemeStatus: 'failed', startDate: '2025-02-20', endDate: '2025-11-20', duration: 9, salary: 1400, signedDate: null },
            { id: 'CTR-2025-0151', seafarerName: 'Antonio Santos', seafarerRank: 'Master', vesselName: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', principalKey: 'diana', status: 'active', pemeStatus: 'cleared', startDate: '2024-09-01', endDate: '2025-06-01', duration: 9, salary: 8500, signedDate: '2024-08-25' },
            { id: 'CTR-2025-0152', seafarerName: 'Pedro Ramos', seafarerRank: 'Master', vesselName: 'MV Diana Star', vesselType: 'Bulk Carrier', principal: 'Diana Shipping', principalKey: 'diana', status: 'draft', pemeStatus: 'pending', startDate: '2025-06-01', endDate: '2026-03-01', duration: 9, salary: 8200, signedDate: null },
            { id: 'CTR-2025-0153', seafarerName: 'Miguel Torres', seafarerRank: 'AB Seaman', vesselName: 'MV Centrofin Glory', vesselType: 'Tanker', principal: 'Centrofin', principalKey: 'centrofin', status: 'active', pemeStatus: 'cleared', startDate: '2024-10-15', endDate: '2025-07-15', duration: 9, salary: 1850, signedDate: '2024-10-01' },
        ];

        // MOCK DATA - Documents & Certificates
        const MOCK_DOCUMENTS = [
            { id: 'DOC-001', seafarerId: 'CW-2024-00142', seafarerName: 'Juan Dela Cruz', rank: 'Chief Officer', docType: 'stcw', docName: 'Certificate of Competency', docNumber: 'COC-2024-12345', issueDate: '2022-03-15', expiryDate: '2027-03-14', status: 'valid', daysLeft: 752 },
            { id: 'DOC-002', seafarerId: 'CW-2024-00142', seafarerName: 'Juan Dela Cruz', rank: 'Chief Officer', docType: 'medical', docName: 'Medical Certificate', docNumber: 'MED-2024-5678', issueDate: '2024-06-01', expiryDate: '2025-06-01', status: 'valid', daysLeft: 110 },
            { id: 'DOC-003', seafarerId: 'CW-2024-00142', seafarerName: 'Juan Dela Cruz', rank: 'Chief Officer', docType: 'flag', docName: 'Panama Flag Endorsement', docNumber: 'PAN-2023-9012', issueDate: '2023-01-10', expiryDate: '2025-03-01', status: 'critical', daysLeft: 18 },
            { id: 'DOC-004', seafarerId: 'CW-2023-00891', seafarerName: 'Mario Reyes', rank: '2nd Engineer', docType: 'stcw', docName: 'Certificate of Competency', docNumber: 'COC-2023-23456', issueDate: '2021-08-20', expiryDate: '2026-08-19', status: 'valid', daysLeft: 554 },
            { id: 'DOC-005', seafarerId: 'CW-2023-00891', seafarerName: 'Mario Reyes', rank: '2nd Engineer', docType: 'stcw', docName: 'GMDSS Certificate', docNumber: 'GMDSS-2022-3456', issueDate: '2022-05-15', expiryDate: '2025-02-20', status: 'critical', daysLeft: 9 },
            { id: 'DOC-006', seafarerId: 'CW-2023-00891', seafarerName: 'Mario Reyes', rank: '2nd Engineer', docType: 'medical', docName: 'Medical Certificate', docNumber: 'MED-2024-7890', issueDate: '2024-08-01', expiryDate: '2025-08-01', status: 'valid', daysLeft: 171 },
            { id: 'DOC-007', seafarerId: 'CW-2022-00567', seafarerName: 'Antonio Santos', rank: 'Master', docType: 'stcw', docName: 'Master License', docNumber: 'ML-2020-78901', issueDate: '2020-04-10', expiryDate: '2025-04-09', status: 'expiring-soon', daysLeft: 57 },
            { id: 'DOC-008', seafarerId: 'CW-2022-00567', seafarerName: 'Antonio Santos', rank: 'Master', docType: 'flag', docName: 'Liberia Flag Endorsement', docNumber: 'LIB-2024-1234', issueDate: '2024-01-15', expiryDate: '2025-03-10', status: 'expiring-soon', daysLeft: 27 },
            { id: 'DOC-009', seafarerId: 'CW-2024-00234', seafarerName: 'Roberto Garcia', rank: 'AB Seaman', docType: 'national', docName: 'Seaman Book', docNumber: 'SB-2023-56789', issueDate: '2023-03-01', expiryDate: '2028-02-28', status: 'valid', daysLeft: 1113 },
            { id: 'DOC-010', seafarerId: 'CW-2024-00234', seafarerName: 'Roberto Garcia', rank: 'AB Seaman', docType: 'stcw', docName: 'Basic Safety Training', docNumber: 'BST-2022-4567', issueDate: '2022-09-01', expiryDate: '2025-02-15', status: 'critical', daysLeft: 4 },
            { id: 'DOC-011', seafarerId: 'CW-2021-00123', seafarerName: 'Eduardo Pascual', rank: 'Chief Engineer', docType: 'stcw', docName: 'Chief Engineer License', docNumber: 'CEL-2019-23456', issueDate: '2019-11-15', expiryDate: '2024-11-14', status: 'expired', daysLeft: -89 },
            { id: 'DOC-012', seafarerId: 'CW-2021-00123', seafarerName: 'Eduardo Pascual', rank: 'Chief Engineer', docType: 'company', docName: 'Tanker Familiarization', docNumber: 'TF-2024-8901', issueDate: '2024-02-01', expiryDate: '2026-02-01', status: 'valid', daysLeft: 355 },
            { id: 'DOC-013', seafarerId: 'CW-2023-00456', seafarerName: 'Jose Martinez', rank: 'Bosun', docType: 'medical', docName: 'Medical Certificate', docNumber: 'MED-2024-2345', issueDate: '2024-03-15', expiryDate: '2025-03-15', status: 'expiring-soon', daysLeft: 32 },
            { id: 'DOC-014', seafarerId: 'CW-2023-00456', seafarerName: 'Jose Martinez', rank: 'Bosun', docType: 'national', docName: 'Passport', docNumber: 'PP-2021-67890', issueDate: '2021-06-01', expiryDate: '2031-05-31', status: 'valid', daysLeft: 2300 },
            { id: 'DOC-015', seafarerId: 'CW-2020-00089', seafarerName: 'Fernando Bautista', rank: '3rd Officer', docType: 'stcw', docName: 'ECDIS Certificate', docNumber: 'ECDIS-2023-5678', issueDate: '2023-07-01', expiryDate: '2025-02-25', status: 'critical', daysLeft: 14 },
        ];

        const KANBAN_COLUMNS = [
            { id: 'new', name: 'New', color: 'new' },
            { id: 'screening', name: 'Screening', color: 'screening' },
            { id: 'interview', name: 'Interview', color: 'interview' },
            { id: 'negotiation', name: 'Negotiation', color: 'negotiation' },
            { id: 'endorsed', name: 'Endorsed', color: 'endorsed' },
            { id: 'rejected', name: 'Rejected', color: 'rejected' },
        ];

        const MOCK_VESSELS = [
            { id: 'V001', name: 'MV Diana Star', type: 'Bulk Carrier', typeKey: 'bulk', principal: 'Diana Shipping', principalKey: 'diana', status: 'active', flag: 'Panama', imo: '9876543', built: 2018, dwt: 82000, crew: [
                { id: 'C001', name: 'Antonio Santos', rank: 'Master', startDate: '2024-09-01', endDate: '2025-03-28', status: 'onboard', nextCrew: { name: 'Pedro Ramos', startDate: '2025-03-28' } },
                { id: 'C002', name: 'Juan Dela Cruz', rank: 'Chief Officer', startDate: '2024-11-15', endDate: '2025-08-15', status: 'onboard' },
                { id: 'C003', name: 'Fernando Bautista', rank: '3rd Officer', startDate: '2024-06-01', endDate: '2025-02-28', status: 'expiring' },
                { id: 'C004', name: null, rank: 'Bosun', startDate: '2025-03-15', endDate: '2025-09-15', status: 'vacancy' },
            ]},
            { id: 'V002', name: 'MV Centrofin Glory', type: 'Tanker', typeKey: 'tanker', principal: 'Centrofin', principalKey: 'centrofin', status: 'active', flag: 'Liberia', imo: '9876544', built: 2020, dwt: 115000, crew: [
                { id: 'C005', name: 'Ricardo Cruz', rank: 'Master', startDate: '2024-08-01', endDate: '2025-04-01', status: 'onboard' },
                { id: 'C006', name: 'Mario Reyes', rank: '2nd Engineer', startDate: '2024-12-01', endDate: '2025-09-20', status: 'onboard' },
                { id: 'C007', name: 'Ramon Lopez', rank: 'Cook', startDate: '2025-02-28', endDate: '2025-11-30', status: 'scheduled' },
                { id: 'C008', name: 'Miguel Torres', rank: 'AB Seaman', startDate: '2024-10-15', endDate: '2025-05-15', status: 'onboard' },
            ]},
            { id: 'V003', name: 'MV Pioneer Spirit', type: 'Container Ship', typeKey: 'container', principal: 'Pioneer Marine', principalKey: 'pioneer', status: 'active', flag: 'Marshall Islands', imo: '9876545', built: 2019, dwt: 68000, crew: [
                { id: 'C009', name: 'Jose Garcia', rank: 'Master', startDate: '2024-07-01', endDate: '2025-03-01', status: 'expiring' },
                { id: 'C010', name: 'Daniel Villanueva', rank: '2nd Officer', startDate: '2024-12-15', endDate: '2025-06-15', status: 'onboard' },
                { id: 'C011', name: null, rank: 'AB Seaman', startDate: '2025-04-01', endDate: '2025-10-01', status: 'vacancy' },
                { id: 'C012', name: 'Carlos Mendoza', rank: 'Oiler', startDate: '2024-11-01', endDate: '2025-07-01', status: 'onboard' },
            ]},
            { id: 'V004', name: 'MV Neda Harmony', type: 'LNG Carrier', typeKey: 'lng', principal: 'Neda Maritime', principalKey: 'neda', status: 'active', flag: 'Greece', imo: '9876546', built: 2021, dwt: 95000, crew: [
                { id: 'C013', name: 'Eduardo Pascual', rank: 'Chief Engineer', startDate: '2024-10-01', endDate: '2025-07-10', status: 'onboard' },
                { id: 'C014', name: 'Roberto Silva', rank: 'Master', startDate: '2024-05-01', endDate: '2025-02-15', status: 'expiring', extension: true },
                { id: 'C015', name: 'Manuel Cruz', rank: '2nd Officer', startDate: '2025-01-15', endDate: '2025-08-15', status: 'onboard' },
            ]},
            { id: 'V005', name: 'MV Diana Ocean', type: 'Bulk Carrier', typeKey: 'bulk', principal: 'Diana Shipping', principalKey: 'diana', status: 'active', flag: 'Panama', imo: '9876547', built: 2017, dwt: 78000, crew: [
                { id: 'C016', name: 'Francisco Ramos', rank: 'Master', startDate: '2024-06-15', endDate: '2025-03-15', status: 'onboard' },
                { id: 'C017', name: 'Gabriel Santos', rank: 'Chief Officer', startDate: '2024-09-01', endDate: '2025-06-01', status: 'onboard' },
                { id: 'C018', name: 'Luis Torres', rank: '2nd Engineer', startDate: '2024-11-01', endDate: '2025-08-01', status: 'onboard' },
            ]},
            { id: 'V006', name: 'MV Centrofin Titan', type: 'Tanker', typeKey: 'tanker', principal: 'Centrofin', principalKey: 'centrofin', status: 'maintenance', flag: 'Liberia', imo: '9876548', built: 2016, dwt: 105000, crew: [
                { id: 'C019', name: 'Pedro Martinez', rank: 'Master', startDate: '2024-04-01', endDate: '2025-01-01', status: 'onboard' },
            ]},
            { id: 'V007', name: 'MV Pioneer Wave', type: 'Container Ship', typeKey: 'container', principal: 'Pioneer Marine', principalKey: 'pioneer', status: 'active', flag: 'Marshall Islands', imo: '9876549', built: 2022, dwt: 72000, crew: [
                { id: 'C020', name: 'Marco Reyes', rank: 'Master', startDate: '2024-08-15', endDate: '2025-05-15', status: 'onboard' },
                { id: 'C021', name: 'Andres Cruz', rank: 'Chief Engineer', startDate: '2024-10-01', endDate: '2025-07-01', status: 'onboard' },
                { id: 'C022', name: 'Felipe Garcia', rank: 'Chief Officer', startDate: '2024-12-01', endDate: '2025-09-01', status: 'onboard' },
                { id: 'C023', name: 'Oscar Mendez', rank: 'Bosun', startDate: '2024-07-01', endDate: '2025-04-01', status: 'onboard' },
            ]},
            { id: 'V008', name: 'MV Neda Spirit', type: 'LNG Carrier', typeKey: 'lng', principal: 'Neda Maritime', principalKey: 'neda', status: 'active', flag: 'Greece', imo: '9876550', built: 2023, dwt: 98000, crew: [
                { id: 'C024', name: 'Rafael Aquino', rank: 'Master', startDate: '2024-09-01', endDate: '2025-06-01', status: 'onboard' },
                { id: 'C025', name: 'Diego Fernandez', rank: 'Chief Engineer', startDate: '2024-11-15', endDate: '2025-08-15', status: 'onboard' },
            ]},
        ];

        // Timeline state
        let timelineStartMonth = 0; // 0 = current month

        // ROTATION PLAN RENDERING
        function renderRotationPlan() {
            renderGanttHeader();
            renderGanttBody();
            lucide.createIcons();
        }

        function getMonthsArray(count, startOffset) {
            const months = [];
            const now = new Date();
            for (let i = startOffset; i < startOffset + count; i++) {
                const d = new Date(now.getFullYear(), now.getMonth() + i, 1);
                months.push({
                    month: d.toLocaleString('en-US', { month: 'short' }),
                    year: d.getFullYear(),
                    date: d,
                    isCurrent: i === 0
                });
            }
            return months;
        }

        function renderGanttHeader() {
            const container = document.getElementById('ganttHeaderScroll');
            if (!container) return;
            const months = getMonthsArray(12, timelineStartMonth);
            container.innerHTML = months.map(m => 
                '<div class="gantt-month' + (m.isCurrent ? ' current' : '') + '">' +
                '<div class="gantt-month-name">' + m.month + '</div>' +
                '<div class="gantt-month-year">' + m.year + '</div></div>'
            ).join('');
        }

        function renderGanttBody() {
            const container = document.getElementById('ganttBody');
            if (!container) return;
            const principalFilter = document.getElementById('rotationPrincipalFilter')?.value || '';
            const vessels = principalFilter ? MOCK_VESSELS.filter(v => v.principalKey === principalFilter) : MOCK_VESSELS;
            const months = getMonthsArray(12, timelineStartMonth);
            
            container.innerHTML = vessels.map(vessel => {
                const crewRows = vessel.crew.map(crew => renderCrewRow(crew, months)).join('');
                return '<div class="gantt-vessel-group" data-vessel="' + vessel.id + '">' +
                    '<div class="gantt-vessel-row" onclick="toggleVesselCrew(\'' + vessel.id + '\')">' +
                        '<div class="gantt-vessel-info">' +
                            '<button class="gantt-expand-btn expanded" data-vessel="' + vessel.id + '"><i data-lucide="chevron-right" style="width:14px;height:14px;"></i></button>' +
                            '<div class="gantt-vessel-icon"><i data-lucide="ship"></i></div>' +
                            '<div><div class="gantt-vessel-name">' + vessel.name + '</div><div class="gantt-vessel-meta">' + vessel.type + ' â€¢ ' + vessel.principal + '</div></div>' +
                        '</div>' +
                        '<div class="gantt-vessel-timeline">' + months.map(m => '<div class="gantt-cell' + (m.isCurrent ? ' current' : '') + '"></div>').join('') + '</div>' +
                    '</div>' +
                    '<div class="gantt-crew-rows" id="crew-' + vessel.id + '">' + crewRows + '</div>' +
                '</div>';
            }).join('');
        }

        function renderCrewRow(crew, months) {
            const barStyle = calculateBarPosition(crew.startDate, crew.endDate, months);
            const statusClass = crew.extension ? 'extension' : crew.status;
            const displayName = crew.name || 'VACANCY';
            const initials = crew.name ? crew.name.split(' ').map(n => n[0]).join('') : '?';
            
            return '<div class="gantt-crew-row">' +
                '<div class="gantt-crew-info">' +
                    '<div class="gantt-crew-avatar" style="' + (crew.status === 'vacancy' ? 'background:var(--tag-nfr);color:white;' : '') + '">' + initials + '</div>' +
                    '<div class="gantt-crew-details">' +
                        '<div class="gantt-crew-name">' + displayName + '</div>' +
                        '<div class="gantt-crew-rank">' + crew.rank + '</div>' +
                    '</div>' +
                '</div>' +
                '<div class="gantt-crew-timeline">' +
                    months.map(m => '<div class="gantt-cell' + (m.isCurrent ? ' current' : '') + '"></div>').join('') +
                    (barStyle ? '<div class="gantt-bar ' + statusClass + '" style="' + barStyle + '" title="' + displayName + ': ' + crew.startDate + ' to ' + crew.endDate + '">' + displayName + '</div>' : '') +
                '</div>' +
            '</div>';
        }

        function calculateBarPosition(startDate, endDate, months) {
            if (!startDate || !endDate || months.length === 0) return null;
            const start = new Date(startDate);
            const end = new Date(endDate);
            const timelineStart = months[0].date;
            const timelineEnd = new Date(months[months.length - 1].date);
            timelineEnd.setMonth(timelineEnd.getMonth() + 1);
            
            if (end < timelineStart || start > timelineEnd) return null;
            
            const effectiveStart = start < timelineStart ? timelineStart : start;
            const effectiveEnd = end > timelineEnd ? timelineEnd : end;
            
            const totalDays = (timelineEnd - timelineStart) / (1000 * 60 * 60 * 24);
            const startOffset = (effectiveStart - timelineStart) / (1000 * 60 * 60 * 24);
            const duration = (effectiveEnd - effectiveStart) / (1000 * 60 * 60 * 24);
            
            const leftPercent = (startOffset / totalDays) * 100;
            const widthPercent = (duration / totalDays) * 100;
            
            return 'left:calc(' + leftPercent + '% + 4px);width:calc(' + widthPercent + '% - 8px);';
        }

        function toggleVesselCrew(vesselId) {
            const crewContainer = document.getElementById('crew-' + vesselId);
            const expandBtn = document.querySelector('.gantt-expand-btn[data-vessel="' + vesselId + '"]');
            if (crewContainer && expandBtn) {
                const isHidden = crewContainer.style.display === 'none';
                crewContainer.style.display = isHidden ? 'block' : 'none';
                expandBtn.classList.toggle('expanded', isHidden);
            }
        }

        function shiftTimeline(months) {
            timelineStartMonth += months;
            renderRotationPlan();
        }
        
        function exportRotationPlan() {
            let csv = 'Vessel,Position,Seafarer,Contract Start,Contract End,Status\n';
            
            // Export rotation data
            MOCK_ROTATION_DATA.forEach(vessel => {
                vessel.positions.forEach(pos => {
                    csv += '"' + vessel.name + '","' + pos.rank + '","' + (pos.seafarer || 'VACANCY') + '","' + (pos.contractStart || 'N/A') + '","' + (pos.contractEnd || 'N/A') + '","' + (pos.seafarer ? 'Filled' : 'Vacant') + '"\n';
                });
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'rotation_plan_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Rotation plan exported successfully!', 'success');
        }
        
        function filterRotationByType(type) {
            const showFilter = document.getElementById('rotationShowFilter');
            if (showFilter) {
                showFilter.value = type;
            }
            showNotification('Filtering: ' + (type === 'vacancies' ? 'Vacancies Only' : type === 'expiring' ? 'Expiring Soon' : 'All'), 'info');
            renderRotationPlan();
        }
        
        function savePlanRotation() {
            const vessel = document.getElementById('rotationVessel')?.value;
            const position = document.getElementById('rotationPosition')?.value;
            const signOffDate = document.getElementById('rotationSignOffDate')?.value;
            
            if (!vessel || !position || !signOffDate) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            const replacement = document.getElementById('rotationReplacement')?.value;
            const signOnDate = document.getElementById('rotationSignOnDate')?.value;
            
            if (replacement && signOnDate) {
                showNotification('Rotation planned: ' + position + ' on ' + vessel.replace('-', ' ').toUpperCase(), 'success');
            } else {
                showNotification('Vacancy created for ' + position + ' position', 'warning');
            }
            
            closeModal('planRotationModal');
            renderRotationPlan();
        }

        // KANBAN BOARD RENDERING
        function renderKanbanBoard(stageFilter = null) {
            const container = document.getElementById('kanbanBoard');
            if (!container) return;
            
            // Get filter values
            const rfcFilter = document.getElementById('candidateRfcFilter')?.value || '';
            const rankFilter = document.getElementById('candidateRankFilter')?.value || '';
            const sourceFilter = document.getElementById('candidateSourceFilter')?.value || '';
            const priorityFilter = document.getElementById('candidatePriorityFilter')?.value || '';
            const searchQuery = document.getElementById('candidateSearchInput')?.value?.toLowerCase() || '';
            
            // Filter candidates
            let filteredCandidates = MOCK_CANDIDATES.filter(c => {
                if (rfcFilter && c.rfcId !== rfcFilter) return false;
                if (rankFilter && c.rank !== rankFilter) return false;
                if (sourceFilter && c.source !== sourceFilter) return false;
                if (priorityFilter && c.priority !== priorityFilter) return false;
                if (searchQuery) {
                    const fullName = (c.firstName + ' ' + c.lastName).toLowerCase();
                    if (!fullName.includes(searchQuery) && !c.rank.toLowerCase().includes(searchQuery)) return false;
                }
                return true;
            });
            
            // Determine which columns to show
            const columnsToShow = stageFilter ? KANBAN_COLUMNS.filter(col => col.id === stageFilter) : KANBAN_COLUMNS;
            
            container.innerHTML = columnsToShow.map(col => {
                const candidates = filteredCandidates.filter(c => c.stage === col.id);
                return '<div class="kanban-column">' +
                    '<div class="kanban-column-header ' + col.color + '">' +
                        '<div class="kanban-column-title">' +
                            '<span class="kanban-column-name">' + col.name + '</span>' +
                            '<span class="kanban-column-count">' + candidates.length + '</span>' +
                        '</div>' +
                        '<div class="kanban-column-actions">' +
                            (stageFilter ? '<button class="kanban-column-btn" onclick="renderKanbanBoard()" title="Show all columns"><i data-lucide="x" style="width:16px;height:16px;"></i></button>' : '<button class="kanban-column-btn"><i data-lucide="more-horizontal" style="width:16px;height:16px;"></i></button>') +
                        '</div>' +
                    '</div>' +
                    '<div class="kanban-cards">' +
                        candidates.map(c => renderCandidateCard(c)).join('') +
                        (candidates.length === 0 ? '<div style="padding:24px;text-align:center;color:var(--cw-gray-400);font-size:0.85rem;">No candidates match filters</div>' : '') +
                        (col.id !== 'endorsed' && col.id !== 'rejected' && candidates.length > 0 ? '<button class="kanban-add-card" onclick="openModal(\'addCandidateModal\')"><i data-lucide="plus" style="width:16px;height:16px;"></i>Add Candidate</button>' : '') +
                    '</div>' +
                '</div>';
            }).join('');
            
            lucide.createIcons();
        }
        
        function filterKanban(stage) {
            renderKanbanBoard(stage);
        }

        function renderCandidateCard(candidate) {
            const initials = candidate.firstName[0] + candidate.lastName[0];
            const daysClass = candidate.daysInStage > 5 ? 'danger' : candidate.daysInStage > 3 ? 'warning' : '';
            
            let tags = '';
            if (candidate.priority === 'urgent') tags += '<span class="kanban-card-tag urgent">Urgent</span>';
            if (candidate.priority === 'high') tags += '<span class="kanban-card-tag high">High</span>';
            if (candidate.rfcId) tags += '<span class="kanban-card-tag rfc">' + candidate.rfcId + '</span>';
            if (candidate.docsStatus === 'ok') tags += '<span class="kanban-card-tag docs-ok">Docs OK</span>';
            if (candidate.docsStatus === 'partial') tags += '<span class="kanban-card-tag docs-pending">Docs Pending</span>';
            
            return '<div class="kanban-card" onclick="openCandidatePanel(\'' + candidate.id + '\')">' +
                '<div class="kanban-card-header">' +
                    '<div class="kanban-card-avatar">' + initials + '</div>' +
                    '<div class="kanban-card-info">' +
                        '<div class="kanban-card-name">' + candidate.firstName + ' ' + candidate.lastName + '</div>' +
                        '<div class="kanban-card-rank">' + candidate.rank + '</div>' +
                    '</div>' +
                '</div>' +
                '<div class="kanban-card-body">' +
                    '<div class="kanban-card-meta"><i data-lucide="briefcase"></i>' + candidate.source + '</div>' +
                    (tags ? '<div class="kanban-card-tags">' + tags + '</div>' : '') +
                '</div>' +
                '<div class="kanban-card-footer">' +
                    '<span class="kanban-card-days ' + daysClass + '">' + candidate.daysInStage + ' day' + (candidate.daysInStage !== 1 ? 's' : '') + ' in stage</span>' +
                    '<div class="kanban-card-actions">' +
                        '<button class="kanban-column-btn" onclick="event.stopPropagation();"><i data-lucide="chevron-right" style="width:14px;height:14px;"></i></button>' +
                    '</div>' +
                '</div>' +
            '</div>';
        }

        let currentPanelItem = null; // Store current item being viewed
        
        function openCandidatePanel(id) {
            const candidate = MOCK_CANDIDATES.find(c => c.id === id);
            if (!candidate) return;
            currentPanelItem = { type: 'candidate', data: candidate };
            const initials = candidate.firstName[0] + candidate.lastName[0];
            const stageLabel = KANBAN_COLUMNS.find(c => c.id === candidate.stage)?.name || candidate.stage;
            const avatar = document.getElementById('seafarerPanelAvatar');
            const name = document.getElementById('seafarerPanelName');
            const rank = document.getElementById('seafarerPanelRank');
            const statusBadge = document.getElementById('seafarerPanelStatus');
            const docsCount = document.getElementById('seafarerDocsCount');
            const contractDays = document.getElementById('seafarerContractDays');
            const poolType = document.getElementById('seafarerPoolType');
            const email = document.getElementById('seafarerEmail');
            const phone = document.getElementById('seafarerPhone');
            if (avatar) avatar.textContent = initials;
            if (name) name.textContent = candidate.firstName + ' ' + candidate.lastName;
            if (rank) rank.textContent = candidate.rank + ' - ' + candidate.id;
            if (statusBadge) { statusBadge.textContent = stageLabel; statusBadge.style.background = 'rgba(59,130,246,0.2)'; statusBadge.style.color = '#3b82f6'; }
            if (docsCount) docsCount.textContent = candidate.docsStatus === 'ok' ? 'Complete' : 'Pending';
            if (contractDays) contractDays.textContent = candidate.daysInStage + 'd';
            if (poolType) poolType.textContent = candidate.priority.toUpperCase();
            if (email) email.innerHTML = '<a href="mailto:' + candidate.email + '">' + candidate.email + '</a>';
            if (phone) phone.textContent = candidate.phone;
            let html = '<div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:20px;">';
            html += '<h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;">Application Details</h4>';
            html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Source</div><div style="font-weight:600;text-transform:capitalize;">' + candidate.source + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Priority</div><div style="font-weight:600;text-transform:capitalize;">' + candidate.priority + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">RFC</div><div style="font-weight:600;">' + (candidate.rfcId || 'None') + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Days in Stage</div><div style="font-weight:600;">' + candidate.daysInStage + ' days</div></div>';
            html += '</div></div>';
            html += '<div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:20px;">';
            html += '<h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;">Document Status</h4>';
            html += '<span class="tag tag-' + (candidate.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '">' + (candidate.docsStatus === 'ok' ? 'All Documents OK' : 'Documents Pending') + '</span>';
            html += '</div>';
            html += '<div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:20px;">';
            html += '<button class="btn btn-primary" onclick="moveToNextStage(\'' + candidate.id + '\')"><i data-lucide="arrow-right"></i>Move to Next Stage</button>';
            html += '<button class="btn btn-secondary" onclick="scheduleInterviewFor(\'' + candidate.id + '\')"><i data-lucide="calendar"></i>Schedule Interview</button>';
            html += '<button class="btn btn-ghost" style="color:#ef4444;" onclick="rejectCandidate(\'' + candidate.id + '\')"><i data-lucide="x-circle"></i>Reject</button>';
            html += '</div>';
            document.getElementById('candidateModalAvatar').textContent = initials;
            document.getElementById('candidateModalName').textContent = candidate.firstName + ' ' + candidate.lastName;
            document.getElementById('candidateModalRank').textContent = candidate.rank + ' â€¢ ' + candidate.id;
            document.getElementById('candidateModalBody').innerHTML = html;
            openModal('candidateDetailModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        

        function editCandidateFromModal() {
            if (!currentPanelItem || currentPanelItem.type !== 'candidate') return;
            const candidate = currentPanelItem.data;
            closeModal('candidateDetailModal');
            openModal('editCandidateModal');
            const idField = document.getElementById('editCandidateId');
            const firstNameField = document.getElementById('editCandidateFirstName');
            const lastNameField = document.getElementById('editCandidateLastName');
            const rankField = document.getElementById('editCandidateRank');
            const emailField = document.getElementById('editCandidateEmail');
            const phoneField = document.getElementById('editCandidatePhone');
            const sourceField = document.getElementById('editCandidateSource');
            const priorityField = document.getElementById('editCandidatePriority');
            if (idField) idField.value = candidate.id;
            if (firstNameField) firstNameField.value = candidate.firstName;
            if (lastNameField) lastNameField.value = candidate.lastName;
            if (rankField) rankField.value = candidate.rank;
            if (emailField) emailField.value = candidate.email;
            if (phoneField) phoneField.value = candidate.phone;
            if (sourceField) sourceField.value = candidate.source;
            if (priorityField) priorityField.value = candidate.priority;
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.editCandidateFromModal = editCandidateFromModal;
        
        function viewFullProfile() {
            if (!currentPanelItem) return;
            
            if (currentPanelItem.type === 'candidate') {
                const c = currentPanelItem.data;
                const initials = c.firstName[0] + c.lastName[0];
                const stageLabel = KANBAN_COLUMNS.find(col => col.id === c.stage)?.name || c.stage;
                
                let html = '<div style="display:flex;gap:24px;margin-bottom:24px;padding-bottom:24px;border-bottom:1px solid var(--cw-gray-200);">' +
                    '<div class="avatar" style="width:100px;height:100px;font-size:2rem;flex-shrink:0;">' + initials + '</div>' +
                    '<div style="flex:1;">' +
                        '<h2 style="font-size:1.5rem;font-weight:700;margin-bottom:4px;">' + c.firstName + ' ' + c.lastName + '</h2>' +
                        '<p style="font-size:1.1rem;color:var(--cw-gray-600);margin-bottom:8px;">' + c.rank + '</p>' +
                        '<p style="font-size:0.9rem;color:var(--cw-gray-500);margin-bottom:12px;">Candidate ID: ' + c.id + '</p>' +
                        '<div style="display:flex;gap:8px;flex-wrap:wrap;">' +
                            '<span class="status-badge status-' + c.stage + '"><span class="dot"></span>' + stageLabel + '</span>' +
                            '<span class="tag tag-' + c.priority + '" style="text-transform:capitalize;">' + c.priority + ' Priority</span>' +
                            '<span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '">' + (c.docsStatus === 'ok' ? 'Docs Complete' : 'Docs Pending') + '</span>' +
                        '</div>' +
                    '</div>' +
                '</div>';
                
                html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">';
                
                // Left Column
                html += '<div>' +
                    '<div class="panel-section"><h4 class="panel-section-title">Contact Information</h4>' +
                        '<div class="info-box">' +
                            '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="mail"></i><span>' + c.email + '</span></div>' +
                            '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="phone"></i><span>' + c.phone + '</span></div>' +
                            '<div class="contact-item"><i data-lucide="map-pin"></i><span>Manila, Philippines</span></div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="panel-section"><h4 class="panel-section-title">Application Details</h4>' +
                        '<div class="info-box"><div class="info-grid">' +
                            '<div class="info-item"><span class="info-label">Source</span><span class="info-value" style="text-transform:capitalize;">' + c.source + '</span></div>' +
                            '<div class="info-item"><span class="info-label">Applied Date</span><span class="info-value">2025-01-15</span></div>' +
                            '<div class="info-item"><span class="info-label">Days in Stage</span><span class="info-value">' + c.daysInStage + ' days</span></div>' +
                            '<div class="info-item"><span class="info-label">Linked RFC</span><span class="info-value">' + (c.rfcId || 'None') + '</span></div>' +
                        '</div></div>' +
                    '</div>' +
                '</div>';
                
                // Right Column
                html += '<div>' +
                    '<div class="panel-section"><h4 class="panel-section-title">Certifications & Documents</h4>' +
                        '<div class="info-box">' +
                            '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>STCW Certificate</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                            '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Medical Certificate</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                            '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Passport</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                            '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Seamans Book</span><span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '" style="font-size:0.7rem;">' + (c.docsStatus === 'ok' ? 'Valid' : 'Pending') + '</span></div>' +
                            '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;"><span>Flag State License</span><span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '" style="font-size:0.7rem;">' + (c.docsStatus === 'ok' ? 'Valid' : 'Pending') + '</span></div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="panel-section"><h4 class="panel-section-title">Experience Summary</h4>' +
                        '<div class="info-box">' +
                            '<div class="info-item" style="margin-bottom:8px;"><span class="info-label">Total Sea Service</span><span class="info-value">8 years, 4 months</span></div>' +
                            '<div class="info-item" style="margin-bottom:8px;"><span class="info-label">Vessel Types</span><span class="info-value">Bulk Carrier, Tanker</span></div>' +
                            '<div class="info-item"><span class="info-label">Last Vessel</span><span class="info-value">MV Pacific Star</span></div>' +
                        '</div>' +
                    '</div>' +
                '</div>';
                
                html += '</div>'; // Close grid
                
                // Timeline
                html += '<div class="panel-section" style="margin-top:24px;"><h4 class="panel-section-title">Application Timeline <span style="font-size:0.75rem;color:var(--cw-gray-400);font-weight:normal;">(Click to change stage)</span></h4>' +
                    '<div style="display:flex;gap:16px;overflow-x:auto;padding:16px 0;">' +
                        '<div onclick="changeCandidateStage(\'' + c.id + '\', \'new\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'new' || c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:white;border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="user-plus" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">New</div><div style="font-size:0.7rem;opacity:0.8;">Jan 15</div></div>' +
                        '<div onclick="changeCandidateStage(\'' + c.id + '\', \'screening\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="search" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Screening</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 18' : 'â€”') + '</div></div>' +
                        '<div onclick="changeCandidateStage(\'' + c.id + '\', \'interview\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="message-square" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Interview</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 22' : 'â€”') + '</div></div>' +
                        '<div onclick="changeCandidateStage(\'' + c.id + '\', \'negotiation\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="handshake" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Negotiation</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 25' : 'â€”') + '</div></div>' +
                        '<div onclick="changeCandidateStage(\'' + c.id + '\', \'endorsed\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="check-circle" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Endorsed</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'endorsed' ? 'Jan 28' : 'â€”') + '</div></div>' +
                    '</div>' +
                '</div>';
                
                // Notes
                html += '<div class="panel-section"><h4 class="panel-section-title">Notes & Comments</h4>' +
                    '<div class="info-box" style="background:var(--cw-gray-50);">' +
                        '<div style="padding:12px;border-bottom:1px solid var(--cw-gray-200);"><div style="font-size:0.8rem;color:var(--cw-gray-500);margin-bottom:4px;">Maria Santos â€¢ 2 days ago</div><div>Strong technical background. Recommended for interview.</div></div>' +
                        '<div style="padding:12px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);margin-bottom:4px;">System â€¢ 5 days ago</div><div>Candidate added to pipeline from ' + c.source + ' source.</div></div>' +
                    '</div>' +
                '</div>';
                
                document.getElementById('fullProfileContent').innerHTML = html;
                closePanel('seafarerPanel');
                openModal('fullProfileModal');
                lucide.createIcons();
            }
        }
        
        function printProfile() {
            window.print();
        }
        
        function openEditModal() {
            if (!currentPanelItem) return;
            
            const item = currentPanelItem.data;
            
            if (currentPanelItem.type === 'candidate') {
                // Populate and open edit candidate modal
                document.getElementById('editCandidateFirstName').value = item.firstName;
                document.getElementById('editCandidateLastName').value = item.lastName;
                document.getElementById('editCandidateRank').value = item.rank;
                document.getElementById('editCandidateEmail').value = item.email;
                document.getElementById('editCandidatePhone').value = item.phone;
                document.getElementById('editCandidatePriority').value = item.priority;
                document.getElementById('editCandidateStage').value = item.stage;
                openModal('editCandidateModal');
            }
        }
        
        function saveEditCandidate() {
            showNotification('Candidate updated successfully!', 'success');
            closeModal('editCandidateModal');
            closePanel('seafarerPanel');
            renderKanbanBoard();
        }
        
        function moveToNextStage(id) {
            const stages = ['new', 'screening', 'interview', 'negotiation', 'endorsed'];
            const candidate = MOCK_CANDIDATES.find(c => c.id === id);
            if (!candidate) return;
            
            const currentIndex = stages.indexOf(candidate.stage);
            if (currentIndex < stages.length - 1) {
                candidate.stage = stages[currentIndex + 1];
                candidate.daysInStage = 0;
                showNotification(candidate.firstName + ' moved to ' + stages[currentIndex + 1].charAt(0).toUpperCase() + stages[currentIndex + 1].slice(1), 'success');
                closePanel('seafarerPanel');
                renderKanbanBoard();
            }
        }
        window.moveToNextStage = moveToNextStage;
        
        function scheduleInterviewFor(id) {
            const candidate = MOCK_CANDIDATES.find(c => c.id === id);
            if (!candidate) return;
            
            closePanel('seafarerPanel');
            document.getElementById('interviewCandidateSelect').value = id;
            openModal('scheduleInterviewModal');
        }
        window.scheduleInterviewFor = scheduleInterviewFor;
        
        function rejectCandidate(id) {
            const candidate = MOCK_CANDIDATES.find(c => c.id === id);
            if (!candidate) return;
            
            if (confirm('Are you sure you want to reject ' + candidate.firstName + ' ' + candidate.lastName + '?')) {
                candidate.stage = 'rejected';
                showNotification('Candidate rejected', 'info');
                closePanel('seafarerPanel');
                renderKanbanBoard();
            }
        }
        window.rejectCandidate = rejectCandidate;
        
        function changeCandidateStage(id, newStage) {
            const candidate = MOCK_CANDIDATES.find(c => c.id === id);
            if (!candidate) return;
            
            const stageLabels = { new: 'New', screening: 'Screening', interview: 'Interview', negotiation: 'Negotiation', endorsed: 'Endorsed' };
            
            if (candidate.stage === newStage) {
                showNotification('Candidate is already in ' + stageLabels[newStage] + ' stage', 'info');
                return;
            }
            
            candidate.stage = newStage;
            candidate.daysInStage = 0;
            
            // Update the currentPanelItem
            if (currentPanelItem) {
                currentPanelItem.data = candidate;
            }
            
            showNotification(candidate.firstName + ' ' + candidate.lastName + ' moved to ' + stageLabels[newStage], 'success');
            
            // Refresh the full profile modal content without closing
            refreshFullProfileContent(candidate);
            
            // Refresh kanban in background
            renderKanbanBoard();
        }
        
        function refreshFullProfileContent(c) {
            const initials = c.firstName[0] + c.lastName[0];
            const stageLabel = KANBAN_COLUMNS.find(col => col.id === c.stage)?.name || c.stage;
            
            let html = '<div style="display:flex;gap:24px;margin-bottom:24px;padding-bottom:24px;border-bottom:1px solid var(--cw-gray-200);">' +
                '<div class="avatar" style="width:100px;height:100px;font-size:2rem;flex-shrink:0;">' + initials + '</div>' +
                '<div style="flex:1;">' +
                    '<h2 style="font-size:1.5rem;font-weight:700;margin-bottom:4px;">' + c.firstName + ' ' + c.lastName + '</h2>' +
                    '<p style="font-size:1.1rem;color:var(--cw-gray-600);margin-bottom:8px;">' + c.rank + '</p>' +
                    '<p style="font-size:0.9rem;color:var(--cw-gray-500);margin-bottom:12px;">Candidate ID: ' + c.id + '</p>' +
                    '<div style="display:flex;gap:8px;flex-wrap:wrap;">' +
                        '<span class="status-badge status-' + c.stage + '"><span class="dot"></span>' + stageLabel + '</span>' +
                        '<span class="tag tag-' + c.priority + '" style="text-transform:capitalize;">' + c.priority + ' Priority</span>' +
                        '<span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '">' + (c.docsStatus === 'ok' ? 'Docs Complete' : 'Docs Pending') + '</span>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">';
            
            // Left Column
            html += '<div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Contact Information</h4>' +
                    '<div class="info-box">' +
                        '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="mail"></i><span>' + c.email + '</span></div>' +
                        '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="phone"></i><span>' + c.phone + '</span></div>' +
                        '<div class="contact-item"><i data-lucide="map-pin"></i><span>Manila, Philippines</span></div>' +
                    '</div>' +
                '</div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Application Details</h4>' +
                    '<div class="info-box"><div class="info-grid">' +
                        '<div class="info-item"><span class="info-label">Source</span><span class="info-value" style="text-transform:capitalize;">' + c.source + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Applied Date</span><span class="info-value">2025-01-15</span></div>' +
                        '<div class="info-item"><span class="info-label">Days in Stage</span><span class="info-value">' + c.daysInStage + ' days</span></div>' +
                        '<div class="info-item"><span class="info-label">Linked RFC</span><span class="info-value">' + (c.rfcId || 'None') + '</span></div>' +
                    '</div></div>' +
                '</div>' +
            '</div>';
            
            // Right Column
            html += '<div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Certifications & Documents</h4>' +
                    '<div class="info-box">' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>STCW Certificate</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Medical Certificate</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Passport</span><span class="tag tag-assigned" style="font-size:0.7rem;">Valid</span></div>' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cw-gray-100);"><span>Seamans Book</span><span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '" style="font-size:0.7rem;">' + (c.docsStatus === 'ok' ? 'Valid' : 'Pending') + '</span></div>' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;"><span>Flag State License</span><span class="tag tag-' + (c.docsStatus === 'ok' ? 'assigned' : 'unassigned') + '" style="font-size:0.7rem;">' + (c.docsStatus === 'ok' ? 'Valid' : 'Pending') + '</span></div>' +
                    '</div>' +
                '</div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Experience Summary</h4>' +
                    '<div class="info-box">' +
                        '<div class="info-item" style="margin-bottom:8px;"><span class="info-label">Total Sea Service</span><span class="info-value">8 years, 4 months</span></div>' +
                        '<div class="info-item" style="margin-bottom:8px;"><span class="info-label">Vessel Types</span><span class="info-value">Bulk Carrier, Tanker</span></div>' +
                        '<div class="info-item"><span class="info-label">Last Vessel</span><span class="info-value">MV Pacific Star</span></div>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            html += '</div>';
            
            // Timeline - Updated
            html += '<div class="panel-section" style="margin-top:24px;"><h4 class="panel-section-title">Application Timeline <span style="font-size:0.75rem;color:var(--cw-gray-400);font-weight:normal;">(Click to change stage)</span></h4>' +
                '<div style="display:flex;gap:16px;overflow-x:auto;padding:16px 0;">' +
                    '<div onclick="changeCandidateStage(\'' + c.id + '\', \'new\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'new' || c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:white;border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="user-plus" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">New</div><div style="font-size:0.7rem;opacity:0.8;">Jan 15</div></div>' +
                    '<div onclick="changeCandidateStage(\'' + c.id + '\', \'screening\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="search" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Screening</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'screening' || c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 18' : 'â€”') + '</div></div>' +
                    '<div onclick="changeCandidateStage(\'' + c.id + '\', \'interview\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="message-square" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Interview</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'interview' || c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 22' : 'â€”') + '</div></div>' +
                    '<div onclick="changeCandidateStage(\'' + c.id + '\', \'negotiation\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="handshake" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Negotiation</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'negotiation' || c.stage === 'endorsed' ? 'Jan 25' : 'â€”') + '</div></div>' +
                    '<div onclick="changeCandidateStage(\'' + c.id + '\', \'endorsed\')" style="flex:1;min-width:120px;text-align:center;padding:16px;background:' + (c.stage === 'endorsed' ? 'var(--status-ready)' : 'var(--cw-gray-200)') + ';color:' + (c.stage === 'endorsed' ? 'white' : 'var(--cw-gray-500)') + ';border-radius:8px;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\';this.style.boxShadow=\'0 4px 12px rgba(0,0,0,0.15)\';" onmouseout="this.style.transform=\'scale(1)\';this.style.boxShadow=\'none\';"><i data-lucide="check-circle" style="width:24px;height:24px;margin-bottom:8px;"></i><div style="font-size:0.8rem;">Endorsed</div><div style="font-size:0.7rem;opacity:0.8;">' + (c.stage === 'endorsed' ? 'Jan 28' : 'â€”') + '</div></div>' +
                '</div>' +
            '</div>';
            
            // Notes
            html += '<div class="panel-section"><h4 class="panel-section-title">Notes & Comments</h4>' +
                '<div class="info-box" style="background:var(--cw-gray-50);">' +
                    '<div style="padding:12px;border-bottom:1px solid var(--cw-gray-200);"><div style="font-size:0.8rem;color:var(--cw-gray-500);margin-bottom:4px;">System â€¢ Just now</div><div>Stage changed to ' + stageLabel + '</div></div>' +
                    '<div style="padding:12px;border-bottom:1px solid var(--cw-gray-200);"><div style="font-size:0.8rem;color:var(--cw-gray-500);margin-bottom:4px;">Maria Santos â€¢ 2 days ago</div><div>Strong technical background. Recommended for interview.</div></div>' +
                    '<div style="padding:12px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);margin-bottom:4px;">System â€¢ 5 days ago</div><div>Candidate added to pipeline from ' + c.source + ' source.</div></div>' +
                '</div>' +
            '</div>';
            
            document.getElementById('fullProfileContent').innerHTML = html;
            lucide.createIcons();
        }

        function searchCandidates(query) {
            // In a real app, this would filter the kanban board
            console.log('Searching for:', query);
        }

        function filterKanban(stage) {
            // In a real app, this would highlight/filter a specific stage
            console.log('Filtering stage:', stage);
        }

        // FLEET & VESSELS RENDERING
        function renderFleetGrid() {
            const container = document.getElementById('fleetGrid');
            if (!container) return;
            
            const principalFilter = document.getElementById('fleetPrincipalFilter')?.value || '';
            const typeFilter = document.getElementById('fleetTypeFilter')?.value || '';
            const statusFilter = document.getElementById('fleetStatusFilter')?.value || '';
            const searchQuery = document.getElementById('fleetSearchInput')?.value?.toLowerCase() || '';
            
            let vessels = MOCK_VESSELS;
            if (principalFilter) vessels = vessels.filter(v => v.principalKey === principalFilter);
            if (typeFilter) vessels = vessels.filter(v => v.typeKey === typeFilter);
            if (statusFilter) vessels = vessels.filter(v => v.status === statusFilter);
            if (searchQuery) vessels = vessels.filter(v => v.name.toLowerCase().includes(searchQuery) || v.principal.toLowerCase().includes(searchQuery));
            
            // Update counts
            const allVessels = MOCK_VESSELS;
            if (document.getElementById('fleetTotalCount')) {
                document.getElementById('fleetTotalCount').textContent = allVessels.length;
            }
            if (document.getElementById('fleetActiveCount')) {
                document.getElementById('fleetActiveCount').textContent = allVessels.filter(v => v.status === 'active').length;
            }
            if (document.getElementById('fleetMaintenanceCount')) {
                document.getElementById('fleetMaintenanceCount').textContent = allVessels.filter(v => v.status === 'maintenance').length;
            }
            
            container.innerHTML = vessels.length > 0 ? 
                vessels.map(vessel => renderVesselCard(vessel)).join('') :
                '<div style="grid-column:1/-1;padding:48px;text-align:center;color:var(--cw-gray-400);"><i data-lucide="ship" style="width:48px;height:48px;margin-bottom:16px;"></i><p>No vessels match your filters</p></div>';
            lucide.createIcons();
        }
        
        function filterFleetByStatus(status) {
            try {
                const statusFilter = document.getElementById('fleetStatusFilter');
                const principalFilter = document.getElementById('fleetPrincipalFilter');
                const typeFilter = document.getElementById('fleetTypeFilter');
                const searchInput = document.getElementById('fleetSearchInput');
                
                if (statusFilter) statusFilter.value = status;
                if (principalFilter) principalFilter.value = '';
                if (typeFilter) typeFilter.value = '';
                if (searchInput) searchInput.value = '';
                
                renderFleetGrid();
            } catch (e) {
                console.error('filterFleetByStatus error:', e);
                alert('Error: ' + e.message);
            }
        }
        
        function exportFleet() {
            let csv = 'ID,Name,Type,Principal,Flag,DWT,Built,Status,Crew\n';
            MOCK_VESSELS.forEach(v => {
                csv += '"' + v.id + '","' + v.name + '","' + v.type + '","' + v.principal + '","' + v.flag + '",' + v.dwt + ',' + v.built + ',"' + v.status + '",' + v.crew.length + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fleet_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Fleet data exported successfully!', 'success');
        }
        
        function showFleetMap() {
            openModal('fleetMapModal');
            lucide.createIcons();
        }
        
        function saveNewVessel() {
            const name = document.getElementById('vesselName').value;
            const type = document.getElementById('vesselType').value;
            const principal = document.getElementById('vesselPrincipal').value;
            
            if (!name || !type || !principal) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            showNotification('Vessel "' + name + '" added successfully!', 'success');
            closeModal('addVesselModal');
        }

        function renderVesselCard(vessel) {
            const crewCount = vessel.crew.length;
            const vacancies = vessel.crew.filter(c => !c.name).length;
            const expiring = vessel.crew.filter(c => c.status === 'expiring').length;
            const crewAvatars = vessel.crew.slice(0, 3).map(c => {
                const initials = c.name ? c.name.split(' ').map(n => n[0]).join('') : '?';
                return '<div class="vessel-crew-avatar">' + initials + '</div>';
            }).join('');
            const moreCount = crewCount > 3 ? crewCount - 3 : 0;
            
            return '<div class="vessel-card" onclick="openVesselDetailModal(\'' + vessel.id + '\')">' +
                '<div class="vessel-card-header">' +
                    '<div class="vessel-card-icon ' + vessel.typeKey + '"><i data-lucide="ship"></i></div>' +
                    '<div class="vessel-card-info">' +
                        '<div class="vessel-card-name">' + vessel.name + '</div>' +
                        '<div class="vessel-card-type">' + vessel.type + ' â€¢ ' + vessel.dwt.toLocaleString() + ' DWT</div>' +
                        '<div class="vessel-card-principal"><i data-lucide="building-2" style="width:12px;height:12px;"></i>' + vessel.principal + '</div>' +
                    '</div>' +
                    '<div class="vessel-card-status"><div class="vessel-status-dot ' + vessel.status + '"></div></div>' +
                '</div>' +
                '<div class="vessel-card-body">' +
                    '<div class="vessel-card-stats">' +
                        '<div class="vessel-stat"><div class="vessel-stat-value">' + crewCount + '</div><div class="vessel-stat-label">Crew</div></div>' +
                        '<div class="vessel-stat"><div class="vessel-stat-value" style="color:' + (vacancies > 0 ? 'var(--tag-nfr)' : 'var(--status-ready)') + ';">' + vacancies + '</div><div class="vessel-stat-label">Vacancies</div></div>' +
                        '<div class="vessel-stat"><div class="vessel-stat-value" style="color:' + (expiring > 0 ? 'var(--status-on-approval)' : 'var(--cw-gray-400)') + ';">' + expiring + '</div><div class="vessel-stat-label">Expiring</div></div>' +
                    '</div>' +
                    '<div class="vessel-card-crew">' +
                        '<div class="vessel-crew-avatars">' + crewAvatars + (moreCount > 0 ? '<div class="vessel-crew-avatar more">+' + moreCount + '</div>' : '') + '</div>' +
                        '<span class="vessel-crew-text">' + crewCount + ' crew members</span>' +
                    '</div>' +
                '</div>' +
                '<div class="vessel-card-footer">' +
                    '<div class="vessel-card-meta">' +
                        '<span class="vessel-card-meta-item"><i data-lucide="flag"></i>' + vessel.flag + '</span>' +
                        '<span class="vessel-card-meta-item"><i data-lucide="calendar"></i>Built ' + vessel.built + '</span>' +
                    '</div>' +
                    '<div class="vessel-card-actions">' +
                        '<button class="actions-btn" onclick="event.stopPropagation(); openVesselDetailModal(\'' + vessel.id + '\');"><i data-lucide="more-horizontal" style="width:16px;height:16px;"></i></button>' +
                    '</div>' +
                '</div>' +
            '</div>';
        }

        function openVesselDetailModal(vesselId) {
            const vessel = MOCK_VESSELS.find(v => v.id === vesselId);
            if (!vessel) return;
            
            // Store current vessel
            window.currentVessel = vessel;
            
            // Update header
            const typeColors = { bulk: '#0ea5e9', tanker: '#f97316', container: '#8b5cf6', lng: '#10b981' };
            const headerColor = typeColors[vessel.typeKey] || '#0ea5e9';
            document.getElementById('vesselDetailHeader').style.background = 'linear-gradient(135deg, ' + headerColor + ' 0%, ' + headerColor + '99 100%)';
            
            document.getElementById('vesselDetailName').textContent = vessel.name;
            document.getElementById('vesselDetailType').textContent = vessel.type + ' â€¢ ' + vessel.dwt.toLocaleString() + ' DWT';
            document.getElementById('vesselDetailPrincipal').innerHTML = '<i data-lucide="building-2" style="width:14px;height:14px;"></i>' + vessel.principal;
            
            // Status badge
            const statusColors = { active: '#10b981', maintenance: '#f59e0b', inactive: '#ef4444' };
            const statusLabels = { active: 'Active', maintenance: 'Maintenance', inactive: 'Inactive' };
            document.getElementById('vesselDetailStatus').innerHTML = '<span style="width:8px;height:8px;border-radius:50%;background:' + statusColors[vessel.status] + ';"></span>' + statusLabels[vessel.status];
            document.getElementById('vesselDetailStatus').style.background = 'rgba(' + (vessel.status === 'active' ? '16,185,129' : vessel.status === 'maintenance' ? '245,158,11' : '239,68,68') + ',0.3)';
            
            // Crew counts
            const crewCount = vessel.crew.length;
            const vacancies = vessel.crew.filter(c => !c.name).length;
            const expiring = vessel.crew.filter(c => c.status === 'expiring').length;
            const onboard = vessel.crew.filter(c => c.status === 'onboard').length;
            const scheduled = vessel.crew.filter(c => c.status === 'scheduled').length;
            
            document.getElementById('vesselDetailCrewCount').textContent = crewCount;
            document.getElementById('vesselDetailVacancies').textContent = vacancies;
            document.getElementById('vesselStatOnboard').textContent = onboard;
            document.getElementById('vesselStatExpiring').textContent = expiring;
            document.getElementById('vesselStatVacancy').textContent = vacancies;
            document.getElementById('vesselStatScheduled').textContent = scheduled;
            
            // Vessel info
            document.getElementById('vesselDetailIMO').textContent = vessel.imo;
            document.getElementById('vesselDetailFlag').textContent = vessel.flag;
            document.getElementById('vesselDetailBuilt').textContent = vessel.built;
            document.getElementById('vesselDetailDWT').textContent = vessel.dwt.toLocaleString();
            document.getElementById('vesselDetailTypeShort').textContent = vessel.type;
            
            // Render crew table
            const tbody = document.getElementById('vesselCrewTableBody');
            tbody.innerHTML = vessel.crew.map(c => {
                const initials = c.name ? c.name.split(' ').map(n => n[0]).join('') : '?';
                const statusColors = { onboard: '#10b981', expiring: '#f59e0b', vacancy: '#ef4444', scheduled: '#3b82f6' };
                const statusLabels = { onboard: 'Onboard', expiring: 'Expiring', vacancy: 'Vacancy', scheduled: 'Scheduled' };
                const statusColor = statusColors[c.status] || '#6b7280';
                const statusLabel = statusLabels[c.status] || c.status;
                
                return '<tr style="border-bottom:1px solid var(--cw-gray-100);">' +
                    '<td style="padding:14px 16px;">' +
                        '<div style="display:flex;align-items:center;gap:12px;">' +
                            '<div style="width:40px;height:40px;border-radius:10px;background:' + (c.name ? 'linear-gradient(135deg,#00495D,#0891b2)' : '#ef4444') + ';color:white;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:0.9rem;">' + initials + '</div>' +
                            '<div><div style="font-weight:600;' + (!c.name ? 'color:#ef4444;' : '') + '">' + (c.name || 'VACANCY') + '</div>' + (c.name ? '<div style="font-size:0.8rem;color:var(--cw-gray-500);">ID: ' + c.id + '</div>' : '') + '</div>' +
                        '</div>' +
                    '</td>' +
                    '<td style="padding:14px 16px;"><span class="badge badge-officer">' + c.rank + '</span></td>' +
                    '<td style="padding:14px 16px;text-align:center;font-family:monospace;">' + c.startDate + '</td>' +
                    '<td style="padding:14px 16px;text-align:center;font-family:monospace;' + (c.status === 'expiring' ? 'color:#f59e0b;font-weight:600;' : '') + '">' + c.endDate + '</td>' +
                    '<td style="padding:14px 16px;text-align:center;"><span style="background:' + statusColor + '20;color:' + statusColor + ';padding:4px 12px;border-radius:12px;font-size:0.8rem;font-weight:600;">' + statusLabel + '</span></td>' +
                    '<td style="padding:14px 16px;text-align:center;">' + (c.nextCrew ? '<div style="font-size:0.85rem;"><div style="font-weight:600;">' + c.nextCrew.name + '</div><div style="color:var(--cw-gray-500);">' + c.nextCrew.startDate + '</div></div>' : '<span style="color:var(--cw-gray-400);">-</span>') + '</td>' +
                    '<td style="padding:14px 16px;text-align:center;">' +
                        (c.name ? '<button class="btn btn-ghost btn-sm" onclick="openSeafarerProfile(\'' + c.name + '\')"><i data-lucide="user" style="width:16px;height:16px;"></i></button>' : '<button class="btn btn-primary btn-sm" onclick="createRfaForPosition(\'' + c.rank + '\')"><i data-lucide="plus" style="width:14px;height:14px;"></i>Fill</button>') +
                    '</td>' +
                '</tr>';
            }).join('');
            
            openModal('vesselDetailModal');
            lucide.createIcons();
        }
        
        function openVesselPanel(vesselId) {
            // Redirect to new modal
            openVesselDetailModal(vesselId);
        }
        
        function printVesselDetails() {
            const v = window.currentVessel;
            if (!v) return;
            
            const crewRows = v.crew.map(c => 
                '<tr><td style="padding:8px;border:1px solid #ddd;">' + (c.name || 'VACANCY') + '</td><td style="padding:8px;border:1px solid #ddd;">' + c.rank + '</td><td style="padding:8px;border:1px solid #ddd;">' + c.startDate + '</td><td style="padding:8px;border:1px solid #ddd;">' + c.endDate + '</td><td style="padding:8px;border:1px solid #ddd;">' + c.status + '</td></tr>'
            ).join('');
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write('<!DOCTYPE html><html><head><title>Vessel Details - ' + v.name + '</title><style>body{font-family:Arial,sans-serif;padding:40px;max-width:900px;margin:0 auto;}.header{text-align:center;border-bottom:3px solid #0369a1;padding-bottom:20px;margin-bottom:30px;}.logo{font-size:24px;font-weight:bold;color:#00495D;}table{width:100%;border-collapse:collapse;margin-top:20px;}th{background:#f3f4f6;padding:10px;text-align:left;border:1px solid #ddd;}</style></head><body>' +
                '<div class="header"><div class="logo">CROSSWORLD MARINE SERVICES</div><div style="font-size:20px;margin-top:10px;">VESSEL CREW MANIFEST</div></div>' +
                '<h2>' + v.name + '</h2><p>' + v.type + ' â€¢ ' + v.principal + '</p>' +
                '<table><tr><td><strong>IMO:</strong> ' + v.imo + '</td><td><strong>Flag:</strong> ' + v.flag + '</td><td><strong>Built:</strong> ' + v.built + '</td><td><strong>DWT:</strong> ' + v.dwt.toLocaleString() + '</td></tr></table>' +
                '<h3 style="margin-top:30px;">Crew List</h3><table><thead><tr><th>Name</th><th>Rank</th><th>Start Date</th><th>End Date</th><th>Status</th></tr></thead><tbody>' + crewRows + '</tbody></table>' +
                '<p style="margin-top:40px;text-align:center;font-size:12px;color:#999;">Generated by ATLANTIS ERP | ' + new Date().toLocaleString() + '</p></body></html>');
            printWindow.document.close();
            setTimeout(() => { printWindow.print(); }, 500);
            showNotification('Print dialog opened', 'success');
        }
        
        function exportVesselCrew() {
            const v = window.currentVessel;
            if (!v) return;
            
            let csv = 'Vessel,IMO,Principal,Crew Name,Rank,Start Date,End Date,Status\n';
            v.crew.forEach(c => {
                csv += '"' + v.name + '","' + v.imo + '","' + v.principal + '","' + (c.name || 'VACANCY') + '","' + c.rank + '","' + c.startDate + '","' + c.endDate + '","' + c.status + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = v.name.replace(/\s+/g, '_') + '_crew_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('âœ“ Crew list exported!', 'success');
        }
        
        function editVessel() {
            const v = window.currentVessel;
            if (!v) return;
            closeModal('vesselDetailModal');
            showNotification('Edit vessel feature coming soon!', 'info');
        }
        
        function createRfaForVessel() {
            const v = window.currentVessel;
            if (!v) return;
            closeModal('vesselDetailModal');
            openModal('newRfaModal');
            showNotification('Creating RFA for ' + v.name, 'info');
        }
        
        function createRfaForPosition(rank) {
            const v = window.currentVessel;
            if (!v) return;
            closeModal('vesselDetailModal');
            openModal('newRfaModal');
            showNotification('Creating RFA for ' + rank + ' on ' + v.name, 'info');
        }
        
        function saveNewVessel() {
            const name = document.getElementById('newVesselName').value;
            const imo = document.getElementById('newVesselIMO').value;
            const type = document.getElementById('newVesselType').value;
            const principal = document.getElementById('newVesselPrincipal').value;
            
            if (!name || !imo || !type || !principal) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            closeModal('addVesselModal');
            showNotification('âœ“ Vessel ' + name + ' added successfully!', 'success');
            renderFleetGrid();
        }
        
        function exportFleet() {
            let csv = 'Vessel Name,IMO,Type,Principal,Flag,Built,DWT,Status,Crew Count\n';
            MOCK_VESSELS.forEach(v => {
                csv += '"' + v.name + '","' + v.imo + '","' + v.type + '","' + v.principal + '","' + v.flag + '",' + v.built + ',' + v.dwt + ',"' + v.status + '",' + v.crew.length + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fleet_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('âœ“ Fleet data exported!', 'success');
        }
        
        function showFleetMap() {
            showNotification('Fleet Map feature coming soon!', 'info');
        }
        
        function filterFleetByStatus(status) {
            const el = document.getElementById('fleetStatusFilter');
            if (el) el.value = status;
            renderFleetGrid();
            if (status) showNotification('Filtering by: ' + status.charAt(0).toUpperCase() + status.slice(1), 'info');
        }

        // DOCUMENTS MODULE RENDERING
        function renderDocumentsModule() {
            renderDocumentAlerts();
            renderDocumentsTable();
        }

        function renderDocumentAlerts() {
            const container = document.getElementById('docAlertsContainer');
            if (!container) return;
            
            const critical = MOCK_DOCUMENTS.filter(d => d.status === 'critical' || d.status === 'expired');
            const expiringSoon = MOCK_DOCUMENTS.filter(d => d.status === 'expiring-soon');
            
            let html = '';
            
            if (critical.length > 0) {
                html += '<div class="doc-alert-card critical">' +
                    '<div class="doc-alert-icon critical"><i data-lucide="alert-triangle"></i></div>' +
                    '<div class="doc-alert-content">' +
                        '<div class="doc-alert-title">' + critical.length + ' Critical Documents</div>' +
                        '<div class="doc-alert-subtitle">Expired or expiring within 7 days - immediate action required</div>' +
                    '</div>' +
                    '<div class="doc-alert-action"><button class="btn btn-sm" style="background:var(--tag-nfr);color:white;" onclick="viewCriticalDocs()">View All</button></div>' +
                '</div>';
            }
            
            if (expiringSoon.length > 0) {
                html += '<div class="doc-alert-card warning">' +
                    '<div class="doc-alert-icon warning"><i data-lucide="clock"></i></div>' +
                    '<div class="doc-alert-content">' +
                        '<div class="doc-alert-title">' + expiringSoon.length + ' Documents Expiring Soon</div>' +
                        '<div class="doc-alert-subtitle">Expiring within 30 days - schedule renewals</div>' +
                    '</div>' +
                    '<div class="doc-alert-action"><button class="btn btn-sm btn-secondary" onclick="viewExpiringSoonDocs()">View All</button></div>' +
                '</div>';
            }
            
            container.innerHTML = html;
            lucide.createIcons();
        }

        function renderDocumentsTable() {
            const tbody = document.getElementById('documentsTableBody');
            if (!tbody) return;
            
            const typeFilter = document.getElementById('docTypeFilter')?.value || '';
            const statusFilter = document.getElementById('docStatusFilter')?.value || '';
            const searchQuery = document.getElementById('docSearchInput')?.value?.toLowerCase() || '';
            
            let docs = MOCK_DOCUMENTS;
            if (typeFilter) docs = docs.filter(d => d.docType === typeFilter);
            if (statusFilter) docs = docs.filter(d => d.status === statusFilter);
            if (searchQuery) docs = docs.filter(d => 
                d.seafarerName.toLowerCase().includes(searchQuery) || 
                d.docName.toLowerCase().includes(searchQuery) ||
                d.docNumber.toLowerCase().includes(searchQuery)
            );
            
            document.getElementById('docTableCount').textContent = 'Showing ' + docs.length + ' documents';
            
            tbody.innerHTML = docs.map(doc => {
                const initials = doc.seafarerName.split(' ').map(n => n[0]).join('');
                const typeIcons = { stcw: 'award', flag: 'flag', medical: 'heart-pulse', national: 'id-card', company: 'building-2' };
                const statusClass = doc.status;
                const statusLabel = doc.status === 'valid' ? 'Valid' : doc.status === 'expiring-soon' ? 'Expiring Soon' : doc.status === 'critical' ? 'Critical' : 'Expired';
                const daysDisplay = doc.daysLeft < 0 ? Math.abs(doc.daysLeft) + 'd overdue' : doc.daysLeft + 'd';
                const daysClass = doc.daysLeft < 0 ? 'danger' : doc.daysLeft <= 7 ? 'danger' : doc.daysLeft <= 30 ? 'warning' : '';
                
                return '<tr>' +
                    '<td><div class="avatar-cell" style="cursor:pointer;" onclick="openSeafarerProfile(\'' + doc.seafarerName + '\')">' +
                        '<div class="avatar">' + initials + '</div>' +
                        '<div class="avatar-info"><span class="avatar-name">' + doc.seafarerName + '</span><span class="avatar-meta">' + doc.rank + '</span></div>' +
                    '</div></td>' +
                    '<td><div class="doc-type-icon ' + doc.docType + '"><i data-lucide="' + typeIcons[doc.docType] + '"></i></div></td>' +
                    '<td><span class="text-primary">' + doc.docName + '</span></td>' +
                    '<td><span class="font-mono" style="font-size:0.8rem;color:var(--cw-gray-500);">' + doc.docNumber + '</span></td>' +
                    '<td class="date-cell">' + doc.issueDate + '</td>' +
                    '<td class="date-cell ' + daysClass + '">' + doc.expiryDate + '</td>' +
                    '<td><span class="doc-expiry-badge ' + statusClass + '">' + statusLabel + '</span></td>' +
                    '<td><span class="date-cell ' + daysClass + '" style="font-weight:600;">' + daysDisplay + '</span></td>' +
                    '<td class="actions-cell"><button class="actions-btn" onclick="openDocumentActions(\'' + doc.id + '\')"><i data-lucide="more-horizontal" style="width:18px;height:18px;"></i></button></td>' +
                '</tr>';
            }).join('');
            
            lucide.createIcons();
        }
        
        function filterDocsByStatus(status) {
            const el = document.getElementById('docStatusFilter');
            if (el) el.value = status;
            renderDocumentsTable();
        }
        
        function exportDocuments() {
            let csv = 'Seafarer,Rank,Document Type,Document Name,Number,Issue Date,Expiry Date,Status,Days Left\n';
            MOCK_DOCUMENTS.forEach(d => {
                const statusLabel = d.status === 'valid' ? 'Valid' : d.status === 'expiring-soon' ? 'Expiring Soon' : d.status === 'critical' ? 'Critical' : 'Expired';
                csv += '"' + d.seafarerName + '","' + d.rank + '","' + d.docType + '","' + d.docName + '","' + d.docNumber + '","' + d.issueDate + '","' + d.expiryDate + '","' + statusLabel + '",' + d.daysLeft + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'documents_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Documents exported successfully!', 'success');
        }
        
        function saveAlertSettings() {
            const criticalDays = document.getElementById('alertCriticalDays')?.value || 7;
            const warningDays = document.getElementById('alertWarningDays')?.value || 30;
            
            showNotification('Alert settings saved: Critical=' + criticalDays + ' days, Warning=' + warningDays + ' days', 'success');
            closeModal('alertSettingsModal');
        }
        
        function handleFileSelect(input) {
            const preview = document.getElementById('filePreview');
            if (input.files && input.files[0]) {
                const file = input.files[0];
                preview.style.display = 'flex';
                preview.style.alignItems = 'center';
                preview.style.gap = '12px';
                preview.innerHTML = '<i data-lucide="file" style="width:24px;height:24px;color:var(--cw-primary);"></i>' +
                    '<div style="flex:1;"><div style="font-weight:600;color:var(--cw-gray-700);">' + file.name + '</div>' +
                    '<div style="font-size:0.8rem;color:var(--cw-gray-500);">' + (file.size / 1024).toFixed(1) + ' KB</div></div>' +
                    '<button type="button" onclick="clearFileUpload()" style="background:none;border:none;cursor:pointer;color:var(--cw-gray-400);"><i data-lucide="x" style="width:20px;height:20px;"></i></button>';
                lucide.createIcons();
            }
        }
        
        function clearFileUpload() {
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').style.display = 'none';
        }
        
        function saveUploadDocument() {
            const seafarer = document.getElementById('uploadSeafarer')?.value;
            const docType = document.getElementById('uploadDocType')?.value;
            const docName = document.getElementById('uploadDocName')?.value;
            const issueDate = document.getElementById('uploadIssueDate')?.value;
            const expiryDate = document.getElementById('uploadExpiryDate')?.value;
            
            if (!seafarer || !docType || !docName || !issueDate || !expiryDate) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            showNotification('Document uploaded successfully: ' + docName, 'success');
            closeModal('uploadDocumentModal');
            renderDocumentsTable();
        }
        
        function openDocumentActions(docId) {
            const doc = MOCK_DOCUMENTS.find(d => d.id === docId);
            if (!doc) return;
            showNotification('Document: ' + doc.docName + ' (' + doc.seafarerName + ')', 'info');
        }
        
        function viewCriticalDocs() {
            filterDocsByStatus('critical');
            showNotification('Showing critical documents (expiring in 7 days)', 'warning');
        }
        
        function viewExpiringSoonDocs() {
            filterDocsByStatus('expiring-soon');
            showNotification('Showing documents expiring within 30 days', 'info');
        }

        // CONTRACTS MODULE RENDERING
        function renderContractsGrid() {
            const container = document.getElementById('contractsGrid');
            if (!container) return;
            
            const statusFilter = document.getElementById('contractStatusFilter')?.value || '';
            const principalFilter = document.getElementById('contractPrincipalFilter')?.value || '';
            const searchQuery = document.getElementById('contractSearchInput')?.value?.toLowerCase() || '';
            
            let contracts = MOCK_CONTRACTS;
            if (statusFilter) contracts = contracts.filter(c => c.status === statusFilter);
            if (principalFilter) contracts = contracts.filter(c => c.principalKey === principalFilter);
            if (searchQuery) contracts = contracts.filter(c => 
                c.seafarerName.toLowerCase().includes(searchQuery) || 
                c.vesselName.toLowerCase().includes(searchQuery) ||
                c.id.toLowerCase().includes(searchQuery)
            );
            
            container.innerHTML = contracts.map(contract => renderContractCard(contract)).join('');
            lucide.createIcons();
        }
        
        function filterContractsByStatus(status) {
            const el = document.getElementById('contractStatusFilter');
            if (el) el.value = status;
            renderContractsGrid();
        }
        
        function exportContracts() {
            let csv = 'ID,Seafarer,Rank,Vessel,Principal,Start Date,Duration,Salary,Status,PEME\n';
            MOCK_CONTRACTS.forEach(c => {
                csv += '"' + c.id + '","' + c.seafarerName + '","' + c.rank + '","' + c.vesselName + '","' + c.principal + '","' + c.startDate + '","' + c.duration + '",' + c.salary + ',"' + c.status + '","' + c.pemeStatus + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'contracts_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Contracts exported successfully!', 'success');
        }
        
        function saveNewContract() {
            const seafarer = document.getElementById('contractSeafarer').value;
            const vessel = document.getElementById('contractVessel').value;
            
            if (!seafarer || !vessel) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            showNotification('Contract created successfully!', 'success');
            closeModal('newContractModal');
        }
        
        let currentContractId = null;
        
        function openContractDetail(contractId) {
            const contract = MOCK_CONTRACTS.find(c => c.id === contractId);
            if (!contract) return;
            
            currentContractId = contractId;
            const seafarerInitials = contract.seafarerName.split(' ').map(n => n[0]).join('');
            const vesselInitials = contract.vesselName.replace('MV ', '').substring(0, 2).toUpperCase();
            
            const statusLabels = {
                'draft': 'Draft', 'pending-peme': 'Pending PEME', 'peme-cleared': 'PEME Cleared',
                'signed': 'Signed', 'active': 'Active', 'completed': 'Completed', 'cancelled': 'Cancelled'
            };
            const statusColors = {
                'draft': '#64748b', 'pending-peme': '#f59e0b', 'peme-cleared': '#10b981',
                'signed': '#3b82f6', 'active': '#059669', 'completed': '#6b7280', 'cancelled': '#ef4444'
            };
            const pemeLabels = { 'pending': 'Pending', 'scheduled': 'Scheduled', 'cleared': 'Cleared', 'failed': 'Failed' };
            
            // Calculate end date
            const startDate = new Date(contract.startDate);
            const endDate = new Date(startDate);
            endDate.setMonth(endDate.getMonth() + contract.duration);
            
            // Days remaining
            const today = new Date();
            const daysRemaining = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
            const progress = Math.min(100, Math.max(0, Math.round(((today - startDate) / (endDate - startDate)) * 100)));
            
            // Header
            document.getElementById('contractDetailHeader').innerHTML = 
                '<div style="display:flex;justify-content:space-between;align-items:flex-start;">' +
                    '<div>' +
                        '<div style="display:flex;align-items:center;gap:16px;margin-bottom:8px;">' +
                            '<span style="font-size:1.5rem;font-weight:700;">' + contract.id + '</span>' +
                            '<span style="padding:6px 16px;border-radius:20px;font-size:0.85rem;font-weight:600;background:' + statusColors[contract.status] + ';">' + statusLabels[contract.status] + '</span>' +
                        '</div>' +
                        '<p style="opacity:0.9;font-size:0.95rem;">Employment Contract â€¢ ' + contract.duration + ' months duration</p>' +
                    '</div>' +
                    '<div style="text-align:right;">' +
                        '<div style="font-size:2rem;font-weight:700;">$' + contract.salary.toLocaleString() + '</div>' +
                        '<div style="opacity:0.85;font-size:0.85rem;">Monthly Salary</div>' +
                    '</div>' +
                '</div>';
            
            // Body Content
            document.getElementById('contractDetailContent').innerHTML = 
                '<div style="padding:32px;">' +
                    // Parties Section
                    '<div style="display:grid;grid-template-columns:1fr auto 1fr;gap:32px;align-items:center;margin-bottom:32px;padding:28px;background:var(--cw-gray-50);border-radius:16px;">' +
                        '<div style="display:flex;align-items:center;gap:16px;">' +
                            '<div style="width:72px;height:72px;border-radius:50%;background:var(--cw-gray-200);display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;color:var(--cw-gray-600);">' + seafarerInitials + '</div>' +
                            '<div>' +
                                '<div style="font-size:1.25rem;font-weight:700;color:var(--cw-gray-800);">' + contract.seafarerName + '</div>' +
                                '<div style="color:var(--cw-gray-500);margin-bottom:4px;">' + contract.seafarerRank + '</div>' +
                                '<span style="padding:4px 10px;border-radius:12px;font-size:0.75rem;font-weight:600;background:var(--cw-primary);color:white;">Seafarer</span>' +
                            '</div>' +
                        '</div>' +
                        '<div style="display:flex;flex-direction:column;align-items:center;gap:8px;">' +
                            '<i data-lucide="arrow-right" style="width:32px;height:32px;color:var(--cw-gray-400);"></i>' +
                            '<span style="font-size:0.75rem;color:var(--cw-gray-400);text-transform:uppercase;letter-spacing:1px;">Assigned To</span>' +
                        '</div>' +
                        '<div style="display:flex;align-items:center;gap:16px;">' +
                            '<div style="width:72px;height:72px;border-radius:50%;background:var(--cw-primary);display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;color:white;">' + vesselInitials + '</div>' +
                            '<div>' +
                                '<div style="font-size:1.25rem;font-weight:700;color:var(--cw-gray-800);">' + contract.vesselName + '</div>' +
                                '<div style="color:var(--cw-gray-500);margin-bottom:4px;">' + contract.principal + '</div>' +
                                '<span style="padding:4px 10px;border-radius:12px;font-size:0.75rem;font-weight:600;background:var(--cw-accent);color:white;">Vessel</span>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    
                    // Contract Progress
                    '<div style="margin-bottom:32px;padding:24px;background:white;border-radius:16px;border:1px solid var(--cw-gray-200);">' +
                        '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">' +
                            '<h3 style="font-size:1rem;font-weight:700;color:var(--cw-gray-800);margin:0;">Contract Progress</h3>' +
                            '<span style="font-size:0.9rem;color:var(--cw-gray-500);">' + daysRemaining + ' days remaining</span>' +
                        '</div>' +
                        '<div style="height:12px;background:var(--cw-gray-100);border-radius:6px;overflow:hidden;margin-bottom:12px;">' +
                            '<div style="height:100%;width:' + progress + '%;background:linear-gradient(90deg,#0d9488,#14b8a6);border-radius:6px;transition:width 0.5s;"></div>' +
                        '</div>' +
                        '<div style="display:flex;justify-content:space-between;font-size:0.85rem;">' +
                            '<span style="color:var(--cw-gray-600);"><strong>Start:</strong> ' + contract.startDate + '</span>' +
                            '<span style="font-weight:600;color:var(--cw-primary);">' + progress + '% Complete</span>' +
                            '<span style="color:var(--cw-gray-600);"><strong>End:</strong> ' + endDate.toISOString().split('T')[0] + '</span>' +
                        '</div>' +
                    '</div>' +
                    
                    // Details Grid
                    '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-bottom:32px;">' +
                        // Contract Details Card
                        '<div style="padding:24px;background:white;border-radius:16px;border:1px solid var(--cw-gray-200);">' +
                            '<h3 style="font-size:0.85rem;font-weight:700;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;margin:0 0 20px 0;display:flex;align-items:center;gap:8px;"><i data-lucide="file-text" style="width:18px;height:18px;"></i>Contract Details</h3>' +
                            '<div style="space-y:16px;">' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Contract ID</span><span style="font-weight:600;">' + contract.id + '</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Duration</span><span style="font-weight:600;">' + contract.duration + ' months</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Type</span><span style="font-weight:600;">Standard</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;"><span style="color:var(--cw-gray-500);">Created</span><span style="font-weight:600;">2024-10-15</span></div>' +
                            '</div>' +
                        '</div>' +
                        // Compensation Card
                        '<div style="padding:24px;background:white;border-radius:16px;border:1px solid var(--cw-gray-200);">' +
                            '<h3 style="font-size:0.85rem;font-weight:700;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;margin:0 0 20px 0;display:flex;align-items:center;gap:8px;"><i data-lucide="wallet" style="width:18px;height:18px;"></i>Compensation</h3>' +
                            '<div style="space-y:16px;">' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Basic Salary</span><span style="font-weight:600;">$' + contract.salary.toLocaleString() + '</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Leave Pay</span><span style="font-weight:600;">$' + Math.round(contract.salary * 0.1).toLocaleString() + '</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);"><span style="color:var(--cw-gray-500);">Overtime Rate</span><span style="font-weight:600;">$18/hr</span></div>' +
                                '<div style="display:flex;justify-content:space-between;padding:12px 0;"><span style="color:var(--cw-gray-500);">Total Contract</span><span style="font-weight:700;color:var(--cw-primary);">$' + (contract.salary * contract.duration).toLocaleString() + '</span></div>' +
                            '</div>' +
                        '</div>' +
                        // PEME Status Card
                        '<div style="padding:24px;background:white;border-radius:16px;border:1px solid var(--cw-gray-200);">' +
                            '<h3 style="font-size:0.85rem;font-weight:700;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;margin:0 0 20px 0;display:flex;align-items:center;gap:8px;"><i data-lucide="heart-pulse" style="width:18px;height:18px;"></i>Medical (PEME)</h3>' +
                            '<div style="text-align:center;padding:20px 0;">' +
                                '<div style="width:80px;height:80px;border-radius:50%;background:' + (contract.pemeStatus === 'cleared' ? '#dcfce7' : contract.pemeStatus === 'failed' ? '#fee2e2' : '#fef3c7') + ';display:flex;align-items:center;justify-content:center;margin:0 auto 16px;"><i data-lucide="' + (contract.pemeStatus === 'cleared' ? 'check-circle' : contract.pemeStatus === 'failed' ? 'x-circle' : 'clock') + '" style="width:40px;height:40px;color:' + (contract.pemeStatus === 'cleared' ? '#059669' : contract.pemeStatus === 'failed' ? '#dc2626' : '#d97706') + ';"></i></div>' +
                                '<div style="font-size:1.25rem;font-weight:700;color:var(--cw-gray-800);margin-bottom:4px;">PEME ' + pemeLabels[contract.pemeStatus] + '</div>' +
                                '<div style="color:var(--cw-gray-500);font-size:0.85rem;">' + (contract.pemeStatus === 'cleared' ? 'Fit for sea duty' : contract.pemeStatus === 'failed' ? 'Medical issues found' : 'Awaiting examination') + '</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    
                    // Timeline
                    '<div style="padding:24px;background:white;border-radius:16px;border:1px solid var(--cw-gray-200);">' +
                        '<h3 style="font-size:0.85rem;font-weight:700;color:var(--cw-gray-500);text-transform:uppercase;letter-spacing:0.5px;margin:0 0 24px 0;display:flex;align-items:center;gap:8px;"><i data-lucide="git-commit" style="width:18px;height:18px;"></i>Contract Timeline</h3>' +
                        '<div style="display:flex;justify-content:space-between;position:relative;">' +
                            '<div style="position:absolute;top:20px;left:40px;right:40px;height:4px;background:var(--cw-gray-200);z-index:0;"></div>' +
                            createTimelineStep('Draft', 'file-text', contract.status !== 'draft', true) +
                            createTimelineStep('PEME', 'heart-pulse', ['peme-cleared','signed','active','completed'].includes(contract.status), ['pending-peme','peme-cleared','signed','active','completed'].includes(contract.status)) +
                            createTimelineStep('Signed', 'pen-tool', ['signed','active','completed'].includes(contract.status), ['signed','active','completed'].includes(contract.status)) +
                            createTimelineStep('Active', 'anchor', ['active','completed'].includes(contract.status), ['active','completed'].includes(contract.status)) +
                            createTimelineStep('Complete', 'check-circle', contract.status === 'completed', contract.status === 'completed') +
                        '</div>' +
                    '</div>' +
                '</div>';
            
            openModal('contractDetailModal');
            lucide.createIcons();
        }
        
        function createTimelineStep(label, icon, completed, active) {
            const bgColor = completed ? '#0d9488' : (active ? '#0d9488' : '#e2e8f0');
            const textColor = completed || active ? '#0d9488' : '#94a3b8';
            return '<div style="display:flex;flex-direction:column;align-items:center;z-index:1;flex:1;">' +
                '<div style="width:40px;height:40px;border-radius:50%;background:' + bgColor + ';display:flex;align-items:center;justify-content:center;margin-bottom:8px;">' +
                    '<i data-lucide="' + icon + '" style="width:20px;height:20px;color:white;"></i>' +
                '</div>' +
                '<span style="font-size:0.8rem;font-weight:600;color:' + textColor + ';">' + label + '</span>' +
            '</div>';
        }
        
        function printContract() {
            if (!currentContractId) return;
            const contract = MOCK_CONTRACTS.find(c => c.id === currentContractId);
            if (!contract) return;
            
            const printWindow = window.open('', '_blank');
            const statusLabels = {
                'draft': 'Draft', 'pending-peme': 'Pending PEME', 'peme-cleared': 'PEME Cleared',
                'signed': 'Signed', 'active': 'Active', 'completed': 'Completed', 'cancelled': 'Cancelled'
            };
            
            const startDate = new Date(contract.startDate);
            const endDate = new Date(startDate);
            endDate.setMonth(endDate.getMonth() + contract.duration);
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Contract ${contract.id}</title>
                    <style>
                        body { font-family: 'Segoe UI', Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        .header { text-align: center; border-bottom: 3px solid #00495D; padding-bottom: 20px; margin-bottom: 30px; }
                        .logo { font-size: 24px; font-weight: bold; color: #00495D; }
                        .contract-title { font-size: 20px; margin-top: 10px; color: #333; }
                        .section { margin-bottom: 25px; }
                        .section-title { font-size: 14px; font-weight: bold; color: #00495D; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-bottom: 15px; }
                        .row { display: flex; margin-bottom: 10px; }
                        .label { width: 180px; color: #666; }
                        .value { font-weight: 600; color: #333; }
                        .parties { display: flex; justify-content: space-between; margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 8px; }
                        .party { text-align: center; }
                        .party-name { font-size: 18px; font-weight: bold; color: #333; }
                        .party-role { color: #666; font-size: 14px; }
                        .signature-area { margin-top: 60px; display: flex; justify-content: space-between; }
                        .signature-box { width: 200px; text-align: center; }
                        .signature-line { border-top: 1px solid #333; margin-top: 60px; padding-top: 10px; }
                        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #999; }
                        @media print { body { padding: 20px; } }
                
        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="logo">CROSSWORLD MARINE SERVICES</div>
                        <div class="contract-title">EMPLOYMENT CONTRACT</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Contract Information</div>
                        <div class="row"><span class="label">Contract Number:</span><span class="value">${contract.id}</span></div>
                        <div class="row"><span class="label">Status:</span><span class="value">${statusLabels[contract.status]}</span></div>
                        <div class="row"><span class="label">Contract Duration:</span><span class="value">${contract.duration} months</span></div>
                        <div class="row"><span class="label">Start Date:</span><span class="value">${contract.startDate}</span></div>
                        <div class="row"><span class="label">End Date:</span><span class="value">${endDate.toISOString().split('T')[0]}</span></div>
                    </div>
                    
                    <div class="parties">
                        <div class="party">
                            <div class="party-name">${contract.seafarerName}</div>
                            <div class="party-role">${contract.seafarerRank}</div>
                            <div class="party-role">Seafarer</div>
                        </div>
                        <div style="display:flex;align-items:center;font-size:24px;color:#ccc;">â†’</div>
                        <div class="party">
                            <div class="party-name">${contract.vesselName}</div>
                            <div class="party-role">${contract.principal}</div>
                            <div class="party-role">Vessel</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Compensation</div>
                        <div class="row"><span class="label">Basic Monthly Salary:</span><span class="value">USD $${contract.salary.toLocaleString()}</span></div>
                        <div class="row"><span class="label">Leave Pay:</span><span class="value">USD $${Math.round(contract.salary * 0.1).toLocaleString()}</span></div>
                        <div class="row"><span class="label">Overtime Rate:</span><span class="value">USD $18.00/hour</span></div>
                        <div class="row"><span class="label">Total Contract Value:</span><span class="value">USD $${(contract.salary * contract.duration).toLocaleString()}</span></div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Medical Clearance (PEME)</div>
                        <div class="row"><span class="label">PEME Status:</span><span class="value">${contract.pemeStatus === 'cleared' ? 'âœ“ Cleared - Fit for Sea Duty' : contract.pemeStatus === 'pending' ? 'â³ Pending' : contract.pemeStatus}</span></div>
                    </div>
                    
                    <div class="signature-area">
                        <div class="signature-box">
                            <div class="signature-line">Seafarer Signature</div>
                            <div style="margin-top:5px;font-size:12px;color:#666;">${contract.seafarerName}</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line">Company Representative</div>
                            <div style="margin-top:5px;font-size:12px;color:#666;">Crossworld Marine Services</div>
                        </div>
                    </div>
                    
                    <div class="footer">
                        <p>This document is computer generated by ATLANTIS ERP</p>
                        <p>Printed on: ${new Date().toLocaleString()}</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            setTimeout(() => { printWindow.print(); }, 500);
            showNotification('Print dialog opened', 'success');
        }
        
        function downloadContract() {
            if (!currentContractId) return;
            const contract = MOCK_CONTRACTS.find(c => c.id === currentContractId);
            if (!contract) return;
            
            const statusLabels = {
                'draft': 'Draft', 'pending-peme': 'Pending PEME', 'peme-cleared': 'PEME Cleared',
                'signed': 'Signed', 'active': 'Active', 'completed': 'Completed', 'cancelled': 'Cancelled'
            };
            
            const startDate = new Date(contract.startDate);
            const endDate = new Date(startDate);
            endDate.setMonth(endDate.getMonth() + contract.duration);
            
            // Create text content for download
            const content = `
CROSSWORLD MARINE SERVICES
EMPLOYMENT CONTRACT
=====================================

CONTRACT INFORMATION
--------------------
Contract Number: ${contract.id}
Status: ${statusLabels[contract.status]}
Duration: ${contract.duration} months
Start Date: ${contract.startDate}
End Date: ${endDate.toISOString().split('T')[0]}

PARTIES
-------
SEAFARER
Name: ${contract.seafarerName}
Rank: ${contract.seafarerRank}

VESSEL
Name: ${contract.vesselName}
Principal: ${contract.principal}
Type: ${contract.vesselType}

COMPENSATION
------------
Basic Monthly Salary: USD $${contract.salary.toLocaleString()}
Leave Pay: USD $${Math.round(contract.salary * 0.1).toLocaleString()}
Overtime Rate: USD $18.00/hour
Total Contract Value: USD $${(contract.salary * contract.duration).toLocaleString()}

MEDICAL CLEARANCE (PEME)
------------------------
Status: ${contract.pemeStatus === 'cleared' ? 'Cleared - Fit for Sea Duty' : contract.pemeStatus}

=====================================
Generated by ATLANTIS ERP
Date: ${new Date().toLocaleString()}
            `.trim();
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = contract.id + '_contract.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Contract downloaded: ' + contract.id + '_contract.txt', 'success');
        }
        
        function editContract() {
            if (!currentContractId) return;
            const contract = MOCK_CONTRACTS.find(c => c.id === currentContractId);
            if (!contract) return;
            
            closeModal('contractDetailModal');
            
            // Open edit contract modal (reuse newContractModal)
            openModal('newContractModal');
            
            // Update modal title
            document.querySelector('#newContractModal .modal-title').textContent = 'Edit Contract';
            document.querySelector('#newContractModal .modal-header p').textContent = 'Editing: ' + contract.id;
            
            // Pre-fill form with existing data (where possible)
            setTimeout(() => {
                const salaryInput = document.getElementById('contractSalary');
                if (salaryInput) salaryInput.value = contract.salary;
                
                const startInput = document.getElementById('contractStartDate');
                if (startInput) startInput.value = contract.startDate;
                
                // Update duration radio
                const durationCards = document.querySelectorAll('#newContractModal .form-radio-card');
                durationCards.forEach(card => {
                    card.classList.remove('selected');
                    if (card.textContent.includes(contract.duration + ' mo')) {
                        card.classList.add('selected');
                    }
                });
                
                showNotification('Editing contract: ' + contract.id, 'info');
            }, 100);
        }

        function renderContractCard(contract) {
            const seafarerInitials = contract.seafarerName.split(' ').map(n => n[0]).join('');
            const vesselInitials = contract.vesselName.replace('MV ', '').substring(0, 2).toUpperCase();
            const statusLabels = {
                'draft': 'Draft', 'pending-peme': 'Pending PEME', 'peme-cleared': 'PEME Cleared',
                'signed': 'Signed', 'active': 'Active', 'completed': 'Completed', 'cancelled': 'Cancelled'
            };
            const pemeLabels = { 'pending': 'PEME Pending', 'scheduled': 'PEME Scheduled', 'cleared': 'PEME Cleared', 'failed': 'PEME Failed' };
            
            // Timeline steps: Draft â†’ PEME â†’ Signed â†’ Active â†’ Completed
            const steps = ['draft', 'pending-peme', 'peme-cleared', 'signed', 'active', 'completed'];
            const currentIndex = steps.indexOf(contract.status);
            
            const timeline = [1, 2, 3, 4, 5].map((step, i) => {
                let stepClass = 'pending';
                if (i < currentIndex) stepClass = 'completed';
                else if (i === currentIndex) stepClass = 'current';
                const lineClass = i < currentIndex ? 'completed' : '';
                return (i > 0 ? '<div class="contract-timeline-line ' + lineClass + '"></div>' : '') +
                    '<div class="contract-timeline-step ' + stepClass + '">' + step + '</div>';
            }).join('');
            
            return '<div class="contract-card" style="cursor:pointer;" onclick="openContractDetail(\'' + contract.id + '\')">' +
                '<div class="contract-card-header">' +
                    '<span class="contract-card-id">' + contract.id + '</span>' +
                    '<span class="contract-status ' + contract.status + '">' + statusLabels[contract.status] + '</span>' +
                '</div>' +
                '<div class="contract-card-body">' +
                    '<div class="contract-parties">' +
                        '<div class="contract-party">' +
                            '<div class="contract-party-avatar seafarer">' + seafarerInitials + '</div>' +
                            '<div class="contract-party-info">' +
                                '<div class="contract-party-name">' + contract.seafarerName + '</div>' +
                                '<div class="contract-party-meta">' + contract.seafarerRank + '</div>' +
                            '</div>' +
                        '</div>' +
                        '<div class="contract-arrow"><i data-lucide="arrow-right" style="width:20px;height:20px;"></i></div>' +
                        '<div class="contract-party">' +
                            '<div class="contract-party-avatar vessel">' + vesselInitials + '</div>' +
                            '<div class="contract-party-info">' +
                                '<div class="contract-party-name">' + contract.vesselName + '</div>' +
                                '<div class="contract-party-meta">' + contract.principal + '</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="contract-details">' +
                        '<div class="contract-detail-item"><div class="contract-detail-label">Start Date</div><div class="contract-detail-value">' + contract.startDate + '</div></div>' +
                        '<div class="contract-detail-item"><div class="contract-detail-label">Duration</div><div class="contract-detail-value">' + contract.duration + ' months</div></div>' +
                        '<div class="contract-detail-item"><div class="contract-detail-label">Salary</div><div class="contract-detail-value">$' + contract.salary.toLocaleString() + '</div></div>' +
                    '</div>' +
                '</div>' +
                '<div class="contract-card-footer">' +
                    '<div class="contract-timeline">' + timeline + '</div>' +
                    '<span class="peme-status ' + contract.pemeStatus + '"><i data-lucide="' + (contract.pemeStatus === 'cleared' ? 'check-circle' : contract.pemeStatus === 'failed' ? 'x-circle' : 'clock') + '" style="width:14px;height:14px;"></i>' + pemeLabels[contract.pemeStatus] + '</span>' +
                '</div>' +
            '</div>';
        }

        // CLIENTS MODULE RENDERING
        function renderClientsGrid() {
            const container = document.getElementById('clientsGrid');
            if (!container) return;
            
            const countryFilter = document.getElementById('clientCountryFilter')?.value || '';
            const fleetSizeFilter = document.getElementById('clientFleetSizeFilter')?.value || '';
            const statusFilter = document.getElementById('clientStatusFilter')?.value || '';
            const searchQuery = document.getElementById('clientSearchInput')?.value?.toLowerCase() || '';
            
            let clients = MOCK_CLIENTS;
            if (countryFilter) clients = clients.filter(c => c.countryKey === countryFilter);
            if (statusFilter) clients = clients.filter(c => c.status === statusFilter);
            if (fleetSizeFilter) {
                if (fleetSizeFilter === 'small') clients = clients.filter(c => c.vessels <= 5);
                else if (fleetSizeFilter === 'medium') clients = clients.filter(c => c.vessels >= 6 && c.vessels <= 15);
                else if (fleetSizeFilter === 'large') clients = clients.filter(c => c.vessels >= 16);
            }
            if (searchQuery) clients = clients.filter(c => 
                c.name.toLowerCase().includes(searchQuery) || 
                c.country.toLowerCase().includes(searchQuery)
            );
            
            // Update count
            const countEl = document.getElementById('clientsTotalCount');
            if (countEl) countEl.textContent = clients.length;
            
            container.innerHTML = clients.length > 0 ? 
                clients.map(client => renderClientCard(client)).join('') :
                '<div style="grid-column:1/-1;padding:48px;text-align:center;color:var(--cw-gray-400);"><i data-lucide="building-2" style="width:48px;height:48px;margin-bottom:16px;"></i><p>No clients match your filters</p></div>';
            lucide.createIcons();
        }
        
        function filterClientsByStatus(status) {
            const el = document.getElementById('clientStatusFilter');
            if (el) el.value = status;
            renderClientsGrid();
        }

        function renderClientCard(client) {
            const fleetPreview = client.fleet.slice(0, 3).map(v => 
                '<div class="client-fleet-item">' +
                    '<div class="client-fleet-item-icon ' + v.type + '"><i data-lucide="ship"></i></div>' +
                    '<span class="client-fleet-item-name">' + v.name + '</span>' +
                    '<span class="client-fleet-item-crew">' + v.crew + ' crew</span>' +
                '</div>'
            ).join('');
            
            const moreVessels = client.vessels > 3 ? '<div class="client-fleet-item" style="justify-content:center;color:var(--cw-gray-500);font-size:0.8rem;">+ ' + (client.vessels - 3) + ' more vessels</div>' : '';
            
            const statusBadge = client.status === 'active' ? 
                '<span class="tag tag-assigned" style="position:absolute;top:12px;right:12px;">Active</span>' : 
                client.status === 'prospect' ? 
                '<span class="tag tag-unassigned" style="position:absolute;top:12px;right:12px;">Prospect</span>' : '';
            
            return '<div class="client-card" onclick="openClientDetail(\'' + client.id + '\')" style="cursor:pointer;position:relative;">' +
                statusBadge +
                '<div class="client-card-header">' +
                    '<div class="client-card-logo"><i data-lucide="building-2"></i></div>' +
                    '<div class="client-card-name">' + client.name + '</div>' +
                    '<div class="client-card-country">' + client.flag + ' ' + client.country + '</div>' +
                '</div>' +
                '<div class="client-card-body">' +
                    '<div class="client-stats-grid">' +
                        '<div class="client-stat"><div class="client-stat-value">' + client.vessels + '</div><div class="client-stat-label">Vessels</div></div>' +
                        '<div class="client-stat"><div class="client-stat-value">' + client.crew + '</div><div class="client-stat-label">Crew</div></div>' +
                        '<div class="client-stat"><div class="client-stat-value">' + client.contracts + '</div><div class="client-stat-label">Contracts</div></div>' +
                        '<div class="client-stat"><div class="client-stat-value">' + (new Date().getFullYear() - client.since) + 'y</div><div class="client-stat-label">Partnership</div></div>' +
                    '</div>' +
                    '<div class="client-fleet-preview">' + fleetPreview + moreVessels + '</div>' +
                '</div>' +
                '<div class="client-card-footer">' +
                    '<div class="client-contact"><i data-lucide="mail"></i>' + client.contact + '</div>' +
                    '<div class="client-since">Since ' + client.since + '</div>' +
                '</div>' +
            '</div>';
        }
        
        let currentClientId = null;

        function openClientDetail(clientId) {
            const client = MOCK_CLIENTS.find(c => c.id === clientId);
            if (!client) return;
            
            currentClientId = clientId;
            
            const fleetList = client.fleet.map(v => 
                '<div style="display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;margin-bottom:8px;">' +
                    '<div style="display:flex;align-items:center;gap:12px;">' +
                        '<div style="width:40px;height:40px;background:var(--cw-primary);color:white;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:0.8rem;">' + v.name.replace('MV ', '').substring(0, 2) + '</div>' +
                        '<div><div style="font-weight:500;">' + v.name + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);text-transform:capitalize;">' + v.type + '</div></div>' +
                    '</div>' +
                    '<div style="text-align:right;"><div style="font-weight:600;">' + v.crew + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">crew</div></div>' +
                '</div>'
            ).join('');
            
            let html = '<div style="padding:24px;background:linear-gradient(135deg,var(--cw-primary) 0%,var(--cw-primary-light) 100%);color:white;margin:-20px -20px 24px -20px;border-radius:8px 8px 0 0;">' +
                '<div style="display:flex;align-items:center;gap:16px;">' +
                    '<div style="width:64px;height:64px;background:rgba(255,255,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="building-2" style="width:32px;height:32px;"></i></div>' +
                    '<div>' +
                        '<h2 style="font-size:1.5rem;font-weight:700;margin-bottom:4px;">' + client.name + '</h2>' +
                        '<p style="font-size:0.95rem;opacity:0.9;">' + client.flag + ' ' + client.country + ' â€¢ Since ' + client.since + '</p>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">';
            
            // Left Column
            html += '<div>';
            
            // Stats
            html += '<div class="panel-section"><h4 class="panel-section-title">Overview</h4>' +
                '<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">' +
                    '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;text-align:center;"><div style="font-size:1.75rem;font-weight:700;color:var(--cw-primary);">' + client.vessels + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Vessels</div></div>' +
                    '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;text-align:center;"><div style="font-size:1.75rem;font-weight:700;color:var(--cw-accent);">' + client.crew + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Crew</div></div>' +
                    '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;text-align:center;"><div style="font-size:1.75rem;font-weight:700;color:var(--status-on-approval);">' + client.contracts + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Contracts</div></div>' +
                    '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;text-align:center;"><div style="font-size:1.75rem;font-weight:700;color:var(--status-ready);">' + (new Date().getFullYear() - client.since) + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Years</div></div>' +
                '</div></div>';
            
            // Contact
            html += '<div class="panel-section"><h4 class="panel-section-title">Contact Information</h4>' +
                '<div class="info-box">' +
                    '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="mail"></i><span>' + client.contact + '</span></div>' +
                    '<div class="contact-item" style="margin-bottom:12px;"><i data-lucide="phone"></i><span>+30 210 ' + Math.floor(1000000 + Math.random() * 9000000) + '</span></div>' +
                    '<div class="contact-item"><i data-lucide="map-pin"></i><span>Athens, ' + client.country + '</span></div>' +
                '</div></div>';
            
            html += '</div>';
            
            // Right Column - Fleet
            html += '<div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Fleet (' + client.fleet.length + ' vessels)</h4>' +
                    '<div style="max-height:300px;overflow-y:auto;">' + fleetList + '</div>' +
                '</div>';
            
            // Quick Actions
            html += '<div class="panel-section"><h4 class="panel-section-title">Quick Actions</h4>' +
                '<div style="display:flex;gap:8px;flex-wrap:wrap;">' +
                    '<button class="btn btn-sm btn-secondary" onclick="createRfcForClient(\'' + client.name + '\')"><i data-lucide="user-plus"></i>Create RFC</button>' +
                    '<button class="btn btn-sm btn-secondary" onclick="viewClientContracts(\'' + client.id + '\')"><i data-lucide="file-text"></i>Contracts</button>' +
                    '<button class="btn btn-sm btn-secondary" onclick="emailClient(\'' + client.contact + '\')"><i data-lucide="mail"></i>Send Email</button>' +
                '</div></div>';
            
            html += '</div></div>';
            
            // Activity
            html += '<div class="panel-section" style="margin-top:24px;"><h4 class="panel-section-title">Recent Activity</h4>' +
                '<div style="border-left:2px solid var(--cw-gray-200);padding-left:16px;margin-left:8px;">' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">2 days ago</div><div>New contract signed for MV ' + (client.fleet[0]?.name.replace('MV ', '') || 'vessel') + '</div></div>' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">1 week ago</div><div>3 crew members embarked on ' + (client.fleet[1]?.name || 'vessel') + '</div></div>' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">2 weeks ago</div><div>RFC-2025-042 completed for Chief Officer position</div></div>' +
                '</div></div>';
            
            document.getElementById('clientDetailContent').innerHTML = html;
            openModal('clientDetailModal');
            lucide.createIcons();
        }
        
        function exportClients() {
            let csv = 'ID,Name,Country,Vessels,Crew,Contracts,Since,Status,Contact\n';
            MOCK_CLIENTS.forEach(c => {
                csv += '"' + c.id + '","' + c.name + '","' + c.country + '",' + c.vessels + ',' + c.crew + ',' + c.contracts + ',' + c.since + ',"' + (c.status || 'active') + '","' + c.contact + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'clients_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Clients exported successfully!', 'success');
        }
        
        function selectFormRadio(element, hiddenId, value) {
            // Remove selected from siblings
            element.parentElement.querySelectorAll('.form-radio-card').forEach(card => card.classList.remove('selected'));
            // Add selected to clicked
            element.classList.add('selected');
            // Update hidden input
            document.getElementById(hiddenId).value = value;
        }
        
        function saveNewClient() {
            const name = document.getElementById('clientName').value;
            const country = document.getElementById('clientCountry').value;
            
            if (!name || !country) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            showNotification('Client "' + name + '" added successfully!', 'success');
            closeModal('addClientModal');
        }
        
        function editClient() {
            closeModal('clientDetailModal');
            showNotification('Opening edit form...', 'info');
            openModal('addClientModal');
        }
        
        function viewClientVessels() {
            closeModal('clientDetailModal');
            navigateTo('fleet');
            showNotification('Showing fleet for selected client', 'info');
        }
        
        function createRfcForClient(clientName) {
            closeModal('clientDetailModal');
            showNotification('Creating RFC for ' + clientName, 'info');
            openModal('createRfcModal');
        }
        
        function viewClientContracts(clientId) {
            showNotification('Opening contracts for client...', 'info');
        }
        
        function emailClient(email) {
            window.location.href = 'mailto:' + email;
        }

        // RFC TASKS MODULE RENDERING
        function renderRfcTasks() {
            const container = document.getElementById('rfcTasksGrid');
            if (!container) return;
            
            const statusFilter = document.getElementById('rfcStatusFilter')?.value || '';
            const priorityFilter = document.getElementById('rfcPriorityFilter')?.value || '';
            const principalFilter = document.getElementById('rfcPrincipalFilter')?.value || '';
            const rankFilter = document.getElementById('rfcRankFilter')?.value || '';
            const searchQuery = document.getElementById('rfcSearchInput')?.value?.toLowerCase() || '';
            
            let tasks = MOCK_RFC_TASKS;
            if (statusFilter) tasks = tasks.filter(t => t.status === statusFilter);
            if (priorityFilter) tasks = tasks.filter(t => t.priority === priorityFilter);
            if (principalFilter) tasks = tasks.filter(t => t.principalKey === principalFilter);
            if (rankFilter) tasks = tasks.filter(t => t.rank === rankFilter);
            if (searchQuery) tasks = tasks.filter(t => 
                t.id.toLowerCase().includes(searchQuery) || 
                t.rank.toLowerCase().includes(searchQuery) ||
                t.vessel.toLowerCase().includes(searchQuery)
            );
            
            // Update stat counts
            const allTasks = MOCK_RFC_TASKS;
            document.getElementById('rfcOpenCount').textContent = allTasks.filter(t => t.status === 'open').length;
            document.getElementById('rfcSourcingCount').textContent = allTasks.filter(t => t.status === 'sourcing').length;
            document.getElementById('rfcShortlistedCount').textContent = allTasks.filter(t => t.status === 'shortlisted').length;
            
            container.innerHTML = tasks.length > 0 ? 
                tasks.map(task => renderRfcTaskCard(task)).join('') :
                '<div style="grid-column:1/-1;padding:48px;text-align:center;color:var(--cw-gray-400);"><i data-lucide="inbox" style="width:48px;height:48px;margin-bottom:16px;"></i><p>No RFC tasks match your filters</p></div>';
            lucide.createIcons();
        }
        
        function filterRfcByStatus(status) {
            document.getElementById('rfcStatusFilter').value = status;
            renderRfcTasks();
        }

        function renderRfcTaskCard(task) {
            const priorityLabels = { urgent: 'Urgent', high: 'High', normal: 'Normal' };
            const statusLabels = { open: 'Open', sourcing: 'Sourcing', shortlisted: 'Shortlisted', filled: 'Filled', cancelled: 'Cancelled' };
            
            // Calculate days remaining
            const today = new Date();
            const target = new Date(task.targetDate);
            const daysLeft = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
            const daysClass = daysLeft < 7 ? 'danger' : daysLeft < 14 ? 'warning' : '';
            
            // Progress calculation
            const progressPercent = task.status === 'filled' ? 100 : 
                                    task.status === 'shortlisted' ? 75 :
                                    task.status === 'sourcing' ? 40 :
                                    task.status === 'open' ? 10 : 0;
            const progressColor = task.status === 'filled' ? 'var(--status-ready)' : 
                                  task.status === 'cancelled' ? 'var(--cw-gray-400)' : 'var(--cw-accent)';
            
            // Candidate avatars
            const candidateAvatars = task.candidates > 0 ? 
                Array(Math.min(task.candidates, 3)).fill(0).map((_, i) => 
                    '<div class="rfc-task-candidates-avatar">C' + (i + 1) + '</div>'
                ).join('') : '';
            
            return '<div class="rfc-task-card ' + task.priority + '" onclick="openRfcPanel(\'' + task.id + '\')" style="cursor:pointer;">' +
                '<div class="rfc-task-header">' +
                    '<div><div class="rfc-task-id">' + task.id + '</div><div class="rfc-task-date">Created ' + task.createdDate + '</div></div>' +
                    '<span class="rfc-task-priority ' + task.priority + '">' + priorityLabels[task.priority] + '</span>' +
                '</div>' +
                '<div class="rfc-task-body">' +
                    '<div class="rfc-task-position">' +
                        '<div class="rfc-task-position-icon"><i data-lucide="user"></i></div>' +
                        '<div class="rfc-task-position-info">' +
                            '<div class="rfc-task-rank">' + task.rank + '</div>' +
                            '<div class="rfc-task-vessel">' + task.vessel + ' â€¢ ' + task.principal + '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="rfc-task-details">' +
                        '<div class="rfc-task-detail"><div class="rfc-task-detail-label">Target Date</div><div class="rfc-task-detail-value ' + daysClass + '">' + task.targetDate + '</div></div>' +
                        '<div class="rfc-task-detail"><div class="rfc-task-detail-label">Days Left</div><div class="rfc-task-detail-value ' + daysClass + '">' + (daysLeft > 0 ? daysLeft + ' days' : 'Overdue') + '</div></div>' +
                        '<div class="rfc-task-detail"><div class="rfc-task-detail-label">Source</div><div class="rfc-task-detail-value">' + task.source + '</div></div>' +
                        '<div class="rfc-task-detail"><div class="rfc-task-detail-label">Linked RFA</div><div class="rfc-task-detail-value">' + (task.rfa || 'â€”') + '</div></div>' +
                    '</div>' +
                    '<div class="rfc-task-progress">' +
                        '<div class="rfc-task-progress-header">' +
                            '<span class="rfc-task-progress-label">Progress</span>' +
                            '<span class="rfc-task-progress-value">' + task.shortlisted + '/' + task.candidates + ' shortlisted</span>' +
                        '</div>' +
                        '<div class="rfc-task-progress-bar"><div class="rfc-task-progress-fill" style="width:' + progressPercent + '%;background:' + progressColor + ';"></div></div>' +
                    '</div>' +
                '</div>' +
                '<div class="rfc-task-footer">' +
                    '<div class="rfc-task-candidates">' +
                        (candidateAvatars ? '<div class="rfc-task-candidates-avatars">' + candidateAvatars + '</div>' : '') +
                        '<span class="rfc-task-candidates-count">' + task.candidates + ' candidates</span>' +
                    '</div>' +
                    '<span class="rfc-task-status ' + task.status + '">' + statusLabels[task.status] + '</span>' +
                '</div>' +
            '</div>';
        }
        
        function openRfcPanel(id) {
            const task = MOCK_RFC_TASKS.find(t => t.id === id);
            if (!task) return;
            
            const priorityLabels = { urgent: 'Urgent', high: 'High', normal: 'Normal' };
            const statusLabels = { open: 'Open', sourcing: 'Sourcing', shortlisted: 'Shortlisted', filled: 'Filled', cancelled: 'Cancelled' };
            
            // Calculate days
            const today = new Date();
            const target = new Date(task.targetDate);
            const created = new Date(task.createdDate);
            const daysLeft = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
            const daysActive = Math.ceil((today - created) / (1000 * 60 * 60 * 24));
            
            // Find linked candidates
            const linkedCandidates = MOCK_CANDIDATES.filter(c => c.rfcId === task.id);
            
            let html = '<div style="margin-bottom:24px;">' +
                '<div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:16px;">' +
                    '<div><h2 style="font-size:1.25rem;font-weight:700;margin-bottom:4px;">' + task.id + '</h2>' +
                    '<p style="font-size:0.9rem;color:var(--cw-gray-500);">Created ' + task.createdDate + '</p></div>' +
                    '<span class="rfc-task-priority ' + task.priority + '">' + priorityLabels[task.priority] + '</span>' +
                '</div>' +
                '<span class="rfc-task-status ' + task.status + '" style="font-size:0.85rem;padding:6px 12px;">' + statusLabels[task.status] + '</span>' +
            '</div>';
            
            // Position Info
            html += '<div class="panel-section"><h4 class="panel-section-title">Position Required</h4>' +
                '<div class="info-box">' +
                    '<div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">' +
                        '<div style="width:48px;height:48px;background:var(--cw-primary);color:white;border-radius:12px;display:flex;align-items:center;justify-content:center;"><i data-lucide="user" style="width:24px;height:24px;"></i></div>' +
                        '<div><div style="font-weight:600;font-size:1.1rem;">' + task.rank + '</div>' +
                        '<div style="color:var(--cw-gray-500);">' + task.vessel + '</div></div>' +
                    '</div>' +
                    '<div class="info-grid">' +
                        '<div class="info-item"><span class="info-label">Principal</span><span class="info-value">' + task.principal + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Source</span><span class="info-value">' + task.source + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Linked RFA</span><span class="info-value">' + (task.rfa || 'None') + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Requestor</span><span class="info-value">' + (task.requestor || 'Operations Team') + '</span></div>' +
                    '</div>' +
                '</div></div>';
            
            // Timeline
            html += '<div class="panel-section"><h4 class="panel-section-title">Timeline</h4>' +
                '<div class="info-box">' +
                    '<div class="info-grid">' +
                        '<div class="info-item"><span class="info-label">Created Date</span><span class="info-value">' + task.createdDate + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Target Date</span><span class="info-value" style="color:' + (daysLeft < 7 ? 'var(--tag-nfr)' : 'inherit') + ';">' + task.targetDate + '</span></div>' +
                        '<div class="info-item"><span class="info-label">Days Active</span><span class="info-value">' + daysActive + ' days</span></div>' +
                        '<div class="info-item"><span class="info-label">Days Remaining</span><span class="info-value" style="color:' + (daysLeft < 0 ? 'var(--tag-nfr)' : daysLeft < 7 ? 'var(--status-on-approval)' : 'var(--status-ready)') + ';">' + (daysLeft > 0 ? daysLeft + ' days' : 'Overdue by ' + Math.abs(daysLeft) + ' days') + '</span></div>' +
                    '</div>' +
                '</div></div>';
            
            // Candidates Progress
            html += '<div class="panel-section"><h4 class="panel-section-title">Candidate Pipeline</h4>' +
                '<div class="info-box">' +
                    '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:16px;text-align:center;">' +
                        '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;"><div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);">' + task.candidates + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Sourced</div></div>' +
                        '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;"><div style="font-size:1.5rem;font-weight:700;color:var(--status-on-approval);">' + task.shortlisted + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Shortlisted</div></div>' +
                        '<div style="padding:16px;background:var(--cw-gray-50);border-radius:8px;"><div style="font-size:1.5rem;font-weight:700;color:var(--status-ready);">' + (task.status === 'filled' ? '1' : '0') + '</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Endorsed</div></div>' +
                    '</div>' +
                    '<div class="rfc-task-progress-bar" style="height:8px;"><div class="rfc-task-progress-fill" style="width:' + (task.status === 'filled' ? 100 : task.shortlisted > 0 ? 60 : task.candidates > 0 ? 30 : 5) + '%;background:var(--cw-accent);"></div></div>' +
                '</div></div>';
            
            // Linked Candidates List
            if (linkedCandidates.length > 0) {
                html += '<div class="panel-section"><h4 class="panel-section-title">Linked Candidates (' + linkedCandidates.length + ')</h4>';
                linkedCandidates.forEach(c => {
                    const initials = c.firstName[0] + c.lastName[0];
                    const stageLabels = { new: 'New', screening: 'Screening', interview: 'Interview', negotiation: 'Negotiation', endorsed: 'Endorsed', rejected: 'Rejected' };
                    html += '<div style="display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--cw-gray-50);border-radius:8px;margin-bottom:8px;">' +
                        '<div style="display:flex;align-items:center;gap:12px;">' +
                            '<div class="avatar" style="width:36px;height:36px;font-size:0.8rem;">' + initials + '</div>' +
                            '<div><div style="font-weight:500;">' + c.firstName + ' ' + c.lastName + '</div>' +
                            '<div style="font-size:0.8rem;color:var(--cw-gray-500);">' + c.rank + '</div></div>' +
                        '</div>' +
                        '<span class="status-badge status-' + c.stage + '" style="font-size:0.75rem;"><span class="dot"></span>' + stageLabels[c.stage] + '</span>' +
                    '</div>';
                });
                html += '</div>';
            }
            
            // Actions
            html += '<div class="panel-section"><h4 class="panel-section-title">Actions</h4>' +
                '<div style="display:flex;gap:8px;flex-wrap:wrap;">' +
                    '<button class="btn btn-primary btn-sm" onclick="navigateTo(\'view-candidates\');closePanel(\'rfcPanel\');"><i data-lucide="user-plus"></i>Add Candidate</button>' +
                    '<button class="btn btn-secondary btn-sm"><i data-lucide="edit"></i>Edit RFC</button>' +
                    '<button class="btn btn-secondary btn-sm"><i data-lucide="message-square"></i>Add Note</button>' +
                    (task.status !== 'filled' && task.status !== 'cancelled' ? '<button class="btn btn-ghost btn-sm" style="color:var(--tag-nfr);"><i data-lucide="x-circle"></i>Cancel RFC</button>' : '') +
                '</div></div>';
            
            // Activity Log
            html += '<div class="panel-section"><h4 class="panel-section-title">Activity Log</h4>' +
                '<div style="border-left:2px solid var(--cw-gray-200);padding-left:16px;margin-left:8px;">' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">Today</div><div style="font-size:0.9rem;">2 new candidates added to pipeline</div></div>' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">Yesterday</div><div style="font-size:0.9rem;">Status changed to ' + statusLabels[task.status] + '</div></div>' +
                    '<div style="margin-bottom:16px;"><div style="font-size:0.8rem;color:var(--cw-gray-500);">' + task.createdDate + '</div><div style="font-size:0.9rem;">RFC created by Operations Team</div></div>' +
                '</div></div>';
            
            document.getElementById('rfcModalBody').innerHTML = html;
            openModal('rfcDetailModal');
            lucide.createIcons();
        }
        
        function exportRfcTasks() {
            let csv = 'ID,Rank,Vessel,Principal,Status,Priority,Created,Target,Candidates,Shortlisted,Source,Linked RFA\n';
            
            MOCK_RFC_TASKS.forEach(t => {
                csv += '"' + t.id + '","' + t.rank + '","' + t.vessel + '","' + t.principal + '","' + t.status + '","' + t.priority + '","' + t.createdDate + '","' + t.targetDate + '",' + t.candidates + ',' + t.shortlisted + ',"' + t.source + '","' + (t.rfa || '') + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'rfc_tasks_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('RFC Tasks exported successfully!', 'success');
        }
        
        function createNewRfc() {
            // In real app, would save to database
            showNotification('RFC created successfully!', 'success');
            closeModal('createRfcModal');
            renderRfcTasks();
        }

        // INTERVIEWS MODULE RENDERING
        function renderInterviews() {
            const container = document.getElementById('interviewsGrid');
            if (!container) return;
            
            const statusFilter = document.getElementById('interviewStatusFilter')?.value || '';
            const dateFilter = document.getElementById('interviewDateFilter')?.value || '';
            const interviewerFilter = document.getElementById('interviewerFilter')?.value || '';
            const resultFilter = document.getElementById('interviewResultFilter')?.value || '';
            const searchQuery = document.getElementById('interviewSearchInput')?.value?.toLowerCase() || '';
            
            const today = new Date().toISOString().split('T')[0];
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const monthAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            let interviews = MOCK_INTERVIEWS;
            if (statusFilter) interviews = interviews.filter(i => i.status === statusFilter);
            if (resultFilter) interviews = interviews.filter(i => i.result === resultFilter);
            if (interviewerFilter) interviews = interviews.filter(i => i.interviewer === interviewerFilter);
            if (dateFilter === 'today') interviews = interviews.filter(i => i.date === today);
            else if (dateFilter === 'week') interviews = interviews.filter(i => i.date >= weekAgo);
            else if (dateFilter === 'month') interviews = interviews.filter(i => i.date >= monthAgo);
            if (searchQuery) interviews = interviews.filter(i => 
                i.candidateName.toLowerCase().includes(searchQuery) || 
                i.candidateRank.toLowerCase().includes(searchQuery) ||
                i.id.toLowerCase().includes(searchQuery)
            );
            
            container.innerHTML = interviews.length > 0 ? 
                interviews.map(interview => renderInterviewCard(interview)).join('') :
                '<div style="grid-column:1/-1;padding:48px;text-align:center;color:var(--cw-gray-400);"><i data-lucide="calendar-x" style="width:48px;height:48px;margin-bottom:16px;"></i><p>No interviews match your filters</p></div>';
            lucide.createIcons();
        }

        function renderInterviewCard(interview) {
            const statusLabels = { scheduled: 'Scheduled', 'in-progress': 'In Progress', completed: 'Completed', cancelled: 'Cancelled', 'no-show': 'No Show' };
            const initials = interview.candidateName.split(' ').map(n => n[0]).join('');
            
            const dateObj = new Date(interview.date);
            const day = dateObj.getDate();
            const month = dateObj.toLocaleString('en-US', { month: 'short' }).toUpperCase();
            
            const avgScore = interview.scores.technical ? 
                Math.round((interview.scores.technical + interview.scores.experience + interview.scores.communication) / 3) : null;
            
            const scoresHtml = avgScore ? 
                '<div class="interview-scores">' +
                    '<div class="interview-score"><div class="interview-score-value">' + interview.scores.technical + '</div><div class="interview-score-label">Technical</div></div>' +
                    '<div class="interview-score"><div class="interview-score-value">' + interview.scores.experience + '</div><div class="interview-score-label">Experience</div></div>' +
                    '<div class="interview-score"><div class="interview-score-value">' + interview.scores.communication + '</div><div class="interview-score-label">Comm.</div></div>' +
                    '<div class="interview-score"><div class="interview-score-value ' + (avgScore >= 70 ? 'pass' : 'fail') + '">' + avgScore + '</div><div class="interview-score-label">Average</div></div>' +
                '</div>' :
                '<div class="interview-scores"><div class="interview-score"><div class="interview-score-value pending">â€”</div><div class="interview-score-label">Pending Assessment</div></div></div>';
            
            return '<div class="interview-card">' +
                '<div class="interview-card-header" onclick="openInterviewDetail(\'' + interview.id + '\')" style="cursor:pointer;">' +
                    '<div class="interview-datetime">' +
                        '<div class="interview-date-box"><div class="interview-date-day">' + day + '</div><div class="interview-date-month">' + month + '</div></div>' +
                        '<div><div class="interview-time">' + interview.time + '</div><div class="interview-time-duration">' + interview.duration + ' min â€¢ ' + interview.type + '</div></div>' +
                    '</div>' +
                    '<span class="interview-status ' + interview.status + '">' + statusLabels[interview.status] + '</span>' +
                '</div>' +
                '<div class="interview-card-body">' +
                    '<div class="interview-candidate clickable-seafarer" onclick="openSeafarerProfile(\'' + interview.candidateName + '\')">' +
                        '<div class="interview-candidate-avatar">' + initials + '</div>' +
                        '<div class="interview-candidate-info">' +
                            '<div class="interview-candidate-name">' + interview.candidateName + '</div>' +
                            '<div class="interview-candidate-rank">' + interview.candidateRank + '</div>' +
                            (interview.rfcId ? '<div class="interview-candidate-rfc">' + interview.rfcId + '</div>' : '') +
                        '</div>' +
                    '</div>' +
                    '<div class="interview-details-grid">' +
                        '<div class="interview-detail"><i data-lucide="map-pin"></i>' + interview.location + '</div>' +
                        '<div class="interview-detail"><i data-lucide="clock"></i>' + interview.duration + ' minutes</div>' +
                    '</div>' +
                    '<div class="interview-assessment">' +
                        '<div class="interview-assessment-title">Assessment Scores</div>' +
                        scoresHtml +
                    '</div>' +
                '</div>' +
                '<div class="interview-card-footer">' +
                    '<div class="interview-interviewer"><div class="interview-interviewer-avatar">' + interview.interviewerInitials + '</div>' + interview.interviewer + '</div>' +
                    '<span class="interview-result ' + interview.result + '">' + (interview.result === 'passed' ? 'âœ“ Passed' : interview.result === 'failed' ? 'âœ— Failed' : 'Pending') + '</span>' +
                '</div>' +
            '</div>';
        }

        // INTERVIEW CALENDAR & EXPORT FUNCTIONS
        let calendarViewActive = false;
        let calendarWeekOffset = 0;

        function toggleInterviewCalendar() {
            calendarViewActive = !calendarViewActive;
            const grid = document.getElementById('interviewsGrid');
            const calendar = document.getElementById('interviewCalendarView');
            const btnText = document.getElementById('calendarBtnText');
            const btn = document.getElementById('toggleCalendarBtn');
            
            if (calendarViewActive) {
                grid.style.display = 'none';
                calendar.style.display = 'block';
                btnText.textContent = 'Card View';
                btn.classList.add('btn-primary');
                btn.classList.remove('btn-secondary');
                renderInterviewCalendar();
            } else {
                grid.style.display = 'grid';
                calendar.style.display = 'none';
                btnText.textContent = 'Calendar View';
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-secondary');
            }
            lucide.createIcons();
        }

        function changeCalendarWeek(offset) {
            calendarWeekOffset += offset;
            renderInterviewCalendar();
        }

        function renderInterviewCalendar() {
            const container = document.getElementById('calendarGrid');
            const titleEl = document.getElementById('calendarWeekTitle');
            if (!container) return;
            
            // Calculate week dates
            const today = new Date();
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - today.getDay() + 1 + (calendarWeekOffset * 7)); // Monday
            
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);
            
            // Update title
            const monthStart = startOfWeek.toLocaleString('en-US', { month: 'long' });
            const monthEnd = endOfWeek.toLocaleString('en-US', { month: 'long' });
            titleEl.textContent = monthStart === monthEnd ? 
                monthStart + ' ' + startOfWeek.getDate() + ' - ' + endOfWeek.getDate() + ', ' + startOfWeek.getFullYear() :
                monthStart + ' ' + startOfWeek.getDate() + ' - ' + monthEnd + ' ' + endOfWeek.getDate() + ', ' + endOfWeek.getFullYear();
            
            // Build calendar HTML
            let html = days.map(d => '<div class="calendar-day-header">' + d + '</div>').join('');
            
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(startOfWeek);
                currentDate.setDate(startOfWeek.getDate() + i);
                const dateStr = currentDate.toISOString().split('T')[0];
                const isToday = dateStr === today.toISOString().split('T')[0];
                
                const dayInterviews = MOCK_INTERVIEWS.filter(int => int.date === dateStr);
                
                html += '<div class="calendar-day' + (isToday ? ' today' : '') + '">';
                html += '<div class="calendar-day-number">' + currentDate.getDate() + '</div>';
                
                const maxShow = 3;
                dayInterviews.slice(0, maxShow).forEach(int => {
                    const eventClass = int.status === 'completed' ? 'completed' : int.status === 'cancelled' ? 'cancelled' : int.status === 'no-show' ? 'no-show' : '';
                    html += '<div class="calendar-event ' + eventClass + '" title="' + int.candidateName + ' - ' + int.candidateRank + '">' + int.time + ' ' + int.candidateName.split(' ')[0] + '</div>';
                });
                
                if (dayInterviews.length > maxShow) {
                    html += '<div class="calendar-more">+' + (dayInterviews.length - maxShow) + ' more</div>';
                }
                
                html += '</div>';
            }
            
            container.innerHTML = html;
        }

        function exportInterviews() {
            // Create CSV content
            let csv = 'ID,Candidate,Rank,Date,Time,Duration,Type,Interviewer,Location,Status,Result,Technical,Experience,Communication\n';
            
            MOCK_INTERVIEWS.forEach(int => {
                csv += '"' + int.id + '","' + int.candidateName + '","' + int.candidateRank + '","' + int.date + '","' + int.time + '",' + int.duration + ',"' + int.type + '","' + int.interviewer + '","' + int.location + '","' + int.status + '","' + int.result + '",' + (int.scores.technical || '') + ',' + (int.scores.experience || '') + ',' + (int.scores.communication || '') + '\n';
            });
            
            // Download file
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'interviews_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            // Show notification
            showNotification('Interviews exported successfully!', 'success');
        }
        
        function filterInterviewsByStatus(status) {
            document.getElementById('interviewStatusFilter').value = status;
            document.getElementById('interviewDateFilter').value = '';
            renderInterviews();
        }
        
        function filterInterviewsByDate(dateRange) {
            document.getElementById('interviewDateFilter').value = dateRange;
            document.getElementById('interviewStatusFilter').value = '';
            renderInterviews();
        }
        
        function openInterviewDetail(id) {
            const interview = MOCK_INTERVIEWS.find(i => i.id === id);
            if (!interview) return;
            
            const statusLabels = { scheduled: 'Scheduled', 'in-progress': 'In Progress', completed: 'Completed', cancelled: 'Cancelled', 'no-show': 'No Show' };
            const initials = interview.candidateName.split(' ').map(n => n[0]).join('');
            
            const dateObj = new Date(interview.date);
            const formattedDate = dateObj.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            
            const avgScore = interview.scores.technical ? 
                Math.round((interview.scores.technical + interview.scores.experience + interview.scores.communication) / 3) : null;
            
            let html = '<div style="display:flex;gap:24px;margin-bottom:24px;padding-bottom:24px;border-bottom:1px solid var(--cw-gray-200);">' +
                '<div style="text-align:center;padding:20px 24px;background:var(--cw-primary);color:white;border-radius:12px;">' +
                    '<div style="font-size:2.5rem;font-weight:700;">' + dateObj.getDate() + '</div>' +
                    '<div style="font-size:0.9rem;text-transform:uppercase;">' + dateObj.toLocaleString('en-US', { month: 'short' }) + '</div>' +
                '</div>' +
                '<div style="flex:1;">' +
                    '<div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;">' +
                        '<div>' +
                            '<h2 style="font-size:1.5rem;font-weight:700;margin-bottom:4px;">' + interview.type + '</h2>' +
                            '<p style="color:var(--cw-gray-500);">' + formattedDate + '</p>' +
                        '</div>' +
                        '<span class="interview-status ' + interview.status + '" style="font-size:0.9rem;padding:8px 16px;">' + statusLabels[interview.status] + '</span>' +
                    '</div>' +
                    '<div style="display:flex;gap:24px;font-size:0.95rem;">' +
                        '<div><i data-lucide="clock" style="width:16px;height:16px;vertical-align:middle;margin-right:6px;"></i>' + interview.time + ' (' + interview.duration + ' min)</div>' +
                        '<div><i data-lucide="map-pin" style="width:16px;height:16px;vertical-align:middle;margin-right:6px;"></i>' + interview.location + '</div>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">';
            
            // Left Column - Candidate Info
            html += '<div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Candidate</h4>' +
                    '<div class="info-box">' +
                        '<div style="display:flex;align-items:center;gap:16px;margin-bottom:16px;">' +
                            '<div class="avatar" style="width:64px;height:64px;font-size:1.25rem;">' + initials + '</div>' +
                            '<div>' +
                                '<div style="font-size:1.1rem;font-weight:600;">' + interview.candidateName + '</div>' +
                                '<div style="color:var(--cw-gray-500);">' + interview.candidateRank + '</div>' +
                                (interview.rfcId ? '<div style="color:var(--cw-accent);font-size:0.85rem;margin-top:4px;">' + interview.rfcId + '</div>' : '') +
                            '</div>' +
                        '</div>' +
                        '<div style="display:flex;gap:8px;">' +
                            '<button class="btn btn-sm btn-secondary" onclick="viewCandidateFromInterview(\'' + interview.candidateName + '\')"><i data-lucide="user"></i>View Profile</button>' +
                            '<button class="btn btn-sm btn-secondary" onclick="viewCandidateDocuments(\'' + interview.candidateName + '\')"><i data-lucide="file-text"></i>Documents</button>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Interviewer</h4>' +
                    '<div class="info-box">' +
                        '<div style="display:flex;align-items:center;gap:12px;">' +
                            '<div class="avatar" style="width:48px;height:48px;background:var(--cw-accent);">' + interview.interviewerInitials + '</div>' +
                            '<div>' +
                                '<div style="font-weight:600;">' + interview.interviewer + '</div>' +
                                '<div style="color:var(--cw-gray-500);font-size:0.85rem;">Senior Recruitment Officer</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            // Right Column - Assessment
            html += '<div>' +
                '<div class="panel-section"><h4 class="panel-section-title">Assessment Scores</h4>' +
                    '<div class="info-box">';
            
            if (avgScore) {
                html += '<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:16px;">' +
                    '<div style="text-align:center;padding:16px;background:var(--cw-gray-50);border-radius:8px;">' +
                        '<div style="font-size:2rem;font-weight:700;color:var(--cw-primary);">' + interview.scores.technical + '</div>' +
                        '<div style="font-size:0.8rem;color:var(--cw-gray-500);">Technical</div>' +
                    '</div>' +
                    '<div style="text-align:center;padding:16px;background:var(--cw-gray-50);border-radius:8px;">' +
                        '<div style="font-size:2rem;font-weight:700;color:var(--cw-primary);">' + interview.scores.experience + '</div>' +
                        '<div style="font-size:0.8rem;color:var(--cw-gray-500);">Experience</div>' +
                    '</div>' +
                    '<div style="text-align:center;padding:16px;background:var(--cw-gray-50);border-radius:8px;">' +
                        '<div style="font-size:2rem;font-weight:700;color:var(--cw-primary);">' + interview.scores.communication + '</div>' +
                        '<div style="font-size:0.8rem;color:var(--cw-gray-500);">Communication</div>' +
                    '</div>' +
                    '<div style="text-align:center;padding:16px;background:' + (avgScore >= 70 ? 'var(--status-ready)' : 'var(--tag-nfr)') + ';border-radius:8px;color:white;">' +
                        '<div style="font-size:2rem;font-weight:700;">' + avgScore + '</div>' +
                        '<div style="font-size:0.8rem;opacity:0.9;">Average</div>' +
                    '</div>' +
                '</div>' +
                '<div style="text-align:center;padding:12px;background:' + (interview.result === 'passed' ? 'rgba(16,185,129,0.1)' : interview.result === 'failed' ? 'rgba(239,68,68,0.1)' : 'var(--cw-gray-50)') + ';border-radius:8px;">' +
                    '<span style="font-weight:600;color:' + (interview.result === 'passed' ? 'var(--status-ready)' : interview.result === 'failed' ? 'var(--tag-nfr)' : 'var(--cw-gray-500)') + ';">' +
                    (interview.result === 'passed' ? 'âœ“ PASSED' : interview.result === 'failed' ? 'âœ— FAILED' : 'Pending Decision') + '</span>' +
                '</div>';
            } else {
                html += '<div style="text-align:center;padding:32px;color:var(--cw-gray-400);">' +
                    '<i data-lucide="clipboard-list" style="width:48px;height:48px;margin-bottom:12px;"></i>' +
                    '<p>Assessment not yet completed</p>' +
                '</div>';
            }
            
            html += '</div></div>';
            
            // Interview Notes
            html += '<div class="panel-section"><h4 class="panel-section-title">Interview Notes</h4>' +
                '<div class="info-box" style="background:var(--cw-gray-50);">' +
                    (interview.notes ? '<p>' + interview.notes + '</p>' : '<p style="color:var(--cw-gray-400);font-style:italic;">No notes recorded yet.</p>') +
                '</div>' +
            '</div></div>';
            
            html += '</div>'; // Close grid
            
            // Interview Checklist
            html += '<div class="panel-section" style="margin-top:24px;"><h4 class="panel-section-title">Interview Checklist</h4>' +
                '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;">' +
                    '<div style="padding:12px;background:var(--cw-gray-50);border-radius:8px;display:flex;align-items:center;gap:8px;">' +
                        '<i data-lucide="' + (interview.status !== 'scheduled' ? 'check-circle' : 'circle') + '" style="width:20px;height:20px;color:' + (interview.status !== 'scheduled' ? 'var(--status-ready)' : 'var(--cw-gray-300)') + ';"></i>' +
                        '<span>Documents Verified</span>' +
                    '</div>' +
                    '<div style="padding:12px;background:var(--cw-gray-50);border-radius:8px;display:flex;align-items:center;gap:8px;">' +
                        '<i data-lucide="' + (interview.status === 'completed' ? 'check-circle' : 'circle') + '" style="width:20px;height:20px;color:' + (interview.status === 'completed' ? 'var(--status-ready)' : 'var(--cw-gray-300)') + ';"></i>' +
                        '<span>Interview Conducted</span>' +
                    '</div>' +
                    '<div style="padding:12px;background:var(--cw-gray-50);border-radius:8px;display:flex;align-items:center;gap:8px;">' +
                        '<i data-lucide="' + (interview.result !== 'pending' ? 'check-circle' : 'circle') + '" style="width:20px;height:20px;color:' + (interview.result !== 'pending' ? 'var(--status-ready)' : 'var(--cw-gray-300)') + ';"></i>' +
                        '<span>Assessment Complete</span>' +
                    '</div>' +
                '</div>' +
            '</div>';
            
            document.getElementById('interviewDetailContent').innerHTML = html;
            
            // Dynamic footer buttons based on status
            let footerHtml = '<button class="btn btn-secondary" onclick="closeModal(\'interviewDetailModal\')">Close</button>';
            
            if (interview.status === 'scheduled') {
                footerHtml += '<button class="btn btn-secondary" onclick="startInterview(\'' + interview.id + '\')"><i data-lucide="play"></i>Start Interview</button>';
                footerHtml += '<button class="btn btn-secondary" onclick="rescheduleInterview(\'' + interview.id + '\')"><i data-lucide="calendar"></i>Reschedule</button>';
                footerHtml += '<button class="btn btn-ghost" style="color:var(--tag-nfr);" onclick="cancelInterview(\'' + interview.id + '\')"><i data-lucide="x-circle"></i>Cancel</button>';
            } else if (interview.status === 'in-progress') {
                footerHtml += '<button class="btn btn-primary" onclick="completeInterview(\'' + interview.id + '\')"><i data-lucide="check"></i>Complete & Score</button>';
            } else if (interview.status === 'completed' && interview.result === 'pending') {
                footerHtml += '<button class="btn btn-primary" onclick="recordInterviewResult(\'' + interview.id + '\', \'passed\')"><i data-lucide="check"></i>Pass</button>';
                footerHtml += '<button class="btn btn-ghost" style="color:var(--tag-nfr);" onclick="recordInterviewResult(\'' + interview.id + '\', \'failed\')"><i data-lucide="x"></i>Fail</button>';
            }
            
            document.getElementById('interviewDetailFooter').innerHTML = footerHtml;
            
            openModal('interviewDetailModal');
            lucide.createIcons();
        }
        
        function startInterview(id) {
            const interview = MOCK_INTERVIEWS.find(i => i.id === id);
            if (interview) {
                interview.status = 'in-progress';
                showNotification('Interview started!', 'success');
                closeModal('interviewDetailModal');
                renderInterviews();
            }
        }
        
        let currentScoringInterview = null;
        let selectedRecommendation = 'pending';
        
        function completeInterview(id) {
            const interview = MOCK_INTERVIEWS.find(i => i.id === id);
            if (!interview) return;
            
            currentScoringInterview = interview;
            
            // Populate candidate info
            const initials = interview.candidateName.split(' ').map(n => n[0]).join('');
            document.getElementById('scoreInterviewCandidate').innerHTML = 
                '<div style="display:flex;align-items:center;gap:12px;">' +
                    '<div class="avatar" style="width:48px;height:48px;">' + initials + '</div>' +
                    '<div>' +
                        '<div style="font-weight:600;">' + interview.candidateName + '</div>' +
                        '<div style="color:var(--cw-gray-500);font-size:0.9rem;">' + interview.candidateRank + ' â€¢ ' + interview.type + '</div>' +
                    '</div>' +
                '</div>';
            
            // Reset form
            document.getElementById('scoreTechnical').value = 75;
            document.getElementById('scoreExperience').value = 80;
            document.getElementById('scoreCommunication').value = 70;
            document.getElementById('interviewNotes').value = '';
            selectedRecommendation = 'pending';
            updateScoreAverage();
            
            closeModal('interviewDetailModal');
            openModal('scoreInterviewModal');
            lucide.createIcons();
            
            // Add input listeners for real-time average calculation
            ['scoreTechnical', 'scoreExperience', 'scoreCommunication'].forEach(id => {
                document.getElementById(id).oninput = updateScoreAverage;
            });
        }
        
        function updateScoreAverage() {
            const tech = parseInt(document.getElementById('scoreTechnical').value) || 0;
            const exp = parseInt(document.getElementById('scoreExperience').value) || 0;
            const comm = parseInt(document.getElementById('scoreCommunication').value) || 0;
            const avg = Math.round((tech + exp + comm) / 3);
            
            const avgEl = document.getElementById('scoreAverage');
            avgEl.textContent = avg;
            avgEl.style.color = avg >= 70 ? 'var(--status-ready)' : avg >= 50 ? 'var(--status-on-approval)' : 'var(--tag-nfr)';
        }
        
        function selectRecommendation(value) {
            selectedRecommendation = value;
            document.querySelectorAll('#scoreInterviewModal label[onclick*="selectRecommendation"]').forEach(label => {
                label.style.borderColor = 'var(--cw-gray-200)';
                label.style.background = 'white';
            });
            event.currentTarget.style.borderColor = value === 'passed' ? 'var(--status-ready)' : value === 'failed' ? 'var(--tag-nfr)' : 'var(--cw-gray-400)';
            event.currentTarget.style.background = value === 'passed' ? 'rgba(16,185,129,0.05)' : value === 'failed' ? 'rgba(239,68,68,0.05)' : 'var(--cw-gray-50)';
        }
        
        function submitInterviewScore() {
            if (!currentScoringInterview) return;
            
            const tech = parseInt(document.getElementById('scoreTechnical').value) || 0;
            const exp = parseInt(document.getElementById('scoreExperience').value) || 0;
            const comm = parseInt(document.getElementById('scoreCommunication').value) || 0;
            const notes = document.getElementById('interviewNotes').value;
            
            // Update interview
            currentScoringInterview.status = 'completed';
            currentScoringInterview.scores = { technical: tech, experience: exp, communication: comm };
            currentScoringInterview.result = selectedRecommendation;
            currentScoringInterview.notes = notes;
            
            const avg = Math.round((tech + exp + comm) / 3);
            showNotification('Assessment submitted! Average score: ' + avg + (selectedRecommendation !== 'pending' ? ' - ' + selectedRecommendation.toUpperCase() : ''), 'success');
            
            closeModal('scoreInterviewModal');
            renderInterviews();
            currentScoringInterview = null;
        }
        
        function viewCandidateFromInterview(candidateName) {
            // Find candidate in MOCK_CANDIDATES
            const nameParts = candidateName.split(' ');
            const candidate = MOCK_CANDIDATES.find(c => 
                c.firstName === nameParts[0] && c.lastName === nameParts[nameParts.length - 1]
            );
            
            if (candidate) {
                closeModal('interviewDetailModal');
                currentPanelItem = { type: 'candidate', data: candidate };
                viewFullProfile();
            } else {
                showNotification('Opening profile for ' + candidateName, 'info');
            }
        }
        
        function viewCandidateDocuments(candidateName) {
            const docs = [
                { name: 'STCW Certificate', status: 'valid', expiry: '2027-03-15', file: 'STCW_Certificate.pdf' },
                { name: 'Medical Certificate', status: 'valid', expiry: '2025-08-20', file: 'Medical_Cert.pdf' },
                { name: 'Passport', status: 'valid', expiry: '2029-11-10', file: 'Passport.pdf' },
                { name: 'Seamans Book', status: 'valid', expiry: '2028-05-22', file: 'Seamans_Book.pdf' },
                { name: 'Flag State License', status: 'pending', expiry: '-', file: null },
                { name: 'Drug Test Results', status: 'valid', expiry: '2025-04-01', file: 'Drug_Test.pdf' },
                { name: 'Training Certificates', status: 'valid', expiry: '2026-12-31', file: 'Training_Certs.pdf' },
            ];
            
            let html = '<div style="margin-bottom:16px;padding:16px;background:var(--cw-gray-50);border-radius:8px;">' +
                '<h4 style="margin-bottom:8px;">' + candidateName + '</h4>' +
                '<div style="display:flex;gap:16px;font-size:0.9rem;color:var(--cw-gray-500);">' +
                    '<span><strong>' + docs.filter(d => d.status === 'valid').length + '</strong> Valid</span>' +
                    '<span><strong>' + docs.filter(d => d.status === 'pending').length + '</strong> Pending</span>' +
                    '<span><strong>' + docs.filter(d => d.status === 'expired').length + '</strong> Expired</span>' +
                '</div>' +
            '</div>';
            
            html += '<div style="border:1px solid var(--cw-gray-200);border-radius:8px;overflow:hidden;">';
            docs.forEach((doc, idx) => {
                const statusColor = doc.status === 'valid' ? 'var(--status-ready)' : doc.status === 'pending' ? 'var(--status-on-approval)' : 'var(--tag-nfr)';
                html += '<div style="display:flex;align-items:center;justify-content:space-between;padding:12px 16px;' + (idx < docs.length - 1 ? 'border-bottom:1px solid var(--cw-gray-200);' : '') + '">' +
                    '<div style="display:flex;align-items:center;gap:12px;">' +
                        '<i data-lucide="file-text" style="width:20px;height:20px;color:var(--cw-gray-400);"></i>' +
                        '<div>' +
                            '<div style="font-weight:500;">' + doc.name + '</div>' +
                            '<div style="font-size:0.8rem;color:var(--cw-gray-500);">Expiry: ' + doc.expiry + '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div style="display:flex;align-items:center;gap:12px;">' +
                        '<span class="tag" style="background:' + statusColor + '20;color:' + statusColor + ';text-transform:capitalize;">' + doc.status + '</span>' +
                        (doc.file ? '<button class="btn btn-sm btn-ghost" onclick="downloadDocument(\'' + doc.file + '\')"><i data-lucide="download" style="width:16px;height:16px;"></i></button>' : '') +
                    '</div>' +
                '</div>';
            });
            html += '</div>';
            
            document.getElementById('candidateDocsContent').innerHTML = html;
            openModal('candidateDocsModal');
            lucide.createIcons();
        }
        
        function downloadDocument(filename) {
            showNotification('Downloading ' + filename + '...', 'info');
        }
        
        function recordInterviewResult(id, result) {
            const interview = MOCK_INTERVIEWS.find(i => i.id === id);
            if (interview) {
                interview.result = result;
                showNotification('Result recorded: ' + (result === 'passed' ? 'Passed âœ“' : 'Failed âœ—'), result === 'passed' ? 'success' : 'info');
                closeModal('interviewDetailModal');
                renderInterviews();
            }
        }
        
        function rescheduleInterview(id) {
            closeModal('interviewDetailModal');
            showNotification('Opening reschedule form...', 'info');
            openModal('scheduleInterviewModal');
        }
        
        function cancelInterview(id) {
            const interview = MOCK_INTERVIEWS.find(i => i.id === id);
            if (interview && confirm('Are you sure you want to cancel this interview?')) {
                interview.status = 'cancelled';
                showNotification('Interview cancelled', 'info');
                closeModal('interviewDetailModal');
                renderInterviews();
            }
        }

        function scheduleNewInterview() {
            const candidate = document.getElementById('interviewCandidateSelect').value;
            const date = document.getElementById('interviewDateInput').value;
            const time = document.getElementById('interviewTimeInput').value;
            const interviewer = document.getElementById('interviewerSelect').value;
            
            if (!candidate || !date || !time || !interviewer) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            // In real app, would save to database
            showNotification('Interview scheduled successfully!', 'success');
            closeModal('scheduleInterviewModal');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = 'position:fixed;top:24px;right:24px;padding:16px 24px;border-radius:8px;color:white;font-weight:500;z-index:9999;animation:slideIn 0.3s ease;box-shadow:0 4px 12px rgba(0,0,0,0.15);';
            notification.style.background = type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#3B82F6';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                notification.style.transition = 'all 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // EMBARKATION PREP MODULE RENDERING
        function renderEmbarkations() {
            const container = document.getElementById('embarkationsGrid');
            if (!container) return;
            
            const readinessFilter = document.getElementById('embarkReadinessFilter')?.value || '';
            const timeframeFilter = document.getElementById('embarkTimeframeFilter')?.value || '';
            const principalFilter = document.getElementById('embarkPrincipalFilter')?.value || '';
            const searchQuery = document.getElementById('embarkSearchInput')?.value?.toLowerCase() || '';
            
            let embarkations = MOCK_EMBARKATIONS;
            if (readinessFilter) embarkations = embarkations.filter(e => e.readiness === readinessFilter);
            if (timeframeFilter) {
                if (timeframeFilter === 'today') embarkations = embarkations.filter(e => e.daysUntil <= 1);
                else if (timeframeFilter === 'week') embarkations = embarkations.filter(e => e.daysUntil <= 7);
                else if (timeframeFilter === 'month') embarkations = embarkations.filter(e => e.daysUntil <= 30);
            }
            if (principalFilter) {
                // Match principal from vessel name patterns
                const principalMap = {
                    'Diana Shipping': ['Diana'],
                    'Centrofin': ['Centrofin'],
                    'Pioneer Marine': ['Pioneer'],
                    'Neda Maritime': ['Neda']
                };
                const patterns = principalMap[principalFilter] || [];
                embarkations = embarkations.filter(e => patterns.some(p => e.vessel.includes(p)));
            }
            if (searchQuery) embarkations = embarkations.filter(e => 
                e.name.toLowerCase().includes(searchQuery) || 
                e.vessel.toLowerCase().includes(searchQuery) ||
                e.rank.toLowerCase().includes(searchQuery)
            );
            
            // Update stats
            const ready = MOCK_EMBARKATIONS.filter(e => e.readiness === 'ready').length;
            const pending = MOCK_EMBARKATIONS.filter(e => e.readiness === 'pending').length;
            const blocked = MOCK_EMBARKATIONS.filter(e => e.readiness === 'blocked').length;
            const thisWeek = MOCK_EMBARKATIONS.filter(e => e.daysUntil <= 7).length;
            const avgReadiness = Math.round(MOCK_EMBARKATIONS.reduce((sum, e) => {
                const completed = Object.values(e.checklist).filter(v => v).length;
                return sum + (completed / 6) * 100;
            }, 0) / MOCK_EMBARKATIONS.length);
            
            if (document.getElementById('embarkReadyCount')) document.getElementById('embarkReadyCount').textContent = ready;
            if (document.getElementById('embarkPendingCount')) document.getElementById('embarkPendingCount').textContent = pending;
            if (document.getElementById('embarkBlockedCount')) document.getElementById('embarkBlockedCount').textContent = blocked;
            if (document.getElementById('embarkWeekCount')) document.getElementById('embarkWeekCount').textContent = thisWeek;
            if (document.getElementById('embarkAvgReadiness')) document.getElementById('embarkAvgReadiness').textContent = avgReadiness + '%';
            
            container.innerHTML = embarkations.map(emb => renderEmbarkCard(emb)).join('');
            lucide.createIcons();
        }

        function renderEmbarkCard(emb) {
            const initials = emb.name.split(' ').map(n => n[0]).join('');
            const checklistItems = [
                { key: 'contract', label: 'Contract Signed', icon: 'file-signature' },
                { key: 'peme', label: 'PEME Cleared', icon: 'heart-pulse' },
                { key: 'visa', label: 'Visa & Documents', icon: 'id-card' },
                { key: 'training', label: 'Training Complete', icon: 'award' },
                { key: 'travel', label: 'Travel Booked', icon: 'plane' },
                { key: 'briefing', label: 'Pre-departure Briefing', icon: 'message-square' },
            ];
            
            const completed = Object.values(emb.checklist).filter(v => v).length;
            const total = Object.values(emb.checklist).length;
            const percent = Math.round((completed / total) * 100);
            
            const checklistHtml = checklistItems.map(item => {
                const status = emb.checklist[item.key] ? 'complete' : (emb.readiness === 'blocked' && !emb.checklist[item.key] ? 'blocked' : 'incomplete');
                const iconName = status === 'complete' ? 'check' : (status === 'blocked' ? 'x' : 'clock');
                const clickAction = status !== 'complete' ? ' onclick="toggleChecklistItem(\'' + emb.id + '\',\'' + item.key + '\')" style="cursor:pointer;"' : '';
                return '<div class="embark-check-item ' + status + '"' + clickAction + '>' +
                    '<div class="embark-check-icon ' + status + '"><i data-lucide="' + iconName + '"></i></div>' +
                    '<span class="embark-check-label">' + item.label + '</span>' +
                    '<span class="embark-check-status" style="color:var(--' + (status === 'complete' ? 'status-ready' : status === 'blocked' ? 'tag-nfr' : 'status-on-approval') + ');">' + (status === 'complete' ? 'Done' : status === 'blocked' ? 'Missing' : 'Pending') + '</span>' +
                '</div>';
            }).join('');
            
            return '<div class="embark-card ' + emb.readiness + '" data-id="' + emb.id + '">' +
                '<div class="embark-header">' +
                    '<div class="embark-avatar clickable-seafarer" onclick="openSeafarerProfile(\'' + emb.name + '\')">' + initials + '</div>' +
                    '<div class="embark-info clickable-seafarer" onclick="openSeafarerProfile(\'' + emb.name + '\')"><div class="embark-name">' + emb.name + '</div><div class="embark-rank">' + emb.rank + '</div></div>' +
                    '<div class="embark-date-box"><div class="embark-date-label">Embark</div><div class="embark-date-value">' + emb.embarkDate.slice(5) + '</div><div class="embark-date-days">' + emb.daysUntil + ' days</div></div>' +
                '</div>' +
                '<div class="embark-body">' +
                    '<div class="embark-vessel"><div class="embark-vessel-icon"><i data-lucide="ship"></i></div><div><div class="embark-vessel-name">' + emb.vessel + '</div><div class="embark-vessel-port">ðŸ“ ' + emb.port + '</div></div></div>' +
                    '<div class="embark-checklist">' + checklistHtml + '</div>' +
                '</div>' +
                '<div class="embark-footer">' +
                    '<div class="embark-progress"><div class="embark-progress-bar"><div class="embark-progress-fill" style="width:' + percent + '%;background:var(--' + (emb.readiness === 'ready' ? 'status-ready' : emb.readiness === 'blocked' ? 'tag-nfr' : 'status-on-approval') + ');"></div></div><span class="embark-progress-text">' + completed + '/' + total + '</span></div>' +
                    '<span class="embark-readiness ' + emb.readiness + '">' + (emb.readiness === 'ready' ? 'âœ“ Ready' : emb.readiness === 'blocked' ? 'âœ— Blocked' : 'â³ Pending') + '</span>' +
                '</div>' +
                '<div class="embark-actions">' +
                    '<button class="btn btn-ghost btn-sm" onclick="viewEmbarkDetails(\'' + emb.id + '\')"><i data-lucide="eye"></i>Details</button>' +
                    '<button class="btn btn-ghost btn-sm" onclick="sendEmbarkReminder(\'' + emb.id + '\',\'' + emb.name + '\')"><i data-lucide="bell"></i>Remind</button>' +
                    (emb.readiness === 'ready' ? '<button class="btn btn-primary btn-sm" onclick="confirmEmbarkation(\'' + emb.id + '\',\'' + emb.name + '\')"><i data-lucide="check-circle"></i>Confirm</button>' : '') +
                '</div>' +
            '</div>';
        }
        
        function filterEmbarkByStatus(status) {
            const el = document.getElementById('embarkReadinessFilter');
            if (el) el.value = status;
            renderEmbarkations();
            showNotification('Filtering: ' + status.charAt(0).toUpperCase() + status.slice(1) + ' embarkations', 'info');
        }
        
        function filterEmbarkByTimeframe(timeframe) {
            const el = document.getElementById('embarkTimeframeFilter');
            if (el) el.value = timeframe;
            renderEmbarkations();
            showNotification('Showing embarkations this week', 'info');
        }
        
        function exportEmbarkChecklist() {
            let csv = 'ID,Seafarer,Rank,Vessel,Port,Embark Date,Days Until,Contract,PEME,Visa,Training,Travel,Briefing,Status\n';
            MOCK_EMBARKATIONS.forEach(e => {
                csv += '"' + e.id + '","' + e.name + '","' + e.rank + '","' + e.vessel + '","' + e.port + '","' + e.embarkDate + '",' + e.daysUntil + ',' +
                    (e.checklist.contract ? 'Done' : 'Pending') + ',' +
                    (e.checklist.peme ? 'Done' : 'Pending') + ',' +
                    (e.checklist.visa ? 'Done' : 'Pending') + ',' +
                    (e.checklist.training ? 'Done' : 'Pending') + ',' +
                    (e.checklist.travel ? 'Done' : 'Pending') + ',' +
                    (e.checklist.briefing ? 'Done' : 'Pending') + ',' +
                    e.readiness + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'embarkation_checklist_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Embarkation checklist exported!', 'success');
        }
        
        function sendEmbarkReminders() {
            const pending = MOCK_EMBARKATIONS.filter(e => e.readiness !== 'ready');
            if (pending.length === 0) {
                showNotification('All seafarers are ready for embarkation!', 'success');
                return;
            }
            
            showNotification('Sending reminders to ' + pending.length + ' seafarer(s)...', 'info');
            
            setTimeout(() => {
                showNotification('âœ“ Reminders sent to ' + pending.length + ' seafarer(s) with pending items', 'success');
            }, 1500);
        }
        
        function sendEmbarkReminder(embarkId, seafarerName) {
            showNotification('Sending reminder to ' + seafarerName + '...', 'info');
            setTimeout(() => {
                showNotification('âœ“ Reminder sent to ' + seafarerName, 'success');
            }, 800);
        }
        
        function toggleChecklistItem(embarkId, itemKey) {
            const emb = MOCK_EMBARKATIONS.find(e => e.id === embarkId);
            if (!emb) return;
            
            emb.checklist[itemKey] = !emb.checklist[itemKey];
            
            // Update readiness status
            const completed = Object.values(emb.checklist).filter(v => v).length;
            if (completed === 6) {
                emb.readiness = 'ready';
            } else if (completed < 3) {
                emb.readiness = 'blocked';
            } else {
                emb.readiness = 'pending';
            }
            
            renderEmbarkations();
            showNotification('Checklist item updated!', 'success');
        }
        
        function viewEmbarkDetails(embarkId) {
            const emb = MOCK_EMBARKATIONS.find(e => e.id === embarkId);
            if (!emb) return;
            
            openSeafarerProfile(emb.name);
        }
        
        function confirmEmbarkation(embarkId, seafarerName) {
            const card = document.querySelector('.embark-card[data-id="' + embarkId + '"]');
            if (card) {
                card.style.transition = 'all 0.5s';
                card.style.background = 'rgba(16,185,129,0.1)';
                card.style.borderColor = 'var(--status-ready)';
            }
            
            showNotification('ðŸŽ‰ ' + seafarerName + ' confirmed for embarkation!', 'success');
        }

        // PENDING TRANSACTIONS MODULE RENDERING
        function renderPendingTable() {
            const container = document.getElementById('pendingTableBody');
            if (!container) return;
            
            const typeFilter = document.getElementById('pendingTypeFilter')?.value || '';
            const priorityFilter = document.getElementById('pendingPriorityFilter')?.value || '';
            const ageFilter = document.getElementById('pendingAgeFilter')?.value || '';
            const searchQuery = document.getElementById('pendingSearchInput')?.value?.toLowerCase() || '';
            
            let pending = MOCK_PENDING;
            if (typeFilter) pending = pending.filter(p => p.type === typeFilter);
            if (priorityFilter) pending = pending.filter(p => p.priority === priorityFilter);
            if (ageFilter) {
                if (ageFilter === 'overdue') pending = pending.filter(p => p.ageHours > 72);
                else if (ageFilter === 'today') pending = pending.filter(p => p.ageHours < 24);
                else if (ageFilter === 'week') pending = pending.filter(p => p.ageHours < 168);
            }
            if (searchQuery) pending = pending.filter(p => 
                p.title.toLowerCase().includes(searchQuery) || 
                p.seafarer.toLowerCase().includes(searchQuery)
            );
            
            container.innerHTML = pending.map(item => renderPendingRow(item)).join('');
            lucide.createIcons();
        }

        function renderPendingRow(item) {
            const typeLabels = { rfa: 'RFA', contract: 'Contract', document: 'Document', travel: 'Travel', peme: 'PEME' };
            const typeIcons = { rfa: 'file-text', contract: 'file-signature', document: 'folder', travel: 'plane', peme: 'heart-pulse' };
            const initials = item.seafarer.split(' ').map(n => n[0]).join('');
            
            const ageText = item.ageHours < 24 ? item.ageHours + 'h' : Math.floor(item.ageHours / 24) + 'd';
            const ageClass = item.ageHours > 72 ? 'overdue' : item.ageHours > 24 ? 'warning' : '';
            
            return '<div class="pending-row" data-id="' + item.id + '">' +
                '<div style="display:flex;justify-content:center;align-items:center;gap:8px;"><input type="checkbox" class="pending-checkbox" value="' + item.id + '" onchange="updateSelectedCount()"><div class="pending-priority ' + item.priority + '"></div></div>' +
                '<div><div class="pending-type-badge ' + item.type + '"><i data-lucide="' + typeIcons[item.type] + '" style="width:12px;height:12px;"></i>' + typeLabels[item.type] + '</div><div style="font-size:0.85rem;color:var(--cw-gray-700);margin-top:4px;">' + item.title + '</div></div>' +
                '<div><div class="avatar-cell clickable-seafarer" onclick="openSeafarerProfile(\'' + item.seafarer + '\')"><div class="avatar" style="width:32px;height:32px;font-size:0.7rem;">' + initials + '</div><div class="avatar-info"><span class="avatar-name" style="font-size:0.85rem;">' + item.seafarer + '</span><span class="avatar-meta">' + item.rank + '</span></div></div></div>' +
                '<div style="font-size:0.85rem;color:var(--cw-gray-600);">' + item.relatedTo + '</div>' +
                '<div class="pending-age ' + ageClass + '">' + ageText + ' ago</div>' +
                '<div><span class="tag tag-unassigned">Awaiting</span></div>' +
                '<div class="pending-actions">' +
                    '<button class="pending-action-btn approve" title="Approve" onclick="approvePendingItem(\'' + item.id + '\',\'' + item.type + '\',\'' + item.title + '\')"><i data-lucide="check"></i></button>' +
                    '<button class="pending-action-btn reject" title="Reject" onclick="rejectPendingItem(\'' + item.id + '\',\'' + item.type + '\',\'' + item.title + '\')"><i data-lucide="x"></i></button>' +
                '</div>' +
            '</div>';
        }
        
        function filterPendingByType(type) {
            const el = document.getElementById('pendingTypeFilter');
            if (el) el.value = type;
            renderPendingTable();
            showNotification('Filtering: ' + type.toUpperCase() + ' transactions', 'info');
        }
        
        function approvePendingItem(id, type, title) {
            const row = document.querySelector('.pending-row[data-id="' + id + '"]');
            if (row) {
                row.style.transition = 'all 0.3s';
                row.style.background = 'rgba(16,185,129,0.1)';
                row.style.opacity = '0.5';
                setTimeout(() => {
                    row.style.display = 'none';
                }, 500);
            }
            showNotification('âœ“ Approved: ' + title, 'success');
        }
        
        function rejectPendingItem(id, type, title) {
            const row = document.querySelector('.pending-row[data-id="' + id + '"]');
            if (row) {
                row.style.transition = 'all 0.3s';
                row.style.background = 'rgba(239,68,68,0.1)';
                row.style.opacity = '0.5';
                setTimeout(() => {
                    row.style.display = 'none';
                }, 500);
            }
            showNotification('âœ— Rejected: ' + title, 'error');
        }
        
        function toggleSelectAllPending(checkbox) {
            const checkboxes = document.querySelectorAll('.pending-checkbox');
            checkboxes.forEach(cb => cb.checked = checkbox.checked);
            updateSelectedCount();
        }
        
        function updateSelectedCount() {
            const selected = document.querySelectorAll('.pending-checkbox:checked').length;
            // Could update UI to show count
        }
        
        function approveSelectedTransactions() {
            const selected = document.querySelectorAll('.pending-checkbox:checked');
            if (selected.length === 0) {
                showNotification('Please select items to approve', 'warning');
                return;
            }
            
            selected.forEach(cb => {
                const row = cb.closest('.pending-row');
                if (row) {
                    row.style.transition = 'all 0.3s';
                    row.style.background = 'rgba(16,185,129,0.1)';
                    row.style.opacity = '0.5';
                    setTimeout(() => { row.style.display = 'none'; }, 500);
                }
            });
            
            showNotification('âœ“ Approved ' + selected.length + ' transaction(s)', 'success');
        }
        
        function exportPendingTransactions() {
            let csv = 'ID,Type,Title,Seafarer,Rank,Related To,Age (Hours),Priority,Status\n';
            MOCK_PENDING.forEach(p => {
                csv += '"' + p.id + '","' + p.type + '","' + p.title + '","' + p.seafarer + '","' + p.rank + '","' + p.relatedTo + '",' + p.ageHours + ',"' + p.priority + '","Awaiting"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'pending_transactions_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Pending transactions exported!', 'success');
        }

        // TICKETS MODULE RENDERING
        function renderTickets() {
            const container = document.getElementById('ticketsGrid');
            if (!container) return;
            
            const statusFilter = document.getElementById('ticketStatusFilter')?.value || '';
            const typeFilter = document.getElementById('ticketTypeFilter')?.value || '';
            const dateFilter = document.getElementById('ticketDateFilter')?.value || '';
            const searchQuery = document.getElementById('ticketSearchInput')?.value?.toLowerCase() || '';
            
            let tickets = MOCK_TICKETS;
            if (statusFilter) tickets = tickets.filter(t => t.status === statusFilter);
            if (typeFilter) tickets = tickets.filter(t => t.type === typeFilter);
            if (dateFilter) {
                const today = new Date();
                tickets = tickets.filter(t => {
                    const ticketDate = new Date(t.date);
                    const daysDiff = Math.ceil((ticketDate - today) / (1000 * 60 * 60 * 24));
                    if (dateFilter === 'today') return daysDiff <= 1 && daysDiff >= 0;
                    if (dateFilter === 'week') return daysDiff <= 7 && daysDiff >= 0;
                    if (dateFilter === 'month') return daysDiff <= 30 && daysDiff >= 0;
                    return true;
                });
            }
            if (searchQuery) tickets = tickets.filter(t => 
                t.pnr.toLowerCase().includes(searchQuery) || 
                t.passenger.toLowerCase().includes(searchQuery)
            );
            
            // Update stats
            const confirmed = MOCK_TICKETS.filter(t => t.status === 'confirmed').length;
            const pending = MOCK_TICKETS.filter(t => t.status === 'pending').length;
            const totalSpend = MOCK_TICKETS.reduce((sum, t) => sum + t.price, 0);
            const avgCost = Math.round(totalSpend / MOCK_TICKETS.length);
            
            if (document.getElementById('ticketConfirmedCount')) document.getElementById('ticketConfirmedCount').textContent = confirmed;
            if (document.getElementById('ticketPendingCount')) document.getElementById('ticketPendingCount').textContent = pending;
            if (document.getElementById('ticketTotalSpend')) document.getElementById('ticketTotalSpend').textContent = '$' + (totalSpend / 1000).toFixed(1) + 'K';
            if (document.getElementById('ticketAvgCost')) document.getElementById('ticketAvgCost').textContent = '$' + avgCost.toLocaleString();
            
            container.innerHTML = tickets.map(ticket => renderTicketCard(ticket)).join('');
            lucide.createIcons();
        }

        function renderTicketCard(ticket) {
            const initials = ticket.passenger.split(' ').map(n => n[0]).join('');
            
            return '<div class="ticket-card" onclick="openTicketDetail(\'' + ticket.pnr + '\')" style="cursor:pointer;">' +
                '<div class="ticket-header">' +
                    '<div class="ticket-pnr">' + ticket.pnr + '</div>' +
                    '<span class="ticket-status ' + ticket.status + '">' + ticket.status + '</span>' +
                '</div>' +
                '<div class="ticket-body">' +
                    '<div class="ticket-route">' +
                        '<div class="ticket-airport"><div class="ticket-airport-code">' + ticket.from + '</div><div class="ticket-airport-city">' + ticket.fromCity + '</div></div>' +
                        '<div class="ticket-flight-info"><div class="ticket-flight-line"><i data-lucide="plane" style="width:18px;height:18px;"></i></div><div class="ticket-duration">' + ticket.duration + '</div></div>' +
                        '<div class="ticket-airport" style="text-align:right;"><div class="ticket-airport-code">' + ticket.to + '</div><div class="ticket-airport-city">' + ticket.toCity + '</div></div>' +
                    '</div>' +
                    '<div class="ticket-details">' +
                        '<div class="ticket-detail-item"><i data-lucide="calendar"></i>' + ticket.date + '</div>' +
                        '<div class="ticket-detail-item"><i data-lucide="clock"></i>' + ticket.time + '</div>' +
                        '<div class="ticket-detail-item"><i data-lucide="plane"></i>' + ticket.flight + '</div>' +
                        '<div class="ticket-detail-item"><i data-lucide="building-2"></i>' + ticket.airline + '</div>' +
                    '</div>' +
                    '<div class="ticket-passenger" onclick="event.stopPropagation(); openSeafarerProfile(\'' + ticket.passenger + '\')">' +
                        '<div class="ticket-passenger-avatar">' + initials + '</div>' +
                        '<div><div class="ticket-passenger-name">' + ticket.passenger + '</div><div class="ticket-passenger-rank">' + ticket.rank + '</div></div>' +
                    '</div>' +
                '</div>' +
                '<div class="ticket-footer">' +
                    '<div class="ticket-price">$' + ticket.price.toLocaleString() + '</div>' +
                    '<div class="ticket-airline"><i data-lucide="plane" style="width:14px;height:14px;"></i>' + ticket.type.charAt(0).toUpperCase() + ticket.type.slice(1) + '</div>' +
                '</div>' +
            '</div>';
        }
        
        function filterTicketsByStatus(status) {
            const el = document.getElementById('ticketStatusFilter');
            if (el) el.value = status;
            renderTickets();
            showNotification('Filtering: ' + status.charAt(0).toUpperCase() + status.slice(1) + ' tickets', 'info');
        }
        
        function filterTicketsByDate(dateRange) {
            const el = document.getElementById('ticketDateFilter');
            if (el) el.value = dateRange;
            renderTickets();
            showNotification('Showing tickets this week', 'info');
        }
        
        function exportTickets() {
            let csv = 'PNR,Passenger,Rank,From,To,Date,Time,Flight,Airline,Duration,Type,Price,Status\n';
            MOCK_TICKETS.forEach(t => {
                csv += '"' + t.pnr + '","' + t.passenger + '","' + t.rank + '","' + t.from + ' - ' + t.fromCity + '","' + t.to + ' - ' + t.toCity + '","' + t.date + '","' + t.time + '","' + t.flight + '","' + t.airline + '","' + t.duration + '","' + t.type + '",' + t.price + ',"' + t.status + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tickets_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Tickets exported successfully!', 'success');
        }
        
        function openTicketDetail(pnr) {
            const ticket = MOCK_TICKETS.find(t => t.pnr === pnr);
            if (!ticket) return;
            
            window.currentTicket = ticket;
            const initials = ticket.passenger.split(' ').map(n => n[0]).join('');
            
            // Update modal content
            document.getElementById('ticketDetailPnr').textContent = ticket.pnr;
            document.getElementById('ticketDetailStatus').textContent = ticket.status.charAt(0).toUpperCase() + ticket.status.slice(1);
            document.getElementById('ticketDetailStatus').className = 'ticket-detail-status-badge ' + ticket.status;
            
            // Route info
            document.getElementById('ticketDetailFrom').textContent = ticket.from;
            document.getElementById('ticketDetailFromCity').textContent = ticket.fromCity;
            document.getElementById('ticketDetailTo').textContent = ticket.to;
            document.getElementById('ticketDetailToCity').textContent = ticket.toCity;
            document.getElementById('ticketDetailDuration').textContent = ticket.duration;
            
            // Flight details
            document.getElementById('ticketDetailDate').textContent = ticket.date;
            document.getElementById('ticketDetailTime').textContent = ticket.time;
            document.getElementById('ticketDetailFlight').textContent = ticket.flight;
            document.getElementById('ticketDetailAirline').textContent = ticket.airline;
            document.getElementById('ticketDetailClass').textContent = 'Economy';
            document.getElementById('ticketDetailBaggage').textContent = '2 x 23kg';
            
            // Passenger info
            document.getElementById('ticketDetailPassengerInitials').textContent = initials;
            document.getElementById('ticketDetailPassengerName').textContent = ticket.passenger;
            document.getElementById('ticketDetailPassengerRank').textContent = ticket.rank;
            document.getElementById('ticketDetailPassengerVessel').textContent = 'MV Diana Star';
            
            // Travel info
            document.getElementById('ticketDetailType').textContent = ticket.type.charAt(0).toUpperCase() + ticket.type.slice(1);
            document.getElementById('ticketDetailPrice').textContent = '$' + ticket.price.toLocaleString();
            document.getElementById('ticketDetailBookedBy').textContent = 'Maria Santos';
            document.getElementById('ticketDetailBookedDate').textContent = '2025-02-08';
            
            openModal('ticketDetailModal');
        }
        
        function printTicket() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            showNotification('Preparing ticket for print...', 'info');
            
            // Create printable content
            const printContent = `
<!DOCTYPE html>
<html>
<head>
    <title>E-Ticket ${ticket.pnr}</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #0f172a, #1e40af); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }
        .header h1 { margin: 0; font-size: 28px; }
        .header p { margin: 10px 0 0; opacity: 0.8; }
        .route { display: flex; justify-content: space-between; align-items: center; padding: 30px 0; border-bottom: 2px dashed #ccc; margin-bottom: 30px; }
        .airport { text-align: center; }
        .airport-code { font-size: 48px; font-weight: bold; color: #00495D; }
        .airport-city { font-size: 16px; color: #666; margin-top: 5px; }
        .flight-info { text-align: center; }
        .details { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .detail-section { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        .detail-section h3 { margin: 0 0 15px; color: #00495D; font-size: 14px; text-transform: uppercase; }
        .detail-row { display: flex; justify-content: space-between; margin: 8px 0; }
        .detail-label { color: #666; }
        .detail-value { font-weight: bold; }
        .barcode { text-align: center; margin-top: 30px; padding: 20px; background: #f5f5f5; border-radius: 8px; }
        .barcode-text { font-family: monospace; font-size: 24px; letter-spacing: 3px; }
        @media print { body { padding: 20px; } }

        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>âœˆ Electronic Ticket - ${ticket.pnr}</h1>
        <p>Crossworld Marine Services Inc. | ATLANTIS ERP</p>
    </div>
    
    <div class="route">
        <div class="airport">
            <div class="airport-code">${ticket.from}</div>
            <div class="airport-city">${ticket.fromCity}</div>
        </div>
        <div class="flight-info">
            <div style="font-size: 24px;">âœˆ</div>
            <div>${ticket.duration}</div>
            <div style="color: #666; font-size: 12px;">Direct Flight</div>
        </div>
        <div class="airport">
            <div class="airport-code">${ticket.to}</div>
            <div class="airport-city">${ticket.toCity}</div>
        </div>
    </div>
    
    <div class="details">
        <div class="detail-section">
            <h3>Flight Information</h3>
            <div class="detail-row"><span class="detail-label">Date</span><span class="detail-value">${ticket.date}</span></div>
            <div class="detail-row"><span class="detail-label">Departure</span><span class="detail-value">${ticket.time}</span></div>
            <div class="detail-row"><span class="detail-label">Flight</span><span class="detail-value">${ticket.flight}</span></div>
            <div class="detail-row"><span class="detail-label">Airline</span><span class="detail-value">${ticket.airline}</span></div>
            <div class="detail-row"><span class="detail-label">Class</span><span class="detail-value">Economy</span></div>
        </div>
        <div class="detail-section">
            <h3>Passenger Information</h3>
            <div class="detail-row"><span class="detail-label">Name</span><span class="detail-value">${ticket.passenger}</span></div>
            <div class="detail-row"><span class="detail-label">Rank</span><span class="detail-value">${ticket.rank}</span></div>
            <div class="detail-row"><span class="detail-label">Seat</span><span class="detail-value">12A (Window)</span></div>
            <div class="detail-row"><span class="detail-label">Baggage</span><span class="detail-value">2 x 23kg</span></div>
        </div>
    </div>
    
    <div class="barcode">
        <div class="barcode-text">||||| ${ticket.pnr} |||||</div>
        <div style="margin-top: 10px; color: #666; font-size: 12px;">Present this ticket at check-in</div>
    </div>
    
    <div style="margin-top: 30px; text-align: center; color: #999; font-size: 12px;">
        Generated by ATLANTIS ERP | ${new Date().toLocaleString()}
    </div>
</body>
</html>`;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                showNotification('âœ“ Print dialog opened', 'success');
            }, 500);
        }
        
        function downloadTicketPdf() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            showNotification('Generating e-ticket...', 'info');
            
            // Generate ticket content as text file (simulating PDF)
            const content = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ELECTRONIC TICKET                            â•‘
â•‘                    CROSSWORLD MARINE SERVICES                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  PNR: ${ticket.pnr.padEnd(20)} Status: ${ticket.status.toUpperCase().padEnd(15)}    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘      ${ticket.from}                    âœˆ                    ${ticket.to}        â•‘
â•‘    ${ticket.fromCity.padEnd(15)}    ${ticket.duration}           ${ticket.toCity.padEnd(15)} â•‘
â•‘                         Direct Flight                            â•‘
â•‘                                                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  FLIGHT INFORMATION                                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Date:        ${ticket.date.padEnd(20)}                          â•‘
â•‘  Departure:   ${ticket.time.padEnd(20)}                          â•‘
â•‘  Flight:      ${ticket.flight.padEnd(20)}                          â•‘
â•‘  Airline:     ${ticket.airline.padEnd(20)}                          â•‘
â•‘  Class:       Economy                                           â•‘
â•‘  Baggage:     2 x 23kg                                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  PASSENGER INFORMATION                                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Name:        ${ticket.passenger.padEnd(20)}                          â•‘
â•‘  Rank:        ${ticket.rank.padEnd(20)}                          â•‘
â•‘  Seat:        12A (Window)                                      â•‘
â•‘  Meal:        Regular                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  BOOKING DETAILS                                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Travel Type: ${ticket.type.padEnd(20)}                          â•‘
â•‘  Ticket Cost: $${ticket.price.toString().padEnd(19)}                          â•‘
â•‘  Booked By:   Maria Santos                                      â•‘
â•‘  Booked On:   2025-02-08                                        â•‘
â•‘  Payment:     PAID âœ“                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘            ||||| ${ticket.pnr} |||||                            â•‘
â•‘                                                                  â•‘
â•‘          Present this ticket at check-in counter                 â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Generated by ATLANTIS ERP | ${new Date().toLocaleString()}
`;
            
            setTimeout(() => {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'eticket_' + ticket.pnr + '_' + ticket.date + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('âœ“ E-ticket downloaded: ' + ticket.pnr, 'success');
            }, 800);
        }
        
        function cancelTicket() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            // Show confirmation modal
            openModal('cancelTicketConfirmModal');
            document.getElementById('cancelTicketPnr').textContent = ticket.pnr;
            document.getElementById('cancelTicketRoute').textContent = ticket.from + ' â†’ ' + ticket.to;
            document.getElementById('cancelTicketDate').textContent = ticket.date;
            document.getElementById('cancelTicketPassenger').textContent = ticket.passenger;
        }
        
        function confirmCancelTicket() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            const reason = document.getElementById('cancelReason').value;
            if (!reason) {
                showNotification('Please select a cancellation reason', 'warning');
                return;
            }
            
            ticket.status = 'cancelled';
            closeModal('cancelTicketConfirmModal');
            closeModal('ticketDetailModal');
            renderTickets();
            
            showNotification('âœ“ Ticket ' + ticket.pnr + ' has been cancelled', 'warning');
        }
        
        function modifyTicket() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            closeModal('ticketDetailModal');
            openModal('modifyTicketModal');
            
            // Populate form with current values
            document.getElementById('modifyTicketPnr').textContent = ticket.pnr;
            document.getElementById('modifyTicketFrom').value = ticket.from;
            document.getElementById('modifyTicketTo').value = ticket.to;
            document.getElementById('modifyTicketDate').value = ticket.date;
            document.getElementById('modifyTicketClass').value = 'economy';
            document.getElementById('modifyTicketNotes').value = '';
            
            lucide.createIcons();
        }
        
        function saveTicketModification() {
            const ticket = window.currentTicket;
            if (!ticket) return;
            
            const newDate = document.getElementById('modifyTicketDate').value;
            const notes = document.getElementById('modifyTicketNotes').value;
            
            if (!newDate) {
                showNotification('Please select a new date', 'warning');
                return;
            }
            
            // Update ticket
            ticket.date = newDate;
            ticket.status = 'pending'; // Set to pending for re-confirmation
            
            closeModal('modifyTicketModal');
            renderTickets();
            
            showNotification('âœ“ Modification request submitted for ' + ticket.pnr, 'success');
        }
        
        function saveNewTicket() {
            const passenger = document.getElementById('newTicketPassenger').value;
            const from = document.getElementById('newTicketFrom').value;
            const to = document.getElementById('newTicketTo').value;
            const date = document.getElementById('newTicketDate').value;
            
            if (!passenger || !from || !to || !date) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            closeModal('bookTicketModal');
            showNotification('âœ“ Ticket booking submitted for approval!', 'success');
        }

        // EVALUATIONS MODULE RENDERING
        function renderEvaluations() {
            const container = document.getElementById('evaluationsGrid');
            if (!container) return;
            
            const ratingFilter = document.getElementById('evalRatingFilter')?.value || '';
            const periodFilter = document.getElementById('evalPeriodFilter')?.value || '';
            const rankFilter = document.getElementById('evalRankFilter')?.value || '';
            const searchQuery = document.getElementById('evalSearchInput')?.value?.toLowerCase() || '';
            
            let evals = MOCK_EVALUATIONS;
            if (ratingFilter) evals = evals.filter(e => e.rating === ratingFilter);
            if (rankFilter) {
                const officers = ['Master', 'Chief Officer', '2nd Officer', '3rd Officer', 'Chief Engineer', '2nd Engineer', '3rd Engineer'];
                if (rankFilter === 'officers') evals = evals.filter(e => officers.includes(e.rank));
                else if (rankFilter === 'ratings') evals = evals.filter(e => !officers.includes(e.rank));
            }
            if (searchQuery) evals = evals.filter(e => e.name.toLowerCase().includes(searchQuery) || e.vessel.toLowerCase().includes(searchQuery));
            
            // Update stats
            const excellent = MOCK_EVALUATIONS.filter(e => e.rating === 'excellent').length;
            const good = MOCK_EVALUATIONS.filter(e => e.rating === 'good').length;
            const average = MOCK_EVALUATIONS.filter(e => e.rating === 'average').length;
            const avgScore = (MOCK_EVALUATIONS.reduce((sum, e) => sum + e.avgScore, 0) / MOCK_EVALUATIONS.length).toFixed(1);
            
            if (document.getElementById('evalExcellentCount')) document.getElementById('evalExcellentCount').textContent = excellent;
            if (document.getElementById('evalGoodCount')) document.getElementById('evalGoodCount').textContent = good;
            if (document.getElementById('evalAverageCount')) document.getElementById('evalAverageCount').textContent = average;
            if (document.getElementById('evalAvgScore')) document.getElementById('evalAvgScore').textContent = avgScore;
            
            container.innerHTML = evals.map(ev => renderEvalCard(ev)).join('');
            lucide.createIcons();
        }

        function renderEvalCard(ev) {
            const initials = ev.name.split(' ').map(n => n[0]).join('');
            const criteria = [
                { key: 'technical', label: 'Technical' },
                { key: 'teamwork', label: 'Teamwork' },
                { key: 'communication', label: 'Communication' },
                { key: 'reliability', label: 'Reliability' },
            ];
            
            const criteriaHtml = criteria.map(c => {
                const score = ev.scores[c.key];
                const stars = [1,2,3,4,5].map(s => '<svg class="' + (s <= score ? 'filled' : 'empty') + '"><use href="#star-icon"/></svg>').join('');
                return '<div class="eval-criterion"><span class="eval-criterion-label">' + c.label + '</span><div class="eval-criterion-stars">' + 
                    [1,2,3,4,5].map(s => '<i data-lucide="star" style="width:14px;height:14px;' + (s <= score ? 'color:#F59E0B;fill:#F59E0B;' : 'color:var(--cw-gray-300);') + '"></i>').join('') +
                '</div></div>';
            }).join('');
            
            return '<div class="eval-card" style="cursor:pointer;" onclick="openEvaluationDetail(\'' + ev.id + '\')">' +
                '<div class="eval-header">' +
                    '<div class="eval-avatar" onclick="event.stopPropagation(); openSeafarerProfile(\'' + ev.name + '\')">' + initials + '</div>' +
                    '<div class="eval-info"><div class="eval-name">' + ev.name + '</div><div class="eval-meta">' + ev.rank + ' â€¢ ' + ev.period + '</div></div>' +
                    '<div class="eval-score-badge ' + ev.rating + '"><div class="eval-score-value">' + ev.avgScore.toFixed(1) + '</div><div class="eval-score-label">' + ev.rating + '</div></div>' +
                '</div>' +
                '<div class="eval-body">' +
                    '<div class="eval-vessel"><i data-lucide="ship"></i><span>' + ev.vessel + ' â€¢ ' + ev.principal + '</span></div>' +
                    '<div class="eval-criteria" style="margin-top:12px;">' + criteriaHtml + '</div>' +
                    '<div class="eval-comment"><div class="eval-comment-text">"' + ev.comment + '"</div><div class="eval-comment-author">â€” ' + ev.evaluator + '</div></div>' +
                '</div>' +
                '<div class="eval-footer"><span>Evaluated: ' + ev.date + '</span><button class="btn btn-ghost btn-sm" onclick="event.stopPropagation(); openEvaluationDetail(\'' + ev.id + '\')">View Full Report</button></div>' +
            '</div>';
        }
        
        function filterEvalsByRating(rating) {
            const el = document.getElementById('evalRatingFilter');
            if (el) el.value = rating;
            renderEvaluations();
            showNotification('Filtering: ' + rating.charAt(0).toUpperCase() + rating.slice(1) + ' evaluations', 'info');
        }
        
        function exportEvaluations() {
            let csv = 'ID,Seafarer,Rank,Vessel,Principal,Period,Technical,Teamwork,Communication,Reliability,Avg Score,Rating,Evaluator,Comment,Date\n';
            MOCK_EVALUATIONS.forEach(e => {
                csv += '"' + e.id + '","' + e.name + '","' + e.rank + '","' + e.vessel + '","' + e.principal + '","' + e.period + '",' +
                    e.scores.technical + ',' + e.scores.teamwork + ',' + e.scores.communication + ',' + e.scores.reliability + ',' +
                    e.avgScore.toFixed(1) + ',"' + e.rating + '","' + e.evaluator + '","' + e.comment.replace(/"/g, '""') + '","' + e.date + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'evaluations_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Evaluations exported successfully!', 'success');
        }
        
        function openEvaluationDetail(evalId) {
            const ev = MOCK_EVALUATIONS.find(e => e.id === evalId);
            if (!ev) return;
            
            window.currentEvaluation = ev;
            const initials = ev.name.split(' ').map(n => n[0]).join('');
            
            // Populate modal
            document.getElementById('evalDetailInitials').textContent = initials;
            document.getElementById('evalDetailName').textContent = ev.name;
            document.getElementById('evalDetailRank').textContent = ev.rank;
            document.getElementById('evalDetailPeriod').textContent = ev.period;
            document.getElementById('evalDetailScore').textContent = ev.avgScore.toFixed(1);
            document.getElementById('evalDetailRating').textContent = ev.rating.charAt(0).toUpperCase() + ev.rating.slice(1);
            document.getElementById('evalDetailRating').className = 'eval-detail-rating-text ' + ev.rating;
            
            document.getElementById('evalDetailVessel').textContent = ev.vessel;
            document.getElementById('evalDetailPrincipal').textContent = ev.principal;
            document.getElementById('evalDetailDate').textContent = ev.date;
            document.getElementById('evalDetailEvaluator').textContent = ev.evaluator;
            
            // Score bars
            const criteria = ['technical', 'teamwork', 'communication', 'reliability'];
            criteria.forEach(c => {
                const score = ev.scores[c];
                const percent = (score / 5) * 100;
                document.getElementById('evalDetail' + c.charAt(0).toUpperCase() + c.slice(1) + 'Score').textContent = score.toFixed(1);
                document.getElementById('evalDetail' + c.charAt(0).toUpperCase() + c.slice(1) + 'Bar').style.width = percent + '%';
                
                // Star display
                const starsHtml = [1,2,3,4,5].map(s => 
                    '<i data-lucide="star" style="width:18px;height:18px;' + (s <= score ? 'color:#F59E0B;fill:#F59E0B;' : 'color:var(--cw-gray-300);') + '"></i>'
                ).join('');
                document.getElementById('evalDetail' + c.charAt(0).toUpperCase() + c.slice(1) + 'Stars').innerHTML = starsHtml;
            });
            
            // Comments
            document.getElementById('evalDetailComment').textContent = '"' + ev.comment + '"';
            document.getElementById('evalDetailCommentAuthor').textContent = 'â€” ' + ev.evaluator;
            
            // Performance summary
            const overallPercent = (ev.avgScore / 5) * 100;
            document.getElementById('evalDetailOverallBar').style.width = overallPercent + '%';
            document.getElementById('evalDetailOverallBar').style.background = ev.rating === 'excellent' ? 'var(--status-ready)' : ev.rating === 'good' ? '#3b82f6' : '#f59e0b';
            
            openModal('evaluationDetailModal');
        }
        
        function printEvaluation() {
            const ev = window.currentEvaluation;
            if (!ev) return;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Evaluation Report - ${ev.name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        .header { text-align: center; border-bottom: 3px solid #00495D; padding-bottom: 20px; margin-bottom: 30px; }
                        .logo { font-size: 24px; font-weight: bold; color: #00495D; }
                        .title { font-size: 20px; margin-top: 10px; }
                        .seafarer { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
                        .seafarer-name { font-size: 24px; font-weight: bold; }
                        .seafarer-rank { color: #666; }
                        .score-box { text-align: center; background: ${ev.rating === 'excellent' ? '#10b981' : ev.rating === 'good' ? '#3b82f6' : '#f59e0b'}; color: white; padding: 15px 25px; border-radius: 12px; }
                        .score-value { font-size: 32px; font-weight: bold; }
                        .score-label { font-size: 14px; text-transform: uppercase; }
                        .section { margin-bottom: 25px; }
                        .section-title { font-size: 14px; font-weight: bold; color: #00495D; text-transform: uppercase; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-bottom: 15px; }
                        .criterion { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: #f9f9f9; border-radius: 4px; }
                        .criterion-label { font-weight: 500; }
                        .criterion-score { font-weight: bold; }
                        .stars { color: #F59E0B; }
                        .comment { font-style: italic; padding: 20px; background: #f0fdf4; border-left: 4px solid #10b981; margin: 20px 0; }
                        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #999; }
                
        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="logo">CROSSWORLD MARINE SERVICES</div>
                        <div class="title">SEAFARER PERFORMANCE EVALUATION</div>
                    </div>
                    
                    <div class="seafarer">
                        <div>
                            <div class="seafarer-name">${ev.name}</div>
                            <div class="seafarer-rank">${ev.rank} â€¢ ${ev.period}</div>
                            <div style="margin-top:8px;color:#666;">${ev.vessel} â€¢ ${ev.principal}</div>
                        </div>
                        <div class="score-box">
                            <div class="score-value">${ev.avgScore.toFixed(1)}</div>
                            <div class="score-label">${ev.rating}</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Performance Criteria</div>
                        <div class="criterion"><span class="criterion-label">Technical Skills</span><span class="criterion-score">${ev.scores.technical}/5 ${'â˜…'.repeat(ev.scores.technical)}${'â˜†'.repeat(5-ev.scores.technical)}</span></div>
                        <div class="criterion"><span class="criterion-label">Teamwork</span><span class="criterion-score">${ev.scores.teamwork}/5 ${'â˜…'.repeat(ev.scores.teamwork)}${'â˜†'.repeat(5-ev.scores.teamwork)}</span></div>
                        <div class="criterion"><span class="criterion-label">Communication</span><span class="criterion-score">${ev.scores.communication}/5 ${'â˜…'.repeat(ev.scores.communication)}${'â˜†'.repeat(5-ev.scores.communication)}</span></div>
                        <div class="criterion"><span class="criterion-label">Reliability</span><span class="criterion-score">${ev.scores.reliability}/5 ${'â˜…'.repeat(ev.scores.reliability)}${'â˜†'.repeat(5-ev.scores.reliability)}</span></div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Evaluator's Comments</div>
                        <div class="comment">"${ev.comment}"<br><br>â€” ${ev.evaluator}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Evaluation Details</div>
                        <p><strong>Evaluation Date:</strong> ${ev.date}</p>
                        <p><strong>Evaluated By:</strong> ${ev.evaluator}</p>
                        <p><strong>Contract Period:</strong> ${ev.period}</p>
                    </div>
                    
                    <div class="footer">
                        <p>This document is computer generated by ATLANTIS ERP</p>
                        <p>Printed on: ${new Date().toLocaleString()}</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            setTimeout(() => { printWindow.print(); }, 500);
            showNotification('Print dialog opened', 'success');
        }
        
        function downloadEvaluationPdf() {
            const ev = window.currentEvaluation;
            if (!ev) return;
            
            const content = `
CROSSWORLD MARINE SERVICES
SEAFARER PERFORMANCE EVALUATION
=====================================

SEAFARER INFORMATION
--------------------
Name: ${ev.name}
Rank: ${ev.rank}
Contract Period: ${ev.period}
Vessel: ${ev.vessel}
Principal: ${ev.principal}

OVERALL RATING
--------------
Score: ${ev.avgScore.toFixed(1)} / 5.0
Rating: ${ev.rating.toUpperCase()}

PERFORMANCE CRITERIA
--------------------
Technical Skills:    ${ev.scores.technical}/5  ${'â˜…'.repeat(ev.scores.technical)}${'â˜†'.repeat(5-ev.scores.technical)}
Teamwork:            ${ev.scores.teamwork}/5  ${'â˜…'.repeat(ev.scores.teamwork)}${'â˜†'.repeat(5-ev.scores.teamwork)}
Communication:       ${ev.scores.communication}/5  ${'â˜…'.repeat(ev.scores.communication)}${'â˜†'.repeat(5-ev.scores.communication)}
Reliability:         ${ev.scores.reliability}/5  ${'â˜…'.repeat(ev.scores.reliability)}${'â˜†'.repeat(5-ev.scores.reliability)}

EVALUATOR'S COMMENTS
--------------------
"${ev.comment}"

â€” ${ev.evaluator}

EVALUATION DETAILS
------------------
Evaluation Date: ${ev.date}
Evaluated By: ${ev.evaluator}

=====================================
Generated by ATLANTIS ERP
Date: ${new Date().toLocaleString()}
            `.trim();
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'evaluation_' + ev.name.replace(/\s+/g, '_') + '_' + ev.date + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Evaluation report downloaded!', 'success');
        }
        
        function saveNewEvaluation() {
            const seafarer = document.getElementById('newEvalSeafarer').value;
            const vessel = document.getElementById('newEvalVessel').value;
            
            if (!seafarer || !vessel) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            closeModal('newEvaluationModal');
            showNotification('âœ“ Evaluation submitted successfully!', 'success');
            renderEvaluations();
        }

        // COMPLAINTS MODULE FUNCTIONS

        // ASSIGNMENT & PROPOSAL MODULE
        let currentCrewPool = 'all';
        
        function renderAssignmentBoard() {
            const container = document.getElementById('rfaMatrixGrid');
            console.log('renderAssignmentBoard called, container:', container);
            if (!container) {
                console.error('rfaMatrixGrid container not found!');
                return;
            }
            
            const statusFilter = document.getElementById('assignmentStatusFilter')?.value || '';
            const clientFilter = document.getElementById('assignmentClientFilter')?.value || '';
            const rankFilter = document.getElementById('assignmentRankFilter')?.value || '';
            const searchQuery = document.getElementById('assignmentSearchInput')?.value?.toLowerCase() || '';
            
            let rfas = MOCK_OPEN_RFAS;
            console.log('Total RFAs:', rfas.length);
            if (statusFilter) rfas = rfas.filter(r => r.status === statusFilter);
            if (clientFilter) rfas = rfas.filter(r => r.client === clientFilter);
            if (rankFilter) rfas = rfas.filter(r => r.rank === rankFilter);
            if (searchQuery) rfas = rfas.filter(r => r.id.toLowerCase().includes(searchQuery) || r.vessel.toLowerCase().includes(searchQuery) || r.rank.toLowerCase().includes(searchQuery));
            
            console.log('Filtered RFAs:', rfas.length);
            
            container.innerHTML = rfas.map(rfa => `
                <div class="rfa-matrix-card ${rfa.urgent ? 'urgent' : ''} ${rfa.proposalsCount > 0 ? 'has-proposals' : ''}" onclick="openRfaDetailsModal('${rfa.id}')">
                    <div class="rfa-card-header">
                        <span class="rfa-card-id">${rfa.id}</span>
                        <span class="rfa-card-type">${rfa.type}</span>
                    </div>
                    <div class="rfa-card-vessel">${rfa.vessel}</div>
                    <div class="rfa-card-rank"><strong>Rank:</strong> ${rfa.rank}</div>
                    ${rfa.urgent ? '<div style="color: #EF4444; font-size: 0.75rem; font-weight: 700;">âš  URGENT</div>' : ''}
                    <div class="rfa-card-meta">
                        <div><span class="rfa-meta-label">Client</span><br><span class="rfa-meta-value">${rfa.client}</span></div>
                        <div><span class="rfa-meta-label">Join</span><br><span class="rfa-meta-value">${new Date(rfa.joinDate).toLocaleDateString('en-GB', {day: '2-digit', month: 'short'})}</span></div>
                    </div>
                    <div class="rfa-card-proposals ${rfa.proposalsCount > 0 ? 'has-proposals' : ''}">
                        <span>Proposals</span><span class="proposals-count">${rfa.proposalsCount}</span>
                    </div>
                    <div class="rfa-card-footer">
                        <button class="rfa-card-btn" onclick="event.stopPropagation(); showNotification('Propose crew for ${rfa.id}', 'success')">Propose</button>
                        <button class="rfa-card-btn secondary" onclick="event.stopPropagation(); showNotification('View ${rfa.id}', 'info')">View</button>
                    </div>
                </div>
            `).join('');
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function renderCrewPool() {
            const container = document.getElementById('crewPoolList');
            if (!container) return;
            
            let crew = MOCK_CREW_POOL;
            if (currentCrewPool !== 'all') {
                crew = crew.filter(c => c.pool === currentCrewPool);
            }
            
            document.getElementById('crewPoolCount').textContent = crew.length;
            
            container.innerHTML = crew.map(c => {
                const initials = c.name.split(' ').map(n => n[0]).join('');
                const eligible = c.docsOK && c.restOK && c.quotaOK;
                return `
                    <div class="crew-pool-card ${eligible ? 'eligible' : ''}" onclick="openCrewDetailsModal('${c.id}')">
                        <div class="crew-card-header">
                            <div class="crew-card-avatar">${initials}</div>
                            <div class="crew-card-info">
                                <div class="crew-card-name">${c.name}</div>
                                <div class="crew-card-rank">${c.rank} â€¢ ${c.experience}</div>
                            </div>
                        </div>
                        <div class="crew-card-badges">
                            <span class="crew-badge ${c.pool}">${c.pool === 'dedicated' ? 'Dedicated' : 'Non-Dedicated'}</span>
                            <span class="crew-badge endorsed">${c.status}</span>
                        </div>
                        <div class="crew-eligibility">
                            <div class="eligibility-indicator ${c.docsOK ? 'ok' : 'error'}">
                                <i data-lucide="${c.docsOK ? 'check-circle' : 'x-circle'}"></i> Docs
                            </div>
                            <div class="eligibility-indicator ${c.restOK ? 'ok' : 'warning'}">
                                <i data-lucide="${c.restOK ? 'check-circle' : 'clock'}"></i> Rest
                            </div>
                            <div class="eligibility-indicator ${c.quotaOK ? 'ok' : 'error'}">
                                <i data-lucide="${c.quotaOK ? 'check-circle' : 'x-circle'}"></i> Quota
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function switchCrewPool(pool) {
            currentCrewPool = pool;
            document.querySelectorAll('.pool-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.pool === pool);
            });
            renderCrewPool();
        }
        
        function refreshAssignmentBoard() {
            showNotification('Board refreshed', 'success');
            renderAssignmentBoard();
            renderCrewPool();
        }
        
        function openCreateProposalModal() {
            const modalContent = `
                <div style="max-width: 700px;">
                    <h2 style="margin-bottom: 24px; color: var(--cw-gray-900);">
                        <i data-lucide="user-plus"></i> Create New Proposal
                    </h2>
                    
                    <div style="background: var(--cw-gray-50); padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                        <p style="color: var(--cw-gray-600); font-size: 0.9rem; margin: 0;">
                            Select an RFA and match it with an available crew member from the pool. The system will check eligibility automatically.
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Select RFA <span style="color: #EF4444;">*</span></label>
                        <select class="form-input" id="proposalRfaSelect" onchange="updateProposalDetails()">
                            <option value="">-- Select an RFA --</option>
                            ${MOCK_OPEN_RFAS.map(rfa => `
                                <option value="${rfa.id}">${rfa.id} - ${rfa.vessel} (${rfa.rank}) - ${rfa.client}</option>
                            `).join('')}
                        </select>
                    </div>
                    
                    <div id="rfaDetails" style="display: none; background: white; border: 2px solid var(--cw-gray-200); border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                        <h3 style="font-size: 0.95rem; font-weight: 700; color: var(--cw-gray-900); margin-bottom: 12px;">RFA Details</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.85rem;">
                            <div><span style="color: var(--cw-gray-600);">Vessel:</span> <strong id="rfaVessel">-</strong></div>
                            <div><span style="color: var(--cw-gray-600);">Rank:</span> <strong id="rfaRank">-</strong></div>
                            <div><span style="color: var(--cw-gray-600);">Client:</span> <strong id="rfaClient">-</strong></div>
                            <div><span style="color: var(--cw-gray-600);">Join Date:</span> <strong id="rfaJoinDate">-</strong></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Select Crew Member <span style="color: #EF4444;">*</span></label>
                        <select class="form-input" id="proposalCrewSelect">
                            <option value="">-- First select an RFA --</option>
                        </select>
                    </div>
                    
                    <div id="eligibilityChecks" style="display: none; margin-top: 20px;">
                        <h3 style="font-size: 0.95rem; font-weight: 700; color: var(--cw-gray-900); margin-bottom: 12px;">Eligibility Checks</h3>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                            <div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 8px; padding: 12px; text-align: center;">
                                <div id="docsCheck" style="font-size: 2rem;">-</div>
                                <div style="font-size: 0.75rem; color: var(--cw-gray-600); margin-top: 4px;">Documents</div>
                            </div>
                            <div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 8px; padding: 12px; text-align: center;">
                                <div id="restCheck" style="font-size: 2rem;">-</div>
                                <div style="font-size: 0.75rem; color: var(--cw-gray-600); margin-top: 4px;">Rest Period</div>
                            </div>
                            <div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 8px; padding: 12px; text-align: center;">
                                <div id="quotaCheck" style="font-size: 2rem;">-</div>
                                <div style="font-size: 0.75rem; color: var(--cw-gray-600); margin-top: 4px;">Quota</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <label class="form-label">Notes to Client (Optional)</label>
                        <textarea class="form-input" id="proposalNotes" rows="3" placeholder="Add any additional notes or remarks..."></textarea>
                    </div>
                    
                    <div class="modal-footer" style="margin-top: 24px; display: flex; gap: 12px; justify-content: flex-end;">
                        <button class="btn btn-secondary" onclick="closeModal('customModal')">
                            Cancel
                        </button>
                        <button class="btn btn-primary" onclick="submitNewProposal()" id="submitProposalBtn" disabled>
                            <i data-lucide="send"></i> Submit Proposal
                        </button>
                    </div>
                </div>
            `;
            
            showModal('customModal', modalContent);
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function updateProposalDetails() {
            const rfaId = document.getElementById('proposalRfaSelect').value;
            const rfaDetailsDiv = document.getElementById('rfaDetails');
            const crewSelect = document.getElementById('proposalCrewSelect');
            
            if (!rfaId) {
                rfaDetailsDiv.style.display = 'none';
                crewSelect.innerHTML = '<option value="">-- First select an RFA --</option>';
                document.getElementById('eligibilityChecks').style.display = 'none';
                document.getElementById('submitProposalBtn').disabled = true;
                return;
            }
            
            const rfa = MOCK_OPEN_RFAS.find(r => r.id === rfaId);
            if (rfa) {
                rfaDetailsDiv.style.display = 'block';
                document.getElementById('rfaVessel').textContent = rfa.vessel;
                document.getElementById('rfaRank').textContent = rfa.rank;
                document.getElementById('rfaClient').textContent = rfa.client;
                document.getElementById('rfaJoinDate').textContent = new Date(rfa.joinDate).toLocaleDateString('en-GB');
                
                // Filter crew by matching rank
                const matchingCrew = MOCK_CREW_POOL.filter(c => c.rank === rfa.rank);
                crewSelect.innerHTML = '<option value="">-- Select crew member --</option>' + 
                    matchingCrew.map(c => `<option value="${c.id}">${c.name} - ${c.rank} (${c.pool}, ${c.experience})</option>`).join('');
                
                // Add change listener for crew selection
                crewSelect.onchange = function() {
                    const crewId = this.value;
                    if (crewId) {
                        const crew = MOCK_CREW_POOL.find(c => c.id === crewId);
                        if (crew) {
                            showEligibilityChecks(crew);
                            document.getElementById('submitProposalBtn').disabled = false;
                        }
                    } else {
                        document.getElementById('eligibilityChecks').style.display = 'none';
                        document.getElementById('submitProposalBtn').disabled = true;
                    }
                };
            }
        }
        
        function showEligibilityChecks(crew) {
            document.getElementById('eligibilityChecks').style.display = 'block';
            document.getElementById('docsCheck').innerHTML = crew.docsOK ? '<span style="color: #10B981;">âœ“</span>' : '<span style="color: #EF4444;">âœ—</span>';
            document.getElementById('restCheck').innerHTML = crew.restOK ? '<span style="color: #10B981;">âœ“</span>' : '<span style="color: #F59E0B;">â°</span>';
            document.getElementById('quotaCheck').innerHTML = crew.quotaOK ? '<span style="color: #10B981;">âœ“</span>' : '<span style="color: #EF4444;">âœ—</span>';
        }
        
        function submitNewProposal() {
            const rfaId = document.getElementById('proposalRfaSelect').value;
            const crewId = document.getElementById('proposalCrewSelect').value;
            const notes = document.getElementById('proposalNotes').value;
            
            if (!rfaId || !crewId) {
                showNotification('Please select both RFA and crew member', 'error');
                return;
            }
            
            const rfa = MOCK_OPEN_RFAS.find(r => r.id === rfaId);
            const crew = MOCK_CREW_POOL.find(c => c.id === crewId);
            
            showNotification(`Proposal created: ${crew.name} for ${rfa.vessel} (${rfa.id})`, 'success');
            closeModal('customModal');
            
            // Update RFA proposals count
            rfa.proposalsCount++;
            renderAssignmentBoard();
        }

        // =====================================================
        // RFA DETAILS MODAL - COMPREHENSIVE VIEW
        // =====================================================
        function openRfaDetailsModal(rfaId) {
            console.log('openRfaDetailsModal called with ID:', rfaId);
            const rfa = MOCK_OPEN_RFAS.find(r => r.id === rfaId);
            console.log('Found RFA:', rfa);
            if (!rfa) {
                console.error('RFA not found!');
                return;
            }
            
            // Mock proposal history
            const mockProposals = [
                { id: 'PROP-001', crewName: 'John Martinez', crewRank: 'Chief Officer', submittedDate: '2026-02-10', status: 'Pending', docsOK: true, restOK: true, quotaOK: true },
                { id: 'PROP-002', crewName: 'Yuki Tanaka', crewRank: 'Chief Officer', submittedDate: '2026-02-09', status: 'Rejected', docsOK: true, restOK: false, quotaOK: true, rejectionReason: 'Insufficient rest period' }
            ];
            
            // Mock timeline events
            const timeline = [
                { date: '2026-02-12 09:30', event: 'RFA Created', user: 'Fleet Manager', icon: 'plus-circle', color: '#0891B2' },
                { date: '2026-02-10 14:15', event: 'Proposal Submitted', user: 'Maria Santos', icon: 'user-plus', color: '#10B981' },
                { date: '2026-02-09 11:00', event: 'Proposal Rejected', user: 'Client', icon: 'x-circle', color: '#EF4444' }
            ];
            
            const statusColors = { 'open': '#F59E0B', 'proposed': '#3B82F6', 'approved': '#10B981' };
            
            const modalContent = '<div style="max-width: 900px; width: 100%;"><div style="background: linear-gradient(135deg, var(--cw-primary) 0%, var(--cw-accent) 100%); padding: 24px; border-radius: 12px 12px 0 0; margin: -24px -24px 24px -24px;"><div style="display: flex; align-items: center; justify-content: space-between; color: white;"><div style="flex: 1;"><div style="font-size: 0.75rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 4px;">' + rfa.type + ' Request</div><h2 style="font-size: 1.75rem; font-weight: 700; margin: 0 0 8px 0;">' + rfa.id + '</h2><div style="font-size: 0.9rem; opacity: 0.9;"><i data-lucide="ship" style="width: 16px; height: 16px; display: inline-block; vertical-align: middle;"></i> ' + rfa.vessel + ' â€¢ IMO ' + rfa.imo + '</div></div><div style="text-align: right;"><div style="display: inline-block; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-bottom: 8px;">' + rfa.status.toUpperCase() + '</div>' + (rfa.urgent ? '<div style="background: rgba(239,68,68,0.2); color: #FEE2E2; padding: 6px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;"><i data-lucide="alert-triangle" style="width: 14px; height: 14px;"></i> URGENT</div>' : '') + '</div></div></div><div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;"><div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 20px; margin-bottom: 20px;"><h3 style="font-size: 1.1rem; font-weight: 700; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--cw-gray-100);"><i data-lucide="info"></i> Request Details</h3><div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;"><div><div style="font-size: 0.75rem; color: var(--cw-gray-500);">Rank Required</div><div style="font-size: 1rem; font-weight: 700;">' + rfa.rank + '</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500);">Client</div><div style="font-size: 1rem; font-weight: 700;">' + rfa.client + '</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500);">Join Date</div><div style="font-size: 1rem; font-weight: 700;"><i data-lucide="calendar" style="width: 14px; height: 14px;"></i> ' + new Date(rfa.joinDate).toLocaleDateString('en-GB') + '</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500);">Days Until</div><div style="font-size: 1rem; font-weight: 700; color: ' + (rfa.urgent ? '#EF4444' : '#10B981') + ';"><i data-lucide="clock" style="width: 14px; height: 14px;"></i> ' + rfa.daysUntil + ' days</div></div></div></div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 20px;"><h3 style="font-size: 1.1rem; font-weight: 700; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--cw-gray-100);"><i data-lucide="users"></i> Proposals (' + rfa.proposalsCount + ')</h3>' + (rfa.proposalsCount > 0 ? mockProposals.slice(0, rfa.proposalsCount).map(p => '<div style="background: var(--cw-gray-50); border: 1px solid var(--cw-gray-200); border-radius: 8px; padding: 14px; margin-bottom: 12px;"><div style="font-weight: 700;">' + p.crewName + '</div><div style="font-size: 0.8rem; color: var(--cw-gray-600);">' + p.crewRank + '</div><div style="margin-top: 8px; font-size: 0.75rem;">Submitted: ' + p.submittedDate + '</div></div>').join('') : '<div style="text-align: center; padding: 20px; color: var(--cw-gray-500);">No proposals yet</div>') + '</div></div><div><div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border: 2px solid #BAE6FD; border-radius: 12px; padding: 16px; margin-bottom: 16px;"><div style="text-align: center;"><div style="font-size: 0.75rem; color: var(--cw-gray-600);">Status</div><div style="font-size: 1.5rem; font-weight: 700; color: ' + statusColors[rfa.status] + ';">' + rfa.status.toUpperCase() + '</div></div></div><button class="btn btn-primary" style="width: 100%; margin-top: 12px;" onclick="closeModal(\'rfaDetailsModal\'); openCreateProposalModal();"><i data-lucide="user-plus"></i> Create Proposal</button></div></div><div style="margin-top: 24px; display: flex; justify-content: flex-end;"><button class="btn btn-secondary" onclick="closeModal(\'rfaDetailsModal\')">Close</button></div></div>';
            
            showModal('rfaDetailsModal', modalContent);
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        // =====================================================
        // CREW DETAILS MODAL - COMPREHENSIVE PROFILE VIEW
        // =====================================================
        function openCrewDetailsModal(crewId) {
            console.log('openCrewDetailsModal called with ID:', crewId);
            const crew = MOCK_CREW_POOL.find(c => c.id === crewId);
            console.log('Found Crew:', crew);
            if (!crew) {
                console.error('Crew not found!');
                return;
            }
            
            const initials = crew.name.split(' ').map(n => n[0]).join('');
            const poolColor = crew.pool === 'dedicated' ? '#0EA5E9' : '#8B5CF6';
            
            // Mock sea service history
            const seaService = [
                { vessel: 'MV EUROPA', rank: crew.rank, from: '2023-05-15', to: '2024-01-20', duration: '8 months' },
                { vessel: 'MV PACIFIC STAR', rank: 'Junior Officer', from: '2022-06-01', to: '2023-04-30', duration: '11 months' },
                { vessel: 'MV OCEAN PRIDE', rank: 'Cadet', from: '2021-03-15', to: '2022-05-15', duration: '14 months' }
            ];
            
            // Mock certificates
            const certificates = [
                { name: 'COC Class II', issueDate: '2023-01-15', expiryDate: '2028-01-15', status: 'valid', daysRemaining: 730 },
                { name: 'STCW Basic Safety', issueDate: '2021-06-20', expiryDate: '2026-06-20', status: 'valid', daysRemaining: 495 },
                { name: 'Medical Certificate', issueDate: '2025-08-10', expiryDate: '2026-08-10', status: 'expiring', daysRemaining: 180 },
                { name: 'Passport', issueDate: '2020-03-01', expiryDate: '2030-03-01', status: 'valid', daysRemaining: 1478 }
            ];
            
            const modalContent = '<div style="max-width: 900px; width: 100%;"><div style="background: linear-gradient(135deg, ' + poolColor + ' 0%, var(--cw-accent) 100%); padding: 24px; border-radius: 12px 12px 0 0; margin: -24px -24px 24px -24px;"><div style="display: flex; align-items: center; gap: 20px; color: white;"><div style="width: 80px; height: 80px; border-radius: 50%; background: rgba(255,255,255,0.25); display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 700; border: 4px solid rgba(255,255,255,0.4);">' + initials + '</div><div style="flex: 1;"><div style="font-size: 0.75rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 4px;">' + (crew.pool === 'dedicated' ? 'Dedicated Pool' : 'Non-Dedicated Pool') + '</div><h2 style="font-size: 1.75rem; font-weight: 700; margin: 0 0 8px 0;">' + crew.name + '</h2><div style="font-size: 1rem; opacity: 0.95;"><i data-lucide="anchor" style="width: 16px; height: 16px; display: inline-block; vertical-align: middle;"></i> ' + crew.rank + ' â€¢ ' + crew.experience + ' Experience</div></div><div style="text-align: right;"><div style="display: inline-block; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 0.85rem; font-weight: 600;">' + crew.status + '</div></div></div></div><div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;"><div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 20px; margin-bottom: 20px;"><h3 style="font-size: 1.1rem; font-weight: 700; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--cw-gray-100);"><i data-lucide="user"></i> Personal Details</h3><div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; font-size: 0.9rem;"><div><div style="font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 4px;">Crew ID</div><div style="font-weight: 700;">' + crew.id + '</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 4px;">Nationality</div><div style="font-weight: 700;">ðŸ‡µðŸ‡­ Philippines</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 4px;">Date of Birth</div><div style="font-weight: 700;">15 Mar 1990 (35y)</div></div><div><div style="font-size: 0.75rem; color: var(--cw-gray-500); text-transform: uppercase; margin-bottom: 4px;">Contact</div><div style="font-weight: 700;">+63 917 xxx xxxx</div></div></div></div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 20px; margin-bottom: 20px;"><h3 style="font-size: 1.1rem; font-weight: 700; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--cw-gray-100);"><i data-lucide="file-text"></i> Documents & Certificates</h3>' + certificates.map(cert => '<div style="background: var(--cw-gray-50); border-left: 3px solid ' + (cert.status === 'valid' ? '#10B981' : cert.status === 'expiring' ? '#F59E0B' : '#EF4444') + '; border-radius: 6px; padding: 12px; margin-bottom: 10px;"><div style="display: flex; justify-content: space-between; align-items: start;"><div><div style="font-weight: 700; font-size: 0.9rem; margin-bottom: 4px;">' + cert.name + '</div><div style="font-size: 0.75rem; color: var(--cw-gray-600);">Expires: ' + new Date(cert.expiryDate).toLocaleDateString('en-GB') + '</div></div><div style="text-align: right;"><div style="font-size: 0.7rem; font-weight: 600; color: ' + (cert.status === 'valid' ? '#059669' : '#D97706') + ';">' + cert.daysRemaining + ' days</div><div style="font-size: 0.65rem; padding: 2px 8px; background: ' + (cert.status === 'valid' ? 'rgba(16,185,129,0.1)' : 'rgba(245,158,11,0.1)') + '; color: ' + (cert.status === 'valid' ? '#059669' : '#D97706') + '; border-radius: 10px; margin-top: 4px;">' + cert.status.toUpperCase() + '</div></div></div></div>').join('') + '</div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 20px;"><h3 style="font-size: 1.1rem; font-weight: 700; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 2px solid var(--cw-gray-100);"><i data-lucide="ship"></i> Sea Service History</h3>' + seaService.map((service, idx) => '<div style="position: relative; padding-left: 20px; padding-bottom: ' + (idx === seaService.length - 1 ? '0' : '16px') + '; margin-bottom: ' + (idx === seaService.length - 1 ? '0' : '16px') + '; border-left: 2px solid var(--cw-gray-200);"><div style="position: absolute; left: -6px; top: 4px; width: 10px; height: 10px; background: var(--cw-accent); border-radius: 50%; border: 2px solid white;"></div><div style="font-weight: 700; font-size: 0.9rem; margin-bottom: 4px;">' + service.vessel + '</div><div style="font-size: 0.85rem; color: var(--cw-gray-700); margin-bottom: 4px;">' + service.rank + '</div><div style="font-size: 0.75rem; color: var(--cw-gray-500);">' + new Date(service.from).toLocaleDateString('en-GB') + ' - ' + new Date(service.to).toLocaleDateString('en-GB') + ' (' + service.duration + ')</div></div>').join('') + '</div></div><div><div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border: 2px solid #BAE6FD; border-radius: 12px; padding: 16px; margin-bottom: 16px;"><h4 style="font-size: 0.9rem; font-weight: 700; margin: 0 0 12px 0;">Eligibility Status</h4><div style="display: grid; grid-template-columns: 1fr; gap: 10px;">' + (['Docs', 'Rest', 'Quota'].map((check, i) => {const ok = i === 0 ? crew.docsOK : i === 1 ? crew.restOK : crew.quotaOK; return '<div style="display: flex; align-items: center; justify-content: space-between; padding: 10px; background: white; border-radius: 8px;"><span style="font-size: 0.85rem; font-weight: 600;">' + check + '</span><span style="font-size: 1.2rem;">' + (ok ? '<span style="color: #10B981;">âœ“</span>' : '<span style="color: #EF4444;">âœ—</span>') + '</span></div>';}).join('')) + '</div></div><div style="background: white; border: 2px solid var(--cw-gray-200); border-radius: 12px; padding: 16px; margin-bottom: 16px;"><h4 style="font-size: 0.9rem; font-weight: 700; margin: 0 0 12px 0;">Quick Actions</h4><div style="display: flex; flex-direction: column; gap: 8px;"><button class="btn btn-primary" style="width: 100%; justify-content: center;" onclick="closeModal(\'crewDetailsModal\'); openCreateProposalModal();"><i data-lucide="user-plus"></i> Propose for RFA</button><button class="btn btn-secondary" style="width: 100%; justify-content: center;" onclick="showNotification(\'Edit profile\', \'info\');"><i data-lucide="edit"></i> Edit Profile</button><button class="btn btn-secondary" style="width: 100%; justify-content: center;" onclick="showNotification(\'View full history\', \'info\');"><i data-lucide="history"></i> Full History</button></div></div><div style="background: var(--cw-gray-50); border: 1px solid var(--cw-gray-200); border-radius: 12px; padding: 16px;"><h4 style="font-size: 0.9rem; font-weight: 700; margin: 0 0 12px 0;"><i data-lucide="info"></i> Additional Info</h4><div style="font-size: 0.85rem; color: var(--cw-gray-700); line-height: 1.6;"><div style="margin-bottom: 6px;"><strong>Pool Type:</strong> ' + (crew.pool === 'dedicated' ? 'Dedicated' : 'Non-Dedicated') + '</div><div style="margin-bottom: 6px;"><strong>Last Vessel:</strong> MV EUROPA</div><div><strong>Total Sea Time:</strong> 33 months</div></div></div></div></div><div style="margin-top: 24px; display: flex; justify-content: flex-end; gap: 12px;"><button class="btn btn-secondary" onclick="closeModal(\'crewDetailsModal\')">Close</button><button class="btn btn-primary" onclick="closeModal(\'crewDetailsModal\'); openCreateProposalModal();"><i data-lucide="send"></i> Create Proposal</button></div></div>';
            
            showModal('crewDetailsModal', modalContent);
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }


        function renderComplaints() {
            const container = document.getElementById('complaintsGrid');
            if (!container) return;
            
            const statusFilter = document.getElementById('complaintStatusFilter')?.value || '';
            const categoryFilter = document.getElementById('complaintCategoryFilter')?.value || '';
            const priorityFilter = document.getElementById('complaintPriorityFilter')?.value || '';
            const searchQuery = document.getElementById('complaintSearchInput')?.value?.toLowerCase() || '';
            
            let complaints = MOCK_COMPLAINTS;
            if (statusFilter) complaints = complaints.filter(c => c.status === statusFilter);
            if (categoryFilter) complaints = complaints.filter(c => c.category === categoryFilter);
            if (priorityFilter) complaints = complaints.filter(c => c.priority === priorityFilter);
            if (searchQuery) complaints = complaints.filter(c => 
                c.id.toLowerCase().includes(searchQuery) || 
                c.seafarer.toLowerCase().includes(searchQuery) || 
                c.vessel.toLowerCase().includes(searchQuery) ||
                c.subject.toLowerCase().includes(searchQuery)
            );
            
            // Update stats
            const open = MOCK_COMPLAINTS.filter(c => c.status === 'open').length;
            const inProgress = MOCK_COMPLAINTS.filter(c => c.status === 'in-progress' || c.status === 'escalated').length;
            const resolved = MOCK_COMPLAINTS.filter(c => c.status === 'resolved' || c.status === 'closed').length;
            
            if (document.getElementById('complaintOpenCount')) document.getElementById('complaintOpenCount').textContent = open;
            if (document.getElementById('complaintProgressCount')) document.getElementById('complaintProgressCount').textContent = inProgress;
            if (document.getElementById('complaintResolvedCount')) document.getElementById('complaintResolvedCount').textContent = resolved;
            
            container.innerHTML = complaints.map(c => renderComplaintCard(c)).join('');
            lucide.createIcons();
        }
        
        function renderComplaintCard(c) {
            const categoryLabels = {
                'wages': 'ðŸ’° Wages & Benefits',
                'working-conditions': 'â° Working Conditions',
                'safety': 'âš ï¸ Safety & Health',
                'harassment': 'ðŸš« Harassment',
                'contract': 'ðŸ“„ Contract Issues',
                'food': 'ðŸ½ï¸ Food & Accommodation',
                'management': 'ðŸ‘” Management',
                'other': 'ðŸ“‹ Other'
            };
            
            const priorityColors = {
                'critical': '#dc2626',
                'high': '#f59e0b',
                'medium': '#3b82f6',
                'low': '#10b981'
            };
            
            const statusColors = {
                'open': '#ef4444',
                'in-progress': '#f59e0b',
                'escalated': '#dc2626',
                'resolved': '#10b981',
                'closed': '#6b7280'
            };
            
            const statusLabels = {
                'open': 'Open',
                'in-progress': 'In Progress',
                'escalated': 'Escalated',
                'resolved': 'Resolved',
                'closed': 'Closed'
            };
            
            return `<div class="complaint-card" style="background:white;border-radius:16px;border:1px solid var(--cw-gray-200);overflow:hidden;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 8px rgba(0,0,0,0.04);" onclick="openComplaintDetail('${c.id}')" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='0 12px 24px rgba(0,0,0,0.1)';" onmouseout="this.style.transform='';this.style.boxShadow='0 2px 8px rgba(0,0,0,0.04)';">
                <div style="padding:20px;border-bottom:1px solid var(--cw-gray-100);">
                    <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;">
                        <div>
                            <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                                <span style="font-weight:700;color:var(--cw-primary);">${c.id}</span>
                                <span style="background:${statusColors[c.status]};color:white;padding:2px 10px;border-radius:12px;font-size:0.75rem;font-weight:600;">${statusLabels[c.status]}</span>
                            </div>
                            <h4 style="margin:0;font-size:1rem;color:var(--cw-gray-800);line-height:1.4;">${c.subject}</h4>
                        </div>
                        <div style="background:${priorityColors[c.priority]}20;color:${priorityColors[c.priority]};padding:4px 10px;border-radius:8px;font-size:0.75rem;font-weight:600;text-transform:uppercase;">${c.priority}</div>
                    </div>
                    <p style="margin:0;font-size:0.9rem;color:var(--cw-gray-600);line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${c.description}</p>
                </div>
                <div style="padding:16px 20px;background:var(--cw-gray-50);">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div style="display:flex;gap:16px;font-size:0.85rem;color:var(--cw-gray-600);">
                            <span style="display:flex;align-items:center;gap:4px;"><i data-lucide="user" style="width:14px;height:14px;"></i>${c.anonymous ? 'Anonymous' : c.seafarer}</span>
                            <span style="display:flex;align-items:center;gap:4px;"><i data-lucide="ship" style="width:14px;height:14px;"></i>${c.vessel}</span>
                        </div>
                        <span style="background:var(--cw-gray-200);padding:4px 10px;border-radius:12px;font-size:0.75rem;">${categoryLabels[c.category] || c.category}</span>
                    </div>
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding-top:12px;border-top:1px solid var(--cw-gray-200);">
                        <span style="font-size:0.8rem;color:var(--cw-gray-500);">Submitted: ${c.dateSubmitted}</span>
                        ${c.status === 'open' || c.status === 'in-progress' ? `<span style="color:${c.daysOpen > 5 ? '#ef4444' : '#f59e0b'};font-weight:600;font-size:0.85rem;">${c.daysOpen} days open</span>` : `<span style="color:#10b981;font-size:0.85rem;">Resolved: ${c.resolvedDate || ''}</span>`}
                    </div>
                </div>
            </div>`;
        }
        
        function filterComplaintsByStatus(status) {
            const el = document.getElementById('complaintStatusFilter');
            if (el) el.value = status;
            renderComplaints();
            showNotification('Filtering: ' + status.charAt(0).toUpperCase() + status.slice(1) + ' complaints', 'info');
        }
        
        function openComplaintDetail(complaintId) {
            const c = MOCK_COMPLAINTS.find(comp => comp.id === complaintId);
            if (!c) return;
            
            window.currentComplaint = c;
            
            const categoryLabels = {
                'wages': 'ðŸ’° Wages & Benefits',
                'working-conditions': 'â° Working Conditions',
                'safety': 'âš ï¸ Safety & Health',
                'harassment': 'ðŸš« Harassment/Discrimination',
                'contract': 'ðŸ“„ Contract Issues',
                'food': 'ðŸ½ï¸ Food & Accommodation',
                'management': 'ðŸ‘” Management Issues',
                'other': 'ðŸ“‹ Other'
            };
            
            // Update header color based on priority
            const header = document.getElementById('complaintDetailHeader');
            if (c.priority === 'critical') {
                header.style.background = 'linear-gradient(135deg,#7f1d1d 0%,#dc2626 100%)';
            } else if (c.priority === 'high') {
                header.style.background = 'linear-gradient(135deg,#dc2626 0%,#ef4444 100%)';
            } else {
                header.style.background = 'linear-gradient(135deg,#ea580c 0%,#f97316 100%)';
            }
            
            document.getElementById('complaintDetailId').textContent = c.id;
            document.getElementById('complaintDetailSubject').textContent = c.subject;
            document.getElementById('complaintDetailStatus').textContent = c.status.toUpperCase().replace('-', ' ');
            document.getElementById('complaintDetailPriority').textContent = c.priority.toUpperCase();
            document.getElementById('complaintDetailDays').textContent = c.daysOpen;
            document.getElementById('complaintDetailSeafarer').textContent = c.anonymous ? 'Anonymous' : c.seafarer;
            document.getElementById('complaintDetailRank').textContent = c.rank;
            document.getElementById('complaintDetailVessel').textContent = c.vessel;
            document.getElementById('complaintDetailDate').textContent = c.dateSubmitted;
            document.getElementById('complaintDetailAssigned').textContent = c.assignedTo || 'Unassigned';
            document.getElementById('complaintDetailDescription').textContent = c.description;
            document.getElementById('complaintDetailCategory').textContent = categoryLabels[c.category] || c.category;
            document.getElementById('complaintTimelineSubmit').textContent = c.dateSubmitted + ' by ' + (c.anonymous ? 'Anonymous' : c.seafarer);
            
            openModal('complaintDetailModal');
        }
        
        function saveNewComplaint() {
            const seafarer = document.getElementById('newComplaintSeafarer').value;
            const vessel = document.getElementById('newComplaintVessel').value;
            const category = document.getElementById('newComplaintCategory').value;
            const priority = document.getElementById('newComplaintPriority').value;
            const subject = document.getElementById('newComplaintSubject').value;
            const description = document.getElementById('newComplaintDescription').value;
            
            if (!seafarer || !vessel || !category || !priority || !subject || !description) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            closeModal('newComplaintModal');
            showNotification('âœ“ Complaint submitted successfully! Reference: CMP-2025-' + String(Math.floor(Math.random() * 900) + 100).padStart(3, '0'), 'success');
            renderComplaints();
        }
        
        function updateComplaintStatus(newStatus) {
            const c = window.currentComplaint;
            if (!c) return;
            
            c.status = newStatus;
            if (newStatus === 'resolved') {
                c.daysOpen = 0;
                c.resolvedDate = new Date().toISOString().split('T')[0];
            }
            
            closeModal('complaintDetailModal');
            renderComplaints();
            showNotification('âœ“ Complaint ' + c.id + ' marked as ' + newStatus, 'success');
        }
        
        function escalateComplaint() {
            const c = window.currentComplaint;
            if (!c) return;
            
            c.status = 'escalated';
            c.priority = 'critical';
            c.assignedTo = 'HR Manager';
            
            closeModal('complaintDetailModal');
            renderComplaints();
            showNotification('âš ï¸ Complaint ' + c.id + ' escalated to HR Manager', 'warning');
        }
        
        function printComplaint() {
            const c = window.currentComplaint;
            if (!c) return;
            
            const categoryLabels = {
                'wages': 'Wages & Benefits', 'working-conditions': 'Working Conditions', 'safety': 'Safety & Health',
                'harassment': 'Harassment/Discrimination', 'contract': 'Contract Issues', 'food': 'Food & Accommodation',
                'management': 'Management Issues', 'other': 'Other'
            };
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Complaint Report - ${c.id}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        .header { text-align: center; border-bottom: 3px solid #dc2626; padding-bottom: 20px; margin-bottom: 30px; }
                        .logo { font-size: 24px; font-weight: bold; color: #00495D; }
                        .title { font-size: 20px; margin-top: 10px; color: #dc2626; }
                        .badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; margin: 0 4px; }
                        .badge-status { background: ${c.status === 'open' ? '#fee2e2' : c.status === 'resolved' ? '#d1fae5' : '#fef3c7'}; color: ${c.status === 'open' ? '#dc2626' : c.status === 'resolved' ? '#059669' : '#d97706'}; }
                        .badge-priority { background: ${c.priority === 'critical' ? '#dc2626' : c.priority === 'high' ? '#f59e0b' : '#3b82f6'}; color: white; }
                        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
                        .info-box { background: #f9fafb; padding: 15px; border-radius: 8px; }
                        .info-label { font-size: 12px; color: #6b7280; text-transform: uppercase; margin-bottom: 4px; }
                        .info-value { font-weight: 600; }
                        .section { margin-bottom: 25px; }
                        .section-title { font-size: 14px; font-weight: bold; color: #00495D; text-transform: uppercase; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-bottom: 15px; }
                        .description { background: #fef2f2; border-left: 4px solid #dc2626; padding: 15px; border-radius: 0 8px 8px 0; }
                        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #999; border-top: 1px solid #ddd; padding-top: 20px; }
                        .confidential { background: #fef3c7; padding: 10px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 12px; color: #92400e; }
                
        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="logo">CROSSWORLD MARINE SERVICES</div>
                        <div class="title">SEAFARER COMPLAINT/GRIEVANCE REPORT</div>
                        <div style="margin-top:15px;">
                            <span class="badge badge-status">${c.status.toUpperCase()}</span>
                            <span class="badge badge-priority">${c.priority.toUpperCase()}</span>
                        </div>
                    </div>
                    
                    <div class="confidential">âš ï¸ CONFIDENTIAL - MLC 2006 Compliant Document - Handle with discretion</div>
                    
                    <div class="section">
                        <div class="section-title">Complaint Information</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">Complaint ID</div><div class="info-value">${c.id}</div></div>
                            <div class="info-box"><div class="info-label">Date Submitted</div><div class="info-value">${c.dateSubmitted}</div></div>
                            <div class="info-box"><div class="info-label">Category</div><div class="info-value">${categoryLabels[c.category] || c.category}</div></div>
                            <div class="info-box"><div class="info-label">Days Open</div><div class="info-value">${c.daysOpen}</div></div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Complainant Details</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">Name</div><div class="info-value">${c.anonymous ? 'ANONYMOUS' : c.seafarer}</div></div>
                            <div class="info-box"><div class="info-label">Rank</div><div class="info-value">${c.rank}</div></div>
                            <div class="info-box"><div class="info-label">Vessel</div><div class="info-value">${c.vessel}</div></div>
                            <div class="info-box"><div class="info-label">Principal</div><div class="info-value">${c.principal}</div></div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Complaint Subject</div>
                        <p style="font-weight:600;font-size:16px;">${c.subject}</p>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Detailed Description</div>
                        <div class="description">${c.description}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Assignment & Resolution</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">Assigned To</div><div class="info-value">${c.assignedTo || 'Unassigned'}</div></div>
                            <div class="info-box"><div class="info-label">Resolution Date</div><div class="info-value">${c.resolvedDate || 'Pending'}</div></div>
                        </div>
                        ${c.resolution ? '<div class="info-box" style="margin-top:15px;"><div class="info-label">Resolution Notes</div><div class="info-value">' + c.resolution + '</div></div>' : ''}
                    </div>
                    
                    <div class="footer">
                        <p>This document is confidential and generated by ATLANTIS ERP</p>
                        <p>MLC 2006 Standard A5.1.5 - On-board complaint procedures</p>
                        <p>Printed on: ${new Date().toLocaleString()}</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            setTimeout(() => { printWindow.print(); }, 500);
            showNotification('Print dialog opened', 'success');
        }
        
        function downloadComplaintPdf() {
            const c = window.currentComplaint;
            if (!c) return;
            
            const categoryLabels = {
                'wages': 'Wages & Benefits', 'working-conditions': 'Working Conditions', 'safety': 'Safety & Health',
                'harassment': 'Harassment/Discrimination', 'contract': 'Contract Issues', 'food': 'Food & Accommodation',
                'management': 'Management Issues', 'other': 'Other'
            };
            
            const content = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           CROSSWORLD MARINE SERVICES - COMPLAINT REPORT                  â•‘
â•‘                    MLC 2006 COMPLIANT DOCUMENT                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  âš ï¸  CONFIDENTIAL - Handle with discretion                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMPLAINT INFORMATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Complaint ID:     ${c.id}
Date Submitted:   ${c.dateSubmitted}
Status:           ${c.status.toUpperCase()}
Priority:         ${c.priority.toUpperCase()}
Category:         ${categoryLabels[c.category] || c.category}
Days Open:        ${c.daysOpen}

COMPLAINANT DETAILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Name:             ${c.anonymous ? 'ANONYMOUS (Identity Protected)' : c.seafarer}
Rank:             ${c.rank}
Vessel:           ${c.vessel}
Principal:        ${c.principal}

COMPLAINT SUBJECT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
${c.subject}

DETAILED DESCRIPTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
${c.description}

ASSIGNMENT & HANDLING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Assigned To:      ${c.assignedTo || 'Unassigned'}
Resolution Date:  ${c.resolvedDate || 'Pending'}
${c.resolution ? '\nResolution Notes:\n' + c.resolution : ''}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Generated by ATLANTIS ERP | ${new Date().toLocaleString()}
MLC 2006 Standard A5.1.5 - On-board complaint procedures
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            `.trim();
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'complaint_' + c.id + '_' + new Date().toISOString().split('T')[0] + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('âœ“ Complaint report downloaded!', 'success');
        }
        
        function addComplaintNote() {
            const c = window.currentComplaint;
            if (!c) return;
            
            const noteText = document.getElementById('complaintNewNote').value.trim();
            if (!noteText) {
                showNotification('Please enter a note', 'warning');
                return;
            }
            
            // Add note to complaint history (in real app, this would save to database)
            if (!c.notes) c.notes = [];
            c.notes.push({
                text: noteText,
                author: 'Current User',
                date: new Date().toISOString()
            });
            
            document.getElementById('complaintNewNote').value = '';
            showNotification('âœ“ Note added to complaint ' + c.id, 'success');
        }
        
        function assignComplaintHandler() {
            const c = window.currentComplaint;
            if (!c) return;
            
            const assignee = document.getElementById('complaintAssignee').value;
            if (!assignee) {
                showNotification('Please select a handler', 'warning');
                return;
            }
            
            c.assignedTo = assignee;
            if (c.status === 'open') {
                c.status = 'in-progress';
            }
            
            document.getElementById('complaintDetailAssigned').textContent = assignee;
            renderComplaints();
            showNotification('âœ“ Complaint assigned to ' + assignee, 'success');
        }
        
        function resolveComplaintWithNotes() {
            const c = window.currentComplaint;
            if (!c) return;
            
            const noteText = document.getElementById('complaintNewNote').value.trim();
            if (noteText) {
                c.resolution = noteText;
            }
            
            c.status = 'resolved';
            c.daysOpen = 0;
            c.resolvedDate = new Date().toISOString().split('T')[0];
            
            closeModal('complaintDetailModal');
            renderComplaints();
            showNotification('âœ“ Complaint ' + c.id + ' resolved successfully!', 'success');
        }
        
        function exportComplaints() {
            let csv = 'ID,Seafarer,Rank,Vessel,Principal,Category,Priority,Status,Subject,Description,Date Submitted,Assigned To,Days Open,Anonymous\n';
            MOCK_COMPLAINTS.forEach(c => {
                csv += '"' + c.id + '","' + c.seafarer + '","' + c.rank + '","' + c.vessel + '","' + c.principal + '","' + c.category + '","' + c.priority + '","' + c.status + '","' + c.subject + '","' + c.description.replace(/"/g, '""') + '","' + c.dateSubmitted + '","' + (c.assignedTo || '') + '",' + c.daysOpen + ',' + c.anonymous + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'complaints_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Complaints exported successfully!', 'success');
        }

        // VIEW CONFIG
        const VIEW_CONFIG = {
            'dashboard': { section: 'Overview', title: 'Dashboard' },
            'candidates': { section: 'Recruitment', title: 'Candidates' },
            'interviews': { section: 'Recruitment', title: 'Interviews' },
            'rfc-tasks': { section: 'Recruitment', title: 'RFC Tasks' },
            'talent-pool': { section: 'Recruitment', title: 'Talent-Pool Settings' },
            'seafarer-profile': { section: 'Crew Management', title: 'Seafarer Profile' },
            'clients': { section: 'Crew Operations', title: 'Clients' },
            'fleet': { section: 'Crew Operations', title: 'Fleet & Vessels' },
            'rfa-hub': { section: 'Crew Operations', title: 'RFA Hub' },
            'contracts': { section: 'Crew Operations', title: 'Contracts' },
            'rotation-plan': { section: 'Crew Operations', title: 'Rotation Plan' },
            'seafarer-roster': { section: 'Crew Management', title: 'Seafarer Roster' },
            'documents': { section: 'Crew Management', title: 'Documents' },
            'pending-transactions': { section: 'Crew Management', title: 'Pending Transactions' },
            'embarkation-prep': { section: 'Crew Management', title: 'Embarkation Prep' },
            'tickets': { section: 'Crew Management', title: 'Tickets' },
            'evaluations': { section: 'Crew Management', title: 'Evaluations' },
            'complaints': { section: 'Crew Management', title: 'Complaints' },
            'analytics': { section: 'Reports', title: 'Analytics' },
            'compliance': { section: 'Reports', title: 'Complaints Analytics' },
            'settings': { section: 'System', title: 'Settings' },
        };

        // NAVIGATION
        function navigateTo(viewId) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === viewId) item.classList.add('active');
            });
            document.querySelectorAll('.view').forEach(view => view.classList.remove('active'));
            const targetView = document.getElementById('view-' + viewId);
            if (targetView) targetView.classList.add('active');
            const config = VIEW_CONFIG[viewId];
            if (config) {
                document.getElementById('breadcrumb').innerHTML = '<span class="breadcrumb-item">' + config.section + '</span><span class="breadcrumb-separator">/</span><span class="breadcrumb-item active">' + config.title + '</span>';
            }
            document.getElementById('sidebar').classList.remove('open');
            if (viewId === 'seafarer-roster') renderRosterTable();
            else if (viewId === 'rfa-hub') renderRfaTable();
            else if (viewId === 'rotation-plan') renderRotationPlan();
            else if (viewId === 'candidates') renderKanbanBoard();
            else if (viewId === 'fleet') renderFleetGrid();
            else if (viewId === 'documents') renderDocumentsModule();
            else if (viewId === 'contracts') renderContractsGrid();
            else if (viewId === 'clients') renderClientsGrid();
            else if (viewId === 'analytics') lucide.createIcons();
            else if (viewId === 'rfc-tasks') renderRfcTasks();
            else if (viewId === 'interviews') renderInterviews();
            else if (viewId === 'embarkation-prep') renderEmbarkations();
            else if (viewId === 'pending-transactions') renderPendingTable();
            else if (viewId === 'tickets') renderTickets();
            else if (viewId === 'evaluations') renderEvaluations();
            else if (viewId === 'complaints') renderComplaints();
            else if (viewId === 'talent-pool') { renderChannelsTable(); if (typeof lucide !== 'undefined') lucide.createIcons(); }
            else if (viewId === 'seafarer-profile') { renderSeafarerProfile(); }
            lucide.createIcons();
        }

        // RENDER ROSTER TABLE
        function renderRosterTable() {
            const tbody = document.getElementById('rosterTableBody');
            if (!tbody) return;
            tbody.innerHTML = MOCK_SEAFARERS.map(s => {
                const initials = s.firstName[0] + s.lastName[0];
                const statusClass = 'status-' + s.status;
                const statusLabel = s.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                const docsPercent = Math.round((s.docsComplete / s.docsTotal) * 100);
                const docsClass = docsPercent === 100 ? 'complete' : docsPercent >= 70 ? 'warning' : 'danger';
                const dateClass = s.contractEnd && new Date(s.contractEnd) < new Date('2025-03-15') ? 'danger' : s.contractEnd && new Date(s.contractEnd) < new Date('2025-04-01') ? 'warning' : '';
                let tags = '<span class="tag tag-' + s.poolType + '">' + (s.poolType === 'dedicated' ? 'Dedicated' : 'Non-Ded') + '</span>';
                tags += '<span class="tag tag-' + (s.assigned ? 'assigned' : 'unassigned') + '">' + (s.assigned ? 'Assigned' : 'Unassigned') + '</span>';
                if (s.tags.includes('on-leave')) tags += '<span class="tag tag-on-leave">On Leave</span>';
                if (s.tags.includes('nfr')) tags += '<span class="tag tag-nfr">NFR</span>';
                return '<tr><td class="checkbox-cell"><div class="custom-checkbox" onclick="toggleCheckbox(this,\'roster\')"><i data-lucide="check" style="width:12px;height:12px;"></i></div></td><td><div class="avatar-cell clickable-seafarer" onclick="openSeafarerProfile(\'' + s.firstName + ' ' + s.lastName + '\')"><div class="avatar">' + initials + '</div><div class="avatar-info"><span class="avatar-name">' + s.firstName + ' ' + s.lastName + '</span><span class="avatar-meta">' + s.id + '</span></div></div></td><td><span class="badge badge-' + s.rankType + '">' + s.rank + '</span></td><td><span class="status-badge ' + statusClass + '"><span class="dot"></span>' + statusLabel + '</span></td><td class="tags-cell">' + tags + '</td><td class="text-cell"><div class="text-primary">' + (s.vessel || 'â€”') + '</div><div class="text-secondary">' + (s.vesselType || '') + '</div></td><td class="text-cell"><span class="text-primary">' + (s.principal || 'â€”') + '</span></td><td class="date-cell ' + dateClass + '">' + (s.contractEnd || 'â€”') + '</td><td class="progress-cell"><div class="progress-bar-wrapper"><div class="progress-bar"><div class="progress-bar-fill ' + docsClass + '" style="width:' + docsPercent + '%;"></div></div><span class="progress-text">' + s.docsComplete + '/' + s.docsTotal + '</span></div></td><td class="actions-cell"><button class="actions-btn"><i data-lucide="more-horizontal" style="width:18px;height:18px;"></i></button></td></tr>';
            }).join('');
            lucide.createIcons();
        }

        // RENDER RFA TABLE
        function renderRfaTable() {
            const tbody = document.getElementById('rfaTableBody');
            if (!tbody) return;
            
            // Get filter values
            const typeFilter = document.getElementById('rfaTypeFilter')?.value || '';
            const statusFilter = document.getElementById('rfaStatusFilter')?.value || '';
            const principalFilter = document.getElementById('rfaPrincipalFilter')?.value || '';
            const priorityFilter = document.getElementById('rfaPriorityFilter')?.value || '';
            const searchQuery = document.getElementById('rfaSearchInput')?.value?.toLowerCase() || '';
            
            // Filter RFAs
            let rfas = MOCK_RFAS;
            if (typeFilter) rfas = rfas.filter(r => r.type === typeFilter);
            if (statusFilter) rfas = rfas.filter(r => r.status === statusFilter);
            if (principalFilter) rfas = rfas.filter(r => r.principal === principalFilter);
            if (priorityFilter) rfas = rfas.filter(r => r.priority === priorityFilter);
            if (searchQuery) rfas = rfas.filter(r => 
                r.id.toLowerCase().includes(searchQuery) ||
                r.vessel.toLowerCase().includes(searchQuery) ||
                (r.seafarer && r.seafarer.toLowerCase().includes(searchQuery)) ||
                r.position.toLowerCase().includes(searchQuery)
            );
            
            // Update stats
            const allRfas = MOCK_RFAS;
            if (document.getElementById('rfaEmbarkCount')) document.getElementById('rfaEmbarkCount').textContent = allRfas.filter(r => r.type === 'embark').length;
            if (document.getElementById('rfaSignoffCount')) document.getElementById('rfaSignoffCount').textContent = allRfas.filter(r => r.type === 'signoff').length;
            if (document.getElementById('rfaPromotionCount')) document.getElementById('rfaPromotionCount').textContent = allRfas.filter(r => r.type === 'promotion').length;
            if (document.getElementById('rfaExtensionCount')) document.getElementById('rfaExtensionCount').textContent = allRfas.filter(r => r.type === 'extension').length;
            if (document.getElementById('rfaReplaceCount')) document.getElementById('rfaReplaceCount').textContent = allRfas.filter(r => r.type === 'replace').length;
            
            // Update count
            if (document.getElementById('rfaTableCount')) {
                document.getElementById('rfaTableCount').textContent = 'Showing ' + rfas.length + ' of ' + MOCK_RFAS.length + ' RFAs';
            }
            
            tbody.innerHTML = rfas.map(r => {
                const typeLabel = r.type.charAt(0).toUpperCase() + r.type.slice(1);
                const statusLabel = r.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                const statusClass = 'status-' + r.status;
                return '<tr><td><span class="font-mono" style="font-weight:600;cursor:pointer;color:var(--cw-accent);" onclick="openRfaPanel(\'' + r.id + '\')">' + r.id + '</span></td><td><span class="tag tag-' + r.type + '">' + typeLabel.toUpperCase() + '</span></td><td><span class="status-badge ' + statusClass + '"><span class="dot"></span>' + statusLabel + '</span></td><td class="text-cell"><div class="text-primary">' + r.vessel + '</div><div class="text-secondary">' + r.vesselType + '</div></td><td><span class="badge badge-officer">' + r.position + '</span></td><td>' + (r.seafarer || '<span class="text-muted">Unassigned</span>') + '</td><td class="date-cell">' + r.targetDate + '</td><td class="date-cell">' + r.createdDate + '</td><td class="actions-cell"><button class="actions-btn" onclick="openRfaPanel(\'' + r.id + '\')"><i data-lucide="more-horizontal" style="width:18px;height:18px;"></i></button></td></tr>';
            }).join('');
            lucide.createIcons();
        }
        
        function filterRfasByType(type) {
            const el = document.getElementById('rfaTypeFilter');
            if (el) el.value = type;
            renderRfaTable();
            showNotification('Filtering by: ' + type.charAt(0).toUpperCase() + type.slice(1), 'info');
        }
        
        function exportRfas() {
            let csv = 'RFA ID,Type,Status,Vessel,Vessel Type,Principal,Position,Seafarer,Priority,Target Date,Created Date\n';
            MOCK_RFAS.forEach(r => {
                csv += '"' + r.id + '","' + r.type + '","' + r.status + '","' + r.vessel + '","' + r.vesselType + '","' + r.principal + '","' + r.position + '","' + (r.seafarer || '') + '","' + r.priority + '","' + r.targetDate + '","' + r.createdDate + '"\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'rfa_export_' + new Date().toISOString().split('T')[0] + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('âœ“ RFA data exported successfully!', 'success');
        }

        // PANEL FUNCTIONS
        function openSeafarerPanel(id) {
            const s = MOCK_SEAFARERS.find(x => x.id === id);
            if (!s) return;
            const initials = s.firstName[0] + s.lastName[0];
            const statusClass = 'status-' + s.status;
            const statusLabel = s.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            const docsPercent = Math.round((s.docsComplete / s.docsTotal) * 100);
            const docsClass = docsPercent === 100 ? 'complete' : docsPercent >= 70 ? 'warning' : 'danger';
            let tags = '<span class="tag tag-' + s.poolType + '">' + (s.poolType === 'dedicated' ? 'Dedicated' : 'Non-Dedicated') + '</span>';
            tags += '<span class="tag tag-' + (s.assigned ? 'assigned' : 'unassigned') + '">' + (s.assigned ? 'Assigned' : 'Unassigned') + '</span>';
            
            let html = '<div style="display:flex;align-items:center;gap:16px;margin-bottom:24px;"><div class="avatar" style="width:72px;height:72px;font-size:1.5rem;">' + initials + '</div><div><h2 style="font-size:1.25rem;font-weight:700;margin-bottom:4px;">' + s.firstName + ' ' + s.lastName + '</h2><p style="font-size:0.9rem;color:var(--cw-gray-500);">' + s.rank + ' â€¢ ' + s.id + '</p><span class="status-badge ' + statusClass + '" style="margin-top:8px;"><span class="dot"></span>' + statusLabel + '</span></div></div>';
            
            if (s.vessel) {
                html += '<div class="panel-section"><h4 class="panel-section-title">Current Assignment</h4><div class="info-box"><div class="info-grid"><div><div class="info-item-label">Vessel</div><div class="info-item-value">' + s.vessel + '</div></div><div><div class="info-item-label">Principal</div><div class="info-item-value">' + s.principal + '</div></div><div><div class="info-item-label">Vessel Type</div><div class="info-item-value">' + s.vesselType + '</div></div><div><div class="info-item-label">Contract End</div><div class="info-item-value font-mono">' + s.contractEnd + '</div></div></div></div></div>';
            }
            
            html += '<div class="panel-section"><h4 class="panel-section-title">Pool Information</h4><div style="display:flex;gap:8px;">' + tags + '</div></div>';
            html += '<div class="panel-section"><h4 class="panel-section-title">Document Status</h4><div class="info-box"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;"><span style="font-weight:600;">' + s.docsComplete + ' of ' + s.docsTotal + ' documents valid</span><span style="color:var(--status-' + (docsClass === 'complete' ? 'ready' : docsClass === 'warning' ? 'on-approval' : 'inactive') + ');font-weight:600;">' + docsPercent + '%</span></div><div class="progress-bar" style="height:8px;"><div class="progress-bar-fill ' + docsClass + '" style="width:' + docsPercent + '%;"></div></div></div></div>';
            html += '<div class="panel-section"><h4 class="panel-section-title">Contact Information</h4><div class="contact-list"><div class="contact-item"><i data-lucide="mail"></i><span>' + s.email + '</span></div><div class="contact-item"><i data-lucide="phone"></i><span>' + s.phone + '</span></div><div class="contact-item"><i data-lucide="map-pin"></i><span>' + s.location + '</span></div></div></div>';
            
            document.getElementById('seafarerPanelContent').innerHTML = html;
            openPanel('seafarerPanel');
        }

        function openRfaPanel(id) {
            const r = MOCK_RFAS.find(x => x.id === id);
            if (!r) return;
            
            // Store current RFA for actions
            window.currentRfa = r;
            
            const typeLabel = r.type.charAt(0).toUpperCase() + r.type.slice(1);
            const statusLabel = r.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            const statusClass = 'status-' + r.status;
            
            let html = '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;"><div><h2 style="font-size:1.25rem;font-weight:700;margin-bottom:4px;">' + r.id + '</h2><span class="tag tag-' + r.type + '" style="margin-right:8px;">' + typeLabel.toUpperCase() + '</span><span class="status-badge ' + statusClass + '"><span class="dot"></span>' + statusLabel + '</span></div></div>';
            html += '<div class="panel-section"><h4 class="panel-section-title">Request Details</h4><div class="info-box"><div class="info-grid"><div><div class="info-item-label">Vessel</div><div class="info-item-value">' + r.vessel + '</div></div><div><div class="info-item-label">Principal</div><div class="info-item-value">' + r.principal + '</div></div><div><div class="info-item-label">Position</div><div class="info-item-value">' + r.position + '</div></div><div><div class="info-item-label">Priority</div><div class="info-item-value" style="text-transform:capitalize;">' + r.priority + '</div></div><div><div class="info-item-label">Target Date</div><div class="info-item-value font-mono">' + r.targetDate + '</div></div><div><div class="info-item-label">Created</div><div class="info-item-value font-mono">' + r.createdDate + '</div></div></div></div></div>';
            
            if (r.seafarer) {
                const initials = r.seafarer.split(' ').map(n => n[0]).join('');
                html += '<div class="panel-section"><h4 class="panel-section-title">Assigned Seafarer</h4><div class="info-box"><div class="avatar-cell clickable-seafarer" onclick="openSeafarerProfile(\'' + r.seafarer + '\')"><div class="avatar">' + initials + '</div><div class="avatar-info"><span class="avatar-name">' + r.seafarer + '</span><span class="avatar-meta">' + r.position + '</span></div></div><button class="btn btn-secondary btn-sm mt-3" onclick="openAssignSeafarerModal()"><i data-lucide="user-x"></i>Change Seafarer</button></div></div>';
            } else {
                html += '<div class="panel-section"><h4 class="panel-section-title">Assigned Seafarer</h4><div class="info-box" style="text-align:center;padding:24px;"><span class="text-muted">No seafarer assigned yet</span><button class="btn btn-primary btn-sm mt-3" onclick="openAssignSeafarerModal()"><i data-lucide="user-plus"></i>Assign Seafarer</button></div></div>';
            }
            
            // Add Activity Timeline
            html += '<div class="panel-section"><h4 class="panel-section-title">Activity Timeline</h4><div class="info-box" style="padding:16px;"><div style="position:relative;padding-left:24px;border-left:2px solid var(--cw-gray-200);">';
            html += '<div style="position:relative;padding-bottom:16px;"><div style="position:absolute;left:-29px;width:10px;height:10px;border-radius:50%;background:#10b981;border:2px solid white;box-shadow:0 0 0 2px #10b981;"></div><div style="font-weight:600;font-size:0.9rem;">RFA Created</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">' + r.createdDate + ' by System</div></div>';
            if (r.status !== 'new') {
                html += '<div style="position:relative;padding-bottom:16px;"><div style="position:absolute;left:-29px;width:10px;height:10px;border-radius:50%;background:#f59e0b;border:2px solid white;box-shadow:0 0 0 2px #f59e0b;"></div><div style="font-weight:600;font-size:0.9rem;">Status Updated</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Changed to ' + statusLabel + '</div></div>';
            }
            html += '<div style="position:relative;"><div style="position:absolute;left:-29px;width:10px;height:10px;border-radius:50%;background:var(--cw-gray-300);border:2px solid white;box-shadow:0 0 0 2px var(--cw-gray-300);"></div><div style="font-weight:600;font-size:0.9rem;opacity:0.6;">Pending Next Action</div><div style="font-size:0.8rem;color:var(--cw-gray-500);">Awaiting updates</div></div>';
            html += '</div></div></div>';
            
            document.getElementById('rfaPanelContent').innerHTML = html;
            openPanel('rfaPanel');
        }

        function openPanel(panelId) {
            document.getElementById(panelId + 'Overlay').classList.add('open');
            document.getElementById(panelId).classList.add('open');
            lucide.createIcons();
        }

        function closePanel(panelId) {
            document.getElementById(panelId + 'Overlay').classList.remove('open');
            document.getElementById(panelId).classList.remove('open');
        }
        
        // RFA ACTION FUNCTIONS
        function cancelRfa() {
            const r = window.currentRfa;
            if (!r) return;
            
            document.getElementById('cancelRfaId').textContent = r.id;
            openModal('cancelRfaModal');
        }
        
        function confirmCancelRfa() {
            const r = window.currentRfa;
            if (!r) return;
            
            const reason = document.getElementById('cancelRfaReason').value;
            if (!reason) {
                showNotification('Please select a cancellation reason', 'warning');
                return;
            }
            
            r.status = 'cancelled';
            closeModal('cancelRfaModal');
            closePanel('rfaPanel');
            renderRfaTable();
            showNotification('âœ“ ' + r.id + ' has been cancelled', 'success');
        }
        
        function printRfa() {
            const r = window.currentRfa;
            if (!r) return;
            
            const typeLabel = r.type.charAt(0).toUpperCase() + r.type.slice(1);
            const statusLabel = r.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>RFA Details - ${r.id}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        .header { text-align: center; border-bottom: 3px solid #00495D; padding-bottom: 20px; margin-bottom: 30px; }
                        .logo { font-size: 24px; font-weight: bold; color: #00495D; }
                        .title { font-size: 20px; margin-top: 10px; }
                        .badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; margin: 0 4px; }
                        .badge-type { background: #00495D; color: white; }
                        .badge-status { background: #10b981; color: white; }
                        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
                        .info-box { background: #f9fafb; padding: 15px; border-radius: 8px; }
                        .info-label { font-size: 12px; color: #6b7280; text-transform: uppercase; margin-bottom: 4px; }
                        .info-value { font-weight: 600; }
                        .section { margin-bottom: 25px; }
                        .section-title { font-size: 14px; font-weight: bold; color: #00495D; text-transform: uppercase; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-bottom: 15px; }
                        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #999; border-top: 1px solid #ddd; padding-top: 20px; }
                
        /* Notification Animation */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="logo">CROSSWORLD MARINE SERVICES</div>
                        <div class="title">REQUEST FOR ACTION (RFA)</div>
                        <div style="margin-top:15px;">
                            <span class="badge badge-type">${typeLabel.toUpperCase()}</span>
                            <span class="badge badge-status">${statusLabel}</span>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">RFA Information</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">RFA ID</div><div class="info-value">${r.id}</div></div>
                            <div class="info-box"><div class="info-label">Type</div><div class="info-value">${typeLabel}</div></div>
                            <div class="info-box"><div class="info-label">Status</div><div class="info-value">${statusLabel}</div></div>
                            <div class="info-box"><div class="info-label">Priority</div><div class="info-value">${r.priority}</div></div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Vessel & Position Details</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">Vessel</div><div class="info-value">${r.vessel}</div></div>
                            <div class="info-box"><div class="info-label">Principal</div><div class="info-value">${r.principal}</div></div>
                            <div class="info-box"><div class="info-label">Position</div><div class="info-value">${r.position}</div></div>
                            <div class="info-box"><div class="info-label">Target Date</div><div class="info-value">${r.targetDate}</div></div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Assigned Seafarer</div>
                        <div class="info-box">
                            <div class="info-value">${r.seafarer || 'Not yet assigned'}</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">Dates</div>
                        <div class="info-grid">
                            <div class="info-box"><div class="info-label">Created Date</div><div class="info-value">${r.createdDate}</div></div>
                            <div class="info-box"><div class="info-label">Target Date</div><div class="info-value">${r.targetDate}</div></div>
                        </div>
                    </div>
                    
                    <div class="footer">
                        <p>Generated by ATLANTIS ERP | ${new Date().toLocaleString()}</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            setTimeout(() => { printWindow.print(); }, 500);
            showNotification('Print dialog opened', 'success');
        }
        
        function openAssignSeafarerModal() {
            const r = window.currentRfa;
            if (!r) return;
            
            document.getElementById('assignRfaId').textContent = r.id;
            document.getElementById('assignRfaPosition').textContent = r.position;
            document.getElementById('assignRfaVessel').textContent = r.vessel;
            
            openModal('assignSeafarerRfaModal');
        }
        
        function confirmAssignSeafarer() {
            const r = window.currentRfa;
            if (!r) return;
            
            const seafarer = document.getElementById('assignSeafarerSelect').value;
            if (!seafarer) {
                showNotification('Please select a seafarer', 'warning');
                return;
            }
            
            r.seafarer = seafarer;
            if (r.status === 'new') {
                r.status = 'in-progress';
            }
            
            closeModal('assignSeafarerRfaModal');
            closePanel('rfaPanel');
            renderRfaTable();
            showNotification('âœ“ ' + seafarer + ' assigned to ' + r.id, 'success');
            
            // Reopen panel to show updated info
            setTimeout(() => openRfaPanel(r.id), 300);
        }
        
        function saveRfaStatus() {
            const r = window.currentRfa;
            if (!r) return;
            
            const newStatus = document.getElementById('newRfaStatus').value;
            if (!newStatus) {
                showNotification('Please select a new status', 'warning');
                return;
            }
            
            r.status = newStatus;
            closeModal('updateRfaStatusModal');
            closePanel('rfaPanel');
            renderRfaTable();
            
            const statusLabel = newStatus.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            showNotification('âœ“ ' + r.id + ' status updated to ' + statusLabel, 'success');
            
            // Reopen panel to show updated info
            setTimeout(() => openRfaPanel(r.id), 300);
        }
        
        function saveNewRfa() {
            const form = document.getElementById('newRfaForm');
            const type = form.querySelector('select[required]').value;
            const vessel = form.querySelectorAll('select[required]')[1]?.value;
            const position = form.querySelectorAll('select[required]')[2]?.value;
            
            if (!type || !vessel || !position) {
                showNotification('Please fill all required fields', 'warning');
                return;
            }
            
            const newId = 'RFA-2025-' + String(Math.floor(Math.random() * 9000) + 1000).padStart(4, '0');
            closeModal('newRfaModal');
            showNotification('âœ“ ' + newId + ' created successfully!', 'success');
            renderRfaTable();
        }
        
        function openUpdateRfaStatusModal() {
            const r = window.currentRfa;
            if (!r) return;
            
            document.getElementById('updateRfaId').textContent = r.id;
            
            const statusLabel = r.status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
            const statusColors = {
                'new': '#3b82f6', 'in-progress': '#f59e0b', 'pending-approval': '#eab308', 
                'in-preparation': '#06b6d4', 'ready': '#10b981', 'approved': '#10b981',
                'completed': '#10b981', 'cancelled': '#ef4444'
            };
            const color = statusColors[r.status] || '#6b7280';
            
            document.getElementById('currentRfaStatus').innerHTML = '<span style="width:10px;height:10px;border-radius:50%;background:' + color + ';display:inline-block;margin-right:8px;"></span>' + statusLabel;
            document.getElementById('newRfaStatus').value = '';
            document.getElementById('rfaStatusNotes').value = '';
            
            openModal('updateRfaStatusModal');
        }
        
        // SEAFARER PROFILE FUNCTIONS
        function openSeafarerProfile(seafarerName) {
            // Find seafarer in mock data by name
            const nameParts = seafarerName.toLowerCase().split(' ');
            let seafarer = MOCK_SEAFARERS.find(s => 
                s.firstName.toLowerCase() === nameParts[0] && 
                (nameParts.length < 2 || s.lastName.toLowerCase().includes(nameParts[nameParts.length - 1]))
            );
            
            // Also check in pending transactions, embarkations, etc.
            if (!seafarer) {
                // Create a temporary seafarer object from the name
                const initials = seafarerName.split(' ').map(n => n[0]).join('');
                seafarer = {
                    firstName: nameParts[0] ? nameParts[0].charAt(0).toUpperCase() + nameParts[0].slice(1) : '',
                    lastName: nameParts.length > 1 ? nameParts[nameParts.length - 1].charAt(0).toUpperCase() + nameParts[nameParts.length - 1].slice(1) : '',
                    rank: 'Seafarer',
                    status: 'active',
                    email: seafarerName.toLowerCase().replace(' ', '.') + '@email.com',
                    phone: '+63 917 000 0000',
                    location: 'Philippines',
                    docsComplete: 20,
                    docsTotal: 24,
                    poolType: 'dedicated',
                    vessel: null,
                    contractEnd: null
                };
            }
            
            // Update panel content
            const initials = (seafarer.firstName[0] || '') + (seafarer.lastName[0] || '');
            document.getElementById('seafarerPanelAvatar').textContent = initials;
            document.getElementById('seafarerPanelName').textContent = seafarer.firstName + ' ' + seafarer.lastName;
            document.getElementById('seafarerPanelRank').textContent = seafarer.rank;
            
            // Status badge
            const statusEl = document.getElementById('seafarerPanelStatus');
            const statusLabels = { embarked: 'Embarked', 'on-preparation': 'On Preparation', ready: 'Ready', endorsed: 'Endorsed', 'on-approval': 'On Approval', inactive: 'Inactive' };
            statusEl.textContent = statusLabels[seafarer.status] || seafarer.status || 'Active';
            statusEl.className = 'tag tag-' + (seafarer.status || 'ready');
            
            // Contact info
            document.getElementById('seafarerEmail').textContent = seafarer.email || 'N/A';
            document.getElementById('seafarerPhone').textContent = seafarer.phone || 'N/A';
            document.getElementById('seafarerLocation').textContent = seafarer.location || 'N/A';
            
            // Documents count
            document.getElementById('seafarerDocsCount').textContent = (seafarer.docsComplete || 0) + '/' + (seafarer.docsTotal || 24);
            
            // Pool type
            document.getElementById('seafarerPoolType').textContent = seafarer.poolType === 'dedicated' ? 'Dedicated' : 'Non-dedicated';
            
            // Contract days
            if (seafarer.contractEnd) {
                const daysLeft = Math.ceil((new Date(seafarer.contractEnd) - new Date()) / (1000 * 60 * 60 * 24));
                document.getElementById('seafarerContractDays').textContent = daysLeft > 0 ? daysLeft + 'd' : 'Ended';
            } else {
                document.getElementById('seafarerContractDays').textContent = 'N/A';
            }
            
            // Assignment info
            if (seafarer.vessel) {
                document.getElementById('seafarerAssignment').style.display = 'block';
                document.getElementById('seafarerNoAssignment').style.display = 'none';
                document.getElementById('seafarerVessel').textContent = seafarer.vessel;
                document.getElementById('seafarerVesselType').textContent = (seafarer.vesselType || 'Vessel') + ' â€¢ ' + (seafarer.principal || 'Principal');
                document.getElementById('seafarerContractEnd').textContent = seafarer.contractEnd || 'N/A';
            } else {
                document.getElementById('seafarerAssignment').style.display = 'none';
                document.getElementById('seafarerNoAssignment').style.display = 'block';
            }
            
            // Store current seafarer for actions
            window.currentSeafarer = seafarer;
            
            // Open panel
            openPanel('seafarerPanel');
        }
        
        function viewSeafarerDocuments() {
            const seafarerName = window.currentSeafarer?.firstName + ' ' + window.currentSeafarer?.lastName || 'Seafarer';
            closePanel('seafarerPanel');
            navigateTo('documents');
            // Set search filter to seafarer name
            setTimeout(() => {
                const searchInput = document.getElementById('docSearchInput');
                if (searchInput) {
                    searchInput.value = window.currentSeafarer?.firstName || '';
                    renderDocumentsTable();
                }
            }, 300);
            showNotification('Viewing documents for ' + seafarerName, 'info');
        }
        
        function viewSeafarerContracts() {
            const seafarerName = window.currentSeafarer?.firstName + ' ' + window.currentSeafarer?.lastName || 'Seafarer';
            closePanel('seafarerPanel');
            navigateTo('contracts');
            showNotification('Viewing contracts for ' + seafarerName, 'info');
        }
        
        function sendSeafarerEmail() {
            const seafarer = window.currentSeafarer;
            if (!seafarer) {
                showNotification('No seafarer selected', 'warning');
                return;
            }
            
            const email = seafarer.email || '';
            const name = (seafarer.firstName + ' ' + seafarer.lastName) || 'Seafarer';
            
            if (email && email !== 'N/A') {
                // Create email with pre-filled subject
                const subject = encodeURIComponent('ATLANTIS ERP - Regarding your employment');
                const body = encodeURIComponent('Dear ' + name + ',\n\n\n\nBest regards,\nCrossworld Marine Services');
                window.open('mailto:' + email + '?subject=' + subject + '&body=' + body, '_blank');
                showNotification('Opening email to ' + name, 'success');
            } else {
                showNotification('No email address available for ' + name, 'warning');
            }
        }
        
        function viewSeafarerHistory() {
            const seafarer = window.currentSeafarer;
            if (!seafarer) return;
            
            openModal('seafarerHistoryModal');
            
            // Populate history modal
            const name = (seafarer.firstName + ' ' + seafarer.lastName) || 'Seafarer';
            document.getElementById('historySeafarerName').textContent = name;
            document.getElementById('historySeafarerId').textContent = seafarer.id || 'N/A';
            
            // Generate mock employment history
            const historyHtml = `
                <div class="history-item">
                    <div class="history-timeline"><div class="history-dot current"></div><div class="history-line"></div></div>
                    <div class="history-content">
                        <div class="history-badge current">Current</div>
                        <h4>${seafarer.vessel || 'Not Assigned'}</h4>
                        <p>${seafarer.rank || 'Seafarer'} â€¢ ${seafarer.principal || 'N/A'}</p>
                        <span class="history-date">Jan 2025 - Present</span>
                    </div>
                </div>
                <div class="history-item">
                    <div class="history-timeline"><div class="history-dot"></div><div class="history-line"></div></div>
                    <div class="history-content">
                        <h4>MV Pacific Voyager</h4>
                        <p>${seafarer.rank || 'Seafarer'} â€¢ Neda Maritime</p>
                        <span class="history-date">Jun 2024 - Dec 2024 (6 months)</span>
                    </div>
                </div>
                <div class="history-item">
                    <div class="history-timeline"><div class="history-dot"></div><div class="history-line"></div></div>
                    <div class="history-content">
                        <h4>MV Ocean Star</h4>
                        <p>${seafarer.rank || 'Seafarer'} â€¢ Diana Shipping</p>
                        <span class="history-date">Jan 2024 - May 2024 (5 months)</span>
                    </div>
                </div>
                <div class="history-item">
                    <div class="history-timeline"><div class="history-dot"></div></div>
                    <div class="history-content">
                        <h4>MV Centrofin Pride</h4>
                        <p>${seafarer.rank || 'Seafarer'} â€¢ Centrofin</p>
                        <span class="history-date">Jul 2023 - Dec 2023 (6 months)</span>
                    </div>
                </div>
            `;
            document.getElementById('employmentHistoryList').innerHTML = historyHtml;
            lucide.createIcons();
        }
        
        function editSeafarer() {
            const seafarer = window.currentSeafarer;
            if (!seafarer) return;
            
            closePanel('seafarerPanel');
            openModal('editSeafarerModal');
            
            // Populate edit form
            document.getElementById('editSeafarerName').textContent = (seafarer.firstName + ' ' + seafarer.lastName) || 'Seafarer';
            document.getElementById('editFirstName').value = seafarer.firstName || '';
            document.getElementById('editLastName').value = seafarer.lastName || '';
            document.getElementById('editEmail').value = seafarer.email || '';
            document.getElementById('editPhone').value = seafarer.phone || '';
            document.getElementById('editLocation').value = seafarer.location || '';
            document.getElementById('editRank').value = seafarer.rank || '';
            document.getElementById('editPoolType').value = seafarer.poolType || 'dedicated';
            document.getElementById('editStatus').value = seafarer.status || 'ready';
            
            lucide.createIcons();
        }
        window.editSeafarer = editSeafarer;
        
        function saveSeafarerEdit() {
            const seafarer = window.currentSeafarer;
            if (!seafarer) return;
            
            // Update local data (in production this would be an API call)
            seafarer.firstName = document.getElementById('editFirstName').value;
            seafarer.lastName = document.getElementById('editLastName').value;
            seafarer.email = document.getElementById('editEmail').value;
            seafarer.phone = document.getElementById('editPhone').value;
            seafarer.location = document.getElementById('editLocation').value;
            seafarer.rank = document.getElementById('editRank').value;
            seafarer.poolType = document.getElementById('editPoolType').value;
            seafarer.status = document.getElementById('editStatus').value;
            
            closeModal('editSeafarerModal');
            showNotification('Seafarer profile updated successfully!', 'success');
            
            // Refresh roster if visible
            renderRosterTable();
        }
        
        function exportSeafarerHistory() {
            const seafarer = window.currentSeafarer;
            if (!seafarer) return;
            
            const name = (seafarer.firstName + ' ' + seafarer.lastName) || 'Seafarer';
            const content = `EMPLOYMENT HISTORY REPORT
================================
Seafarer: ${name}
ID: ${seafarer.id || 'N/A'}
Rank: ${seafarer.rank || 'N/A'}
Generated: ${new Date().toLocaleString()}

EMPLOYMENT RECORDS
------------------

1. CURRENT ASSIGNMENT
   Vessel: ${seafarer.vessel || 'Not Assigned'}
   Principal: ${seafarer.principal || 'N/A'}
   Position: ${seafarer.rank || 'N/A'}
   Period: Jan 2025 - Present

2. PREVIOUS ASSIGNMENT
   Vessel: MV Pacific Voyager
   Principal: Neda Maritime
   Position: ${seafarer.rank || 'N/A'}
   Period: Jun 2024 - Dec 2024 (6 months)

3. PREVIOUS ASSIGNMENT
   Vessel: MV Ocean Star
   Principal: Diana Shipping
   Position: ${seafarer.rank || 'N/A'}
   Period: Jan 2024 - May 2024 (5 months)

4. PREVIOUS ASSIGNMENT
   Vessel: MV Centrofin Pride
   Principal: Centrofin
   Position: ${seafarer.rank || 'N/A'}
   Period: Jul 2023 - Dec 2023 (6 months)

================================
Total Sea Service: 2+ years
Report generated by ATLANTIS ERP`;

            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'employment_history_' + name.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Employment history exported!', 'success');
        }

        // MODAL FUNCTIONS
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('open');
            lucide.createIcons();
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.remove('open');
        }

        // Dynamic modal function for custom content
        function showModal(modalId, content) {
            let modal = document.getElementById(modalId);
            
            // Create modal if it doesn't exist
            if (!modal) {
                modal = document.createElement('div');
                modal.id = modalId;
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal" style="max-width: 960px;" onclick="event.stopPropagation()">
                        <button class="modal-close" onclick="closeModal('${modalId}')" style="position: absolute; top: 16px; right: 16px; z-index: 10;">
                            <i data-lucide="x"></i>
                        </button>
                        <div class="modal-body" id="${modalId}-body" style="max-height: 85vh; overflow-y: auto;"></div>
                    </div>
                `;
                modal.onclick = function() { closeModal(modalId); };
                document.body.appendChild(modal);
            }
            
            // Update content
            const modalBody = document.getElementById(`${modalId}-body`);
            if (modalBody) modalBody.innerHTML = content;
            
            // Open modal
            modal.classList.add('open');
            console.log('Modal opened:', modalId);
            
            // Recreate Lucide icons
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }


        function closeModalOnOverlay(event, modalId) {
            if (event.target === event.currentTarget) closeModal(modalId);
        }

        // CHECKBOX FUNCTIONS
        function toggleCheckbox(el, tableId) {
            el.classList.toggle('checked');
            const row = el.closest('tr');
            if (row) row.classList.toggle('selected', el.classList.contains('checked'));
            updateSelectedCount(tableId);
        }

        function toggleAllCheckboxes(tableId) {
            const headerCheckbox = event.currentTarget;
            const isChecked = headerCheckbox.classList.contains('checked');
            const tbody = document.getElementById(tableId + 'TableBody');
            const checkboxes = tbody.querySelectorAll('.custom-checkbox');
            checkboxes.forEach(cb => {
                if (isChecked) { cb.classList.remove('checked'); cb.closest('tr').classList.remove('selected'); }
                else { cb.classList.add('checked'); cb.closest('tr').classList.add('selected'); }
            });
            headerCheckbox.classList.toggle('checked');
            updateSelectedCount(tableId);
        }

        function updateSelectedCount(tableId) {
            const tbody = document.getElementById(tableId + 'TableBody');
            if (!tbody) return;
            const selected = tbody.querySelectorAll('.custom-checkbox.checked').length;
            const selectedActions = document.getElementById(tableId + 'SelectedActions');
            if (selectedActions) {
                if (selected > 0) { selectedActions.classList.add('show'); selectedActions.querySelector('.selected-count').textContent = selected + ' selected'; }
                else { selectedActions.classList.remove('show'); }
            }
        }

        // SIDEBAR TOGGLE
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }

        // SORT COLUMNS
        document.addEventListener('click', function(e) {
            if (e.target.closest('th.sortable')) {
                const th = e.target.closest('th');
                const allThs = th.closest('thead').querySelectorAll('th.sortable');
                allThs.forEach(t => { if (t !== th) t.classList.remove('sorted-asc', 'sorted-desc'); });
                if (th.classList.contains('sorted-asc')) { th.classList.remove('sorted-asc'); th.classList.add('sorted-desc'); }
                else if (th.classList.contains('sorted-desc')) { th.classList.remove('sorted-desc'); }
                else { th.classList.add('sorted-asc'); }
            }
        });

        // KEYBOARD SHORTCUTS
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.panel-overlay.open').forEach(overlay => { const panelId = overlay.id.replace('Overlay', ''); closePanel(panelId); });
                document.querySelectorAll('.modal-overlay.open').forEach(modal => { closeModal(modal.id); });
            }
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') { e.preventDefault(); document.getElementById('globalSearch').focus(); }
        });

        // ==========================================
        // ANALYTICS & CHARTS MODULE
        // ==========================================
        
        let chartsInitialized = false;
        const chartInstances = {};
        
        function switchAnalyticsTab(tabName) {
            document.querySelectorAll('.analytics-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.analytics-tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.analytics-tab[data-tab="${tabName}"]`)?.classList.add('active');
            document.getElementById('tab-' + tabName)?.classList.add('active');
            
            if (!chartsInitialized) {
                initializeAllCharts();
                chartsInitialized = true;
            }
            
            // Initialize travel charts when tab is selected
            if (tabName === 'travel' && !chartInstances.travelSpend) {
                initTravelCharts();
            }
            
            // Initialize evaluation analytics charts when tab is selected
            if (tabName === 'evaluations-analytics' && !chartInstances.evalRatingDist) {
                initEvalAnalyticsCharts();
            }
            
            // Initialize crew changes analytics charts when tab is selected
            if (tabName === 'crew-changes-analytics' && !chartInstances.crewChangesByPort) {
                initCrewChangesCharts();
            }
            
            lucide.createIcons();
        }
        
        function initializeAllCharts() {
            // Chart.js global defaults for 3D-like appearance
            Chart.defaults.font.family = "'Inter', 'SF Pro Display', sans-serif";
            Chart.defaults.plugins.legend.display = false;
            
            createEmbarkationsChart();
            createCrewDistributionChart();
            createPrincipalsChart();
            createRfcPerformanceChart();
            createDocumentComplianceChart();
            createSeafarersByRankChart();
            createPoolUtilizationChart();
            createSeafarerGrowthChart();
            createRecruitmentFunnelChart();
            createCandidateSourceChart();
            createRfcCompletionChart();
            createContractStatusChart();
            createPemeRateChart();
            createContractValueChart();
            createFleetByTypeChart();
            createVesselsByPrincipalChart();
            createFleetGrowthChart();
            createDocsByTypeChart();
            createExpiryDistributionChart();
            createComplianceTrendChart();
            initTravelCharts();
            initEvalAnalyticsCharts();
            initComplaintsAnalyticsCharts();
            initCrewChangesCharts();
            
            animateKPICounters();
        }
        
        function animateKPICounters() {
            document.querySelectorAll('.kpi-card-3d-value[data-count]').forEach(el => {
                const target = parseInt(el.dataset.count);
                let current = 0;
                const increment = target / 50;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    el.textContent = Math.floor(current).toLocaleString();
                }, 30);
            });
        }
        
        function createGradient(ctx, color1, color2) {
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, color1);
            gradient.addColorStop(1, color2);
            return gradient;
        }
        
        function createEmbarkationsChart() {
            const ctx = document.getElementById('embarkationsChart');
            if (!ctx) return;
            if (chartInstances.embarkations) { chartInstances.embarkations.destroy(); }
            const gradient1 = createGradient(ctx.getContext('2d'), 'rgba(0,73,93,0.8)', 'rgba(0,73,93,0.2)');
            const gradient2 = createGradient(ctx.getContext('2d'), 'rgba(5,150,105,0.8)', 'rgba(5,150,105,0.2)');
            chartInstances.embarkations = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    datasets: [{
                        label: 'Embarkations',
                        data: [89, 104, 96, 130, 116, 144, 136, 110, 156, 170, 124, 180],
                        borderColor: '#00495D',
                        backgroundColor: gradient1,
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                        pointBackgroundColor: '#00495D',
                        pointBorderColor: 'white',
                        pointBorderWidth: 2,
                        pointRadius: 5,
                        pointHoverRadius: 8
                    }, {
                        label: 'Sign-offs',
                        data: [78, 92, 88, 115, 105, 128, 120, 98, 140, 155, 112, 165],
                        borderColor: '#059669',
                        backgroundColor: gradient2,
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                        pointBackgroundColor: '#059669',
                        pointBorderColor: 'white',
                        pointBorderWidth: 2,
                        pointRadius: 5,
                        pointHoverRadius: 8
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'top' } }, scales: { y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } } }
            });
        }
        
        function createCrewDistributionChart() {
            const ctx = document.getElementById('crewDistributionChart');
            if (!ctx) return;
            chartInstances.crewDistribution = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Embarked', 'On Preparation', 'Ready Pool', 'Other'],
                    datasets: [{
                        data: [1456, 389, 512, 490],
                        backgroundColor: ['#059669', '#f59e0b', '#3b82f6', '#8b5cf6'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { display: true, position: 'bottom' } } }
            });
        }
        
        function createPrincipalsChart() {
            const ctx = document.getElementById('principalsChart');
            if (!ctx) return;
            chartInstances.principals = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Diana', 'Neda', 'Oldendorff', 'Centrofin', 'Mitsui', 'Pioneer'],
                    datasets: [{ data: [312, 289, 267, 178, 165, 134], backgroundColor: ['#00495D', '#0891b2', '#059669', '#8b5cf6', '#f59e0b', '#ef4444'], borderRadius: 8, borderSkipped: false }]
                },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, scales: { x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, y: { grid: { display: false } } } }
            });
        }
        
        function createRfcPerformanceChart() {
            const ctx = document.getElementById('rfcPerformanceChart');
            if (!ctx) return;
            chartInstances.rfcPerformance = new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Embark', 'Sign-off', 'Extension', 'Replace'],
                    datasets: [{ data: [28, 15, 7, 4], backgroundColor: ['rgba(5,150,105,0.7)', 'rgba(59,130,246,0.7)', 'rgba(245,158,11,0.7)', 'rgba(239,68,68,0.7)'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'bottom' } } }
            });
        }
        
        function createDocumentComplianceChart() {
            const ctx = document.getElementById('documentComplianceChart');
            if (!ctx) return;
            chartInstances.documentCompliance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Valid', 'Expiring 30d', 'Critical', 'Expired'],
                    datasets: [{ data: [11923, 156, 23, 45], backgroundColor: ['#059669', '#f59e0b', '#ef4444', '#6b7280'], borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: true, position: 'bottom' } } }
            });
        }
        
        function createSeafarersByRankChart() {
            const ctx = document.getElementById('seafarersByRankChart');
            if (!ctx) return;
            chartInstances.seafarersByRank = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Master', 'Ch.Officer', '2nd Officer', '3rd Officer', 'Ch.Engineer', '2nd Engineer', 'Bosun', 'AB Seaman', 'Oiler', 'Cook'],
                    datasets: [{ label: 'Officers', data: [89, 156, 201, 189, 92, 178, 0, 0, 0, 0], backgroundColor: '#00495D', borderRadius: 6 }, { label: 'Ratings', data: [0, 0, 0, 0, 0, 0, 234, 567, 389, 245], backgroundColor: '#0891b2', borderRadius: 6 }]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true, grid: { display: false } }, y: { stacked: true, grid: { color: 'rgba(0,0,0,0.05)' } } }, plugins: { legend: { display: true, position: 'top' } } }
            });
        }
        
        function createPoolUtilizationChart() {
            const ctx = document.getElementById('poolUtilizationChart');
            if (!ctx) return;
            chartInstances.poolUtilization = new Chart(ctx, {
                type: 'pie',
                data: { labels: ['Dedicated Pool', 'Non-dedicated Pool'], datasets: [{ data: [1856, 991], backgroundColor: ['#00495D', '#0891b2'], borderWidth: 0, hoverOffset: 15 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'bottom' } } }
            });
        }
        
        function createSeafarerGrowthChart() {
            const ctx = document.getElementById('seafarerGrowthChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(0,73,93,0.6)', 'rgba(0,73,93,0.05)');
            chartInstances.seafarerGrowth = new Chart(ctx, {
                type: 'line',
                data: { labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], datasets: [{ data: [2100, 2180, 2250, 2320, 2410, 2480, 2560, 2650, 2720, 2780, 2820, 2847], borderColor: '#00495D', backgroundColor: gradient, fill: true, tension: 0.4, borderWidth: 3, pointRadius: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } } }
            });
        }
        
        function createRecruitmentFunnelChart() {
            const ctx = document.getElementById('recruitmentFunnelChart');
            if (!ctx) return;
            chartInstances.recruitmentFunnel = new Chart(ctx, {
                type: 'bar',
                data: { labels: ['New', 'Screening', 'Interview', 'Negotiation', 'Endorsed', 'Rejected'], datasets: [{ data: [42, 28, 15, 8, 6, 12], backgroundColor: ['#3b82f6', '#0891b2', '#8b5cf6', '#f59e0b', '#059669', '#ef4444'], borderRadius: 8 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } } }
            });
        }
        
        function createCandidateSourceChart() {
            const ctx = document.getElementById('candidateSourceChart');
            if (!ctx) return;
            chartInstances.candidateSource = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Walk-in', 'Referral', 'Agency', 'Online'], datasets: [{ data: [35, 28, 22, 15], backgroundColor: ['#00495D', '#059669', '#8b5cf6', '#f59e0b'], borderWidth: 0, hoverOffset: 10 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { display: true, position: 'right' } } }
            });
        }
        
        function createRfcCompletionChart() {
            const ctx = document.getElementById('rfcCompletionChart');
            if (!ctx) return;
            chartInstances.rfcCompletion = new Chart(ctx, {
                type: 'bar',
                data: { labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], datasets: [{ label: 'Opened', data: [45, 52, 48, 65, 58, 72, 68, 55, 78, 85, 62, 47], backgroundColor: '#dc2626', borderRadius: 4 }, { label: 'Closed', data: [42, 48, 45, 60, 55, 68, 65, 52, 72, 80, 58, 23], backgroundColor: '#059669', borderRadius: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { grid: { display: false } } }, plugins: { legend: { display: true, position: 'top' } } }
            });
        }
        
        function createContractStatusChart() {
            const ctx = document.getElementById('contractStatusChart');
            if (!ctx) return;
            chartInstances.contractStatus = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Active', 'Draft', 'Pending PEME', 'Signed', 'Completed'], datasets: [{ data: [1456, 12, 23, 38, 3847], backgroundColor: ['#059669', '#6b7280', '#f59e0b', '#3b82f6', '#8b5cf6'], borderWidth: 0, hoverOffset: 12 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: true, position: 'right' } } }
            });
        }
        
        function createPemeRateChart() {
            const ctx = document.getElementById('pemeRateChart');
            if (!ctx) return;
            chartInstances.pemeRate = new Chart(ctx, {
                type: 'pie',
                data: { labels: ['Cleared', 'Pending', 'Scheduled', 'Failed'], datasets: [{ data: [92, 5, 2, 1], backgroundColor: ['#059669', '#f59e0b', '#3b82f6', '#ef4444'], borderWidth: 0, hoverOffset: 15 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: true, position: 'right' } } }
            });
        }
        
        function createContractValueChart() {
            const ctx = document.getElementById('contractValueChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(13,148,136,0.6)', 'rgba(13,148,136,0.05)');
            chartInstances.contractValue = new Chart(ctx, {
                type: 'line',
                data: { labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], datasets: [{ data: [4.2, 4.5, 4.8, 5.1, 5.4, 5.8, 6.1, 6.4, 6.8, 7.2, 7.5, 7.8], borderColor: '#0d9488', backgroundColor: gradient, fill: true, tension: 0.4, borderWidth: 3 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, ticks: { callback: v => '$' + v + 'M' } }, x: { grid: { display: false } } } }
            });
        }
        
        function createFleetByTypeChart() {
            const ctx = document.getElementById('fleetByTypeChart');
            if (!ctx) return;
            chartInstances.fleetByType = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Bulk Carrier', 'Tanker', 'Container', 'LNG', 'Other'], datasets: [{ data: [35, 24, 15, 10, 5], backgroundColor: ['#00495D', '#0891b2', '#8b5cf6', '#f59e0b', '#6b7280'], borderWidth: 0, hoverOffset: 12 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { display: true, position: 'right' } } }
            });
        }
        
        function createVesselsByPrincipalChart() {
            const ctx = document.getElementById('vesselsByPrincipalChart');
            if (!ctx) return;
            chartInstances.vesselsByPrincipal = new Chart(ctx, {
                type: 'bar',
                data: { labels: ['Diana', 'Neda', 'Oldendorff', 'Centrofin', 'Pioneer', 'Other'], datasets: [{ data: [18, 15, 14, 12, 10, 20], backgroundColor: ['#00495D', '#0891b2', '#059669', '#8b5cf6', '#f59e0b', '#6b7280'], borderRadius: 8 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { grid: { display: false } } } }
            });
        }
        
        function createFleetGrowthChart() {
            const ctx = document.getElementById('fleetGrowthChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(139,92,246,0.6)', 'rgba(139,92,246,0.05)');
            chartInstances.fleetGrowth = new Chart(ctx, {
                type: 'line',
                data: { labels: ['2020', '2021', '2022', '2023', '2024', '2025'], datasets: [{ data: [45, 52, 61, 72, 82, 89], borderColor: '#8b5cf6', backgroundColor: gradient, fill: true, tension: 0.4, borderWidth: 3, pointRadius: 6, pointBackgroundColor: '#8b5cf6' }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false }, x: { grid: { display: false } } } }
            });
        }
        
        function createDocsByTypeChart() {
            const ctx = document.getElementById('docsByTypeChart');
            if (!ctx) return;
            chartInstances.docsByType = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['STCW', 'Flag Docs', 'Medical', 'National', 'Company'], datasets: [{ data: [4500, 3200, 2800, 1500, 847], backgroundColor: ['#00495D', '#0891b2', '#059669', '#8b5cf6', '#f59e0b'], borderWidth: 0, hoverOffset: 12 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { display: true, position: 'right' } } }
            });
        }
        
        function createExpiryDistributionChart() {
            const ctx = document.getElementById('expiryDistributionChart');
            if (!ctx) return;
            chartInstances.expiryDistribution = new Chart(ctx, {
                type: 'bar',
                data: { labels: ['7 days', '30 days', '60 days', '90 days', '180 days', '365+ days'], datasets: [{ data: [23, 156, 245, 389, 567, 10921], backgroundColor: ['#ef4444', '#f59e0b', '#fbbf24', '#a3e635', '#22c55e', '#059669'], borderRadius: 8 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, type: 'logarithmic' }, x: { grid: { display: false } } } }
            });
        }
        
        function createComplianceTrendChart() {
            const ctx = document.getElementById('complianceTrendChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(5,150,105,0.6)', 'rgba(5,150,105,0.05)');
            chartInstances.complianceTrend = new Chart(ctx, {
                type: 'line',
                data: { labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], datasets: [{ data: [89.2, 90.1, 90.8, 91.2, 91.8, 92.0, 92.3, 92.5, 92.6, 92.7, 92.8, 92.8], borderColor: '#059669', backgroundColor: gradient, fill: true, tension: 0.4, borderWidth: 3 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 85, max: 100, ticks: { callback: v => v + '%' } }, x: { grid: { display: false } } } }
            });
        }
        
        // TRAVEL ANALYTICS CHARTS
        function createTravelSpendChart() {
            const ctx = document.getElementById('travelSpendChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(30,64,175,0.6)', 'rgba(30,64,175,0.05)');
            chartInstances.travelSpend = new Chart(ctx, {
                type: 'line',
                data: { 
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], 
                    datasets: [
                        { label: 'Monthly Spend', data: [85, 92, 78, 105, 98, 112, 125, 118, 135, 142, 128, 95], borderColor: '#1e40af', backgroundColor: gradient, fill: true, tension: 0.4, borderWidth: 3, yAxisID: 'y' },
                        { label: 'Bookings', data: [58, 62, 54, 72, 68, 78, 85, 80, 92, 98, 87, 65], borderColor: '#f59e0b', backgroundColor: 'transparent', borderWidth: 2, borderDash: [5,5], tension: 0.4, yAxisID: 'y1' }
                    ] 
                },
                options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, scales: { y: { type: 'linear', position: 'left', beginAtZero: true, ticks: { callback: v => '$' + v + 'K' }, grid: { color: 'rgba(0,0,0,0.05)' } }, y1: { type: 'linear', position: 'right', beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } }, plugins: { legend: { display: true, position: 'top' } } }
            });
        }
        
        function createTravelTypeChart() {
            const ctx = document.getElementById('travelTypeChart');
            if (!ctx) return;
            chartInstances.travelType = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Embarkation', 'Sign-off', 'Transit', 'Medical', 'Training'], datasets: [{ data: [412, 358, 77, 42, 28], backgroundColor: ['#1e40af', '#8b5cf6', '#f59e0b', '#ef4444', '#10b981'], borderWidth: 0, hoverOffset: 12 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: true, position: 'right', labels: { usePointStyle: true, padding: 15 } } } }
            });
        }
        
        function createTopAirlinesChart() {
            const ctx = document.getElementById('topAirlinesChart');
            if (!ctx) return;
            chartInstances.topAirlines = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Philippine Airlines', 'Singapore Airlines', 'Emirates', 'KLM', 'Qatar Airways', 'Cathay Pacific', 'Turkish Airlines', 'EVA Air'], 
                    datasets: [{ 
                        label: 'Bookings', 
                        data: [245, 178, 156, 134, 98, 72, 65, 48], 
                        backgroundColor: ['#1e40af', '#f59e0b', '#ef4444', '#3b82f6', '#8b5cf6', '#10b981', '#ec4899', '#06b6d4'],
                        borderRadius: 8 
                    }] 
                },
                options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', scales: { x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, y: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });
        }
        
        function createTopDestinationsChart() {
            const ctx = document.getElementById('topDestinationsChart');
            if (!ctx) return;
            chartInstances.topDestinations = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Singapore (SIN)', 'Amsterdam (AMS)', 'Rotterdam (RTM)', 'Dubai (DXB)', 'Piraeus (PIR)', 'Hamburg (HAM)', 'Hong Kong (HKG)', 'Tokyo (NRT)'], 
                    datasets: [{ 
                        label: 'Arrivals', 
                        data: [156, 98, 87, 74, 65, 52, 48, 35], 
                        backgroundColor: ['#10b981', '#8b5cf6', '#f59e0b', '#ef4444', '#3b82f6', '#ec4899', '#06b6d4', '#84cc16'],
                        borderRadius: 8 
                    }] 
                },
                options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', scales: { x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, y: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });
        }
        
        function createRouteCostChart() {
            const ctx = document.getElementById('routeCostChart');
            if (!ctx) return;
            chartInstances.routeCost = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['MNL-SIN', 'MNL-AMS', 'MNL-RTM', 'MNL-PIR', 'MNL-DXB', 'MNL-HAM', 'MNL-HKG'], 
                    datasets: [
                        { label: 'Average Cost', data: [485, 1245, 1320, 980, 720, 1180, 380], backgroundColor: '#1e40af', borderRadius: 4, barPercentage: 0.6 },
                        { label: 'Lowest Fare', data: [320, 890, 950, 720, 520, 850, 280], backgroundColor: '#10b981', borderRadius: 4, barPercentage: 0.6 }
                    ] 
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { callback: v => '$' + v }, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } }, plugins: { legend: { display: true, position: 'top' } } }
            });
        }
        
        function createMonthlyBookingsChart() {
            const ctx = document.getElementById('monthlyBookingsChart');
            if (!ctx) return;
            chartInstances.monthlyBookings = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], 
                    datasets: [
                        { label: 'Embarkation', data: [28, 32, 25, 38, 35, 42, 48, 45, 52, 58, 48, 35], backgroundColor: '#1e40af', borderRadius: 4, stack: 'stack0' },
                        { label: 'Sign-off', data: [24, 28, 22, 32, 30, 38, 42, 40, 48, 52, 42, 30], backgroundColor: '#8b5cf6', borderRadius: 4, stack: 'stack0' },
                        { label: 'Transit', data: [6, 7, 5, 8, 7, 10, 12, 10, 12, 14, 10, 8], backgroundColor: '#f59e0b', borderRadius: 4, stack: 'stack0' }
                    ] 
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, stacked: true, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { stacked: true, grid: { display: false } } }, plugins: { legend: { display: true, position: 'top' } } }
            });
        }
        
        function initTravelCharts() {
            createTravelSpendChart();
            createTravelTypeChart();
            createTopAirlinesChart();
            createTopDestinationsChart();
            createRouteCostChart();
            createMonthlyBookingsChart();
        }
        
        function initCrewChangesCharts() {
            createCrewChangesByPortChart();
            createCrewChangesStatusChart();
            populateCrewChangesTable();
        }
        
        function createCrewChangesByPortChart() {
            const ctx = document.getElementById('crewChangesByPortChart');
            if (!ctx) return;
            chartInstances.crewChangesByPort = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Piraeus', 'Singapore', 'Rotterdam', 'Dubai'],
                    datasets: [{
                        label: 'Crew Changes',
                        data: [3, 5, 2, 2],
                        backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#ef4444'],
                        borderRadius: 8,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } }, x: { grid: { display: false } } }
                }
            });
        }
        
        function createCrewChangesStatusChart() {
            const ctx = document.getElementById('crewChangesStatusChart');
            if (!ctx) return;
            chartInstances.crewChangesStatus = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Confirmed', 'Planning'],
                    datasets: [{
                        data: [6, 6],
                        backgroundColor: ['#10b981', '#3b82f6'],
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: { legend: { display: true, position: 'bottom' } }
                }
            });
        }
        
        function populateCrewChangesTable() {
            const tableBody = document.getElementById('crewChangesTableBody');
            if (!tableBody || !MOCK_CREW_CHANGES) return;
            tableBody.innerHTML = '';
            MOCK_CREW_CHANGES.forEach(function(cc) {
                const row = document.createElement('tr');
                const typeClass = cc.type === 'embark' ? 'badge-success' : 'badge-danger';
                const typeLabel = cc.type === 'embark' ? 'Embarkation' : 'Sign-off';
                const statusClass = cc.status === 'confirmed' ? 'badge-success' : 'badge-primary';
                row.innerHTML = '<td>' + cc.date + '</td><td>' + cc.name + '</td><td>' + cc.rank + '</td><td>' + cc.vessel + '</td><td>' + cc.port + '</td><td><span class="badge ' + typeClass + '">' + typeLabel + '</span></td><td><span class="badge ' + statusClass + '">' + cc.status + '</span></td>';
                tableBody.appendChild(row);
            });
        }
        
        function exportTravelAnalytics() {
            showNotification('Generating Travel Analytics Report...', 'info');
            setTimeout(() => {
                const report = `ATLANTIS Travel Analytics Report
Generated: ${new Date().toLocaleString()}
=====================================

EXECUTIVE SUMMARY
-----------------
Total Bookings (YTD): 847
Total Spend (YTD): $1,247,850
Average Ticket Cost: $1,473
Cost Savings vs Last Year: -12%

BOOKING STATUS
--------------
Confirmed: 724 (85.5%)
Pending: 47 (5.5%)
Completed: 53 (6.3%)
Cancelled: 23 (2.7%)

TRAVEL TYPE BREAKDOWN
--------------------
Embarkation: 412 (48.6%)
Sign-off: 358 (42.3%)
Transit: 77 (9.1%)

TOP 5 ROUTES BY VOLUME
---------------------
1. Manila â†’ Singapore: 156 bookings ($75,660)
2. Manila â†’ Amsterdam: 98 bookings ($122,010)
3. Manila â†’ Rotterdam: 87 bookings ($114,840)
4. Manila â†’ Piraeus: 74 bookings ($72,520)
5. Manila â†’ Dubai: 65 bookings ($46,800)

TOP AIRLINES
-----------
1. Philippine Airlines: 245 bookings
2. Singapore Airlines: 178 bookings
3. Emirates: 156 bookings
4. KLM: 134 bookings
5. Qatar Airways: 98 bookings

COST ANALYSIS
-------------
Highest Avg Cost Route: MNL-RTM ($1,320)
Lowest Avg Cost Route: MNL-HKG ($380)
Best Value Route: MNL-SIN ($485)

=====================================
Report generated by ATLANTIS ERP v2.18`;

                const blob = new Blob([report], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'travel_analytics_report_' + new Date().toISOString().split('T')[0] + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('âœ“ Travel Analytics Report exported!', 'success');
            }, 1000);
        }
        
        // EVALUATIONS ANALYTICS CHARTS
        function createEvalRatingDistChart() {
            const ctx = document.getElementById('evalRatingDistChart');
            if (!ctx) return;
            chartInstances.evalRatingDist = new Chart(ctx, {
                type: 'doughnut',
                data: { 
                    labels: ['Excellent', 'Good', 'Average', 'Needs Improvement'], 
                    datasets: [{ 
                        data: [823, 712, 267, 45], 
                        backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#ef4444'],
                        borderWidth: 0,
                        hoverOffset: 15
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    cutout: '65%',
                    plugins: { 
                        legend: { display: true, position: 'bottom', labels: { usePointStyle: true, padding: 20 } }
                    }
                }
            });
        }
        
        function createEvalScoreTrendChart() {
            const ctx = document.getElementById('evalScoreTrendChart');
            if (!ctx) return;
            chartInstances.evalScoreTrend = new Chart(ctx, {
                type: 'line',
                data: { 
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], 
                    datasets: [
                        { label: 'Overall', data: [4.0, 4.05, 4.08, 4.12, 4.15, 4.18, 4.2, 4.22, 4.2, 4.18, 4.22, 4.25], borderColor: '#10b981', backgroundColor: 'rgba(16,185,129,0.1)', fill: true, tension: 0.4, borderWidth: 3 },
                        { label: 'Officers', data: [4.2, 4.22, 4.25, 4.28, 4.3, 4.35, 4.38, 4.4, 4.38, 4.35, 4.4, 4.42], borderColor: '#3b82f6', backgroundColor: 'transparent', tension: 0.4, borderWidth: 2, borderDash: [5,5] },
                        { label: 'Ratings', data: [3.8, 3.85, 3.88, 3.92, 3.95, 3.98, 4.0, 4.02, 4.0, 3.98, 4.02, 4.05], borderColor: '#f59e0b', backgroundColor: 'transparent', tension: 0.4, borderWidth: 2, borderDash: [5,5] }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: { 
                        y: { min: 3.5, max: 5, ticks: { callback: v => v.toFixed(1) }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }
        
        function createEvalCriteriaChart() {
            const ctx = document.getElementById('evalCriteriaChart');
            if (!ctx) return;
            chartInstances.evalCriteria = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Technical Skills', 'Teamwork', 'Communication', 'Reliability', 'Leadership', 'Safety Awareness'], 
                    datasets: [{ 
                        label: 'Average Score',
                        data: [4.3, 4.4, 4.1, 4.2, 4.0, 4.5], 
                        backgroundColor: ['#10b981', '#3b82f6', '#8b5cf6', '#f59e0b', '#ec4899', '#06b6d4'],
                        borderRadius: 8,
                        barThickness: 40
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: { 
                        x: { min: 0, max: 5, grid: { color: 'rgba(0,0,0,0.05)' } },
                        y: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createEvalByRankChart() {
            const ctx = document.getElementById('evalByRankChart');
            if (!ctx) return;
            chartInstances.evalByRank = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Master', 'Chief Officer', 'Chief Engineer', '2nd Officer', '2nd Engineer', 'Bosun', 'AB Seaman', 'Oiler'], 
                    datasets: [{ 
                        label: 'Avg Score',
                        data: [4.5, 4.4, 4.3, 4.2, 4.1, 4.0, 3.9, 3.8], 
                        backgroundColor: 'rgba(245,158,11,0.8)',
                        borderColor: '#f59e0b',
                        borderWidth: 2,
                        borderRadius: 6
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { min: 3, max: 5, ticks: { callback: v => v.toFixed(1) }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createEvalByPrincipalChart() {
            const ctx = document.getElementById('evalByPrincipalChart');
            if (!ctx) return;
            chartInstances.evalByPrincipal = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Diana Shipping', 'Centrofin', 'Pioneer Marine', 'Neda Maritime', 'Oldendorff', 'Eastern Med'], 
                    datasets: [{ 
                        label: 'Avg Rating',
                        data: [4.5, 4.3, 4.2, 4.1, 4.0, 3.9], 
                        backgroundColor: ['#00495D', '#0891b2', '#059669', '#8b5cf6', '#f59e0b', '#ec4899'],
                        borderRadius: 8
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { min: 3, max: 5, ticks: { callback: v => v.toFixed(1) }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createEvalByVesselTypeChart() {
            const ctx = document.getElementById('evalByVesselTypeChart');
            if (!ctx) return;
            chartInstances.evalByVesselType = new Chart(ctx, {
                type: 'polarArea',
                data: { 
                    labels: ['Bulk Carrier', 'Tanker', 'Container', 'LNG Carrier', 'General Cargo'], 
                    datasets: [{ 
                        data: [4.3, 4.2, 4.1, 4.4, 3.9], 
                        backgroundColor: ['rgba(0,73,93,0.7)', 'rgba(8,145,178,0.7)', 'rgba(139,92,246,0.7)', 'rgba(16,185,129,0.7)', 'rgba(245,158,11,0.7)'],
                        borderWidth: 2,
                        borderColor: ['#00495D', '#0891b2', '#8b5cf6', '#10b981', '#f59e0b']
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { r: { min: 3, max: 5 } },
                    plugins: { legend: { display: true, position: 'right' } }
                }
            });
        }
        
        function createEvalVolumeChart() {
            const ctx = document.getElementById('evalVolumeChart');
            if (!ctx) return;
            const gradient = createGradient(ctx.getContext('2d'), 'rgba(245,158,11,0.6)', 'rgba(245,158,11,0.05)');
            chartInstances.evalVolume = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], 
                    datasets: [
                        { label: 'Excellent', data: [58, 62, 54, 72, 68, 78, 85, 80, 92, 98, 87, 65], backgroundColor: '#10b981', borderRadius: 4, stack: 'stack0' },
                        { label: 'Good', data: [52, 55, 48, 62, 58, 65, 72, 68, 78, 82, 72, 55], backgroundColor: '#3b82f6', borderRadius: 4, stack: 'stack0' },
                        { label: 'Average', data: [18, 20, 16, 22, 20, 24, 28, 25, 30, 32, 28, 20], backgroundColor: '#f59e0b', borderRadius: 4, stack: 'stack0' },
                        { label: 'Poor', data: [3, 4, 3, 5, 4, 5, 6, 5, 6, 7, 5, 4], backgroundColor: '#ef4444', borderRadius: 4, stack: 'stack0' }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { stacked: true, beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { stacked: true, grid: { display: false } }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }
        
        function createEvalEvaluatorsChart() {
            const ctx = document.getElementById('evalEvaluatorsChart');
            if (!ctx) return;
            chartInstances.evalEvaluators = new Chart(ctx, {
                type: 'doughnut',
                data: { 
                    labels: ['Capt. Santos', 'C/E Pascual', 'Capt. Reyes', 'C/E Garcia', 'Other'], 
                    datasets: [{ 
                        data: [245, 198, 178, 156, 312], 
                        backgroundColor: ['#00495D', '#0891b2', '#8b5cf6', '#f59e0b', '#e5e7eb'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    cutout: '50%',
                    plugins: { legend: { display: true, position: 'right', labels: { usePointStyle: true, padding: 12 } } }
                }
            });
        }
        
        function createEvalRadarChart() {
            const ctx = document.getElementById('evalRadarChart');
            if (!ctx) return;
            chartInstances.evalRadar = new Chart(ctx, {
                type: 'radar',
                data: { 
                    labels: ['Technical', 'Teamwork', 'Communication', 'Reliability', 'Leadership', 'Safety'], 
                    datasets: [
                        { label: 'Officers', data: [4.5, 4.6, 4.3, 4.4, 4.2, 4.7], backgroundColor: 'rgba(0,73,93,0.2)', borderColor: '#00495D', borderWidth: 3, pointBackgroundColor: '#00495D', pointRadius: 5 },
                        { label: 'Ratings', data: [4.0, 4.2, 3.8, 3.9, 3.5, 4.3], backgroundColor: 'rgba(245,158,11,0.2)', borderColor: '#f59e0b', borderWidth: 3, pointBackgroundColor: '#f59e0b', pointRadius: 5 }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { r: { min: 3, max: 5, ticks: { stepSize: 0.5 } } },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }
        
        function createEvalExcellenceChart() {
            const ctx = document.getElementById('evalExcellenceChart');
            if (!ctx) return;
            chartInstances.evalExcellence = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Deck Officers', 'Engine Officers', 'Deck Ratings', 'Engine Ratings', 'Catering'], 
                    datasets: [
                        { label: 'Excellence Rate %', data: [92, 88, 78, 72, 85], backgroundColor: 'rgba(16,185,129,0.8)', borderColor: '#10b981', borderWidth: 2, borderRadius: 8 },
                        { label: 'Target 80%', data: [80, 80, 80, 80, 80], type: 'line', borderColor: '#ef4444', borderWidth: 2, borderDash: [5,5], pointRadius: 0, fill: false }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { min: 0, max: 100, ticks: { callback: v => v + '%' }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }
        
        function initEvalAnalyticsCharts() {
            createEvalRatingDistChart();
            createEvalScoreTrendChart();
            createEvalCriteriaChart();
            createEvalByRankChart();
            createEvalByPrincipalChart();
            createEvalByVesselTypeChart();
            createEvalVolumeChart();
            createEvalEvaluatorsChart();
            createEvalRadarChart();
            createEvalExcellenceChart();
        }
        
        function exportEvalAnalytics() {
            showNotification('Generating Evaluations Analytics Report...', 'info');
            setTimeout(() => {
                const report = `ATLANTIS Evaluations Analytics Report
Generated: ${new Date().toLocaleString()}
=====================================

EXECUTIVE SUMMARY
-----------------
Total Evaluations: 1,847
Seafarers Evaluated: 1,245
Average Score: 4.2 / 5.0
Excellence Rate: 84%
YoY Improvement: +8%

RATING DISTRIBUTION
-------------------
Excellent (4.5+): 823 (45%)
Good (3.5-4.4): 712 (39%)
Average (2.5-3.4): 267 (14%)
Needs Improvement (<2.5): 45 (2%)

CRITERIA SCORES
---------------
Technical Skills: 4.3
Teamwork: 4.4
Communication: 4.1
Reliability: 4.2
Leadership: 4.0
Safety Awareness: 4.5

PERFORMANCE BY RANK
-------------------
Master: 4.5
Chief Officer: 4.4
Chief Engineer: 4.3
2nd Officer: 4.2
2nd Engineer: 4.1
Bosun: 4.0
AB Seaman: 3.9
Oiler: 3.8

PERFORMANCE BY PRINCIPAL
------------------------
Diana Shipping: 4.5
Centrofin: 4.3
Pioneer Marine: 4.2
Neda Maritime: 4.1
Oldendorff: 4.0
Eastern Med: 3.9

TOP 5 PERFORMERS
----------------
1. Juan Dela Cruz (Chief Officer) - 4.9
2. Eduardo Pascual (Chief Engineer) - 4.8
3. Ricardo Santos (2nd Officer) - 4.8
4. Mario Reyes (2nd Engineer) - 4.7
5. Antonio Cruz (Bosun) - 4.6

DEPARTMENT EXCELLENCE RATES
---------------------------
Deck Officers: 92%
Engine Officers: 88%
Catering: 85%
Deck Ratings: 78%
Engine Ratings: 72%

INSIGHTS & RECOMMENDATIONS
--------------------------
âœ“ Communication skills improved 12% this quarter
âœ“ Diana Shipping leads with 92% excellent ratings
âš  Engine Ratings need reliability focus (avg 3.8)
â†’ Recommended: Mentorship program for ratings

=====================================
Report generated by ATLANTIS ERP v2.18`;

                const blob = new Blob([report], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'evaluations_analytics_report_' + new Date().toISOString().split('T')[0] + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('âœ“ Evaluations Analytics Report exported!', 'success');
            }, 1000);
        }
        
        // COMPLAINTS ANALYTICS CHARTS
        function createComplaintStatusChart() {
            const ctx = document.getElementById('complaintStatusChart');
            if (!ctx) return;
            chartInstances.complaintStatus = new Chart(ctx, {
                type: 'doughnut',
                data: { 
                    labels: ['Open', 'In Progress', 'Escalated', 'Resolved', 'Closed'], 
                    datasets: [{ 
                        data: [7, 9, 3, 98, 39], 
                        backgroundColor: ['#ef4444', '#f59e0b', '#7f1d1d', '#10b981', '#6b7280'],
                        borderWidth: 0,
                        hoverOffset: 15
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    cutout: '60%',
                    plugins: { 
                        legend: { display: true, position: 'bottom', labels: { usePointStyle: true, padding: 15 } }
                    }
                }
            });
        }
        
        function createComplaintTrendChart() {
            const ctx = document.getElementById('complaintTrendChart');
            if (!ctx) return;
            chartInstances.complaintTrend = new Chart(ctx, {
                type: 'line',
                data: { 
                    labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'], 
                    datasets: [
                        { label: 'Received', data: [12, 15, 11, 18, 14, 16, 13, 19, 17, 15, 14, 12], borderColor: '#ef4444', backgroundColor: 'rgba(239,68,68,0.1)', fill: true, tension: 0.4, borderWidth: 3, pointRadius: 4 },
                        { label: 'Resolved', data: [10, 14, 12, 16, 15, 14, 14, 17, 16, 16, 13, 11], borderColor: '#10b981', backgroundColor: 'rgba(16,185,129,0.1)', fill: true, tension: 0.4, borderWidth: 3, pointRadius: 4 }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: { 
                        y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createComplaintCategoryChart() {
            const ctx = document.getElementById('complaintCategoryChart');
            if (!ctx) return;
            chartInstances.complaintCategory = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Wages', 'Working Cond.', 'Safety', 'Harassment', 'Contract', 'Food', 'Management', 'Other'], 
                    datasets: [{ 
                        label: 'Complaints',
                        data: [50, 32, 24, 12, 18, 8, 7, 5], 
                        backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#dc2626', '#8b5cf6', '#06b6d4', '#ec4899', '#6b7280'],
                        borderRadius: 8,
                        barThickness: 28
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: { 
                        x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        y: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createComplaintPriorityChart() {
            const ctx = document.getElementById('complaintPriorityChart');
            if (!ctx) return;
            chartInstances.complaintPriority = new Chart(ctx, {
                type: 'polarArea',
                data: { 
                    labels: ['Critical', 'High', 'Medium', 'Low'], 
                    datasets: [{ 
                        data: [8, 35, 78, 35], 
                        backgroundColor: ['rgba(127,29,29,0.8)', 'rgba(245,158,11,0.8)', 'rgba(59,130,246,0.8)', 'rgba(16,185,129,0.8)'],
                        borderWidth: 2,
                        borderColor: ['#7f1d1d', '#f59e0b', '#3b82f6', '#10b981']
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    plugins: { legend: { display: true, position: 'right', labels: { usePointStyle: true } } }
                }
            });
        }
        
        function createComplaintByVesselChart() {
            const ctx = document.getElementById('complaintByVesselChart');
            if (!ctx) return;
            chartInstances.complaintByVessel = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['MV Pioneer Spirit', 'MV Centrofin Glory', 'MV Diana Star', 'MV Neda Harmony', 'MV Diana Ocean', 'MV Oldendorff Star', 'MV Centrofin Titan', 'Other'], 
                    datasets: [{ 
                        label: 'Complaints',
                        data: [28, 24, 18, 16, 14, 12, 10, 34], 
                        backgroundColor: 'rgba(220,38,38,0.7)',
                        borderColor: '#dc2626',
                        borderWidth: 2,
                        borderRadius: 6
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false }, ticks: { maxRotation: 45, minRotation: 45 } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createComplaintResolutionTimeChart() {
            const ctx = document.getElementById('complaintResolutionTimeChart');
            if (!ctx) return;
            chartInstances.complaintResolutionTime = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Wages', 'Working Cond.', 'Safety', 'Harassment', 'Contract', 'Food', 'Management'], 
                    datasets: [
                        { label: 'Avg Days', data: [3.2, 4.5, 2.8, 6.2, 5.1, 2.1, 4.8], backgroundColor: 'rgba(245,158,11,0.8)', borderRadius: 6 },
                        { label: 'Target (7 days)', data: [7, 7, 7, 7, 7, 7, 7], type: 'line', borderColor: '#ef4444', borderWidth: 2, borderDash: [5,5], pointRadius: 0, fill: false }
                    ] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { beginAtZero: true, max: 10, title: { display: true, text: 'Days' }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }
        
        function createComplaintByPrincipalChart() {
            const ctx = document.getElementById('complaintByPrincipalChart');
            if (!ctx) return;
            chartInstances.complaintByPrincipal = new Chart(ctx, {
                type: 'doughnut',
                data: { 
                    labels: ['Pioneer Marine', 'Centrofin', 'Diana Shipping', 'Neda Maritime', 'Oldendorff', 'Other'], 
                    datasets: [{ 
                        data: [38, 32, 28, 24, 18, 16], 
                        backgroundColor: ['#dc2626', '#f59e0b', '#00495D', '#8b5cf6', '#10b981', '#e5e7eb'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    cutout: '50%',
                    plugins: { legend: { display: true, position: 'right', labels: { usePointStyle: true, padding: 12 } } }
                }
            });
        }
        
        function createComplaintHandlerChart() {
            const ctx = document.getElementById('complaintHandlerChart');
            if (!ctx) return;
            chartInstances.complaintHandler = new Chart(ctx, {
                type: 'bar',
                data: { 
                    labels: ['Maria Santos', 'HR Manager', 'Safety Officer', 'Fleet Manager', 'Finance Dept', 'Compliance'], 
                    datasets: [{ 
                        label: 'Resolution Rate %',
                        data: [94, 88, 92, 85, 91, 89], 
                        backgroundColor: ['#10b981', '#3b82f6', '#10b981', '#f59e0b', '#10b981', '#3b82f6'],
                        borderRadius: 8
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: { 
                        y: { min: 0, max: 100, ticks: { callback: v => v + '%' }, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function initComplaintsAnalyticsCharts() {
            createComplaintStatusChart();
            createComplaintTrendChart();
            createComplaintCategoryChart();
            createComplaintPriorityChart();
            createComplaintByVesselChart();
            createComplaintResolutionTimeChart();
            createComplaintByPrincipalChart();
            createComplaintHandlerChart();
        }
        
        function refreshComplaintsAnalytics() {
            showNotification('Refreshing complaints analytics...', 'info');
            setTimeout(() => {
                showNotification('âœ“ Complaints analytics updated!', 'success');
            }, 1000);
        }
        
        function exportComplaintsAnalytics() {
            showNotification('Generating Complaints Analytics Report...', 'info');
            setTimeout(() => {
                const report = `ATLANTIS Complaints Analytics Report
Generated: ${new Date().toLocaleString()}
=====================================

EXECUTIVE SUMMARY
-----------------
Total Complaints: 156
Resolution Rate: 86%
Avg Resolution Time: 4.2 days
Satisfaction Rate: 92%

STATUS BREAKDOWN
----------------
Open: 7 (4%)
In Progress: 12 (8%)
Escalated: 3 (2%)
Resolved: 134 (86%)

COMPLAINTS BY CATEGORY
----------------------
Wages & Benefits: 50 (32%)
Working Conditions: 32 (21%)
Safety & Health: 24 (15%)
Contract Issues: 18 (12%)
Harassment: 12 (8%)
Food & Accommodation: 8 (5%)
Management Issues: 7 (4%)
Other: 5 (3%)

PRIORITY DISTRIBUTION
---------------------
Critical: 8 (5%)
High: 35 (22%)
Medium: 78 (50%)
Low: 35 (23%)

TOP VESSELS BY COMPLAINTS
-------------------------
1. MV Pioneer Spirit: 28
2. MV Centrofin Glory: 24
3. MV Diana Star: 18
4. MV Neda Harmony: 16
5. MV Diana Ocean: 14

RESOLUTION TIME BY CATEGORY
---------------------------
Food & Accommodation: 2.1 days
Safety & Health: 2.8 days
Wages & Benefits: 3.2 days
Working Conditions: 4.5 days
Management Issues: 4.8 days
Contract Issues: 5.1 days
Harassment: 6.2 days

HANDLER PERFORMANCE
-------------------
Maria Santos: 94% resolution rate
Safety Officer: 92% resolution rate
Finance Dept: 91% resolution rate
Compliance Officer: 89% resolution rate
HR Manager: 88% resolution rate
Fleet Manager: 85% resolution rate

MLC 2006 COMPLIANCE
-------------------
âœ“ Documented procedure in place
âœ“ Confidential handling enabled
âœ“ Average resolution within target
âœ“ No victimization policy enforced

=====================================
Report generated by ATLANTIS ERP v2.18
MLC 2006 Standard A5.1.5 Compliant`;

                const blob = new Blob([report], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'complaints_analytics_report_' + new Date().toISOString().split('T')[0] + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('âœ“ Complaints Analytics Report exported!', 'success');
            }, 1000);
        }
        
        function updateAllCharts() {
            showNotification('Updating charts with new time range...', 'info');
        }
        
        function refreshAnalytics() {
            showNotification('Analytics refreshed successfully!', 'success');
            if (chartsInitialized) {
                Object.values(chartInstances).forEach(chart => { if (chart) chart.update(); });
            }
        }
        
        function exportAnalyticsReport() {
            showNotification('Generating comprehensive analytics report...', 'info');
            setTimeout(() => {
                const report = `ATLANTIS Analytics Report
Generated: ${new Date().toLocaleString()}
=====================================

EXECUTIVE SUMMARY
-----------------
Total Seafarers: 2,847
Active Contracts: 1,456
Fleet Vessels: 89
Principals: 34

KEY METRICS
-----------
Crew Retention Rate: 92.3%
Document Compliance: 97.8%
Avg Days to Fill: 14.2

SEAFARER DISTRIBUTION
--------------------
Embarked: 1,456 (51.2%)
On Preparation: 389 (13.7%)
Ready Pool: 512 (18.0%)
Other: 490 (17.2%)

RECRUITMENT
-----------
Open RFCs: 47
Active Candidates: 89
Interviews Today: 12

Generated by ATLANTIS ERP v2.18
`;
                const blob = new Blob([report], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ATLANTIS_Analytics_Report_' + new Date().toISOString().split('T')[0] + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                showNotification('Report downloaded successfully!', 'success');
            }, 1000);
        }
        
        function showApiEndpoints(category) {
            showNotification('Viewing ' + category.charAt(0).toUpperCase() + category.slice(1) + ' API endpoints', 'info');
        }
        
        function refreshRealtimeMetrics() {
            // Animate refresh button
            const btn = document.querySelector('.btn-realtime-refresh i');
            if (btn) {
                btn.style.animation = 'spin 1s linear';
                setTimeout(() => { btn.style.animation = ''; }, 1000);
            }
            
            // Update last updated time
            const timeEl = document.getElementById('lastUpdateTime');
            if (timeEl) timeEl.textContent = 'just now';
            
            // Re-animate counters
            animateRealtimeCounters();
            
            showNotification('Real-time metrics refreshed!', 'success');
        }
        
        function animateRealtimeCounters() {
            document.querySelectorAll('.metric-value-large[data-target]').forEach(el => {
                const target = parseInt(el.dataset.target);
                let current = 0;
                const increment = target / 40;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    el.textContent = Math.floor(current).toLocaleString();
                }, 40);
            });
        }
        
        // Initialize realtime dashboard when analytics tab opens
        function initRealtimeDashboard() {
            animateRealtimeCounters();
            
            // Update time periodically
            setInterval(() => {
                const timeEl = document.getElementById('lastUpdateTime');
                if (timeEl && timeEl.textContent === 'just now') {
                    setTimeout(() => { if (timeEl) timeEl.textContent = '30 seconds ago'; }, 30000);
                }
            }, 1000);
        }

        // INIT
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            document.querySelectorAll('.nav-item[data-view]').forEach(item => {
                item.addEventListener('click', function(e) { e.preventDefault(); navigateTo(this.dataset.view); });
            });
            renderRosterTable();
            renderRfaTable();
            
            // Initialize analytics when tab is visible
            setTimeout(() => {
                if (document.getElementById('tab-overview')?.classList.contains('active')) {
                    initializeAllCharts();
                }
            }, 500);
            
            // Initialize charts when navigating to analytics views
            document.querySelectorAll('.nav-item[data-view]').forEach(item => {
                item.addEventListener('click', function() {
                    const viewId = this.dataset.view;
                    setTimeout(() => {
                        if (viewId === 'analytics') {
                            initializeAllCharts();
                        } else if (viewId === 'complaints-analytics') {
                            initComplaintsAnalyticsCharts();
                        } else if (viewId === 'evaluations-analytics') {
                            initEvalAnalyticsCharts();
                        } else if (viewId === 'travel-analytics') {
                            initTravelCharts();
                        } else if (viewId === 'talent-pool') {
                            renderChannelsTable();
                        } else if (viewId === 'assignment-proposal') {
                            console.log('Assignment view clicked, initializing...');
                            setTimeout(() => {
                                renderAssignmentBoard();
                                renderCrewPool();
                            }, 50);
                        } else if (viewId === 'supernumerary') {
                            setTimeout(() => {
                                renderSupernumeraryGrid();
                            }, 50);
                        } else if (viewId === 'crew-changes') {
                            setTimeout(() => {
                                renderCrewChanges();
                            }, 50);
                        }
                    }, 100);
                });
            });
        });
        
        // =====================================================
        // TALENT-POOL SETTINGS MODULE (v2.6)
        // =====================================================
        
        const MOCK_CHANNELS = [
            { id: 'CH001', name: 'Maritime Jobs PH', type: 'job-board', cost: 150, successRate: 68, contact: 'Maria Santos', email: 'maria@maritimejobs.ph', status: 'active' },
            { id: 'CH002', name: 'Crew Solutions Agency', type: 'agency', cost: 500, successRate: 82, contact: 'John Cruz', email: 'john@crewsolutions.com', status: 'active' },
            { id: 'CH003', name: 'Walk-in Applications', type: 'walk-in', cost: 0, successRate: 45, contact: 'HR Department', email: 'hr@crossworld.com.ph', status: 'active' },
            { id: 'CH004', name: 'Employee Referrals', type: 'referral', cost: 200, successRate: 78, contact: 'HR Department', email: 'hr@crossworld.com.ph', status: 'active' },
            { id: 'CH005', name: 'Facebook Maritime Groups', type: 'social-media', cost: 50, successRate: 35, contact: 'Marketing Team', email: 'marketing@crossworld.com.ph', status: 'active' },
            { id: 'CH006', name: 'PMMA Graduates', type: 'school', cost: 100, successRate: 72, contact: 'Registrar Office', email: 'registrar@pmma.edu.ph', status: 'active' },
            { id: 'CH007', name: 'Returning Crew Database', type: 'returning', cost: 0, successRate: 92, contact: 'Crewing Dept', email: 'crewing@crossworld.com.ph', status: 'active' },
            { id: 'CH008', name: 'Magsaysay Training Center', type: 'school', cost: 75, successRate: 65, contact: 'Training Director', email: 'training@magsaysay.com', status: 'inactive' }
        ];
        
        const MOCK_SALARY_RANGES = [
            { id: 'SR001', rank: 'Master', vesselType: 'bulk', min: 9000, max: 12000, currencies: ['USD', 'EUR'] },
            { id: 'SR002', rank: 'Master', vesselType: 'tanker', min: 10000, max: 14000, currencies: ['USD', 'EUR'] },
            { id: 'SR003', rank: 'Chief Officer', vesselType: 'all', min: 5500, max: 7500, currencies: ['USD'] },
            { id: 'SR004', rank: 'Chief Engineer', vesselType: 'all', min: 8000, max: 11000, currencies: ['USD', 'EUR'] },
            { id: 'SR005', rank: '2nd Officer', vesselType: 'all', min: 3500, max: 4500, currencies: ['USD'] },
            { id: 'SR006', rank: '2nd Engineer', vesselType: 'all', min: 4500, max: 6000, currencies: ['USD'] },
            { id: 'SR007', rank: 'AB', vesselType: 'all', min: 1200, max: 1800, currencies: ['USD', 'PHP'] },
            { id: 'SR008', rank: 'Oiler', vesselType: 'all', min: 1000, max: 1500, currencies: ['USD', 'PHP'] },
            { id: 'SR009', rank: 'Bosun', vesselType: 'all', min: 1500, max: 2200, currencies: ['USD'] },
            { id: 'SR010', rank: 'Cook', vesselType: 'all', min: 1100, max: 1600, currencies: ['USD', 'PHP'] },
            { id: 'SR011', rank: 'Electrician', vesselType: 'all', min: 3000, max: 4500, currencies: ['USD'] },
            { id: 'SR012', rank: 'Cadet', vesselType: 'all', min: 400, max: 600, currencies: ['USD', 'PHP'] }
        ];
        
        const MOCK_NFR_LIST = [
            { id: 'NFR001', seafarerId: 'SEA101', name: 'Roberto Aquino', rank: 'AB', reason: 'Contract abandonment - left vessel without notice', category: 'abandonment', type: 'nfr', addedBy: 'Maria Santos', dateAdded: '2024-08-15', principal: '' },
            { id: 'NFR002', seafarerId: 'SEA102', name: 'Carlos Mendez', rank: 'Oiler', reason: 'Failed drug test during PEME', category: 'medical', type: 'blacklist', addedBy: 'Dr. Reyes', dateAdded: '2024-07-22', principal: '' },
            { id: 'NFR003', seafarerId: 'SEA103', name: 'Miguel Torres', rank: '3rd Officer', reason: 'Poor performance - multiple navigation errors', category: 'performance', type: 'watchlist', addedBy: 'Capt. Santos', dateAdded: '2024-09-10', principal: 'Diana Shipping' },
            { id: 'NFR004', seafarerId: 'SEA104', name: 'Jose Garcia', rank: 'Cook', reason: 'Food safety violations - repeated warnings', category: 'misconduct', type: 'nfr', addedBy: 'Fleet Manager', dateAdded: '2024-06-05', principal: '' },
            { id: 'NFR005', seafarerId: 'SEA105', name: 'Antonio Reyes', rank: 'Bosun', reason: 'Principal request - attitude problems', category: 'principal', type: 'principal-ban', addedBy: 'Operations', dateAdded: '2024-10-01', principal: 'Centrofin' }
        ];
        
        const MOCK_AUTO_TAGS = [
            { id: 'AT001', name: 'New Hire', color: '#10b981', condition: 'first-contract', value: 'No previous contracts', autoApply: 'yes', status: 'active' },
            { id: 'AT002', name: 'Returning Crew', color: '#3b82f6', condition: 'returning', value: 'Gap > 6 months', autoApply: 'yes', status: 'active' },
            { id: 'AT003', name: 'Senior Officer', color: '#8b5cf6', condition: 'experience', value: '> 10 years', autoApply: 'suggest', status: 'active' },
            { id: 'AT004', name: 'Diana Preferred', color: '#f59e0b', condition: 'principal', value: 'Diana Shipping', autoApply: 'manual', status: 'active' },
            { id: 'AT005', name: 'Top Performer', color: '#10b981', condition: 'performance', value: 'Score > 4.5', autoApply: 'yes', status: 'active' },
            { id: 'AT006', name: 'PMMA Graduate', color: '#3b82f6', condition: 'source', value: 'PMMA', autoApply: 'yes', status: 'inactive' }
        ];
        
        function getChannelTypeColor(type) {
            const colors = { 'agency': '#3b82f6', 'job-board': '#10b981', 'walk-in': '#8b5cf6', 'referral': '#f59e0b', 'social-media': '#ec4899', 'school': '#06b6d4', 'returning': '#10b981' };
            return colors[type] || '#6b7280';
        }
        function formatChannelType(type) {
            const names = { 'agency': 'Agency', 'job-board': 'Job Board', 'walk-in': 'Walk-in', 'referral': 'Referral', 'social-media': 'Social Media', 'school': 'Maritime School', 'returning': 'Returning Crew' };
            return names[type] || type;
        }
        function formatVesselType(type) {
            const names = { 'bulk': 'Bulk Carrier', 'tanker': 'Tanker', 'container': 'Container', 'lng': 'LNG/LPG', 'roro': 'RoRo' };
            return names[type] || type;
        }
        function getNfrTypeColor(type) {
            const colors = { 'nfr': '#ef4444', 'watchlist': '#f59e0b', 'blacklist': '#1f2937', 'principal-ban': '#8b5cf6' };
            return colors[type] || '#6b7280';
        }
        function formatNfrType(type) {
            const names = { 'nfr': 'NFR', 'watchlist': 'Watch List', 'blacklist': 'Blacklisted', 'principal-ban': 'Principal Ban' };
            return names[type] || type;
        }
        function formatCondition(cond) {
            const names = { 'first-contract': 'First Contract', 'returning': 'Returning After Gap', 'experience': 'Experience Level', 'source': 'Sourcing Channel', 'rank': 'Specific Rank', 'principal': 'Specific Principal', 'performance': 'Performance Score' };
            return names[cond] || cond;
        }
        function formatAutoApply(apply) {
            const names = { 'yes': 'Auto', 'suggest': 'Suggest', 'manual': 'Manual' };
            return names[apply] || apply;
        }
        function tpFormatDate(dateStr) {
            return new Date(dateStr).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }
        
        function switchTalentPoolTab(tabName) {
            document.querySelectorAll('.tp-tab-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('#view-talent-pool .analytics-tab').forEach(el => el.classList.remove('active'));
            const content = document.getElementById('tp-content-' + tabName);
            const tab = document.getElementById('tp-tab-' + tabName);
            if (content) content.style.display = 'block';
            if (tab) tab.classList.add('active');
            if (tabName === 'channels') renderChannelsTable();
            else if (tabName === 'negotiation') renderSalaryRangesTable();
            else if (tabName === 'nfr') renderNfrTable();
            else if (tabName === 'autotag') renderAutoTagTable();
        }
        window.switchTalentPoolTab = switchTalentPoolTab;
        
        function renderChannelsTable() {
            const tbody = document.getElementById('channelsTableBody');
            if (!tbody) return;
            tbody.innerHTML = MOCK_CHANNELS.map(ch => `
                <tr>
                    <td><strong>${ch.name}</strong><br><small style="color:var(--cw-gray-500);">${ch.contact}</small></td>
                    <td><span class="tag" style="background:${getChannelTypeColor(ch.type)}20;color:${getChannelTypeColor(ch.type)};">${formatChannelType(ch.type)}</span></td>
                    <td>$${ch.cost.toLocaleString()}</td>
                    <td><div style="display:flex;align-items:center;gap:8px;"><div style="width:60px;height:6px;background:var(--cw-gray-200);border-radius:3px;overflow:hidden;"><div style="width:${ch.successRate}%;height:100%;background:${ch.successRate >= 70 ? '#10b981' : ch.successRate >= 50 ? '#f59e0b' : '#ef4444'};"></div></div><span>${ch.successRate}%</span></div></td>
                    <td><span class="status-badge ${ch.status === 'active' ? 'status-ready' : 'status-inactive'}">${ch.status}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="editChannel('${ch.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteChannel('${ch.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderChannelsTable = renderChannelsTable;
        
        function renderSalaryRangesTable() {
            const tbody = document.getElementById('salaryRangesTableBody');
            if (!tbody) return;
            tbody.innerHTML = MOCK_SALARY_RANGES.map(sr => `
                <tr>
                    <td><strong>${sr.rank}</strong></td>
                    <td>${sr.vesselType === 'all' ? 'All Types' : formatVesselType(sr.vesselType)}</td>
                    <td>$${sr.min.toLocaleString()}</td>
                    <td>$${sr.max.toLocaleString()}</td>
                    <td>${sr.currencies.map(c => `<span class="tag" style="margin-right:4px;">${c}</span>`).join('')}</td>
                    <td>
                        <button class="btn btn-sm" onclick="editSalaryRange('${sr.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteSalaryRange('${sr.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderSalaryRangesTable = renderSalaryRangesTable;
        
        function renderNfrTable() {
            const tbody = document.getElementById('nfrTableBody');
            if (!tbody) return;
            tbody.innerHTML = MOCK_NFR_LIST.map(nfr => `
                <tr>
                    <td><div style="display:flex;align-items:center;gap:8px;"><div class="avatar" style="width:32px;height:32px;background:${getNfrTypeColor(nfr.type)};font-size:12px;">${nfr.name.split(' ').map(n=>n[0]).join('')}</div><div><strong>${nfr.name}</strong><br><small style="color:var(--cw-gray-500);">${nfr.seafarerId}</small></div></div></td>
                    <td>${nfr.rank}</td>
                    <td style="max-width:200px;"><span style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${nfr.reason}</span></td>
                    <td>${nfr.addedBy}</td>
                    <td>${tpFormatDate(nfr.dateAdded)}</td>
                    <td><span class="status-badge" style="background:${getNfrTypeColor(nfr.type)}20;color:${getNfrTypeColor(nfr.type)};">${formatNfrType(nfr.type)}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="viewNfrDetails('${nfr.id}')" title="View"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="removeNfr('${nfr.id}')" title="Remove" style="color:#10b981;"><i data-lucide="user-check" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderNfrTable = renderNfrTable;
        
        function renderAutoTagTable() {
            const tbody = document.getElementById('autoTagTableBody');
            if (!tbody) return;
            tbody.innerHTML = MOCK_AUTO_TAGS.map(at => `
                <tr>
                    <td><span class="tag" style="background:${at.color}20;color:${at.color};border:1px solid ${at.color};">${at.name}</span></td>
                    <td>${formatCondition(at.condition)}</td>
                    <td>${at.value}</td>
                    <td><span class="status-badge ${at.autoApply === 'yes' ? 'status-ready' : at.autoApply === 'suggest' ? 'status-on-approval' : 'status-on-preparation'}">${formatAutoApply(at.autoApply)}</span></td>
                    <td><span class="status-badge ${at.status === 'active' ? 'status-ready' : 'status-inactive'}">${at.status}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="editAutoTag('${at.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteAutoTag('${at.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderAutoTagTable = renderAutoTagTable;
        
        // Filter functions for each tab
        function filterChannels() {
            const search = document.getElementById('channelSearch')?.value.toLowerCase() || '';
            const typeFilter = document.getElementById('channelTypeFilter')?.value || '';
            const statusFilter = document.getElementById('channelStatusFilter')?.value || '';
            
            const filtered = MOCK_CHANNELS.filter(ch => {
                const matchSearch = ch.name.toLowerCase().includes(search) || ch.contact.toLowerCase().includes(search);
                const matchType = !typeFilter || ch.type === typeFilter;
                const matchStatus = !statusFilter || ch.status === statusFilter;
                return matchSearch && matchType && matchStatus;
            });
            
            const tbody = document.getElementById('channelsTableBody');
            if (!tbody) return;
            tbody.innerHTML = filtered.map(ch => `
                <tr>
                    <td><strong>${ch.name}</strong><br><small style="color:var(--cw-gray-500);">${ch.contact}</small></td>
                    <td><span class="tag" style="background:${getChannelTypeColor(ch.type)}20;color:${getChannelTypeColor(ch.type)};">${formatChannelType(ch.type)}</span></td>
                    <td>$${ch.cost.toLocaleString()}</td>
                    <td><div style="display:flex;align-items:center;gap:8px;"><div style="width:60px;height:6px;background:var(--cw-gray-200);border-radius:3px;overflow:hidden;"><div style="width:${ch.successRate}%;height:100%;background:${ch.successRate >= 70 ? '#10b981' : ch.successRate >= 50 ? '#f59e0b' : '#ef4444'};"></div></div><span>${ch.successRate}%</span></div></td>
                    <td><span class="status-badge ${ch.status === 'active' ? 'status-ready' : 'status-inactive'}">${ch.status}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="editChannel('${ch.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteChannel('${ch.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (filtered.length === 0) tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No channels found matching your filters</td></tr>';
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterChannels = filterChannels;
        
        function filterSalaryRanges() {
            const rankFilter = document.getElementById('salaryRankFilter')?.value || '';
            const vesselFilter = document.getElementById('salaryVesselFilter')?.value || '';
            const currencyFilter = document.getElementById('salaryCurrencyFilter')?.value || '';
            
            const filtered = MOCK_SALARY_RANGES.filter(sr => {
                const matchRank = !rankFilter || sr.rank === rankFilter;
                const matchVessel = !vesselFilter || sr.vesselType === vesselFilter;
                const matchCurrency = !currencyFilter || sr.currencies.includes(currencyFilter);
                return matchRank && matchVessel && matchCurrency;
            });
            
            const tbody = document.getElementById('salaryRangesTableBody');
            if (!tbody) return;
            tbody.innerHTML = filtered.map(sr => `
                <tr>
                    <td><strong>${sr.rank}</strong></td>
                    <td>${sr.vesselType === 'all' ? 'All Types' : formatVesselType(sr.vesselType)}</td>
                    <td>$${sr.min.toLocaleString()}</td>
                    <td>$${sr.max.toLocaleString()}</td>
                    <td>${sr.currencies.map(c => `<span class="tag" style="margin-right:4px;">${c}</span>`).join('')}</td>
                    <td>
                        <button class="btn btn-sm" onclick="editSalaryRange('${sr.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteSalaryRange('${sr.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (filtered.length === 0) tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No salary ranges found matching your filters</td></tr>';
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterSalaryRanges = filterSalaryRanges;
        
        function filterNfr() {
            const search = document.getElementById('nfrSearch')?.value.toLowerCase() || '';
            const typeFilter = document.getElementById('nfrTypeFilter')?.value || '';
            const categoryFilter = document.getElementById('nfrCategoryFilter')?.value || '';
            const principalFilter = document.getElementById('nfrPrincipalFilter')?.value || '';
            
            const filtered = MOCK_NFR_LIST.filter(nfr => {
                const matchSearch = nfr.name.toLowerCase().includes(search) || nfr.seafarerId.toLowerCase().includes(search);
                const matchType = !typeFilter || nfr.type === typeFilter;
                const matchCategory = !categoryFilter || nfr.category === categoryFilter;
                const matchPrincipal = !principalFilter || nfr.principal === principalFilter;
                return matchSearch && matchType && matchCategory && matchPrincipal;
            });
            
            const tbody = document.getElementById('nfrTableBody');
            if (!tbody) return;
            tbody.innerHTML = filtered.map(nfr => `
                <tr>
                    <td><div style="display:flex;align-items:center;gap:8px;"><div class="avatar" style="width:32px;height:32px;background:${getNfrTypeColor(nfr.type)};font-size:12px;">${nfr.name.split(' ').map(n=>n[0]).join('')}</div><div><strong>${nfr.name}</strong><br><small style="color:var(--cw-gray-500);">${nfr.seafarerId}</small></div></div></td>
                    <td>${nfr.rank}</td>
                    <td style="max-width:200px;"><span style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${nfr.reason}</span></td>
                    <td>${nfr.addedBy}</td>
                    <td>${tpFormatDate(nfr.dateAdded)}</td>
                    <td><span class="status-badge" style="background:${getNfrTypeColor(nfr.type)}20;color:${getNfrTypeColor(nfr.type)};">${formatNfrType(nfr.type)}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="viewNfrDetails('${nfr.id}')" title="View"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="removeNfr('${nfr.id}')" title="Remove" style="color:#10b981;"><i data-lucide="user-check" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (filtered.length === 0) tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No NFR records found matching your filters</td></tr>';
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterNfr = filterNfr;
        
        function filterAutoTags() {
            const search = document.getElementById('autoTagSearch')?.value.toLowerCase() || '';
            const conditionFilter = document.getElementById('autoTagConditionFilter')?.value || '';
            const applyFilter = document.getElementById('autoTagApplyFilter')?.value || '';
            const statusFilter = document.getElementById('autoTagStatusFilter')?.value || '';
            
            const filtered = MOCK_AUTO_TAGS.filter(at => {
                const matchSearch = at.name.toLowerCase().includes(search) || at.value.toLowerCase().includes(search);
                const matchCondition = !conditionFilter || at.condition === conditionFilter;
                const matchApply = !applyFilter || at.autoApply === applyFilter;
                const matchStatus = !statusFilter || at.status === statusFilter;
                return matchSearch && matchCondition && matchApply && matchStatus;
            });
            
            const tbody = document.getElementById('autoTagTableBody');
            if (!tbody) return;
            tbody.innerHTML = filtered.map(at => `
                <tr>
                    <td><span class="tag" style="background:${at.color}20;color:${at.color};border:1px solid ${at.color};">${at.name}</span></td>
                    <td>${formatCondition(at.condition)}</td>
                    <td>${at.value}</td>
                    <td><span class="status-badge ${at.autoApply === 'yes' ? 'status-ready' : at.autoApply === 'suggest' ? 'status-on-approval' : 'status-on-preparation'}">${formatAutoApply(at.autoApply)}</span></td>
                    <td><span class="status-badge ${at.status === 'active' ? 'status-ready' : 'status-inactive'}">${at.status}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="editAutoTag('${at.id}')" title="Edit"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" onclick="deleteAutoTag('${at.id}')" title="Delete" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (filtered.length === 0) tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No auto-tag rules found matching your filters</td></tr>';
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterAutoTags = filterAutoTags;
        
        // =====================================================
        // SEAFARER PROFILE MODULE (v2.6)
        // =====================================================
        
        const MOCK_SEAFARER_PROFILE = {
            id: 'SEA-2024-0847',
            firstName: 'Juan',
            middleName: 'Santos',
            lastName: 'Dela Cruz',
            rank: 'Chief Officer',
            status: 'embarked',
            poolType: 'Dedicated',
            assigned: true,
            nationality: 'Filipino',
            dob: '1986-03-15',
            age: 38,
            pob: 'Manila, Philippines',
            gender: 'Male',
            civilStatus: 'Married',
            religion: 'Roman Catholic',
            email: 'juan.delacruz@email.com',
            mobile: '+63 917 123 4567',
            homePhone: '+63 2 8123 4567',
            address: '123 Mabini St., Brgy. San Antonio, Quezon City',
            nokName: 'Maria Dela Cruz',
            nokRelation: 'Spouse',
            nokPhone: '+63 918 765 4321',
            nokEmail: 'maria.delacruz@email.com',
            nokAddress: 'Same as permanent address',
            vessel: 'MV Diana Star',
            vesselType: 'Bulk Carrier',
            vesselIMO: 'IMO 9876543',
            principal: 'Diana Shipping',
            contractStart: '2025-02-15',
            contractEnd: '2025-08-15',
            signOnPort: 'Manila, Philippines',
            docsCount: '24/24',
            seaTime: 12.5,
            evalScore: 4.7,
            contracts: 18,
            basicWage: 5500,
            fixedOT: 1650,
            leavePay: 550,
            subsistence: 300,
            bankName: 'BDO Unibank',
            accountName: 'Juan Santos Dela Cruz',
            accountNumber: 'â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 4567',
            swiftCode: 'BNORPHMM'
        };
        
        const SP_DOCUMENTS = [
            { id: 'DOC001', name: 'STCW Certificate', number: 'STCW-2024-12345', category: 'certificate', issueDate: '2020-05-15', expiryDate: '2025-05-14', status: 'valid' },
            { id: 'DOC002', name: 'Passport', number: 'P1234567A', category: 'travel', issueDate: '2020-01-10', expiryDate: '2030-01-09', status: 'valid' },
            { id: 'DOC003', name: 'Seaman\'s Book', number: 'SRB-2019-98765', category: 'license', issueDate: '2019-06-20', expiryDate: '2029-06-19', status: 'valid' },
            { id: 'DOC004', name: 'Medical Certificate', number: 'MED-2024-5678', category: 'medical', issueDate: '2024-12-01', expiryDate: '2025-12-01', status: 'valid' },
            { id: 'DOC005', name: 'GMDSS Certificate', number: 'GMDSS-2021-3456', category: 'certificate', issueDate: '2021-03-15', expiryDate: '2025-03-14', status: 'expiring' },
            { id: 'DOC006', name: 'COC Deck Officer', number: 'COC-2018-7890', category: 'license', issueDate: '2018-08-20', expiryDate: '2028-08-19', status: 'valid' },
            { id: 'DOC007', name: 'Basic Safety Training', number: 'BST-2023-1234', category: 'training', issueDate: '2023-01-15', expiryDate: '2028-01-14', status: 'valid' },
            { id: 'DOC008', name: 'US Visa (C1/D)', number: 'US-2022-9876', category: 'travel', issueDate: '2022-06-10', expiryDate: '2025-06-09', status: 'expiring' },
            { id: 'DOC009', name: 'Yellow Fever Certificate', number: 'YF-2024-4567', category: 'medical', issueDate: '2024-02-20', expiryDate: '2034-02-19', status: 'valid' },
            { id: 'DOC010', name: 'Flag State Endorsement', number: 'FSE-2023-8901', category: 'license', issueDate: '2023-09-01', expiryDate: '2024-09-01', status: 'expired' }
        ];
        
        const SP_SEA_SERVICE = [
            { id: 'SS001', vessel: 'MV Diana Star', company: 'Diana Shipping', rank: 'Chief Officer', signOn: '2025-02-15', signOff: null, duration: '5 months (ongoing)' },
            { id: 'SS002', vessel: 'MV Pacific Voyager', company: 'Diana Shipping', rank: 'Chief Officer', signOn: '2024-03-10', signOff: '2024-12-15', duration: '9 months' },
            { id: 'SS003', vessel: 'MV Ocean Pride', company: 'Centrofin', rank: '2nd Officer', signOn: '2023-01-20', signOff: '2023-11-25', duration: '10 months' },
            { id: 'SS004', vessel: 'MV Atlantic Star', company: 'Pioneer Marine', rank: '2nd Officer', signOn: '2022-02-15', signOff: '2022-10-30', duration: '8 months' },
            { id: 'SS005', vessel: 'MV Eastern Wind', company: 'Diana Shipping', rank: '3rd Officer', signOn: '2021-04-01', signOff: '2021-12-20', duration: '8 months' },
            { id: 'SS006', vessel: 'MV Northern Light', company: 'Neda Maritime', rank: '3rd Officer', signOn: '2020-03-10', signOff: '2020-11-15', duration: '8 months' }
        ];
        
        const SP_ALLOTMENTS = [
            { id: 'ALL001', beneficiary: 'Maria Dela Cruz', relationship: 'Spouse', bank: 'BDO Unibank', account: '****4321', amount: '$3,000.00' },
            { id: 'ALL002', beneficiary: 'Jose Dela Cruz', relationship: 'Father', bank: 'Metrobank', account: '****7890', amount: '$1,000.00' },
            { id: 'ALL003', beneficiary: 'Ana Dela Cruz', relationship: 'Daughter', bank: 'BDO Unibank', account: '****5678', amount: '$500.00' }
        ];
        
        const SP_EVALUATIONS = [
            { id: 'EVAL001', contract: 'MV Diana Star', vessel: 'Bulk Carrier', evaluator: 'Capt. Rodriguez', date: '2025-01-15', score: 4.8 },
            { id: 'EVAL002', contract: 'MV Pacific Voyager', vessel: 'Bulk Carrier', evaluator: 'Capt. Santos', date: '2024-12-10', score: 4.7 },
            { id: 'EVAL003', contract: 'MV Ocean Pride', vessel: 'Tanker', evaluator: 'Capt. Lee', date: '2023-11-20', score: 4.6 },
            { id: 'EVAL004', contract: 'MV Atlantic Star', vessel: 'Container', evaluator: 'Capt. Kim', date: '2022-10-25', score: 4.5 },
            { id: 'EVAL005', contract: 'MV Eastern Wind', vessel: 'Bulk Carrier', evaluator: 'Capt. Garcia', date: '2021-12-15', score: 4.8 }
        ];
        
        const SP_NOTES = [
            { id: 'NOTE001', author: 'Maria Santos', date: '2025-02-10', content: 'Seafarer confirmed for Diana Star assignment. All documents verified and valid.', type: 'info' },
            { id: 'NOTE002', author: 'Capt. Rodriguez', date: '2025-01-15', content: 'Excellent performance during first month onboard. Shows strong leadership qualities.', type: 'positive' },
            { id: 'NOTE003', author: 'HR Department', date: '2024-12-20', content: 'Contract renewal approved for another 6-month term.', type: 'info' },
            { id: 'NOTE004', author: 'Fleet Manager', date: '2024-12-01', content: 'Recommended for promotion to Chief Officer. Completed all required training.', type: 'positive' }
        ];
        
        const SP_TIMELINE = [
            { date: '2025-02-15', event: 'Signed on MV Diana Star', type: 'embark', icon: 'ship' },
            { date: '2025-02-10', event: 'PEME completed - Fit for duty', type: 'medical', icon: 'heart' },
            { date: '2025-02-05', event: 'Contract signed for Diana Star', type: 'contract', icon: 'file-signature' },
            { date: '2025-01-20', event: 'Approved for Diana Star assignment', type: 'approval', icon: 'check-circle' },
            { date: '2024-12-15', event: 'Signed off MV Pacific Voyager', type: 'signoff', icon: 'log-out' },
            { date: '2024-12-10', event: 'Evaluation completed - Score 4.7', type: 'evaluation', icon: 'star' },
            { date: '2024-03-10', event: 'Signed on MV Pacific Voyager', type: 'embark', icon: 'ship' }
        ];
        
        function renderSeafarerProfile() {
            const p = MOCK_SEAFARER_PROFILE;
            // Populate all fields
            document.getElementById('spAvatar').textContent = p.firstName[0] + p.lastName[0];
            document.getElementById('spName').textContent = p.firstName + ' ' + p.lastName;
            document.getElementById('spRank').textContent = p.rank;
            document.getElementById('spId').textContent = p.id;
            document.getElementById('spNationality').textContent = p.nationality;
            document.getElementById('spAge').textContent = p.age + ' years old';
            
            // Overview tab
            document.getElementById('spFirstName').textContent = p.firstName;
            document.getElementById('spMiddleName').textContent = p.middleName;
            document.getElementById('spLastName').textContent = p.lastName;
            document.getElementById('spDOB').textContent = formatDateLong(p.dob);
            document.getElementById('spPOB').textContent = p.pob;
            document.getElementById('spGender').textContent = p.gender;
            document.getElementById('spCivilStatus').textContent = p.civilStatus;
            document.getElementById('spReligion').textContent = p.religion;
            
            // Render tables
            renderDocumentsTable();
            renderSeaServiceTable();
            renderAllotmentsTable();
            renderEvaluationsTable();
            renderNotesAndTimeline();
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderSeafarerProfile = renderSeafarerProfile;
        
        function formatDateLong(dateStr) {
            if (!dateStr) return '-';
            return new Date(dateStr).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        }
        
        function getDocStatusColor(status) {
            const colors = { 'valid': '#10b981', 'expiring': '#f59e0b', 'expired': '#ef4444' };
            return colors[status] || '#6b7280';
        }
        
        function switchProfileTab(tabName) {
            document.querySelectorAll('.sp-tab-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('#view-seafarer-profile .analytics-tab').forEach(el => el.classList.remove('active'));
            const content = document.getElementById('sp-content-' + tabName);
            const tab = document.getElementById('sp-tab-' + tabName);
            if (content) content.style.display = 'block';
            if (tab) tab.classList.add('active');
            if (tabName === 'notes') { renderNotesAndTimeline(); }
            else if (tabName === 'documents') { renderDocumentsTable(); }
            else if (tabName === 'sea') { renderSeaServiceTable(); }
            else if (tabName === 'salary') { renderAllotmentsTable(); }
            else if (tabName === 'evaluations') { renderEvaluationsTable(); }
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.switchProfileTab = switchProfileTab;
        
        function renderDocumentsTable() {
            const tbody = document.getElementById('documentsTableBody');
            if (!tbody) return;
            tbody.innerHTML = SP_DOCUMENTS.map(doc => `
                <tr>
                    <td><strong>${doc.name}</strong><br><small style="color:var(--cw-gray-500);">${doc.category}</small></td>
                    <td>${doc.number}</td>
                    <td>${formatDateLong(doc.issueDate)}</td>
                    <td>${formatDateLong(doc.expiryDate)}</td>
                    <td><span class="status-badge" style="background:${getDocStatusColor(doc.status)}20;color:${getDocStatusColor(doc.status)};">${doc.status}</span></td>
                    <td>
                        <button class="btn btn-sm" title="View" onclick="viewDocument('${doc.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Download" onclick="downloadDocument('${doc.id}')"><i data-lucide="download" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Edit" onclick="editDocument('${doc.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteDocument('${doc.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function renderSeaServiceTable() {
            const tbody = document.getElementById('seaServiceTableBody');
            if (!tbody) return;
            tbody.innerHTML = SP_SEA_SERVICE.map(ss => `
                <tr>
                    <td><strong>${ss.vessel}</strong></td>
                    <td>${ss.company}</td>
                    <td>${ss.rank}</td>
                    <td>${formatDateLong(ss.signOn)}</td>
                    <td>${ss.signOff ? formatDateLong(ss.signOff) : '<span class="status-badge status-embarked">Onboard</span>'}</td>
                    <td>${ss.duration}</td>
                    <td>
                        <button class="btn btn-sm" title="View" onclick="viewSeaService('${ss.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Edit" onclick="editSeaService('${ss.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteSeaService('${ss.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function renderAllotmentsTable() {
            const tbody = document.getElementById('allotmentsTableBody');
            if (!tbody) return;
            tbody.innerHTML = SP_ALLOTMENTS.map(all => `
                <tr>
                    <td><strong>${all.beneficiary}</strong></td>
                    <td>${all.relationship}</td>
                    <td>${all.bank}</td>
                    <td>${all.account}</td>
                    <td><strong style="color:var(--cw-primary);">${all.amount}</strong></td>
                    <td>
                        <button class="btn btn-sm" title="Edit" onclick="editAllotment('${all.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteAllotment('${all.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function renderEvaluationsTable() {
            const tbody = document.getElementById('evaluationsTableBody');
            if (!tbody) return;
            tbody.innerHTML = SP_EVALUATIONS.map(ev => `
                <tr>
                    <td><strong>${ev.contract}</strong></td>
                    <td>${ev.vessel}</td>
                    <td>${ev.evaluator}</td>
                    <td>${formatDateLong(ev.date)}</td>
                    <td>
                        <div style="display:flex;align-items:center;gap:8px;">
                            <div style="display:flex;gap:2px;">
                                ${[1,2,3,4,5].map(i => `<i data-lucide="star" style="width:14px;height:14px;${i <= Math.floor(ev.score) ? 'fill:#f59e0b;' : ''}color:#f59e0b;"></i>`).join('')}
                            </div>
                            <strong>${ev.score}</strong>
                        </div>
                    </td>
                    <td><button class="btn btn-sm" title="View Details" onclick="viewEvaluation('${ev.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        function renderNotesAndTimeline() {
            const notesContainer = document.getElementById('notesContainer');
            const timelineContainer = document.getElementById('timelineContainer');
            
            if (notesContainer) {
                notesContainer.innerHTML = SP_NOTES.map(note => `
                    <div style="padding:16px;background:var(--cw-gray-50);border-radius:12px;margin-bottom:12px;border-left:4px solid ${note.type === 'positive' ? '#10b981' : '#3b82f6'};">
                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                            <strong style="font-size:0.9rem;">${note.author}</strong>
                            <span style="color:var(--cw-gray-500);font-size:0.8rem;">${formatDateLong(note.date)}</span>
                        </div>
                        <p style="margin:0;color:var(--cw-gray-700);font-size:0.9rem;">${note.content}</p>
                    </div>
                `).join('');
            }
            
            if (timelineContainer) {
                timelineContainer.innerHTML = SP_TIMELINE.map((item, i) => `
                    <div style="display:flex;gap:16px;padding-bottom:${i === SP_TIMELINE.length - 1 ? '0' : '20px'};position:relative;">
                        <div style="position:relative;">
                            <div style="width:40px;height:40px;border-radius:50%;background:var(--cw-primary);display:flex;align-items:center;justify-content:center;"><i data-lucide="${item.icon}" style="width:18px;height:18px;color:white;"></i></div>
                            ${i !== SP_TIMELINE.length - 1 ? '<div style="position:absolute;left:50%;top:40px;bottom:-20px;width:2px;background:var(--cw-gray-200);transform:translateX(-50%);"></div>' : ''}
                        </div>
                        <div style="flex:1;padding-top:8px;">
                            <div style="font-weight:500;color:var(--cw-gray-800);">${item.event}</div>
                            <div style="font-size:0.8rem;color:var(--cw-gray-500);margin-top:4px;">${formatDateLong(item.date)}</div>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        function filterDocuments() {
            const categoryFilter = document.getElementById('docCategoryFilter')?.value || '';
            const statusFilter = document.getElementById('docStatusFilter')?.value || '';
            const searchQuery = document.getElementById('docSearchInput')?.value?.toLowerCase() || '';
            
            const filtered = SP_DOCUMENTS.filter(doc => {
                const matchCategory = !categoryFilter || doc.category === categoryFilter;
                const matchStatus = !statusFilter || doc.status === statusFilter;
                const matchSearch = !searchQuery || doc.name.toLowerCase().includes(searchQuery) || doc.number.toLowerCase().includes(searchQuery);
                return matchCategory && matchStatus && matchSearch;
            });
            
            const tbody = document.getElementById('documentsTableBody');
            if (!tbody) return;
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No documents found matching your filters</td></tr>';
                return;
            }
            tbody.innerHTML = filtered.map(doc => `
                <tr>
                    <td><strong>${doc.name}</strong><br><small style="color:var(--cw-gray-500);">${doc.category}</small></td>
                    <td>${doc.number}</td>
                    <td>${formatDateLong(doc.issueDate)}</td>
                    <td>${formatDateLong(doc.expiryDate)}</td>
                    <td><span class="status-badge" style="background:${getDocStatusColor(doc.status)}20;color:${getDocStatusColor(doc.status)};">${doc.status}</span></td>
                    <td>
                        <button class="btn btn-sm" title="View" onclick="viewDocument('${doc.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Download" onclick="downloadDocument('${doc.id}')"><i data-lucide="download" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Edit" onclick="editDocument('${doc.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteDocument('${doc.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterDocuments = filterDocuments;
        
        function printSeafarerProfile() { 
            showNotification('Preparing PDF...', 'info'); 
            setTimeout(() => {
                // Create printable version
                const printContent = `
                    <html>
                    <head><title>Seafarer Profile - ${MOCK_SEAFARER_PROFILE.firstName} ${MOCK_SEAFARER_PROFILE.lastName}</title>
                    <style>body{font-family:Arial,sans-serif;padding:40px;}h1{color:#00495D;}table{width:100%;border-collapse:collapse;margin:20px 0;}td,th{border:1px solid #ddd;padding:8px;text-align:left;}</style></head>
                    <body>
                    <h1>Seafarer Profile</h1>
                    <h2>${MOCK_SEAFARER_PROFILE.firstName} ${MOCK_SEAFARER_PROFILE.lastName}</h2>
                    <p><strong>Rank:</strong> ${MOCK_SEAFARER_PROFILE.rank}</p>
                    <p><strong>ID:</strong> ${MOCK_SEAFARER_PROFILE.id}</p>
                    <p><strong>Nationality:</strong> ${MOCK_SEAFARER_PROFILE.nationality}</p>
                    <p><strong>Status:</strong> ${MOCK_SEAFARER_PROFILE.status}</p>
                    <hr>
                    <h3>Contact Information</h3>
                    <p><strong>Email:</strong> ${MOCK_SEAFARER_PROFILE.email}</p>
                    <p><strong>Mobile:</strong> ${MOCK_SEAFARER_PROFILE.mobile}</p>
                    <p><strong>Address:</strong> ${MOCK_SEAFARER_PROFILE.address}</p>
                    <hr>
                    <h3>Current Assignment</h3>
                    <p><strong>Vessel:</strong> ${MOCK_SEAFARER_PROFILE.vessel}</p>
                    <p><strong>Principal:</strong> ${MOCK_SEAFARER_PROFILE.principal}</p>
                    <p><strong>Contract:</strong> ${MOCK_SEAFARER_PROFILE.contractStart} to ${MOCK_SEAFARER_PROFILE.contractEnd}</p>
                    </body></html>
                `;
                const printWindow = window.open('', '_blank');
                printWindow.document.write(printContent);
                printWindow.document.close();
                printWindow.print();
                showNotification('PDF generated!', 'success');
            }, 500);
        }
        function emailSeafarer() { 
            const email = MOCK_SEAFARER_PROFILE.email;
            const subject = encodeURIComponent('Regarding Your Assignment - ' + MOCK_SEAFARER_PROFILE.vessel);
            const body = encodeURIComponent('Dear ' + MOCK_SEAFARER_PROFILE.firstName + ',\n\n');
            window.open('mailto:' + email + '?subject=' + subject + '&body=' + body);
            showNotification('Opening email client...', 'info'); 
        }
        function editSeafarerProfile() { 
            showNotification('Edit mode enabled', 'info'); 
            openModal('editSeafarerModal'); 
        }
        window.printSeafarerProfile = printSeafarerProfile;
        window.emailSeafarer = emailSeafarer;
        window.editSeafarerProfile = editSeafarerProfile;
        
        // SAVE FUNCTIONS FOR MODALS
        function saveNewDocument() {
            const docType = document.getElementById('newDocType')?.value;
            const docNumber = document.getElementById('newDocNumber')?.value;
            const issueDate = document.getElementById('newDocIssueDate')?.value;
            const expiryDate = document.getElementById('newDocExpiryDate')?.value;
            
            if (!docType || !docNumber || !issueDate || !expiryDate) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const newDoc = {
                id: 'DOC' + Date.now(),
                name: docType,
                number: docNumber,
                category: docType.includes('passport') || docType.includes('visa') ? 'travel' : 'certificate',
                issueDate: issueDate,
                expiryDate: expiryDate,
                status: 'valid'
            };
            SP_DOCUMENTS.push(newDoc);
            renderDocumentsTable();
            closeModal('addDocumentModal');
            showNotification('Document added successfully!', 'success');
            // Clear form
            document.getElementById('newDocType').value = '';
            document.getElementById('newDocNumber').value = '';
            document.getElementById('newDocIssueDate').value = '';
            document.getElementById('newDocExpiryDate').value = '';
        }
        window.saveNewDocument = saveNewDocument;
        
        function saveNewSeaService() {
            const vessel = document.getElementById('newSSVessel')?.value;
            const company = document.getElementById('newSSCompany')?.value;
            const rank = document.getElementById('newSSRank')?.value;
            const signOn = document.getElementById('newSSSignOn')?.value;
            const signOff = document.getElementById('newSSSignOff')?.value;
            
            if (!vessel || !company || !rank || !signOn) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const duration = signOff ? calculateDuration(signOn, signOff) : 'Ongoing';
            const newSS = {
                id: 'SS' + Date.now(),
                vessel: vessel,
                company: company,
                rank: rank,
                signOn: signOn,
                signOff: signOff,
                duration: duration
            };
            SP_SEA_SERVICE.unshift(newSS);
            renderSeaServiceTable();
            closeModal('addSeaServiceModal');
            showNotification('Sea service record added successfully!', 'success');
            // Clear form
            document.getElementById('newSSVessel').value = '';
            document.getElementById('newSSCompany').value = '';
            document.getElementById('newSSRank').value = '';
            document.getElementById('newSSSignOn').value = '';
            document.getElementById('newSSSignOff').value = '';
        }
        window.saveNewSeaService = saveNewSeaService;
        
        function calculateDuration(start, end) {
            const s = new Date(start);
            const e = new Date(end);
            const months = Math.round((e - s) / (1000 * 60 * 60 * 24 * 30));
            return months + ' months';
        }
        
        function saveNewAllotment() {
            const beneficiary = document.getElementById('newAllotBeneficiary')?.value;
            const relation = document.getElementById('newAllotRelation')?.value;
            const bank = document.getElementById('newAllotBank')?.value;
            const account = document.getElementById('newAllotAccount')?.value;
            const amount = document.getElementById('newAllotAmount')?.value;
            
            if (!beneficiary || !relation || !bank || !account || !amount) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const newAllot = {
                id: 'ALL' + Date.now(),
                beneficiary: beneficiary,
                relationship: relation,
                bank: bank,
                account: '****' + account.slice(-4),
                amount: '$' + parseFloat(amount).toFixed(2)
            };
            SP_ALLOTMENTS.push(newAllot);
            renderAllotmentsTable();
            closeModal('addAllotmentModal');
            showNotification('Allotment added successfully!', 'success');
            // Clear form
            document.getElementById('newAllotBeneficiary').value = '';
            document.getElementById('newAllotRelation').value = '';
            document.getElementById('newAllotBank').value = '';
            document.getElementById('newAllotAccount').value = '';
            document.getElementById('newAllotAmount').value = '';
        }
        window.saveNewAllotment = saveNewAllotment;
        
        function saveNewNote() {
            const noteType = document.getElementById('newNoteType')?.value || 'info';
            const content = document.getElementById('newNoteContent')?.value;
            
            if (!content) {
                showNotification('Please enter note content', 'error');
                return;
            }
            
            const newNote = {
                id: 'NOTE' + Date.now(),
                author: 'Current User',
                date: new Date().toISOString().split('T')[0],
                content: content,
                type: noteType
            };
            SP_NOTES.unshift(newNote);
            renderNotesAndTimeline();
            closeModal('addNoteModal');
            showNotification('Note added successfully!', 'success');
            document.getElementById('newNoteContent').value = '';
        }
        window.saveNewNote = saveNewNote;
        
        // VIEW/EDIT/DELETE FUNCTIONS FOR TABLE ACTIONS
        function viewDocument(docId) {
            const doc = SP_DOCUMENTS.find(d => d.id === docId);
            if (!doc) return;
            
            const content = document.getElementById('viewDocContent');
            document.getElementById('viewDocTitle').textContent = doc.name;
            content.innerHTML = `
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                    <div class="card" style="margin:0;">
                        <div class="card-body">
                            <h4 style="margin:0 0 16px;color:var(--cw-gray-500);font-size:0.85rem;">DOCUMENT INFORMATION</h4>
                            <div style="display:grid;gap:12px;">
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Document Type</label><div style="font-weight:500;">${doc.name}</div></div>
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Document Number</label><div style="font-weight:500;">${doc.number}</div></div>
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Category</label><div style="font-weight:500;text-transform:capitalize;">${doc.category}</div></div>
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Status</label><div><span class="status-badge" style="background:${getDocStatusColor(doc.status)}20;color:${getDocStatusColor(doc.status)};">${doc.status}</span></div></div>
                            </div>
                        </div>
                    </div>
                    <div class="card" style="margin:0;">
                        <div class="card-body">
                            <h4 style="margin:0 0 16px;color:var(--cw-gray-500);font-size:0.85rem;">VALIDITY</h4>
                            <div style="display:grid;gap:12px;">
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Issue Date</label><div style="font-weight:500;">${formatDateLong(doc.issueDate)}</div></div>
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Expiry Date</label><div style="font-weight:500;">${formatDateLong(doc.expiryDate)}</div></div>
                                <div><label style="font-size:0.75rem;color:var(--cw-gray-500);">Days Until Expiry</label><div style="font-weight:500;color:${doc.status === 'expired' ? '#ef4444' : doc.status === 'expiring' ? '#f59e0b' : '#10b981'};">${calculateDaysUntilExpiry(doc.expiryDate)}</div></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card" style="margin:24px 0 0;">
                    <div class="card-body" style="text-align:center;padding:40px;">
                        <i data-lucide="file-text" style="width:64px;height:64px;color:var(--cw-gray-300);margin-bottom:16px;"></i>
                        <p style="color:var(--cw-gray-500);">Document preview not available</p>
                        <button class="btn btn-primary" onclick="downloadDocument('${docId}')" style="margin-top:12px;"><i data-lucide="download"></i>Download Document</button>
                    </div>
                </div>
            `;
            openModal('viewDocumentModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewDocument = viewDocument;
        
        function calculateDaysUntilExpiry(expiryDate) {
            const today = new Date();
            const expiry = new Date(expiryDate);
            const diff = Math.ceil((expiry - today) / (1000 * 60 * 60 * 24));
            if (diff < 0) return Math.abs(diff) + ' days ago (EXPIRED)';
            if (diff === 0) return 'Expires today';
            return diff + ' days';
        }
        
        function editDocument(docId) {
            showNotification('Edit document feature - opening editor...', 'info');
            // Could populate addDocumentModal with existing data
        }
        window.editDocument = editDocument;
        
        function downloadDocument(docId) {
            showNotification('Downloading document...', 'info');
            setTimeout(() => showNotification('Document downloaded successfully!', 'success'), 1000);
        }
        window.downloadDocument = downloadDocument;
        
        function deleteDocument(docId) {
            if (!confirm('Are you sure you want to delete this document?')) return;
            const idx = SP_DOCUMENTS.findIndex(d => d.id === docId);
            if (idx > -1) {
                SP_DOCUMENTS.splice(idx, 1);
                renderDocumentsTable();
                showNotification('Document deleted', 'success');
            }
        }
        window.deleteDocument = deleteDocument;
        
        function viewSeaService(ssId) {
            const ss = SP_SEA_SERVICE.find(s => s.id === ssId);
            if (!ss) return;
            const initials = ss.vessel.split(' ').map(w => w[0]).join('').substring(0, 2);
            document.getElementById('seaServiceAvatar').textContent = initials;
            document.getElementById('seaServiceVesselName').textContent = ss.vessel;
            document.getElementById('seaServiceRankCompany').textContent = ss.rank + ' - ' + ss.company;
            const statusBadge = document.getElementById('seaServiceStatusBadge');
            if (ss.signOff) {
                statusBadge.textContent = 'COMPLETED';
                statusBadge.style.background = 'rgba(16,185,129,0.3)';
                statusBadge.style.color = '#10b981';
            } else {
                statusBadge.textContent = 'ONBOARD';
                statusBadge.style.background = 'rgba(59,130,246,0.3)';
                statusBadge.style.color = '#3b82f6';
            }
            let statsHtml = '<div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">';
            statsHtml += '<div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);">' + ss.duration + '</div>';
            statsHtml += '<div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Documents</div></div>';
            statsHtml += '<div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">';
            statsHtml += '<div style="font-size:1.5rem;font-weight:700;color:var(--cw-primary);">' + formatDateLong(ss.signOn).split(',')[0] + '</div>';
            statsHtml += '<div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Contract Left</div></div>';
            statsHtml += '<div style="background:var(--cw-gray-50);border-radius:12px;padding:16px;text-align:center;">';
            statsHtml += '<div style="font-size:1.5rem;font-weight:700;color:var(--status-ready);">Dedicated</div>';
            statsHtml += '<div style="font-size:0.75rem;color:var(--cw-gray-500);margin-top:4px;">Pool Type</div></div>';
            document.getElementById('seaServiceStats').innerHTML = statsHtml;
            let html = '<div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:20px;">';
            html += '<h4 style="margin:0 0 16px;font-size:0.85rem;color:var(--cw-gray-500);text-transform:uppercase;"><i data-lucide="anchor" style="width:16px;height:16px;"></i> Sea Service Details</h4>';
            html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Vessel</div><div style="font-weight:600;">' + ss.vessel + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Company</div><div style="font-weight:600;">' + ss.company + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Rank</div><div style="font-weight:600;">' + ss.rank + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Sign On</div><div style="font-weight:600;">' + formatDateLong(ss.signOn) + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Sign Off</div><div style="font-weight:600;">' + (ss.signOff ? formatDateLong(ss.signOff) : '<span class="tag tag-assigned">Onboard</span>') + '</div></div>';
            html += '<div><div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Duration</div><div style="font-weight:600;color:var(--cw-primary);">' + ss.duration + '</div></div>';
            html += '</div></div>';
            document.getElementById('seaServiceContent').innerHTML = html;
            openModal('seaServiceModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        function editSeaServiceFromModal() {
            closeModal('seaServiceModal');
            showNotification('Edit sea service feature coming soon', 'info');
        }
        window.editSeaServiceFromModal = editSeaServiceFromModal;
                window.viewSeaService = viewSeaService;
        
        function editSeaService(ssId) {
            showNotification('Edit sea service feature', 'info');
        }
        window.editSeaService = editSeaService;
        
        function deleteSeaService(ssId) {
            if (!confirm('Are you sure you want to delete this sea service record?')) return;
            const idx = SP_SEA_SERVICE.findIndex(s => s.id === ssId);
            if (idx > -1) {
                SP_SEA_SERVICE.splice(idx, 1);
                renderSeaServiceTable();
                showNotification('Sea service record deleted', 'success');
            }
        }
        window.deleteSeaService = deleteSeaService;
        
        function editAllotment(allId) {
            showNotification('Edit allotment feature', 'info');
        }
        window.editAllotment = editAllotment;
        
        function deleteAllotment(allId) {
            if (!confirm('Are you sure you want to delete this allotment?')) return;
            const idx = SP_ALLOTMENTS.findIndex(a => a.id === allId);
            if (idx > -1) {
                SP_ALLOTMENTS.splice(idx, 1);
                renderAllotmentsTable();
                showNotification('Allotment deleted', 'success');
            }
        }
        window.deleteAllotment = deleteAllotment;
        
        function viewEvaluation(evalId) {
            const ev = SP_EVALUATIONS.find(e => e.id === evalId);
            if (!ev) return;
            showNotification(`Evaluation by ${ev.evaluator} - Score: ${ev.score}/5.0`, 'info');
        }
        window.viewEvaluation = viewEvaluation;
        
        // SEARCH/FILTER FUNCTIONS
        function searchSeaService() {
            const query = document.getElementById('seaServiceSearch')?.value?.toLowerCase() || '';
            const filtered = SP_SEA_SERVICE.filter(ss => 
                ss.vessel.toLowerCase().includes(query) || 
                ss.company.toLowerCase().includes(query) || 
                ss.rank.toLowerCase().includes(query)
            );
            renderSeaServiceTableFiltered(filtered);
        }
        window.searchSeaService = searchSeaService;
        
        function renderSeaServiceTableFiltered(data) {
            const tbody = document.getElementById('seaServiceTableBody');
            if (!tbody) return;
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No sea service records found</td></tr>';
                return;
            }
            tbody.innerHTML = data.map(ss => `
                <tr>
                    <td><strong>${ss.vessel}</strong></td>
                    <td>${ss.company}</td>
                    <td>${ss.rank}</td>
                    <td>${formatDateLong(ss.signOn)}</td>
                    <td>${ss.signOff ? formatDateLong(ss.signOff) : '<span class="status-badge status-embarked">Onboard</span>'}</td>
                    <td>${ss.duration}</td>
                    <td>
                        <button class="btn btn-sm" title="View" onclick="viewSeaService('${ss.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Edit" onclick="editSeaService('${ss.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteSeaService('${ss.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        
        // ALLOTMENTS FILTER
        function filterAllotments() {
            const query = document.getElementById('allotmentSearch')?.value?.toLowerCase() || '';
            const relationFilter = document.getElementById('allotmentRelationFilter')?.value || '';
            
            const filtered = SP_ALLOTMENTS.filter(all => {
                const matchQuery = !query || all.beneficiary.toLowerCase().includes(query) || all.bank.toLowerCase().includes(query);
                const matchRelation = !relationFilter || all.relationship === relationFilter;
                return matchQuery && matchRelation;
            });
            
            const tbody = document.getElementById('allotmentsTableBody');
            if (!tbody) return;
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No allotments found</td></tr>';
                return;
            }
            tbody.innerHTML = filtered.map(all => `
                <tr>
                    <td><strong>${all.beneficiary}</strong></td>
                    <td>${all.relationship}</td>
                    <td>${all.bank}</td>
                    <td>${all.account}</td>
                    <td><strong style="color:var(--cw-primary);">${all.amount}</strong></td>
                    <td>
                        <button class="btn btn-sm" title="Edit" onclick="editAllotment('${all.id}')"><i data-lucide="edit" style="width:14px;height:14px;"></i></button>
                        <button class="btn btn-sm" title="Delete" onclick="deleteAllotment('${all.id}')" style="color:#ef4444;"><i data-lucide="trash-2" style="width:14px;height:14px;"></i></button>
                    </td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterAllotments = filterAllotments;
        
        // EVALUATIONS FILTER
        function filterEvaluations() {
            const query = document.getElementById('evalSearch')?.value?.toLowerCase() || '';
            const scoreFilter = document.getElementById('evalScoreFilter')?.value || '';
            const yearFilter = document.getElementById('evalYearFilter')?.value || '';
            
            const filtered = SP_EVALUATIONS.filter(ev => {
                const matchQuery = !query || ev.contract.toLowerCase().includes(query) || ev.vessel.toLowerCase().includes(query) || ev.evaluator.toLowerCase().includes(query);
                let matchScore = true;
                if (scoreFilter === '5') matchScore = ev.score >= 4.9;
                else if (scoreFilter === '4') matchScore = ev.score >= 4.0;
                else if (scoreFilter === '3') matchScore = ev.score >= 3.0;
                else if (scoreFilter === '2') matchScore = ev.score < 3.0;
                const matchYear = !yearFilter || ev.date.startsWith(yearFilter);
                return matchQuery && matchScore && matchYear;
            });
            
            const tbody = document.getElementById('evaluationsTableBody');
            if (!tbody) return;
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:var(--cw-gray-500);">No evaluations found</td></tr>';
                return;
            }
            tbody.innerHTML = filtered.map(ev => `
                <tr>
                    <td><strong>${ev.contract}</strong></td>
                    <td>${ev.vessel}</td>
                    <td>${ev.evaluator}</td>
                    <td>${formatDateLong(ev.date)}</td>
                    <td>
                        <div style="display:flex;align-items:center;gap:8px;">
                            <div style="display:flex;gap:2px;">
                                ${[1,2,3,4,5].map(i => `<i data-lucide="star" style="width:14px;height:14px;${i <= Math.floor(ev.score) ? 'fill:#f59e0b;' : ''}color:#f59e0b;"></i>`).join('')}
                            </div>
                            <strong>${ev.score}</strong>
                        </div>
                    </td>
                    <td><button class="btn btn-sm" title="View Details" onclick="viewEvaluation('${ev.id}')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                </tr>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterEvaluations = filterEvaluations;
        
        // NOTES FILTER
        function filterNotes() {
            const query = document.getElementById('notesSearch')?.value?.toLowerCase() || '';
            const typeFilter = document.getElementById('notesTypeFilter')?.value || '';
            
            const filtered = SP_NOTES.filter(note => {
                const matchQuery = !query || note.content.toLowerCase().includes(query) || note.author.toLowerCase().includes(query);
                const matchType = !typeFilter || note.type === typeFilter;
                return matchQuery && matchType;
            });
            
            const container = document.getElementById('notesContainer');
            if (!container) return;
            if (filtered.length === 0) {
                container.innerHTML = '<div style="text-align:center;padding:40px;color:var(--cw-gray-500);">No notes found</div>';
                return;
            }
            container.innerHTML = filtered.map(note => `
                <div style="padding:16px;background:var(--cw-gray-50);border-radius:12px;margin-bottom:12px;border-left:4px solid ${note.type === 'positive' ? '#10b981' : note.type === 'warning' ? '#f59e0b' : '#3b82f6'};">
                    <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                        <strong style="font-size:0.9rem;">${note.author}</strong>
                        <span style="color:var(--cw-gray-500);font-size:0.8rem;">${formatDateLong(note.date)}</span>
                    </div>
                    <p style="margin:0;color:var(--cw-gray-700);font-size:0.9rem;">${note.content}</p>
                </div>
            `).join('');
        }
        window.filterNotes = filterNotes;
        
        // TIMELINE FILTER
        function filterTimeline() {
            const typeFilter = document.getElementById('timelineTypeFilter')?.value || '';
            const yearFilter = document.getElementById('timelineYearFilter')?.value || '';
            
            const filtered = SP_TIMELINE.filter(item => {
                const matchType = !typeFilter || item.type === typeFilter;
                const matchYear = !yearFilter || item.date.startsWith(yearFilter);
                return matchType && matchYear;
            });
            
            const container = document.getElementById('timelineContainer');
            if (!container) return;
            if (filtered.length === 0) {
                container.innerHTML = '<div style="text-align:center;padding:40px;color:var(--cw-gray-500);">No timeline events found</div>';
                return;
            }
            container.innerHTML = filtered.map((item, i) => `
                <div style="display:flex;gap:16px;padding-bottom:${i === filtered.length - 1 ? '0' : '20px'};position:relative;">
                    <div style="position:relative;">
                        <div style="width:40px;height:40px;border-radius:50%;background:var(--cw-primary);display:flex;align-items:center;justify-content:center;"><i data-lucide="${item.icon}" style="width:18px;height:18px;color:white;"></i></div>
                        ${i !== filtered.length - 1 ? '<div style="position:absolute;left:50%;top:40px;bottom:-20px;width:2px;background:var(--cw-gray-200);transform:translateX(-50%);"></div>' : ''}
                    </div>
                    <div style="flex:1;padding-top:8px;">
                        <div style="font-weight:500;color:var(--cw-gray-800);">${item.event}</div>
                        <div style="font-size:0.8rem;color:var(--cw-gray-500);margin-top:4px;">${formatDateLong(item.date)}</div>
                    </div>
                </div>
            `).join('');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.filterTimeline = filterTimeline;
        
        function saveChannel() { closeModal('tpChannelModal'); showNotification('Channel saved successfully!', 'success'); renderChannelsTable(); }
        function saveSalaryRange() { closeModal('tpSalaryModal'); showNotification('Salary range saved!', 'success'); renderSalaryRangesTable(); }
        function saveNfr() { closeModal('tpNfrModal'); showNotification('Added to NFR list!', 'success'); renderNfrTable(); }
        function saveAutoTag() { closeModal('tpAutoTagModal'); showNotification('Auto-tag rule saved!', 'success'); renderAutoTagTable(); }
        
        function editChannel(id) { showNotification('Editing channel ' + id, 'info'); openModal('tpChannelModal'); }
        function editSalaryRange(id) { showNotification('Editing salary range', 'info'); openModal('tpSalaryModal'); }
        function editAutoTag(id) { showNotification('Editing rule', 'info'); openModal('tpAutoTagModal'); }
        
        function deleteChannel(id) { if(confirm('Delete this channel?')) { showNotification('Channel deleted!', 'success'); } }
        function deleteSalaryRange(id) { if(confirm('Delete this salary range?')) { showNotification('Salary range deleted!', 'success'); } }
        function deleteAutoTag(id) { if(confirm('Delete this rule?')) { showNotification('Rule deleted!', 'success'); } }
        function removeNfr(id) { if(confirm('Remove from NFR list?')) { showNotification('Removed from NFR!', 'success'); } }
        function viewNfrDetails(id) { 
            const nfr = MOCK_NFR_LIST.find(n => n.id === id);
            if (nfr) showNotification(nfr.name + ': ' + nfr.reason, 'info'); 
        }
        
        // Make all functions globally accessible
        window.saveChannel = saveChannel;
        window.saveSalaryRange = saveSalaryRange;
        window.saveNfr = saveNfr;
        window.saveAutoTag = saveAutoTag;
        window.editChannel = editChannel;
        window.editSalaryRange = editSalaryRange;
        window.editAutoTag = editAutoTag;
        window.deleteChannel = deleteChannel;
        window.deleteSalaryRange = deleteSalaryRange;
        window.deleteAutoTag = deleteAutoTag;
        window.removeNfr = removeNfr;
        window.viewNfrDetails = viewNfrDetails;
        window.exportTalentPoolSettings = exportTalentPoolSettings;
        window.importTalentPoolSettings = importTalentPoolSettings;
        function exportTalentPoolSettings() { 
            const settings = {
                channels: MOCK_CHANNELS,
                salaryRanges: MOCK_SALARY_RANGES,
                nfrList: MOCK_NFR_LIST,
                autoTags: MOCK_AUTO_TAGS,
                exportDate: new Date().toISOString(),
                version: '2.6'
            };
            const blob = new Blob([JSON.stringify(settings, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'talent-pool-settings-' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('Settings exported successfully!', 'success');
        }
        
        function importTalentPoolSettings() { 
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const data = JSON.parse(event.target.result);
                            showNotification('Imported ' + (data.channels?.length || 0) + ' channels, ' + (data.salaryRanges?.length || 0) + ' salary ranges, ' + (data.nfrList?.length || 0) + ' NFR records, ' + (data.autoTags?.length || 0) + ' auto-tag rules.', 'success');
                            // Optionally reload or apply the imported data
                        } catch (error) {
                            showNotification('Error importing settings: ' + error.message, 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }
    
        // Public Registration Modal Functions
        function copyPublicRegURL() {
            const urlInput = document.getElementById('publicRegURL');
            urlInput.select();
            document.execCommand('copy');
            showNotification('URL copied to clipboard!', 'success');
        }
        window.copyPublicRegURL = copyPublicRegURL;

        function openPublicRegPage() {
            window.open('https://crossworld-marine.com/register', '_blank');
            showNotification('Opening registration page...', 'info');
        }
        window.openPublicRegPage = openPublicRegPage;

        function shareViaEmail() {
            const subject = encodeURIComponent('Crossworld Marine - Candidate Registration');
            const body = encodeURIComponent('Please register your profile at: https://crossworld-marine.com/register');
            window.location.href = 'mailto:?subject=' + subject + '&body=' + body;
        }
        window.shareViaEmail = shareViaEmail;

        function generateQRCode() {
            showNotification('QR Code generator coming soon!', 'info');
        }
        window.generateQRCode = generateQRCode;

        function viewRegistrations() {
            closeModal('publicRegistrationModal');
            navigateTo('candidates');
            // Small delay to ensure DOM is ready
            setTimeout(() => {
                const sourceFilter = document.getElementById('candidateSourceFilter');
                if (sourceFilter) {
                    sourceFilter.value = 'online';
                    renderKanbanBoard();
                    showNotification('Showing ' + MOCK_CANDIDATES.filter(c => c.source === 'online').length + ' self-registered candidates', 'success');
                } else {
                    console.error('candidateSourceFilter not found');
                }
            }, 100);
        }
        window.viewRegistrations = viewRegistrations;

        // ===== SUPERNUMERARY PERSONNEL FUNCTIONS =====
        function renderSupernumeraryGrid(data = MOCK_SUPERNUMERARY) {
            const grid = document.getElementById('supernumeraryGrid');
            if (!grid) return;

            if (data.length === 0) {
                grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:60px;color:var(--cw-gray-500);"><i data-lucide="users" style="width:48px;height:48px;margin-bottom:16px;"></i><div style="font-size:1.1rem;font-weight:600;margin-bottom:8px;">No supernumerary personnel found</div><div>Try adjusting your filters</div></div>';
                if (typeof lucide !== 'undefined') lucide.createIcons();
                return;
            }

            grid.innerHTML = data.map(sup => {
                let statusBadge, statusColor, borderColor;
                if (sup.status === 'embarked') {
                    statusBadge = 'EMBARKED';
                    statusColor = '#10b981';
                    borderColor = '#10b981';
                } else if (sup.status === 'pending') {
                    statusBadge = 'PENDING';
                    statusColor = '#3b82f6';
                    borderColor = '#3b82f6';
                } else {
                    statusBadge = 'DISEMBARKED';
                    statusColor = '#6b7280';
                    borderColor = '#6b7280';
                }

                let dateInfo = '';
                if (sup.status === 'embarked') {
                    dateInfo = `
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
                            <div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Currently On</div>
                                <div style="font-weight:600;color:var(--cw-primary);">${sup.vessel}</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-600);margin-top:2px;">Embarked: ${formatDate(sup.embarkedDate)}</div>
                            </div>
                            <div style="text-align:right;">
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Duration</div>
                                <div style="font-weight:600;color:var(--cw-primary);">${sup.duration} days</div>
                                <div style="font-size:0.8rem;color:var(--cw-gray-600);margin-top:2px;">Disembark: ${formatDate(sup.disembarkDate)}</div>
                            </div>
                        </div>
                    `;
                } else if (sup.status === 'pending') {
                    dateInfo = `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Scheduled For</div>
                            <div style="font-weight:600;color:var(--cw-primary);">${sup.vessel}</div>
                            <div style="font-size:0.8rem;color:var(--cw-gray-600);margin-top:2px;">Expected: ${formatDate(sup.scheduledDate)}</div>
                        </div>
                    `;
                } else {
                    dateInfo = `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Last Assignment</div>
                            <div style="font-weight:600;color:var(--cw-primary);">${sup.vessel}</div>
                            <div style="font-size:0.8rem;color:var(--cw-gray-600);margin-top:2px;">Disembarked: ${formatDate(sup.disembarkDate)}</div>
                        </div>
                    `;
                }

                return `
                    <div onclick="viewSupernumerary('${sup.id}')" style="background:white;border-radius:12px;border-left:4px solid ${borderColor};padding:20px;box-shadow:var(--shadow-sm);transition:all var(--transition-base);cursor:pointer;" onmouseover="this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.boxShadow='var(--shadow-sm)'">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:16px;">
                            <div>
                                <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:4px;color:var(--cw-gray-900);">${sup.name}</h3>
                                <div style="font-size:0.85rem;color:var(--cw-gray-600);">${sup.categoryLabel}</div>
                            </div>
                            <span style="display:inline-block;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;background:rgba(${statusColor === '#10b981' ? '16,185,129' : statusColor === '#3b82f6' ? '59,130,246' : '107,114,128'},0.1);color:${statusColor};">${statusBadge}</span>
                        </div>
                        ${dateInfo}
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;padding-top:12px;border-top:1px solid var(--cw-gray-200);">
                            <div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);">Port</div>
                                <div style="font-weight:600;font-size:0.9rem;">${sup.port}</div>
                            </div>
                            <div style="text-align:right;">
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);">Purpose</div>
                                <div style="font-weight:600;font-size:0.9rem;">${sup.purpose}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        function filterSupernumerary() {
            const categoryFilter = document.getElementById('supCategoryFilter')?.value || '';
            const statusFilter = document.getElementById('supStatusFilter')?.value || '';
            const search = document.getElementById('supSearch')?.value?.toLowerCase() || '';

            const filtered = MOCK_SUPERNUMERARY.filter(sup => {
                const matchCategory = !categoryFilter || sup.category === categoryFilter;
                const matchStatus = !statusFilter || sup.status === statusFilter;
                const matchSearch = !search || 
                    sup.name.toLowerCase().includes(search) || 
                    sup.vessel.toLowerCase().includes(search) ||
                    sup.categoryLabel.toLowerCase().includes(search);
                
                return matchCategory && matchStatus && matchSearch;
            });

            renderSupernumeraryGrid(filtered);
        }
        window.filterSupernumerary = filterSupernumerary;

        function viewSupernumerary(supId) {
            const sup = MOCK_SUPERNUMERARY.find(s => s.id === supId);
            if (!sup) return;

            // Store current supernumerary for actions
            currentSupernumerary = sup;

            // Header
            document.getElementById('supModalAvatar').textContent = sup.initials;
            document.getElementById('supModalName').textContent = sup.name;
            document.getElementById('supModalCategory').textContent = sup.categoryLabel;
            
            // Status badge
            const statusBadge = document.getElementById('supModalStatusBadge');
            if (sup.status === 'embarked') {
                statusBadge.textContent = 'EMBARKED';
                statusBadge.style.background = 'rgba(16,185,129,0.3)';
                statusBadge.style.color = '#10b981';
            } else if (sup.status === 'pending') {
                statusBadge.textContent = 'PENDING';
                statusBadge.style.background = 'rgba(59,130,246,0.3)';
                statusBadge.style.color = '#3b82f6';
            } else {
                statusBadge.textContent = 'DISEMBARKED';
                statusBadge.style.background = 'rgba(107,114,128,0.3)';
                statusBadge.style.color = '#6b7280';
            }

            // Duration badge
            const durationBadge = document.getElementById('supModalDurationBadge');
            if (sup.duration) {
                durationBadge.textContent = sup.duration + ' Days';
                durationBadge.style.display = 'inline-block';
            } else {
                durationBadge.style.display = 'none';
            }

            // Personal Details
            document.getElementById('supModalId').textContent = sup.id;
            document.getElementById('supModalNationality').textContent = sup.nationality;
            document.getElementById('supModalCompany').textContent = sup.company;
            document.getElementById('supModalEmail').textContent = sup.email;
            document.getElementById('supModalPhone').textContent = sup.phone;

            // Current Assignment
            document.getElementById('supModalVessel').textContent = sup.vessel;
            document.getElementById('supModalPort').textContent = sup.port;
            document.getElementById('supModalEmbarkDate').textContent = sup.embarkedDate ? formatDateLong(sup.embarkedDate) : '-';
            document.getElementById('supModalDisembarkDate').textContent = sup.disembarkDate ? formatDateLong(sup.disembarkDate) : (sup.scheduledDate ? formatDateLong(sup.scheduledDate) : '-');
            document.getElementById('supModalPurpose').textContent = sup.purpose;

            // Notes
            document.getElementById('supModalNotes').textContent = sup.remarks;

            // Timeline
            document.getElementById('supModalCreatedDate').textContent = formatDateLong(sup.createdDate);
            document.getElementById('supModalApprovedDate').textContent = formatDateLong(sup.approvedDate);
            
            const embarkedTimeline = document.getElementById('supModalEmbarkedTimeline');
            if (sup.status === 'embarked' && sup.embarkedDate) {
                embarkedTimeline.style.display = 'flex';
                document.getElementById('supModalEmbarkedDate').textContent = formatDateLong(sup.embarkedDate);
            } else {
                embarkedTimeline.style.display = 'none';
            }

            openModal('supernumeraryDetailModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewSupernumerary = viewSupernumerary;

        // Supernumerary Quick Actions Functions
        let currentSupernumerary = null;

        function editSupernumeraryDetails() {
            if (!currentSupernumerary) {
                showNotification('No supernumerary selected', 'error');
                return;
            }
            
            closeModal('supernumeraryDetailModal');
            
            // Create edit modal content
            const editHtml = `
                <div class="modal-header">
                    <h3 class="modal-title">Edit Supernumerary Details</h3>
                    <button class="modal-close" onclick="closeModal('editSupernumeraryModal')">
                        <i data-lucide="x" style="width:20px;height:20px;"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editSupernumeraryForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-input" value="${currentSupernumerary.name}" id="editSupName">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="editSupCategory">
                                    <option value="inspector" ${currentSupernumerary.category === 'inspector' ? 'selected' : ''}>Flag State Inspector</option>
                                    <option value="observer" ${currentSupernumerary.category === 'observer' ? 'selected' : ''}>Port State Observer</option>
                                    <option value="superintendent" ${currentSupernumerary.category === 'superintendent' ? 'selected' : ''}>Technical Superintendent</option>
                                    <option value="auditor" ${currentSupernumerary.category === 'auditor' ? 'selected' : ''}>Safety Auditor</option>
                                    <option value="trainer" ${currentSupernumerary.category === 'trainer' ? 'selected' : ''}>Training Officer</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-input" value="${currentSupernumerary.email}" id="editSupEmail">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-input" value="${currentSupernumerary.phone}" id="editSupPhone">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Company</label>
                                <input type="text" class="form-input" value="${currentSupernumerary.company}" id="editSupCompany">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nationality</label>
                                <input type="text" class="form-input" value="${currentSupernumerary.nationality}" id="editSupNationality">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Notes</label>
                            <textarea class="form-textarea" id="editSupRemarks" rows="3">${currentSupernumerary.remarks}</textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('editSupernumeraryModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSupernumeraryEdit()">
                        <i data-lucide="save"></i>Save Changes
                    </button>
                </div>
            `;
            
            // Create modal if doesn't exist
            let modal = document.getElementById('editSupernumeraryModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'editSupernumeraryModal';
                modal.className = 'modal-overlay';
                modal.onclick = function(e) { if (e.target === modal) closeModal('editSupernumeraryModal'); };
                document.body.appendChild(modal);
            }
            
            modal.innerHTML = `<div class="modal large" onclick="event.stopPropagation()">${editHtml}</div>`;
            openModal('editSupernumeraryModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.editSupernumeraryDetails = editSupernumeraryDetails;

        function saveSupernumeraryEdit() {
            const name = document.getElementById('editSupName').value;
            const email = document.getElementById('editSupEmail').value;
            const phone = document.getElementById('editSupPhone').value;
            
            if (!name || !email) {
                showNotification('Name and Email are required', 'error');
                return;
            }
            
            // Update mock data
            const sup = MOCK_SUPERNUMERARY.find(s => s.id === currentSupernumerary.id);
            if (sup) {
                sup.name = name;
                sup.email = email;
                sup.phone = phone;
                sup.company = document.getElementById('editSupCompany').value;
                sup.nationality = document.getElementById('editSupNationality').value;
                sup.remarks = document.getElementById('editSupRemarks').value;
                
                const categorySelect = document.getElementById('editSupCategory');
                sup.category = categorySelect.value;
                sup.categoryLabel = categorySelect.options[categorySelect.selectedIndex].text;
            }
            
            closeModal('editSupernumeraryModal');
            renderSupernumeraryGrid();
            showNotification('Supernumerary details updated successfully', 'success');
        }
        window.saveSupernumeraryEdit = saveSupernumeraryEdit;

        function sendSupernumeraryEmail() {
            if (!currentSupernumerary) {
                showNotification('No supernumerary selected', 'error');
                return;
            }
            
            const subject = encodeURIComponent(`Re: ${currentSupernumerary.purpose} - ${currentSupernumerary.vessel}`);
            const body = encodeURIComponent(`Dear ${currentSupernumerary.name},

Regarding your assignment:
Vessel: ${currentSupernumerary.vessel}
Port: ${currentSupernumerary.port}
Purpose: ${currentSupernumerary.purpose}

Best regards,
Crossworld Marine Services`);
            
            window.location.href = `mailto:${currentSupernumerary.email}?subject=${subject}&body=${body}`;
            showNotification('Opening email client...', 'info');
        }
        window.sendSupernumeraryEmail = sendSupernumeraryEmail;

        function viewSupernumeraryDocuments() {
            if (!currentSupernumerary) {
                showNotification('No supernumerary selected', 'error');
                return;
            }
            
            closeModal('supernumeraryDetailModal');
            
            // Create documents modal
            const docsHtml = `
                <div class="modal-header">
                    <h3 class="modal-title">Documents - ${currentSupernumerary.name}</h3>
                    <button class="modal-close" onclick="closeModal('supernumeraryDocsModal')">
                        <i data-lucide="x" style="width:20px;height:20px;"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div style="margin-bottom:20px;">
                        <div style="display:flex;align-items:center;gap:12px;padding:16px;background:var(--cw-gray-50);border-radius:8px;">
                            <i data-lucide="user" style="width:40px;height:40px;color:var(--cw-primary);"></i>
                            <div>
                                <div style="font-weight:600;font-size:1.1rem;">${currentSupernumerary.name}</div>
                                <div style="color:var(--cw-gray-600);font-size:0.9rem;">${currentSupernumerary.categoryLabel}</div>
                            </div>
                        </div>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Document Type</th>
                                <th>Number</th>
                                <th>Issue Date</th>
                                <th>Expiry Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Passport</strong></td>
                                <td id="doc-passport-num">P${Math.random().toString().slice(2,11)}</td>
                                <td>${formatDateLong('2021-03-15')}</td>
                                <td>${formatDateLong('2031-03-14')}</td>
                                <td><span class="status-badge status-ready">Valid</span></td>
                                <td><button class="btn btn-sm" onclick="viewDocument('Passport', document.getElementById('doc-passport-num').textContent, '2021-03-15', '2031-03-14')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                            </tr>
                            <tr>
                                <td><strong>Professional License</strong></td>
                                <td id="doc-license-num">LIC-${Math.random().toString().slice(2,9)}</td>
                                <td>${formatDateLong('2023-01-10')}</td>
                                <td>${formatDateLong('2028-01-09')}</td>
                                <td><span class="status-badge status-ready">Valid</span></td>
                                <td><button class="btn btn-sm" onclick="viewDocument('Professional License', document.getElementById('doc-license-num').textContent, '2023-01-10', '2028-01-09')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                            </tr>
                            <tr>
                                <td><strong>Medical Certificate</strong></td>
                                <td id="doc-medical-num">MED-${Math.random().toString().slice(2,8)}</td>
                                <td>${formatDateLong('2025-11-20')}</td>
                                <td>${formatDateLong('2026-11-19')}</td>
                                <td><span class="status-badge status-ready">Valid</span></td>
                                <td><button class="btn btn-sm" onclick="viewDocument('Medical Certificate', document.getElementById('doc-medical-num').textContent, '2025-11-20', '2026-11-19')"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                            </tr>
                            <tr>
                                <td><strong>Certification of Employment</strong></td>
                                <td>COE-${currentSupernumerary.id}</td>
                                <td>${formatDateLong(currentSupernumerary.createdDate)}</td>
                                <td>-</td>
                                <td><span class="status-badge status-ready">Active</span></td>
                                <td><button class="btn btn-sm" onclick="viewDocument('Certification of Employment', 'COE-${currentSupernumerary.id}', '${currentSupernumerary.createdDate}', null)"><i data-lucide="eye" style="width:14px;height:14px;"></i></button></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="margin-top:24px;padding:16px;background:#fef3c7;border:2px solid #fbbf24;border-radius:8px;">
                        <div style="display:flex;align-items:start;gap:12px;">
                            <i data-lucide="info" style="width:20px;height:20px;color:#f59e0b;flex-shrink:0;"></i>
                            <div style="color:#78350f;font-size:0.9rem;">
                                <strong>Note:</strong> All documents are subject to verification by the vessel master and must be valid for the entire duration of the assignment.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('supernumeraryDocsModal')">Close</button>
                    <button class="btn btn-primary" onclick="showNotification('Upload feature coming soon','info')">
                        <i data-lucide="upload"></i>Upload Document
                    </button>
                </div>
            `;
            
            let modal = document.getElementById('supernumeraryDocsModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'supernumeraryDocsModal';
                modal.className = 'modal-overlay';
                modal.onclick = function(e) { if (e.target === modal) closeModal('supernumeraryDocsModal'); };
                document.body.appendChild(modal);
            }
            
            modal.innerHTML = `<div class="modal large" onclick="event.stopPropagation()">${docsHtml}</div>`;
            openModal('supernumeraryDocsModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewSupernumeraryDocuments = viewSupernumeraryDocuments;

        function viewDocument(docType, docNumber, issueDate, expiryDate) {
            if (!currentSupernumerary) return;
            
            const viewerHtml = `
                <div class="modal-header" style="background:linear-gradient(135deg, #00495D 0%, #0891b2 100%);color:white;border-radius:12px 12px 0 0;margin:-24px -24px 24px -24px;padding:24px;">
                    <h3 style="margin:0;font-size:1.3rem;font-weight:700;color:white;">Document Viewer</h3>
                    <button class="modal-close" onclick="closeModal('documentViewerModal')" style="background:rgba(255,255,255,0.2);color:white;">
                        <i data-lucide="x" style="width:20px;height:20px;"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Document Info Header -->
                    <div style="background:var(--cw-gray-50);border-radius:12px;padding:20px;margin-bottom:24px;">
                        <div style="display:grid;grid-template-columns:auto 1fr;gap:20px;align-items:center;">
                            <div style="width:80px;height:80px;background:linear-gradient(135deg, #00495D, #0891b2);border-radius:12px;display:flex;align-items:center;justify-content:center;">
                                <i data-lucide="file-text" style="width:40px;height:40px;color:white;"></i>
                            </div>
                            <div>
                                <div style="font-size:0.75rem;color:var(--cw-gray-500);text-transform:uppercase;margin-bottom:4px;">Document Type</div>
                                <h2 style="margin:0 0 8px 0;font-size:1.5rem;font-weight:700;color:var(--cw-gray-900);">${docType}</h2>
                                <div style="font-size:0.9rem;color:var(--cw-gray-600);">
                                    <strong>Number:</strong> ${docNumber} â€¢ 
                                    <strong>Holder:</strong> ${currentSupernumerary.name}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Document Details -->
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px;">
                        <div style="background:white;border:2px solid var(--cw-gray-200);border-radius:12px;padding:20px;">
                            <h4 style="margin:0 0 16px 0;font-size:0.9rem;font-weight:600;color:var(--cw-gray-700);display:flex;align-items:center;gap:8px;">
                                <i data-lucide="calendar" style="width:16px;height:16px;"></i>
                                Issue Information
                            </h4>
                            <div style="display:grid;gap:12px;">
                                <div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Issue Date</div>
                                    <div style="font-weight:600;font-size:1rem;">${formatDateLong(issueDate)}</div>
                                </div>
                                <div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Expiry Date</div>
                                    <div style="font-weight:600;font-size:1rem;">${expiryDate ? formatDateLong(expiryDate) : 'No expiry'}</div>
                                </div>
                            </div>
                        </div>
                        <div style="background:white;border:2px solid var(--cw-gray-200);border-radius:12px;padding:20px;">
                            <h4 style="margin:0 0 16px 0;font-size:0.9rem;font-weight:600;color:var(--cw-gray-700);display:flex;align-items:center;gap:8px;">
                                <i data-lucide="user" style="width:16px;height:16px;"></i>
                                Holder Information
                            </h4>
                            <div style="display:grid;gap:12px;">
                                <div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Name</div>
                                    <div style="font-weight:600;font-size:1rem;">${currentSupernumerary.name}</div>
                                </div>
                                <div>
                                    <div style="font-size:0.75rem;color:var(--cw-gray-500);margin-bottom:4px;">Nationality</div>
                                    <div style="font-weight:600;font-size:1rem;">${currentSupernumerary.nationality}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Document Preview -->
                    <div style="background:white;border:2px solid var(--cw-gray-200);border-radius:12px;padding:20px;margin-bottom:24px;">
                        <h4 style="margin:0 0 16px 0;font-size:0.9rem;font-weight:600;color:var(--cw-gray-700);display:flex;align-items:center;gap:8px;">
                            <i data-lucide="image" style="width:16px;height:16px;"></i>
                            Document Preview
                        </h4>
                        <div style="background:var(--cw-gray-100);border:2px dashed var(--cw-gray-300);border-radius:8px;padding:60px;text-align:center;">
                            <i data-lucide="file" style="width:64px;height:64px;color:var(--cw-gray-400);margin-bottom:16px;"></i>
                            <div style="font-size:1.1rem;font-weight:600;color:var(--cw-gray-700);margin-bottom:8px;">Document Preview Unavailable</div>
                            <div style="font-size:0.9rem;color:var(--cw-gray-500);">
                                ${docType} â€¢ ${docNumber}
                            </div>
                            <div style="margin-top:20px;">
                                <button class="btn btn-primary" onclick="downloadDocumentFile('${docType}', '${docNumber}')">
                                    <i data-lucide="download"></i>
                                    Download Document
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Verification Status -->
                    <div style="background:linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);border:2px solid #10b981;border-radius:12px;padding:16px;">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <div style="width:40px;height:40px;background:#10b981;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
                                <i data-lucide="check" style="width:24px;height:24px;color:white;"></i>
                            </div>
                            <div style="flex:1;">
                                <div style="font-weight:600;color:#065f46;margin-bottom:4px;">Document Verified</div>
                                <div style="font-size:0.85rem;color:#047857;">This document has been verified by Crossworld Marine Services on ${formatDateLong(new Date().toISOString())}</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('documentViewerModal')">Close</button>
                    <button class="btn btn-secondary" onclick="printDocument('${docType}', '${docNumber}')">
                        <i data-lucide="printer"></i>Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadDocumentFile('${docType}', '${docNumber}')">
                        <i data-lucide="download"></i>Download
                    </button>
                </div>
            `;
            
            let modal = document.getElementById('documentViewerModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'documentViewerModal';
                modal.className = 'modal-overlay';
                modal.onclick = function(e) { if (e.target === modal) closeModal('documentViewerModal'); };
                document.body.appendChild(modal);
            }
            
            modal.innerHTML = `<div class="modal large" onclick="event.stopPropagation()" style="max-width:800px;">${viewerHtml}</div>`;
            openModal('documentViewerModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewDocument = viewDocument;

        function downloadDocumentFile(docType, docNumber) {
            if (!currentSupernumerary) return;
            
            const pdfContent = `CROSSWORLD MARINE SERVICES - Official Document

Document Type: ${docType}
Document Number: ${docNumber}

HOLDER INFORMATION
Name: ${currentSupernumerary.name}
Nationality: ${currentSupernumerary.nationality}
Company: ${currentSupernumerary.company}
Category: ${currentSupernumerary.categoryLabel}

CONTACT INFORMATION
Email: ${currentSupernumerary.email}
Phone: ${currentSupernumerary.phone}

CURRENT ASSIGNMENT
Vessel: ${currentSupernumerary.vessel}
Port: ${currentSupernumerary.port}
Purpose: ${currentSupernumerary.purpose}

VERIFICATION
This document has been verified by Crossworld Marine Services
Verification Date: ${new Date().toLocaleDateString()}

Document ID: ${docNumber}
Generated: ${new Date().toISOString()}`;
            
            const blob = new Blob([pdfContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = docType.replace(/\s+/g, '_') + '_' + docNumber + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            showNotification(docType + ' downloaded successfully', 'success');
        }
        window.downloadDocumentFile = downloadDocumentFile;

        function printDocument(docType, docNumber) {
            if (!currentSupernumerary) return;
            const printWin = window.open('', '_blank');
            printWin.document.write('<html><head><title>' + docType + '</title>');
            printWin.document.write('<style>body{font-family:Arial;max-width:800px;margin:40px auto;padding:40px}.header{text-align:center;margin-bottom:40px;border-bottom:3px solid #00495D;padding-bottom:20px}.company{font-size:24px;font-weight:bold;color:#00495D}.doc-title{font-size:28px;font-weight:bold;margin:20px 0}.section{margin:30px 0}.section-title{background:#00495D;color:white;padding:10px 15px;font-weight:bold;margin-bottom:15px}.info-row{display:grid;grid-template-columns:200px 1fr;padding:10px 15px;border-bottom:1px solid #e0e0e0}.info-label{font-weight:bold;color:#666}.verification{background:#ecfdf5;border:2px solid #10b981;padding:20px;margin-top:40px}.footer{margin-top:60px;padding-top:20px;border-top:2px solid #ddd;text-align:center;font-size:12px;color:#666}</style>');
            printWin.document.write('</head><body>');
            printWin.document.write('<div class="header"><div class="company">CROSSWORLD MARINE SERVICES</div><div>Official Document</div></div>');
            printWin.document.write('<div class="doc-title">' + docType + '</div>');
            printWin.document.write('<div style="text-align:center;font-size:18px;color:#666;margin-bottom:40px">Document Number: ' + docNumber + '</div>');
            printWin.document.write('<div class="section"><div class="section-title">HOLDER INFORMATION</div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Name:</div><div>' + currentSupernumerary.name + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Nationality:</div><div>' + currentSupernumerary.nationality + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Company:</div><div>' + currentSupernumerary.company + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Category:</div><div>' + currentSupernumerary.categoryLabel + '</div></div></div>');
            printWin.document.write('<div class="section"><div class="section-title">CONTACT INFORMATION</div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Email:</div><div>' + currentSupernumerary.email + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Phone:</div><div>' + currentSupernumerary.phone + '</div></div></div>');
            printWin.document.write('<div class="section"><div class="section-title">CURRENT ASSIGNMENT</div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Vessel:</div><div>' + currentSupernumerary.vessel + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Port:</div><div>' + currentSupernumerary.port + '</div></div>');
            printWin.document.write('<div class="info-row"><div class="info-label">Purpose:</div><div>' + currentSupernumerary.purpose + '</div></div></div>');
            printWin.document.write('<div class="verification"><strong style="color:#065f46">âœ“ Document Verified</strong><br>Verified by Crossworld Marine Services on ' + new Date().toLocaleDateString() + '</div>');
            printWin.document.write('<div class="footer">Document ID: ' + docNumber + ' | Generated: ' + new Date().toLocaleString() + '</div>');
            printWin.document.write('</body></html>');
            printWin.document.close();
            printWin.focus();
            setTimeout(function() { printWin.print(); }, 250);
            showNotification('Opening print dialog...', 'info');
        }
        window.printDocument = printDocument;

        function saveNewSupernumerary() {
            const name = document.getElementById('newSupName').value.trim();
            const category = document.getElementById('newSupCategory').value;
            const email = document.getElementById('newSupEmail').value.trim();
            
            if (!name || !category || !email) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const categoryLabels = {
                'inspector': 'Flag State Inspector',
                'observer': 'Port State Observer',
                'superintendent': 'Technical Superintendent',
                'auditor': 'Safety Auditor',
                'trainer': 'Training Officer'
            };
            
            const newId = 'SUP-' + String(MOCK_SUPERNUMERARY.length + 1).padStart(3, '0');
            const initials = name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            
            const newSupernumerary = {
                id: newId,
                name: name,
                initials: initials,
                nationality: document.getElementById('newSupNationality').value.trim() || 'Not specified',
                company: document.getElementById('newSupCompany').value.trim() || 'Not specified',
                email: email,
                phone: document.getElementById('newSupPhone').value.trim() || 'Not specified',
                category: category,
                categoryLabel: categoryLabels[category],
                status: 'pending',
                vessel: document.getElementById('newSupVessel').value.trim() || 'TBA',
                port: document.getElementById('newSupPort').value.trim() || 'TBA',
                embarkedDate: null,
                disembarkDate: null,
                scheduledDate: null,
                duration: null,
                purpose: document.getElementById('newSupPurpose').value.trim() || 'TBA',
                remarks: document.getElementById('newSupRemarks').value.trim() || 'No remarks',
                createdDate: new Date().toISOString().split('T')[0],
                approvedDate: new Date().toISOString().split('T')[0]
            };
            
            MOCK_SUPERNUMERARY.push(newSupernumerary);
            
            document.getElementById('addSupernumeraryForm').reset();
            closeModal('addSupernumeraryModal');
            renderSupernumeraryGrid();
            showNotification('Supernumerary personnel added successfully', 'success');
        }
        window.saveNewSupernumerary = saveNewSupernumerary;

        function renderCrewChanges(data) {
            if (!data) data = MOCK_CREW_CHANGES;
            
            const grid = document.getElementById('crewChangesGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            if (data.length === 0) {
                grid.innerHTML = '<div style="text-align:center;padding:60px;color:var(--cw-gray-500);">No crew changes found</div>';
                return;
            }
            
            data.forEach(function(cc) {
                const card = document.createElement('div');
                card.style.cssText = 'background:white;border-radius:12px;padding:20px;box-shadow:var(--shadow-sm);border-left:4px solid ' + (cc.type === 'embark' ? '#10b981' : '#ef4444') + ';cursor:pointer;transition:all 0.2s;';
                card.onmouseover = function() { this.style.boxShadow = 'var(--shadow-md)'; };
                card.onmouseout = function() { this.style.boxShadow = 'var(--shadow-sm)'; };
                card.onclick = function() { viewCrewChangeDetail(cc.id); };
                
                const header = document.createElement('div');
                header.style.cssText = 'display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;';
                
                const nameRank = document.createElement('div');
                const name = document.createElement('div');
                name.style.cssText = 'font-size:1.1rem;font-weight:600;margin-bottom:4px;';
                name.textContent = cc.name + ' - ' + cc.rank;
                const vesselPort = document.createElement('div');
                vesselPort.style.cssText = 'font-size:0.9rem;color:var(--cw-gray-600);';
                vesselPort.textContent = cc.vessel + ' â€¢ ' + cc.port;
                nameRank.appendChild(name);
                nameRank.appendChild(vesselPort);
                
                const statusBadge = document.createElement('span');
                statusBadge.style.cssText = 'display:inline-block;padding:4px 12px;border-radius:12px;font-size:0.75rem;font-weight:600;text-transform:uppercase;';
                if (cc.status === 'confirmed') {
                    statusBadge.style.background = 'rgba(16,185,129,0.1)';
                    statusBadge.style.color = '#10b981';
                    statusBadge.textContent = 'CONFIRMED';
                } else if (cc.status === 'planning') {
                    statusBadge.style.background = 'rgba(59,130,246,0.1)';
                    statusBadge.style.color = '#3b82f6';
                    statusBadge.textContent = 'PLANNING';
                } else {
                    statusBadge.style.background = 'rgba(107,114,128,0.1)';
                    statusBadge.style.color = '#6b7280';
                    statusBadge.textContent = 'COMPLETED';
                }
                
                header.appendChild(nameRank);
                header.appendChild(statusBadge);
                
                const dateInfo = document.createElement('div');
                dateInfo.style.cssText = 'display:flex;align-items:center;gap:8px;color:var(--cw-gray-700);font-size:0.9rem;';
                const icon = document.createElement('span');
                icon.innerHTML = cc.type === 'embark' ? 'ðŸ”¼' : 'ðŸ”½';
                const label = document.createElement('span');
                label.style.fontWeight = '600';
                label.textContent = cc.type === 'embark' ? 'Embarkation:' : 'Sign-off:';
                const date = document.createElement('span');
                date.textContent = cc.date;
                dateInfo.appendChild(icon);
                dateInfo.appendChild(label);
                dateInfo.appendChild(date);
                
                card.appendChild(header);
                card.appendChild(dateInfo);
                grid.appendChild(card);
            });
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.renderCrewChanges = renderCrewChanges;

        function filterCrewChanges() {
            const typeFilter = document.getElementById('crewChangeTypeFilter').value;
            const statusFilter = document.getElementById('crewChangeStatusFilter').value;
            const portFilter = document.getElementById('crewChangePortFilter').value;
            const search = document.getElementById('crewChangeSearch').value.toLowerCase();
            
            let filtered = MOCK_CREW_CHANGES.filter(function(cc) {
                if (typeFilter && cc.type !== typeFilter) return false;
                if (statusFilter && cc.status !== statusFilter) return false;
                if (portFilter && cc.port.toLowerCase() !== portFilter) return false;
                if (search && !cc.name.toLowerCase().includes(search) && !cc.vessel.toLowerCase().includes(search) && !cc.port.toLowerCase().includes(search)) return false;
                return true;
            });
            
            renderCrewChanges(filtered);
        }
        window.filterCrewChanges = filterCrewChanges;

        function viewCrewChangeDetail(ccId) {
            const cc = MOCK_CREW_CHANGES.find(function(c) { return c.id === ccId; });
            if (!cc) return;
            
            currentCrewChange = cc;
            
            const container = document.getElementById('crewChangeDetailContent');
            if (!container) return;
            
            container.innerHTML = '';
            
            const borderColor = cc.type === 'embark' ? '#10b981' : '#ef4444';
            const bgColor = cc.type === 'embark' ? 'rgba(16,185,129,0.05)' : 'rgba(239,68,68,0.05)';
            
            const mainCard = document.createElement('div');
            mainCard.style.cssText = 'background:' + bgColor + ';border-left:4px solid ' + borderColor + ';border-radius:12px;padding:24px;';
            
            const header = document.createElement('div');
            header.style.cssText = 'display:flex;justify-content:space-between;align-items:start;margin-bottom:20px;';
            
            const nameSection = document.createElement('div');
            const name = document.createElement('h2');
            name.style.cssText = 'font-size:1.5rem;font-weight:700;margin:0 0 8px 0;color:var(--cw-gray-900);';
            name.textContent = cc.name + ' - ' + cc.rank;
            
            const vesselPort = document.createElement('div');
            vesselPort.style.cssText = 'font-size:1rem;color:var(--cw-gray-600);';
            vesselPort.textContent = cc.vessel + ' â€¢ ' + cc.port;
            
            nameSection.appendChild(name);
            nameSection.appendChild(vesselPort);
            
            const statusBadge = document.createElement('span');
            statusBadge.style.cssText = 'display:inline-block;padding:8px 16px;border-radius:16px;font-size:0.85rem;font-weight:600;text-transform:uppercase;';
            if (cc.status === 'confirmed') {
                statusBadge.style.background = 'rgba(16,185,129,0.15)';
                statusBadge.style.color = '#059669';
                statusBadge.textContent = 'CONFIRMED';
            } else if (cc.status === 'planning') {
                statusBadge.style.background = 'rgba(59,130,246,0.15)';
                statusBadge.style.color = '#2563eb';
                statusBadge.textContent = 'PLANNING';
            } else {
                statusBadge.style.background = 'rgba(107,114,128,0.15)';
                statusBadge.style.color = '#4b5563';
                statusBadge.textContent = 'COMPLETED';
            }
            
            header.appendChild(nameSection);
            header.appendChild(statusBadge);
            
            const dateSection = document.createElement('div');
            dateSection.style.cssText = 'display:flex;align-items:center;gap:12px;padding:16px;background:white;border-radius:8px;';
            
            const icon = document.createElement('div');
            icon.style.cssText = 'width:40px;height:40px;border-radius:50%;background:' + borderColor + ';display:flex;align-items:center;justify-content:center;font-size:1.2rem;';
            icon.textContent = cc.type === 'embark' ? 'ðŸ”¼' : 'ðŸ”½';
            
            const dateInfo = document.createElement('div');
            dateInfo.style.flex = '1';
            
            const dateLabel = document.createElement('div');
            dateLabel.style.cssText = 'font-size:0.85rem;color:var(--cw-gray-600);margin-bottom:4px;';
            dateLabel.textContent = cc.type === 'embark' ? 'Embarkation Date' : 'Sign-off Date';
            
            const dateValue = document.createElement('div');
            dateValue.style.cssText = 'font-size:1.1rem;font-weight:600;color:var(--cw-gray-900);';
            dateValue.textContent = cc.date;
            
            dateInfo.appendChild(dateLabel);
            dateInfo.appendChild(dateValue);
            
            dateSection.appendChild(icon);
            dateSection.appendChild(dateInfo);
            
            mainCard.appendChild(header);
            mainCard.appendChild(dateSection);
            
            const infoCard = document.createElement('div');
            infoCard.style.cssText = 'background:white;border:1px solid var(--cw-gray-200);border-radius:12px;padding:20px;';
            
            const infoTitle = document.createElement('h4');
            infoTitle.style.cssText = 'margin:0 0 16px 0;font-size:0.95rem;font-weight:600;color:var(--cw-gray-700);';
            infoTitle.textContent = 'Additional Information';
            
            const infoGrid = document.createElement('div');
            infoGrid.style.cssText = 'display:grid;gap:12px;';
            
            const createInfoRow = function(label, value) {
                const row = document.createElement('div');
                row.style.cssText = 'display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--cw-gray-100);';
                
                const labelEl = document.createElement('span');
                labelEl.style.cssText = 'color:var(--cw-gray-600);';
                labelEl.textContent = label;
                
                const valueEl = document.createElement('span');
                valueEl.style.cssText = 'font-weight:600;color:var(--cw-gray-900);';
                valueEl.textContent = value;
                
                row.appendChild(labelEl);
                row.appendChild(valueEl);
                return row;
            };
            
            infoGrid.appendChild(createInfoRow('Crew Change ID:', cc.id));
            infoGrid.appendChild(createInfoRow('Type:', cc.type === 'embark' ? 'Embarkation' : 'Sign-off'));
            infoGrid.appendChild(createInfoRow('Vessel:', cc.vessel));
            infoGrid.appendChild(createInfoRow('Port:', cc.port));
            infoGrid.appendChild(createInfoRow('Date:', cc.date));
            
            infoCard.appendChild(infoTitle);
            infoCard.appendChild(infoGrid);
            
            container.appendChild(mainCard);
            container.appendChild(infoCard);
            
            openModal('crewChangeDetailModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewCrewChangeDetail = viewCrewChangeDetail;

        let currentCrewChange = null;

        function editCrewChange() {
            if (!currentCrewChange) return;
            
            closeModal('crewChangeDetailModal');
            
            document.getElementById('editCcName').value = currentCrewChange.name;
            document.getElementById('editCcRank').value = currentCrewChange.rank;
            document.getElementById('editCcVessel').value = currentCrewChange.vessel;
            document.getElementById('editCcPort').value = currentCrewChange.port;
            document.getElementById('editCcDate').value = currentCrewChange.date;
            document.getElementById('editCcStatus').value = currentCrewChange.status;
            
            openModal('editCrewChangeModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.editCrewChange = editCrewChange;

        function saveCrewChangeEdit() {
            if (!currentCrewChange) return;
            
            const cc = MOCK_CREW_CHANGES.find(function(c) { return c.id === currentCrewChange.id; });
            if (!cc) return;
            
            cc.vessel = document.getElementById('editCcVessel').value;
            cc.port = document.getElementById('editCcPort').value;
            cc.date = document.getElementById('editCcDate').value;
            cc.status = document.getElementById('editCcStatus').value;
            
            closeModal('editCrewChangeModal');
            renderCrewChanges();
            showNotification('Crew change updated successfully', 'success');
        }
        window.saveCrewChangeEdit = saveCrewChangeEdit;

        function filterByPort(portName) {
            document.getElementById('crewChangePortFilter').value = portName.toLowerCase();
            filterCrewChanges();
            showNotification('Showing crew changes for ' + portName, 'info');
        }
        window.filterByPort = filterByPort;

        function viewAlertDetail(alertType) {
            const container = document.getElementById('alertDetailContent');
            const titleEl = document.getElementById('alertModalTitle');
            if (!container || !titleEl) return;
            
            container.innerHTML = '';
            
            let alertData = {};
            
            if (alertType === 'visa-pending') {
                titleEl.textContent = 'Visa Pending Alert';
                alertData = {
                    severity: 'Critical',
                    severityColor: '#ef4444',
                    severityBg: '#fee2e2',
                    seafarer: 'SF-2847',
                    name: 'Rajesh Kumar',
                    rank: 'AB Seaman',
                    vessel: 'MV ARTEMIS',
                    issue: 'India visa processing',
                    description: 'Seafarer visa application submitted to India consulate on Feb 5, 2026. Standard processing time is 7-10 business days. Current status: Under review.',
                    impact: 'Crew change scheduled for Feb 25, 2026 may be delayed if visa not approved by Feb 20.',
                    action: 'Follow up with consulate on Feb 15. Consider backup seafarer if not resolved by Feb 18.'
                };
            } else if (alertType === 'port-agent') {
                titleEl.textContent = 'Port Agent Unconfirmed';
                alertData = {
                    severity: 'Warning',
                    severityColor: '#f59e0b',
                    severityBg: '#fef3c7',
                    seafarer: 'Multiple',
                    name: 'Dubai Crew Changes',
                    rank: 'Various',
                    vessel: 'MV ARTEMIS, MV HERMES',
                    issue: 'Port agent awaiting confirmation',
                    description: 'Dubai port agent has not confirmed availability for crew changes scheduled Feb 25-28. Agent contacted on Feb 10, response pending.',
                    impact: '2 crew changes (1 embarkation, 1 sign-off) may need alternative port arrangements.',
                    action: 'Escalate to agent manager. Identify backup port agents in Dubai or consider Jebel Ali alternative.'
                };
            }
            
            const severityCard = document.createElement('div');
            severityCard.style.cssText = 'padding:16px;background:' + alertData.severityBg + ';border-left:4px solid ' + alertData.severityColor + ';border-radius:8px;';
            
            const severityLabel = document.createElement('div');
            severityLabel.style.cssText = 'font-weight:700;font-size:0.9rem;color:' + alertData.severityColor + ';margin-bottom:8px;';
            severityLabel.textContent = 'âš ï¸ ' + alertData.severity + ' Alert';
            
            const issueText = document.createElement('div');
            issueText.style.cssText = 'font-size:1rem;font-weight:600;';
            issueText.textContent = alertData.issue;
            
            severityCard.appendChild(severityLabel);
            severityCard.appendChild(issueText);
            
            const detailsCard = document.createElement('div');
            detailsCard.style.cssText = 'background:white;border:1px solid var(--cw-gray-200);border-radius:8px;padding:16px;';
            
            const createRow = function(label, value) {
                const row = document.createElement('div');
                row.style.cssText = 'display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cw-gray-100);';
                
                const labelEl = document.createElement('span');
                labelEl.style.cssText = 'color:var(--cw-gray-600);font-size:0.85rem;';
                labelEl.textContent = label;
                
                const valueEl = document.createElement('span');
                valueEl.style.cssText = 'font-weight:600;color:var(--cw-gray-900);font-size:0.85rem;';
                valueEl.textContent = value;
                
                row.appendChild(labelEl);
                row.appendChild(valueEl);
                return row;
            };
            
            detailsCard.appendChild(createRow('Seafarer:', alertData.seafarer));
            detailsCard.appendChild(createRow('Name:', alertData.name));
            detailsCard.appendChild(createRow('Rank:', alertData.rank));
            detailsCard.appendChild(createRow('Vessel:', alertData.vessel));
            
            const descCard = document.createElement('div');
            descCard.style.cssText = 'background:var(--cw-gray-50);border-radius:8px;padding:16px;';
            
            const descTitle = document.createElement('div');
            descTitle.style.cssText = 'font-weight:600;margin-bottom:8px;font-size:0.9rem;';
            descTitle.textContent = 'Description';
            
            const descText = document.createElement('div');
            descText.style.cssText = 'font-size:0.85rem;color:var(--cw-gray-700);line-height:1.5;';
            descText.textContent = alertData.description;
            
            descCard.appendChild(descTitle);
            descCard.appendChild(descText);
            
            const impactCard = document.createElement('div');
            impactCard.style.cssText = 'background:#fef3c7;border-left:3px solid #f59e0b;border-radius:8px;padding:16px;';
            
            const impactTitle = document.createElement('div');
            impactTitle.style.cssText = 'font-weight:600;margin-bottom:8px;color:#92400e;font-size:0.9rem;';
            impactTitle.textContent = 'âš¡ Impact';
            
            const impactText = document.createElement('div');
            impactText.style.cssText = 'font-size:0.85rem;color:#78350f;line-height:1.5;';
            impactText.textContent = alertData.impact;
            
            impactCard.appendChild(impactTitle);
            impactCard.appendChild(impactText);
            
            const actionCard = document.createElement('div');
            actionCard.style.cssText = 'background:#dbeafe;border-left:3px solid #3b82f6;border-radius:8px;padding:16px;';
            
            const actionTitle = document.createElement('div');
            actionTitle.style.cssText = 'font-weight:600;margin-bottom:8px;color:#1e40af;font-size:0.9rem;';
            actionTitle.textContent = 'âœ“ Recommended Action';
            
            const actionText = document.createElement('div');
            actionText.style.cssText = 'font-size:0.85rem;color:#1e3a8a;line-height:1.5;';
            actionText.textContent = alertData.action;
            
            actionCard.appendChild(actionTitle);
            actionCard.appendChild(actionText);
            
            container.appendChild(severityCard);
            container.appendChild(detailsCard);
            container.appendChild(descCard);
            container.appendChild(impactCard);
            container.appendChild(actionCard);
            
            openModal('alertDetailModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.viewAlertDetail = viewAlertDetail;

        function openTakeActionModal() {
            closeModal('alertDetailModal');
            
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const dateStr = tomorrow.toISOString().split('T')[0];
            document.getElementById('actionDueDate').value = dateStr;
            
            openModal('takeActionModal');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }
        window.openTakeActionModal = openTakeActionModal;

        function submitAlertAction() {
            const actionType = document.getElementById('actionType').value;
            const notes = document.getElementById('actionNotes').value.trim();
            
            if (!actionType || !notes) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const assignee = document.getElementById('actionAssignee').value;
            const priority = document.getElementById('actionPriority').value;
            const dueDate = document.getElementById('actionDueDate').value;
            
            const actionLabels = {
                'followup': 'Follow-up scheduled',
                'escalate': 'Alert escalated',
                'resolve': 'Alert marked as resolved',
                'defer': 'Alert deferred'
            };
            
            document.getElementById('takeActionForm').reset();
            closeModal('takeActionModal');
            showNotification(actionLabels[actionType] + ' successfully', 'success');
        }
        window.submitAlertAction = submitAlertAction;

        function formatDateLong(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

</script>
</body>
</html>
